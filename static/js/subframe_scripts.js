window.__assetPrefix__="",(()=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t){var n=function(t,n){if("object"!==e(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var r=o.call(t,n||"default");if("object"!==e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(t)}(t,"string");return"symbol"===e(n)?n:String(n)}function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function o(e){for(var o=1;o<arguments.length;o++){var r=null!=arguments[o]?arguments[o]:{};o%2?n(Object(r),!0).forEach((function(n){var o,i,a;o=e,i=n,a=r[n],(i=t(i))in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var r,i;null===(r=globalThis.chrome)||void 0===r||r.runtime,null===(i=globalThis.chrome)||void 0===i||i.tabs;function a(e){return new Promise(((t,n)=>{const o=new FileReader;o.onload=function(e){var n;t((null===(n=e.target)||void 0===n?void 0:n.result)||"")},o.onerror=function(e){n(e)},o.readAsDataURL(e)}))}let c=function(e){return e[e.Capture_Video_Failed=1]="Capture_Video_Failed",e[e.Blob_To_Base64_Failed=2]="Blob_To_Base64_Failed",e}({});const d={command:"current_video_info",func:function(e){const t=document.querySelector("video"),{currentTime:n,duration:o}=t,r=n,i=Math.ceil(n);(function(e){return new Promise(((t,n)=>{try{var o;const n=null===(o=e.getClientRects())||void 0===o?void 0:o[0],r=document.createElement("canvas"),i=r.getContext("2d");r.width=n.width,r.height=n.height,null==i||i.drawImage(e,0,0,n.width,n.height),r.toBlob(t,"image/jpeg",1)}catch(r){n(r)}}))})(t).then((e=>{if(e)a(e).then((e=>{var t;const n={currentTime:i,currentPreciseTime:r,duration:o,snapshotImg:e};null===(t=window.parent)||void 0===t||t.postMessage({videoCommandResponse:n},"*")})).catch((e=>{var t;const n={errorInfo:{code:c.Blob_To_Base64_Failed,message:e.toString()},currentTime:i,currentPreciseTime:r,duration:o};null===(t=window.parent)||void 0===t||t.postMessage({videoCommandResponse:n},"*")}));else{var t;const e={errorInfo:{code:c.Capture_Video_Failed,message:"capture blob is null"},currentTime:i,currentPreciseTime:r,duration:o};null===(t=window.parent)||void 0===t||t.postMessage({videoCommandResponse:e},"*")}})).catch((e=>{var t;const n={errorInfo:{code:c.Capture_Video_Failed,message:e.toString()},currentTime:i,currentPreciseTime:r,duration:o};null===(t=window.parent)||void 0===t||t.postMessage({videoCommandResponse:n},"*")}))}},l=[o({},d)];function s(e,t,n,o){let r=0;const i=/\s/;for(let a=0;a<n;a++)i.test(t[a])&&r++;return function(e,t,n){const o={found:!1,startIndex:-1,endIndex:-1};if(!t||!e)return o;const r=/\s/g,i=e.replace(r,""),a=t.replace(r,""),c=i.indexOf(a);if(-1===c)return o;const d=[];let l=0;const s=/\s/;for(const f of e)s.test(f)||d.push(l),l++;let u=c;if(n)return u=c+n.start,{found:!0,startIndex:d[u],endIndex:d[u+n.len-1]};return{found:!0,startIndex:d[u],endIndex:d[u+a.length-1]}}(e,t,{start:n-r,len:o.replace(/\s/g,"").length})}function u(e,t,n){let o=0;const r=[];var i;return i=e=>{var i;if(null===(i=e.textContent)||void 0===i||!i.length)return!1;const a=o;o+=e.textContent.length;let c=!1;return r.length&&(r.push({node:e,offset:0}),c=!0),o-1>=t&&a-1<t&&r.push({node:e,offset:t-a}),o-1>=n&&a-1<n&&(c&&r.pop(),r.push({node:e,offset:n-a}),!0)},m(e,i),r}function f(e,t){if(!(e.length<2)){if(2===e.length){const n=e[0],o=e[1];if(n.node===o.node&&n.node)return void p(n.node,n.offset,o.offset,t)}for(let n=0;n<e.length;n++){const o=e[n];o.node&&(n===e.length-1?p(o.node,0,o.offset,t):p(o.node,o.offset,void 0,t))}}}function m(e,t){for(const n of e.childNodes)if(n.nodeType===Node.TEXT_NODE){if(t(n))return!0}else if(n.nodeType===Node.ELEMENT_NODE){if(m(n,t))return!0}return!1}function p(e,t,n,o){var r;if(function(e){if((null==e?void 0:e.nodeType)!==Node.ELEMENT_NODE)return!1;const{tagName:t}=e;if("PRE"===t)return!0;return!1}(e.parentNode))return;const i=void 0===n,a=e.textContent||"",c=a.substring(0,t),d=a.substring(t,i?a.length:n+1),l=i?"":a.substring(n+1),s=`<mark ${null==o?void 0:o()}>${d}</mark>`,u=`${v(c)}${s}${v(l)}`,f=document.createRange().createContextualFragment(u);null===(r=e.parentNode)||void 0===r||r.replaceChild(f,e)}function v(e){return e.replaceAll("<","&lt;").replaceAll(">","&gt;")}function g(e){const t=`mark[data-type="${e}"]`;let n=document.querySelector(t);for(;n;)try{var o;const e=document.createRange().createContextualFragment(n.textContent||"");null===(o=n)||void 0===o||null===(o=o.parentNode)||void 0===o||o.replaceChild(e,n)}catch(r){}finally{n=document.querySelector(t)}}const h={command:"highlightTextSelections",func:function(e){const{data:t={}}=e,{selections:n,highlights:o}=t;n&&function(e){const{body:t}=document,n="userMark";g(n),e.forEach((e=>{const o=s((null==t?void 0:t.textContent)||"",e.context,e.offset,e.selection);f(u(t,o.startIndex,o.endIndex),(()=>`data-mark-id='${e.id}' data-type='${n}'  style="background: rgba(183, 201, 255, 0.3);cursor: pointer;" `)),t.querySelectorAll(`mark[data-type="${n}"]`).forEach((e=>{e.addEventListener("click",(()=>{var t;const{markId:n}=e.dataset;null===(t=window.parent)||void 0===t||t.postMessage({eventName:"onMarkClick",markId:n},"*")}))}))}))}(n),o&&function(e){const{body:t}=document,n="userHighlight";g(n),e.forEach((e=>{const o=s((null==t?void 0:t.textContent)||"",e.context,e.offset,e.selection);f(u(t,o.startIndex,o.endIndex),(()=>`data-mark-id='${e.id}' data-type='${n}' style="background: rgba(183, 201, 255);cursor: pointer;" `)),t.querySelectorAll(`mark[data-type="${n}"]`).forEach((e=>{e.addEventListener("click",(()=>{var t;const{markId:n}=e.dataset;null===(t=window.parent)||void 0===t||t.postMessage({eventName:"onMarkClick",markId:n},"*")}))}))}))}(o)}};const y={command:"scrollToMarker",func:function(e){const{data:t={}}=e,{markId:n}=t,o=document.querySelector(`mark[data-mark-id='${n}']`);null==o||o.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},b=[o({},h),o({},y)];try{null===(w=window.parent)||void 0===w||w.postMessage({eventName:"documentContentLoaded",url:location.href},"*"),window.addEventListener("message",(e=>{const{videoCommand:t}=(null==e?void 0:e.data)||{};l.forEach((n=>{if(t===n.command)try{null==n||n.func(e)}catch(o){}}))})),window.addEventListener("message",(e=>{const{textSelectionCommand:t}=(null==e?void 0:e.data)||{};b.forEach((n=>{if(t===n.command)try{null==n||n.func(e)}catch(o){}}))}))}catch(k){}var w})();