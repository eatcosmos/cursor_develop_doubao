(self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[]).push([[896],{2573:(e,t,n)=>{n.d(t,{A:()=>s});const s=new(n(60588).b)},59517:(e,t,n)=>{n.d(t,{A:()=>o});var s=n(11855);function o(e,t){const n=(0,s.useRef)(null),o=s=>{var o;const r=null===(o=s.composedPath)||void 0===o?void 0:o.call(s);if(t){const n=t();r&&n&&!r.includes(n)&&e(s)}else r&&n.current&&!r.includes(n.current)&&e(s)};return(0,s.useEffect)((()=>(document.addEventListener("pointerdown",o),()=>{document.removeEventListener("pointerdown",o)})),[t]),n}},27609:(e,t,n)=>{n.d(t,{A:()=>r});var s=n(11855),o=n(93804);const r=()=>(0,s.useContext)(o.A)},93804:(e,t,n)=>{n.d(t,{A:()=>s});const s=(0,n(11855).createContext)(null)},41659:(e,t,n)=>{n.d(t,{nW:()=>s});n(11855);const s=e=>/^https:\/\/mail\.google\.com\/mail\/u\/\d+\//.test(e)},75882:(e,t,n)=>{n.d(t,{c:()=>l});var s=n(14065),o=n(10633),r=n(91689),i=n(24337);const a=new class{constructor(){var e,t;(0,o.A)(this,"handlers",{}),(0,o.A)(this,"interceptors",[]),null===(e=chrome)||void 0===e||null===(e=e.runtime)||void 0===e||null===(e=e.onMessage)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,this.onMessage.bind(this)),this.interceptors=[],this.handlers={}}onMessage(e,t,n){let o=!1;this.interceptors.forEach((s=>{o=o||Boolean(s.onMessage(e,t,n))}));const r=this.handlers[e.name];var a;return(0,i.Rm)(`[runtime] onMessage -> [${e.name}][${r?"yes":"no"}] `,e.body||""),!!r&&(!r.preCheck||null!==(a=r.preCheck)&&void 0!==a&&a.call(r,t)?((0,s.A)((function*(){try{const s=yield r.handle(e.body,t);n(s)}catch(s){n({__hasError:!0,errorMessage:`${s.message}[${e.name}]`})}}))(),!0):o)}supportExternal(){var e,t;null===(e=chrome)||void 0===e||null===(e=e.runtime)||void 0===e||null===(e=e.onMessageExternal)||void 0===e||null===(t=e.addListener)||void 0===t||t.call(e,this.onMessage.bind(this))}register(e){const{name:t}=e||{};t&&(this.handlers[t]&&(0,i.z3)(`[runtime] handler name[${t}] duplicated !`),(0,i.Rm)(`[runtime] register handler for event: [${t}]`),this.handlers[t]=e)}unregister(e){delete this.handlers[e]}injectInterceptor(e){this.interceptors.push(e)}destroy(){this.handlers={},this.interceptors=[];try{chrome.runtime.onMessage.removeListener(this.onMessage)}catch(e){}}},l=e=>{const t=(0,r.A)(e)?e:[e];return t.forEach((e=>{a.register(e)})),()=>{t.forEach((e=>{a.unregister(e.name)}))}}},23362:(e,t,n)=>{n.d(t,{Ay:()=>s});n(11855);const s=e=>/^http(s)?:\/\/www.baidu.com\//.test(e)?{name:"baidu",inputQuery:["input[name='wd']"],searchTag:"#searchTag",sidebarContainerQuery:"#content_right",searchParam:"wd",watchRouteChange:e=>{const t=document.getElementById("wrapper_wrapper");if(!t)return;const n=new MutationObserver((function(t){for(const n of t){if("childList"!==n.type)break;for(const t of n.addedNodes)if("container"===(null==t?void 0:t.id))return void e()}}));return n.observe(t,{childList:!0}),()=>{n.disconnect()}}}:/^https:\/\/www.google.com?(?:.\w+)?\/search\?/.test(e)?{name:"google",inputQuery:["input[name='q']","textarea[name='q']"],sidebarContainerQuery:"#rhs",searchParam:"q",customAppend(){if("lcl"===((e,t)=>new URL(t).searchParams.get(e))("tbm",window.location.href))return null;let e=document.querySelector(this.sidebarContainerQuery);if(!e){const t=document.querySelector("#rcnt");t&&(e=document.createElement("div"),e.id="rhs",e.style.width="368px",e.style.marginLeft="24px",t.appendChild(e))}return e}}:/^https:\/\/so.toutiao.com\/search\?/.test(e)?{name:"toutiao",inputQuery:["input[type='search']"],sidebarContainerQuery:".s-side-list",searchParam:"keyword",disabled:()=>!0}:/^https:\/\/\w+.bing.com\/search\?/.test(e)?{name:"bing",inputQuery:["[name='q']"],sidebarContainerQuery:"#b_context",searchParam:"q",containerStyle:{minWidth:470,marginLeft:-20},getPageContent:()=>[]}:null},29988:(e,t,n)=>{n.d(t,{A:()=>r,q:()=>o});var s=n(67593);const o="local",r=new s.w({area:o})},86785:(e,t,n)=>{n.d(t,{A:()=>y});var s=n(85335),o=n(11855),r=n(29019),i=n.n(r),a=n(57214),l=n(34944),c=n(66351),d=n(67685),u=n(78503),h=n(17933),g=n(56397),p=n(64353),m=n(59517),f=n(47730),v=n(16464),w=n(63159);const _=({disabledScene:e,disableKey:t=u.lf.selectAssistant,onClickItem:n,onDisableOnceClick:o,optionPageSection:r})=>{const c=(0,a.B)(),[,m]=(0,f.Y)(d.zs[t].global),[_,y]=(0,f.Y)(d.zs[t].page);return(0,w.jsxs)(l.ms.Menu,{children:[d._E.filter((t=>!(null!=e&&e.includes(t.key)))).map((e=>(0,w.jsx)(l.ms.Item,{onClick:()=>(e=>{if((0,h.jk)(e.key,t),null==n||n(),"page"===e.key){const e=window.location.host;_.includes(e)||_.unshift(e),y([..._])}else"global"===e.key?m(!0):o()})(e),"data-testid":`disable-settings-role-${e.key}`,className:v.A.dropItem,children:(0,w.jsx)("span",{className:i()(v.A.name,"disable-menu-item-name"),children:c(e.name)})},e.id))),(0,w.jsx)("p",{className:i()(v.A.info,"disable-footer-info"),children:(0,w.jsxs)(s.x,{i18nKey:"flow_web_ext_setting_reopen",children:["Reopen in",(0,w.jsx)("span",{className:v.A.link,onClick:()=>(0,p.I)({enter_method:g.cz.disableMenu,settting_key:r}),children:"\xa0setting \xa0"})]})})]})},y=e=>{const{optionPageSection:t="",position:n="bottomRight",disableKey:s=u.lf.selectAssistant,className:r,dropdownClassName:a,show:d,setShow:g,cssStyle:p,closeClick:f,renderChildren:y,spacing:b=4,onDisableOnceClick:x,disabledScene:S=[],getPopupContainer:T,getPopupRootContainer:A,children:C,onOutsideClick:k}=e,M=(0,o.useRef)(null),E=(0,m.A)((e=>{const t=e.composedPath();if(A){const e=A();if(e&&t.includes(e))return}M.current&&t.includes(M.current)||(null==g||g(!1),null==k||k())}),A),I=(0,o.useMemo)((()=>T||(()=>E.current)),[T,E.current]),N=e=>{e.preventDefault(),e.stopPropagation(),null==g||g(!0),null==f||f()};(0,o.useEffect)((()=>{d&&(0,h.Bq)(s)}),[d]);return(0,w.jsx)("div",{className:r,ref:E,style:p,"data-testid":"disable-option",children:(0,w.jsx)(l.ms,{trigger:"custom",visible:d,spacing:b,position:n,className:v.A.dropdown,contentClassName:i()(a),getPopupContainer:I,render:(0,w.jsx)("div",{ref:M,onClick:e=>{e.preventDefault(),e.stopPropagation(),null==g||g(!0)},style:{overflow:"hidden"},children:(0,w.jsx)(_,{disabledScene:S,optionPageSection:t,disableKey:s,onClickItem:()=>null==g?void 0:g(!1),onDisableOnceClick:x})}),children:C||(y?y({onTriggerClick:N}):(0,w.jsx)("div",{className:v.A.area,onClick:N,children:(0,w.jsx)(c.gz,{className:v.A.icon})}))})})}},4290:(e,t,n)=>{n.d(t,{gR:()=>l});var s=n(88090),o=n(97311),r=(n(58980),n(60296)),i=n(77591),a=n(96638);function l(e){const t=(0,s.wz)((0,i.TK)("inputAssistantLang")),n={skill_name:"rewrite",template_type:e.template_type};e.adjust&&(n.adjust=e.adjust),e.tone&&(n.tone=e.tone);return r.P.getState().sendMessage({text:e.text,scene:e.scene||o.sJ.writing_assistant,sec_scene:e.sec_scene,prompt:a.EU.adjust_skill,replyLang:e.lang?e.lang:t,browser_plugin_info:JSON.stringify(n)})}},792:(e,t,n)=>{n.d(t,{wu:()=>r});var s=n(82770),o=n(22074);const r=()=>!(0,o.gm)()&&!0===(0,s.Mz)(s.FM.vocabruary,!1)},75943:(e,t,n)=>{n.d(t,{A:()=>c,m:()=>l});var s,o=n(10633),r=n(77591),i=n(24337),a=n(44969);class l{static getInstance(){return l._instance}init(){void 0===this._hostId&&(this._hostId=(0,r.TK)("hostId"),this._listenBrandInfoMessage(),this._listenStoreMessage(),this._sendHostIdMessage(),this._sendBrandInfo(),this._listenHostIdMessage())}registerRecyclable(e){this._recyclables.push(e)}registerRecyclables(e){e.forEach((e=>{e&&this._recyclables.push(e)}))}registerStore(e,t){this._stores.set(e,t)}getHostId(){return this._hostId}constructor(){(0,o.A)(this,"_recyclables",[]),(0,o.A)(this,"_stores",new Map),(0,o.A)(this,"_hostId",void 0),(0,o.A)(this,"_listenHostIdMessage",(()=>{window.addEventListener("message",this._hostIdMessageHandler)})),(0,o.A)(this,"_listenStoreMessage",(()=>{window.addEventListener("message",this._storeMessageHandler)})),(0,o.A)(this,"_listenBrandInfoMessage",(()=>{window.addEventListener("message",this._brandInfoMessageHandler)})),(0,o.A)(this,"_hostIdMessageHandler",(e=>{var t,n,s,o;void 0!==(null==e||null===(t=e.data)||void 0===t?void 0:t.brand)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.brand)!==a.R3||void 0!==(null==e||null===(s=e.data)||void 0===s?void 0:s.hostId)&&(null==e||null===(o=e.data)||void 0===o?void 0:o.hostId)!==this._hostId&&(window.removeEventListener("message",this._hostIdMessageHandler),this._destory())})),(0,o.A)(this,"_brandInfoMessageHandler",(e=>{var t;null!=e&&null!==(t=e.data)&&void 0!==t&&null!==(t=t.extensionReq)&&void 0!==t&&t.requireExtensionInfo&&this._sendBrandInfo(e.origin)})),(0,o.A)(this,"_storeMessageHandler",(e=>{var t,n,s;if(void 0!==(null==e||null===(t=e.data)||void 0===t?void 0:t.brand)&&(null==e||null===(n=e.data)||void 0===n?void 0:n.brand)!==a.R3)return;if(void 0===(null==e||null===(s=e.data)||void 0===s?void 0:s.storeData))return;const o=JSON.parse(e.data.storeData);Object.keys(o).forEach((e=>{const t=this._stores.get(e);t&&t.setState(JSON.parse(o[e]))}))})),(0,o.A)(this,"_sendStoreData",(()=>{const e={};this._stores.forEach(((t,n)=>{e[n]=JSON.stringify(t.getState())}));const t=JSON.stringify(e);window.postMessage({storeData:t}),this._stores.clear()}))}_sendHostIdMessage(){window.postMessage({hostId:this._hostId,brand:a.R3})}_sendBrandInfo(e="*"){const t={brandName:a.R3,version:chrome.runtime.getManifest().version};window.postMessage({extensionRes:t},e)}_destory(){window.removeEventListener("message",this._storeMessageHandler),window.removeEventListener("message",this._brandInfoMessageHandler),this._sendStoreData(),this._recyclables.forEach((e=>{try{"function"==typeof e?e():"function"==typeof(null==e?void 0:e.destory)&&e.destory()}catch(t){(0,i.z3)({message:"\u6267\u884cdestroy\u5931\u8d25",error:t})}})),this._recyclables=[]}}function c(e){l.getInstance().registerRecyclable(e)}s=l,(0,o.A)(l,"_instance",new s)},12710:(e,t,n)=>{n.d(t,{Bx:()=>s});const s=[["rgba(183, 201, 255, 0.44)","rgba(164, 186, 254, 0.44)"],["rgba(215, 160, 255, 0.44)","rgba(199, 126, 250, 0.44)"],["rgba(255, 201, 126, 0.44)","rgba(248, 191, 111, 0.44)"],["rgba(204, 255, 86, 0.44)","rgba(189, 243, 61, 0.44)"],["rgba(251, 255, 20, 0.44)","rgba(251, 255, 30, 0.44)"]]},64353:(e,t,n)=>{n.d(t,{I:()=>i});var s=n(21811),o=n(77591),r=n(16409);const i=e=>{(0,o.TK)("authInfo").isAuthenticated?(0,r.cs)({name:"open-options-page",body:e}):(0,s.DT)()}},86855:(e,t,n)=>{n.d(t,{t_:()=>f});var s=n(14065),o=n(44557),r=n(34870),i=n(45498),a=n(60296),l=n(64802),c=n(5440),d=n(89669),u=n(75943),h=n(4290),g=n(77591),p=n(96638);const m={inputTextReady:!0,barVisible:!1,barFakeHide:!1,boxVisible:!1,displayMode:"bar",inputText:"",contextText:"",range:null,currentAction:p.EU.explain,actionMessages:{},messageCursor:0,askContent:"",writeEnabled:!1,selectionBaseInfo:(0,o.A)({},c.Ws),simpleSelectionBaseInfo:(0,o.A)({},c.Ws),sceneId:void 0},f=(0,i.vt)()((0,r.eh)(((e,t)=>{return(0,o.A)((0,o.A)({},m),{},{setBarVisible:t=>e((()=>({barVisible:t,barFakeHide:!t}))),setBarFakeHide:t=>e((()=>({barFakeHide:t}))),setBoxVisible:t=>e((()=>({boxVisible:t}))),setDisplayMode:t=>e((()=>({displayMode:t}))),setInputText:t=>e((()=>({inputText:t}))),setRange:t=>e((()=>({range:t}))),setAskContent:t=>e((()=>({askContent:t}))),setCurrentAction:t=>e((()=>({currentAction:t}))),clearMessages:()=>e((()=>m)),setMessageCursor:t=>e((()=>({messageCursor:t}))),setWriteEnabled:t=>{e((()=>({writeEnabled:t})))},setTone:t=>{e((()=>({tone:t})))},search:n=>{var s,r;const{inputText:i,currentAction:c,lastSearchId:d="",abort:u,tone:m,askContent:f,range:v}=t();u(null!==(s=null==n||null===(r=n.abortOptions)||void 0===r?void 0:r.id)&&void 0!==s?s:d,null==n?void 0:n.abortOptions);const{enter_chat_method:w,current_page:_="",scene:y="",contextText:b="",translateService:x,answerWithSuggest:S,sceneId:T}=n||{},A=(null==n?void 0:n.text)||i;let C=A;const k=c===p.EU.translate?(0,g.TK)("translateLanguage"):"";let M,E="";var I;(c===p.EU.ask?E=f:c===p.EU.translate&&v&&(C=(0,l.l$)(v)||C),c===p.EU.adjust_skill)?M=(0,h.gR)({text:C||"",template_type:"tone",tone:null==m?void 0:m.value,scene:"highlight_search_result_tool",sec_scene:"highlight_search_result_adjust_tone"}):M=a.P.getState().sendMessage({text:C,prompt:c,language:null!==(I=null==n?void 0:n.language)&&void 0!==I?I:k,answerWithSuggest:S,enter_chat_method:w,current_page:_,scene:y,userQueryContent:E,sec_scene:null==n?void 0:n.sec_scene,isUserCustomSkill:(0,p.em)(c),contextText:b,translateService:x,sceneId:T});e((e=>({inputText:c===p.EU.ask?A:C,actionMessages:(0,o.A)((0,o.A)({},e.actionMessages),{},{[e.currentAction]:[M]}),messageCursor:0,lastSearchId:M})))},regenerate:({replyId:n,enter_chat_method:s,current_page:r="",scene:i="",answerWithSuggest:l}={})=>{var c;const{actionMessages:d,inputText:u,currentAction:m,messageCursor:f,tone:v}=t(),w=null===(c=d[m])||void 0===c?void 0:c[f],_=a.P.getState().messages[null!=w?w:""];let y;var b;m===p.EU.adjust_skill?y=(0,h.gR)({text:u||"",template_type:"tone",tone:null==v?void 0:v.value,scene:"highlight_search_result_tool",sec_scene:"highlight_search_result_adjust_tone"}):y=a.P.getState().sendMessage({text:u,prompt:m,enter_chat_method:s,current_page:r,scene:i,language:m===p.EU.translate?(0,g.TK)("translateLanguage"):navigator.language,isRegenerate:!0,replyId:n||(null==_||null===(b=_.body)||void 0===b||null===(b=b.message)||void 0===b?void 0:b.reply_id),isUserCustomSkill:(0,p.em)(m),answerWithSuggest:l});e((e=>{var t;const n=[...null!==(t=e.actionMessages[e.currentAction])&&void 0!==t?t:[],y];return{actionMessages:(0,o.A)((0,o.A)({},e.actionMessages),{},{[e.currentAction]:n}),messageCursor:n.length-1,lastSearchId:y}}))},retry:({enter_chat_method:n,current_page:s="",scene:r=""}={})=>{const{inputText:i,currentAction:l}=t(),c=a.P.getState().sendMessage({text:i,prompt:l,enter_chat_method:n,current_page:s,scene:r,language:l===p.EU.translate?(0,g.TK)("translateLanguage"):navigator.language,isUserCustomSkill:(0,p.em)(l)});e((e=>{var t;const n=null!==(t=e.actionMessages[e.currentAction])&&void 0!==t?t:[];return n.splice(e.messageCursor,1,c),{actionMessages:(0,o.A)((0,o.A)({},e.actionMessages),{},{[e.currentAction]:n}),lastSearchId:c}}))},abort:(e,t)=>{a.P.getState().abortMessage(e,t)},checkAndSetInputLang:(n=(0,s.A)((function*(){e({inputTextLangDetecting:!0});const n=yield(0,d.v)(t().inputText);return e({inputTextLang:n,inputTextLangDetecting:!1}),n})),function(){return n.apply(this,arguments)}),setSceneId:t=>e({sceneId:t}),setTrigger:t=>e({trigger:t})});var n})));u.m.getInstance().registerStore("useSelectAssistantStore",f)},58484:(e,t,n)=>{n.d(t,{gR:()=>u,zl:()=>g});var s=n(72106),o=n(56397),r=n(82770),i=n(82275),a=n(97311),l=n(21559);const c=e=>e&&e!==o.g6.webOther?e:window.location.host,d=e=>{var t;const{current_page:n,show_from:i,show_type:a}=e,l=(0,s.A)({current_page:c(n),show_from:i,show_type:a},(e=>void 0===e));null===(t=r.Ay.Tea)||void 0===t||t.event(o.Ur.viewDAU,l)},u=(e,t)=>e===o.Ur.enterPage&&(null==t?void 0:t.current_page)===o.g6.chat?(t.show_from="enter_page_chat",void d(t)):e===o.Ur.showMailEntryButton||e===o.Ur.writingSkilShow?(t.show_from=t.show_from||e,void d(t)):e===o.Ur.showSelectAssistantMenu||e===o.Ur.showSearchAssistant||e===o.Ur.showVideoAssistant||e===o.Ur.showChatAssistant||e===o.Ur.collectionButtonShow?(t.show_from=e,void d(t)):e===o.Ur.searchLinkPreviewEntryShow||e===o.Ur.hyperLinkPreviewEntryShow?(t.show_from=e===o.Ur.searchLinkPreviewEntryShow?o.Z5.searchResultPreview:o.Z5.hyperlinkResultPreview,void d(t)):e===o.Ur.showPodcastAssistant?(t.show_from=o.Z5.podcast_show,void d(t)):void 0,h=e=>{var t;null===(t=r.Ay.Tea)||void 0===t||t.event(o.Ur.activeDAU,{current_page:c(null==e?void 0:e.current_page),button_name:null==e?void 0:e.button_name,click_from:null==e?void 0:e.click_from})},g=(e,t)=>e!==o.Ur.copy&&e!==o.Ur.regenerate&&e!==o.Ur.continueInChat&&e!==o.Ur.retry||(null==t?void 0:t.click_from)!==o.Z5.selectAssistantResult?(null==t?void 0:t.click_from)===o.Z5.deepSearchMode||e===o.Ur.searchResultCardClick||e===o.Ur.clickDeepSearchBtn?(t.click_from=o.Z5.searchAssistant,void h(t)):t.click_from!==a.sJ.writing_assistant?e===o.Ur.copy||e===o.Ur.regenerate||e===o.Ur.continueInChat||e===o.Ur.retry||e===o.Ur.clickSearchAssistantSuggest?(null===t.click_from&&l.vF.persist.log({eventName:"NULL_CLICK_FROM_EVENT",meta:{event_name:e,params:t}}),void h(t)):e===o.Ur.clickSelectAssistantMenuBtn||e===o.Ur.clickSelectAssistantResultBtn?(t.click_from=o.Z5.selectAssistantMenu,void h(t)):e!==o.Ur.clickVideoAssistantSummarizeBtn||t.click_from!==i.K.IMMERSION_BTN&&t.click_from!==i.K.UPPER_RIGHT&&t.click_from!==i.K.ONBOARDING?e===o.Ur.clickVideoImmersionGuideTips||e===o.Ur.clickVideoImmersionGuideIcon||e===o.Ur.immersionTimeLine?(t.click_from=o.Z5.videoAssistant,void h(t)):e===o.Ur.clickChatAssistantPopoverSettings||e===o.Ur.clickChatAssistantPopover?(t.click_from=o.Z5.chatAssistantPopover,void h(t)):e===o.Ur.sendMessage&&(null==t?void 0:t.current_page)===o.g6.chat?(t.click_from=o.Z5.sendMessageInChat,void h(t)):e===o.Ur.clickMailEntryButton?(t.click_from=o.Z5.mailEntryButton,void h(t)):e===o.Ur.collectionButtonClickSave?(t.click_from=o.Z5.collect,void h(t)):e===o.Ur.searchLinkPreviewResultShow||e===o.Ur.hyperLinkPreviewResultShow?(t.click_from=e===o.Ur.searchLinkPreviewResultShow?o.Z5.searchResultPreview:o.Z5.hyperlinkResultPreview,void h(t)):e===o.Ur.clickPodcastAssistantSummarizeBtn||e===o.Ur.clickPodcastAssistantSummarizeResult?(t.click_from=o.Z5.podcast_click,void h(t)):e===o.Ur.quickTranslate?(t.click_from=o.Z5.quick_translate,void h(t)):e===o.Ur.takeNoteBtnClick?(t.click_from=o.Z5.videoAssistant,void h(t)):void 0:(t.click_from=o.Z5.videoAssistant,void h(t)):void h(t):(t.click_from=o.Z5.selectAssistantMenu,void h(t))},40992:(e,t,n)=>{n.d(t,{Kt:()=>d});var s=n(58980),o=n(56397),r=n(12038),i=n(77591),a=n(64123),l=n(4252);const c=({hoverTranslateSetting:e})=>{const t=(0,i.gv)(),n={[s.X0.NO_TRANSLATE]:{clickFrom:"mouse_nothing",value:"nothing"},[s.X0.TRANSLATE_DIRECTLY]:{clickFrom:"mouse_hover",value:"direct_translate"},[s.X0.TRANSLATE_BY_COMMAND]:{clickFrom:`mouse_${(0,a.AI)(a.jv.Command)}`,value:(0,a.AI)(a.jv.Command)},[s.X0.TRANSLATE_BY_OPTION]:{clickFrom:`mouse_${(0,a.AI)(a.jv.Option)}`,value:(0,a.AI)(a.jv.Option)},[s.X0.TRANSLATE_BY_CUSTOM_SHORTCUT]:{clickFrom:`mouse_${t[l.e.HoverTextTranslate].key}`,value:t[l.e.HoverTextTranslate].key}};if(e){return n[e]}return{clickFrom:"setting",value:"setting"}},d=({hoverTranslateSetting:e,isClickSetting:t})=>{const n=c({hoverTranslateSetting:e,isClickSetting:t});(0,r.z8)(o.Ur.chooseMouseHoverResult,{value:n.value.toLowerCase()})}},4252:(e,t,n)=>{n.d(t,{e:()=>s});let s=function(e){return e.OpenSide="OpenSide",e.TranslatePage="TranslatePage",e.ReadPage="ReadPage",e.HoverTextTranslate="HoverTextTranslate",e.ScreenCapture="ScreenCapture",e.VoiceInput="VoiceInput",e.CollectPage="CollectPage",e.BilingualSubtitles="BilingualSubtitles",e.TTSReadPage="TTSReadPage",e}({})},5440:(e,t,n)=>{n.d(t,{Ws:()=>c});var s=n(44557),o=(n(93772),n(77453),n(10633));const r=["width","height","max-width","max-height","min-width","min-height","padding-top","padding-bottom","padding-left","padding-right","border","box-sizing","line-height","text-indent","text-align","font-size","font-family","font-weight","font-style","font-variant","letter-spacing","white-space","word-spacing","word-wrap","word-break","position","overflow"],i=class{getStyles(e,t=r){const n=window.getComputedStyle(e),s={};return t.map((t=>{const o=function(e,t=["-","_"]){let n=[],s=0,o=new Set(t);for(;s<e.length;)o.has(e[s])?(n.push(e[s+1].toUpperCase()),s++):n.push(e[s]),s++;return n.join("")}(t),r=n.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===r){const t=e.getBoundingClientRect();s[o]=`${t[o]}px`}else["max-width","max-height","min-width","min-height"].includes(t)?s[o]=this.convertPercentToPx(e,t,r):s[o]=r})),s}getStyle(e,t){return window.getComputedStyle(e).getPropertyValue(t)}getCssText(e,t=r){const n=window.getComputedStyle(e);return t.map((t=>{const s=n.getPropertyValue(t);if(["width","height"].includes(t)&&"auto"===s){return`${t}: ${e.getBoundingClientRect()[t]}px`}return["max-width","max-height","min-width","min-height"].includes(t)?`${t}: ${this.convertPercentToPx(e,t,s)}`:`${t}: ${s}`})).join(";")}getFontStyles(e){const t=window.getComputedStyle(e);return{fontFamily:t.getPropertyValue("font-family"),fontSize:parseFloat(t.getPropertyValue("font-size")),fontWeight:parseFloat(t.getPropertyValue("font-weight")),lineHeight:parseFloat(t.getPropertyValue("line-height"))}}getContentBox(e){return{width:e.scrollWidth,height:e.scrollHeight}}getScrollbarWidth(e){const t=window.getComputedStyle(e),n=parseFloat(t.getPropertyValue("border-left-width"))||0,s=parseFloat(t.getPropertyValue("border-right-width"))||0;return e.offsetWidth-e.clientWidth-n-s}convertPercentToPx(e,t,n){if(!n.includes("%"))return n;const s=parseFloat(n)/100,o=e.parentElement;if(!o)return"none";let r=window.getComputedStyle(o),i=parseFloat(r.getPropertyValue("width")),a=parseFloat(r.getPropertyValue("height")),l=r.getPropertyValue("box-sizing"),c=parseFloat(r.getPropertyValue("border-width")),d=parseFloat(r.getPropertyValue("padding-left")),u=parseFloat(r.getPropertyValue("padding-right")),h=parseFloat(r.getPropertyValue("padding-top")),g=parseFloat(r.getPropertyValue("padding-bottom")),p=i,m=a;return"border-box"===l&&(p=i-d-u-2*c,m=a-h-g-2*c),t.includes("height")?m*s+"px":p*s+"px"}},a=class{constructor(){if((0,o.A)(this,"nodeId","-aichat-mirrorTextNode"),(0,o.A)(this,"mirrorTextNode",void 0),(0,o.A)(this,"domMeasurement",new i),(0,o.A)(this,"mirrorContainer",void 0),!document)throw new Error("TextareaMeasurement can only be run under DOM environment");this.initMirrorTextarea()}measureText(e,t,n){const s=this.domMeasurement.getStyle(e,"display"),o=this.domMeasurement.getCssText(e);return this.mirrorTextNode.style.cssText=o,"inline"===s&&(this.mirrorTextNode.style.textAlign="initial"),this.mirrorTextNode.innerHTML=t.split("").map((e=>`<span>${e}</span>`)).join(""),this.doMeasureText({element:e,display:s,text:t,index:n})}loadElement(e,t){let n=this.domMeasurement.getStyle(e,"display"),s=parseFloat(this.domMeasurement.getStyle(e,"width"))-this.domMeasurement.getScrollbarWidth(e),o=this.domMeasurement.getCssText(e);return o+=`; height: auto; max-height: none; width: ${s}px; overflow: hidden;`,"inline"===n&&(o+="; text-align: initial"),this.mirrorTextNode.style.cssText=o,this.mirrorTextNode.innerHTML=t.split("").map((e=>`<span>${e}</span>`)).join(""),{measureText:s=>this.doMeasureText({element:e,display:n,text:t,index:s})}}destroy(){this.mirrorContainer.remove()}doMeasureText(e){const{element:t,display:n,index:s,text:o}=e;if(s<0||s>o.length-1)throw new Error(`char indexing(index: ${s})overflowed, allowed range:0 - ${o.length-1}`);let r=this.mirrorTextNode.querySelector(`span:nth-child(${s+1})`),{offsetLeft:i,offsetTop:a,offsetHeight:l,offsetWidth:c}=r,d=0;if("inline"===n){const e=this.mirrorTextNode.querySelector("span:nth-child(1)");e&&(d=e.offsetTop)}let u=a,h=i;if("\n"===o[s]&&s===o.length-1){u+=parseFloat(this.domMeasurement.getStyle(t,"line-height")),h=0}return{left:h,right:h+c,top:u,bottom:u+l,width:c,height:l,deviation:d}}initMirrorTextarea(){const e=document.createElement("div");this.mirrorContainer=e,e.setAttribute("contenteditable","false"),e.id=this.nodeId,e.style.position="absolute",e.style.width="0px",e.style.height="0px",e.style.overflow="hidden",document.body.appendChild(e);const t=e.shadowRoot||e.attachShadow({mode:"open"});if(!this.mirrorTextNode){const e=document.createElement("div");e.className="mirror-text-container",t.appendChild(e),this.mirrorTextNode=e,this.mirrorTextNode.style.display="block"}}};new class{getSelectionRect(e,t){if(!e.collapsed){const t=e.getBoundingClientRect();if(0!==t.width||0!==t.height)return t}const n=e.startContainer;if(n instanceof HTMLElement){const s=n.childNodes[e.startOffset];if(s&&this.isBasicInput(s)){const e=this.getSelectionRectForBasicInputV2(s);return e.left=Math.round(e.left),e.right=Math.round(e.right),e.top=Math.round(e.top),e.bottom=Math.round(e.bottom),e.width=Math.round(e.width),e.height=Math.round(e.height),e}if(t)return this.getSelectionRectFromCollapsedElement(s)}return null}getSelectedText(e){if(e.commonAncestorContainer.nodeType===Node.TEXT_NODE){const t=a(e.commonAncestorContainer.parentElement);return t.selectable?i(t.whiteSpaceType,e.commonAncestorContainer.textContent.slice(e.startOffset,e.endOffset).trim()):""}if(e.startContainer instanceof HTMLElement){const t=e.startContainer.childNodes[e.startOffset];if(t&&this.isBasicInput(t)){if(!a(t).selectable)return"";const{selectionStart:e,selectionEnd:n}=t;return t.value.slice(e,n).trim()}}let t,n=[],s=!1,o=!1,r=(t,l)=>{t.nodeType===Node.TEXT_NODE?function(t,r){function a(e){return i(r.whiteSpaceType,e)}t===e.startContainer&&(s=!0),s&&t.nodeType===Node.TEXT_NODE&&r.selectable&&(t===e.startContainer&&t===e.endContainer?n.push({content:a(t.textContent.slice(e.startOffset,e.endOffset))}):t===e.startContainer?n.push({content:a(t.textContent.slice(e.startOffset))}):t===e.endContainer?n.push({content:a(t.textContent.slice(0,e.endOffset))}):n.push({content:a(t.textContent)})),t===e.endContainer&&(o=!0)}(t,l):t.nodeType===Node.ELEMENT_NODE&&function(t){if(t===e.startContainer&&(s=!0),t===e.endContainer)return void(o=!0);const i=a(t);i.selectable&&n.push({content:" "});for(const e of t.childNodes)if(r(e,i),o)break;i.selectable&&(function(e,t){return"BR"===e.tagName||!t.display.startsWith("inline")}(t,i.style)?n.push({content:"\n"}):n.push({content:" "}))}(t)};return t=e.commonAncestorContainer instanceof HTMLElement?a(e.commonAncestorContainer):a(e.commonAncestorContainer.parentElement),r(e.commonAncestorContainer,t),n.map((e=>e.content)).join("").trim().split("\n").map((e=>e.trim())).join("\n").replace(/\n\n+/g,"\n\n").replace(/  +/g," ");function i(e,t){return"normal"===e?t.split("\n").map((e=>e.trim())).join(""):"keepNewLine"===e?t.split("\n").map((e=>e.trim())).join("\n"):t}function a(e){const t=getComputedStyle(e);if("SCRIPT"===e.tagName||"STYLE"===e.tagName||"none"===t.userSelect||"0"===t.opacity||"none"===t.display||"hidden"===t.visibility)return{style:t,selectable:!1,whiteSpaceType:"normal"};let n;return n="pre-line"===t.whiteSpace?"keepNewLine":t.whiteSpace.startsWith("pre")||"break-spaces"===t.whiteSpace?"keepNewLineAndSpace":"normal",{style:t,selectable:!0,whiteSpaceType:n}}}isBasicInput(e){return e instanceof HTMLTextAreaElement||e instanceof HTMLInputElement}getSelectionRectFromCollapsedElement(e){const t=e.shadowRoot.getSelection().getRangeAt(0);return this.getSelectionRect(t)}getSelectionRectForBasicInputV2(e){const t=e.getBoundingClientRect(),n=e.selectionStart,s=e.selectionEnd-1,o=e.scrollTop,r=e.value,i=new a,{measureText:l}=i.loadElement(e,e.value),c=l(n),d=l(s);if(c.top===d.top)return i.destroy(),{left:t.left+c.left,right:t.left+d.left,top:t.top+c.top-o,bottom:t.top+d.bottom,width:d.left-c.left,height:d.bottom-c.top};let u="",h="",g=n,p=n;for(let a=n;a<=s;a++){const e=r[a];"\n"===e||a===s?(h.length>u.length&&(u=h,g=p),h="",p=a+1):h+=e}const m=l(g),f=l(g+u.length);if(m.top!==f.top)return i.destroy(),{left:t.left,right:t.right,top:t.top+c.top-o,bottom:t.top+d.bottom,width:t.width,height:d.bottom-c.top};const v=Math.min(c.left,d.left,m.left,f.left),w=Math.max(c.left,d.left,m.left,f.left);return i.destroy(),{left:t.left+v,right:t.left+w,top:t.top+c.top-o,bottom:t.top+d.bottom,width:w-v,height:d.bottom-c.top}}};n(77259);const l={top:NaN,left:NaN,bottom:NaN,right:NaN,height:NaN,width:NaN,clientBottom:NaN},c=(0,s.A)({text:"",contextText:"",range:null},l)},77453:(e,t,n)=>{(()=>{let e=null})()}}]);