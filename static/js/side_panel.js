var e,t,n,a={77191:(e,t,n)=>{n.d(t,{M$:()=>d,jI:()=>l,ml:()=>g});var a=n(44557),s=n(14065),i=n(9144),o=n(70405),r=n(67685);function l(e){return c.apply(this,arguments)}function c(){return(c=(0,s.A)((function*(e){return(0,o.S6)({method:"POST",url:`${r.kD}/plugin/detect_lang`,params:(0,i.wH)(),data:{raw_text:e}})}))).apply(this,arguments)}function d(e){return u.apply(this,arguments)}function u(){return(u=(0,s.A)((function*(e){let t=(0,i.wH)();return e&&(t=(0,a.A)((0,a.A)({},t),{},{language:e})),(0,o.S6)({method:"POST",url:`${r.kD}/skill/recommend`,params:t})}))).apply(this,arguments)}function g(e){return h.apply(this,arguments)}function h(){return(h=(0,s.A)((function*(e){const t=(0,i.wH)();return(0,o.S6)({method:"POST",url:`${r.kD}/image/ocr`,params:t,data:e})}))).apply(this,arguments)}},70405:(e,t,n)=>{n.d(t,{S6:()=>c,sY:()=>r});var a=n(14065),s=n(16409),i=n(2573),o=n(44969);const r=function(){var e=(0,a.A)((function*(e,t){const{data:n,success:a,error:i}=yield(0,s.cs)({name:"http-request",body:{config:e,options:t}});return a?n:i}));return function(t,n){return e.apply(this,arguments)}}(),l=new Set([o.Be,o.BW]),c=function(){var e=(0,a.A)((function*(e,t){try{const{data:n,success:a,error:o}=yield(0,s.cs)({name:"http-request",body:{config:e,options:t}});if(l.has(`${null==n?void 0:n.code}`)&&i.A.emit("api-request-proxy-unAuthorized",{params:e,data:n}),!a)throw o;const{code:r,msg:c,data:d}=n;if(void 0!==r&&0!==r)throw new Error(JSON.stringify({message:`code invalid error: ${r}, ${c}`,code:r}));return d}catch(n){return n}}));return function(t,n){return e.apply(this,arguments)}}()},9144:(e,t,n)=>{n.d(t,{Ql:()=>c,wH:()=>l});var a=n(77591),s=n(44969),i=n(67976),o=n(67685);const r=()=>{const{ttWid:e,webId:t=""}=(0,a.bU)();return e?t:"0"},l=()=>{var e;const{country:t,teaWebId:n,teaUuid:l}=(0,a.bU)();return{version:s.rE,version_code:s.br,language:(0,i.XQ)(),browser_language:navigator.language,device_platform:o.lx,aid:o.sZ,pkg_type:o.eG,device_id:r(),web_id:null!==(e=null!=n?n:l)&&void 0!==e?e:"0",is_new_user:"0",region:t,sys_region:t,"use-olympus-account":1,samantha_web:"1",real_aid:o.sZ||""}},c=()=>{const e={},{isEnableDebug:t,extEnv:n}=(0,a.MI)();return t&&n&&(e["x-tt-env"]=n,e["production"===o.nD?"x-use-ppe":"x-use-boe"]="1"),e}},85563:(e,t,n)=>{n.d(t,{X:()=>s});n(77591);var a=n(47730);const s=()=>{const[e]=(0,a.Y)("authInfo");return(null==e?void 0:e.isAuthenticated)||!1}},22074:(e,t,n)=>{n.d(t,{O:()=>r,fv:()=>l,fx:()=>c,gm:()=>o,nr:()=>i});var a=n(9012),s=n(55322);n(77591);const i=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),o=()=>{var e;return null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Samantha")},r=()=>{var e;return(null===(e=Intl)||void 0===e||null===(e=e.DateTimeFormat())||void 0===e||null===(e=e.resolvedOptions())||void 0===e?void 0:e.timeZone)||""},l=()=>{try{return Boolean(getComputedStyle(document.documentElement||document.body).getPropertyValue("--arc-palette-title"))}catch(e){return!1}};const c=()=>i()?"safari":(()=>{var e;const t=(0,a.A)(navigator,"userAgentData.brands",[]);return null==t||null===(e=t.some)||void 0===e?void 0:e.call(t,(e=>["Chrome"].some((t=>{var n;return null==e||null===(n=e.brand)||void 0===n?void 0:n.includes(t)}))))})()?"chrome":(0,s.m)()?"360":l()?"arc":(()=>{var e;const t=(0,a.A)(navigator,"userAgentData.brands",[]);return null==t||null===(e=t.some)||void 0===e?void 0:e.call(t,(e=>["Chrome","Edge"].some((t=>{var n;return null==e||null===(n=e.brand)||void 0===n?void 0:n.includes(t)}))))})()?"edge":""},44969:(e,t,n)=>{n.d(t,{$9:()=>h,BW:()=>_,Be:()=>p,Cp:()=>r,EP:()=>l,JE:()=>c,LN:()=>b,R3:()=>m,Vn:()=>v,Yq:()=>g,Zn:()=>f,br:()=>o,j0:()=>u,o2:()=>d,rE:()=>i,v:()=>w});var a=n(77793);function s(){return(0,a.A)().replaceAll("-","")}const i="1.12.0",o=20650,r="/browser-extension",l=`${r}/login`,c=`${r}/welcome`,d=`${r}/landing`,u=`${r}/uninstall`,g=`${s()}`,h=`${s()}`,m="doubao",p="710022013",_="710012001",v=634880,f="en-GB",b="en",w="flow-ext-chat-chunk-task-store"},80459:(e,t,n)=>{n.d(t,{JL:()=>r,Ku:()=>s,ST:()=>o,V6:()=>i,qB:()=>c,yL:()=>l});var a=n(9012);n(11855),n(75541),n(77591),n(22074),n(76813),n(75943),n(77259);function s(e){return e&&("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName)}function i(e,t){let n=null,s=null;const i=(0,a.A)(t,"maxWait",1e3);function o(){n&&(clearInterval(n),n=null)}return new Promise((r=>{const l=()=>{const n=(0,a.A)(t,"wrapper",document).querySelector(e);n&&(o(),s&&(clearTimeout(s),s=null),r(n))};n=window.setInterval(l,100),s=window.setTimeout((()=>{o(),r(null)}),i),l()}))}const o=e=>e instanceof Element&&"STYLE"===e.tagName.toUpperCase(),r=e=>e instanceof Element&&"LINK"===e.tagName.toUpperCase(),l=e=>e instanceof Element&&"SCRIPT"===e.tagName.toUpperCase(),c=e=>8===e.nodeType},20825:(e,t,n)=>{n.d(t,{Cu:()=>o,GR:()=>i,_K:()=>s});var a=n(14065);const s={windowId:-1,get isInSidePanel(){return location.href.startsWith(chrome.runtime.getURL("side_panel.html"))}},i=function(){var e=(0,a.A)((function*(){s.windowId=(yield chrome.windows.getCurrent()).id}));return function(){return e.apply(this,arguments)}}(),o=!1},91376:(e,t,n)=>{n.d(t,{ku:()=>s});var a=n(77591);n(22074);const s=()=>{var e;return null===(e=(0,a.TK)("collectionConfig"))||void 0===e?void 0:e.showEntry}},4297:(e,t,n)=>{n.d(t,{r:()=>l});var a=n(14065),s=n(20716),i=n(11855),o=n(67593),r=n(29988);const l=(e,t)=>{const n="object"==typeof e,l=n?e.key:e,[c,d]=(0,i.useState)(t),u=(0,i.useRef)(!1),g=(0,i.useRef)(t instanceof Function?t():t);(0,i.useEffect)((()=>{g.current=c}),[c]);const h=(0,i.useRef)(n?e.instance:new o.w({area:r.q})),m=(0,i.useCallback)((e=>h.current.set(l,void 0!==e?e:g.current)),[l]),p=(0,i.useCallback)(function(){var e=(0,a.A)((function*(e){const t=e instanceof Function?e(g.current):e;yield m(t),u.current&&d(t)}));return function(t){return e.apply(this,arguments)}}(),[m]);(0,i.useEffect)((()=>{var e;u.current=!0;const n={[l]:e=>{u.current&&d(e.newValue)}};return h.current.watch(n),null===(e=h.current.get(l))||void 0===e||e.then((e=>{if(t instanceof Function){const n=null==t?void 0:t(e,!0);void 0!==n&&p(n)}else(0,s.A)(e,t)||d(void 0!==e?e:t)})),()=>{u.current=!1,h.current.unwatch(n),t instanceof Function&&d(t)}}),[l,p]);const _=(0,i.useCallback)((()=>{h.current.remove(l),d(void 0)}),[l]);return[c,p,{setRenderValue:d,setStoreValue:m,remove:_}]}},37358:(e,t,n)=>{n.d(t,{Iq:()=>d});var a=n(44557),s=n(14065),i=n(33451),o=n(24337),r=n(76360);const l=["tabId"];function c(e,t=1e4){const{tabId:n}=e,a=(0,i.A)(e,l);return Promise.race([new Promise((e=>{try{chrome.tabs.sendMessage(n,a,(t=>{var n;chrome.runtime.lastError?("tab-activated"!==a.name&&(0,o.z3)(`[ms][bg][runtime.lastError]${a.name}`,chrome.runtime.lastError),e({success:!1,error:new Error(`[${a.name}]${null===(n=chrome.runtime.lastError)||void 0===n?void 0:n.message}`),data:t})):null!=t&&t.__hasError?e({success:!1,error:new Error(t.errorMessage)}):e({success:!0,data:t})}))}catch(t){e({success:!1,error:t})}})),new Promise((e=>{setTimeout((()=>e({success:!1,error:new Error("timeout")})),t)}))])}function d(e){return u.apply(this,arguments)}function u(){return(u=(0,s.A)((function*(e,t=1e4){const n=yield(0,r.e6)();if(!n)return Promise.resolve({success:!1,data:{}});const s="string"==typeof e?{name:e}:e;return c((0,a.A)({tabId:n.id},s),t)}))).apply(this,arguments)}},16409:(e,t,n)=>{n.d(t,{Iq:()=>s.Iq,cs:()=>a.c});var a=n(44963),s=n(37358)},96638:(e,t,n)=>{n.d(t,{EU:()=>a,HO:()=>s,Hh:()=>d,I8:()=>m,R1:()=>i,WN:()=>u,em:()=>f,fS:()=>p,tE:()=>_});var a={search:"search",read:"read",pronounce:"pronounce",explain:"explain",translate:"translate",summarize:"summarize",grammar:"grammar",rewrite:"rewrite",ask:"browser_ask",browser_explain:"browser_explain",youtube:"youtube",mail:"browser_mail",copy:"copy",browser_plugin_info:"browser_plugin_info",input_skill:"input_skill",collect:"collect",adjust_skill:"adjust_skill"};[{cnName:"\u200b\u4e2d\u6587\u200b",enName:"Chinese\u200b",name:"\u4e2d\u6587",lang:"zh"},{cnName:"\u82f1\u6587\u200b",enName:"English\u200b",name:"English",lang:"en"},{cnName:"\u65e5\u8bed\u200b",enName:"Japanese\u200b",name:"\u65e5\u672c\u8a9e",lang:"ja"},{cnName:"\u97e9\u8bed\u200b",enName:"Korean\u200b",name:"\ud55c\uad6d\uc5b4",lang:"ko"},{cnName:"\u6cd5\u8bed\u200b",enName:"French\u200b",name:"Fran\xe7ais",lang:"fr"},{cnName:"\u5fb7\u8bed\u200b",enName:"German\u200b",name:"Deutsch",lang:"de"},{cnName:"\u897f\u73ed\u7259\u8bed\u200b",enName:"Spanish\u200b",name:"Espa\xf1ol",lang:"es"},{cnName:"\u4fc4\u8bed\u200b",enName:"Russian\u200b",name:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",lang:"ru"},{cnName:"\u610f\u5927\u5229\u8bed\u200b",enName:"Italian\u200b",name:"Italiano",lang:"it"},{cnName:"\u8461\u8404\u7259\u8bed\u200b",enName:"Portuguese\u200b",name:"Portugu\xeas",lang:"pt"},{cnName:"\u8377\u5170\u8bed\u200b",enName:"Dutch\u200b",name:"Nederlands",lang:"nl"},{cnName:"\u745e\u5178\u8bed\u200b",enName:"Swedish\u200b",name:"Svenska",lang:"sv"},{cnName:"\u4e39\u9ea6\u8bed\u200b",enName:"Danish\u200b",name:"Dansk",lang:"da"},{cnName:"\u632a\u5a01\u8bed\u200b",enName:"Norwegian\u200b",name:"Norsk",lang:"no"},{cnName:"\u6ce2\u5170\u8bed\u200b",enName:"Polish\u200b",name:"Polski",lang:"pl"},{cnName:"\u5e0c\u814a\u8bed\u200b",enName:"Greek\u200b",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",lang:"el"},{cnName:"\u571f\u8033\u5176\u8bed\u200b",enName:"Turkish\u200b",name:"T\xfcrk\xe7e",lang:"tr"},{cnName:"\u8d8a\u5357\u8bed\u200b",enName:"Vietlangse\u200b",name:"Ti\u1ebfng Vi\u1ec7t",lang:"vi"},{cnName:"\u6cf0\u8bed\u200b",enName:"Thai\u200b",name:"\u0e44\u0e17\u0e22",lang:"th"},{cnName:"\u5370\u5730\u8bed\u200b",enName:"Hindi\u200b",name:"\u0939\u093f\u0928\u094d\u0926\u0940\u200b",lang:"hi"}].reduce(((e,t)=>(e[t.lang]=t.name,e)),{});const s=[{id:a.ask,prompt:"",name:"flow_web_ext_action_ask",icon:"searchAI"},{id:a.explain,prompt:"\u89e3\u91ca\u8fd9\u6bb5\u6587\u672c: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_explain",icon:"explain"},{id:a.translate,prompt:"\u628a\u4e0b\u9762\u8fd9\u6bb5\u6587\u672c\u7ffb\u8bd1\u6210\u76ee\u6807\u8bed\u8a00: $[lang]\u3002\u9700\u8981\u7ffb\u8bd1\u7684\u5185\u5bb9\u662f: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_translate",icon:"IconTranslateOutline"},{id:a.pronounce,prompt:"",name:"\u6717\u8bfb",icon:"IconPlayAudio"},{id:a.summarize,prompt:"\u603b\u7ed3\u4ee5\u4e0b\u5185\u5bb9: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_summarize",icon:"summarize"},{id:a.grammar,prompt:"\u6821\u5bf9\u5e76\u7ea0\u6b63\u8fd9\u6bb5\u6587\u5b57: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_grammar",icon:"check"},{id:a.adjust_skill,prompt:"\u91cd\u65b0\u8868\u8ff0\u8fd9\u6bb5\u6587\u5b57, \u4f7f\u8fd9\u6bb5\u6587\u5b57\u8868\u8ff0\u7684\u66f4\u52a0\u5408\u7406: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"modify_change_tone",icon:"adjust_skill"},{id:a.copy,prompt:"",name:"message_long_press_copy",icon:"copy"},{id:a.collect,prompt:"",name:"flow_web_ext_action_bookmarks",icon:"collect",options:{brand:"\u8c46\u5305"}}],i=[a.ask,a.grammar,a.rewrite,a.adjust_skill],o=[a.grammar,a.rewrite,a.explain,a.translate,a.copy,a.adjust_skill],r=(new Set([a.ask]),[a.explain,a.translate,a.pronounce,a.collect]),l=[a.copy],c=new Set([a.summarize]),d=(e=[])=>s.filter((t=>r.includes(t.id)&&!c.has(t.id)&&!e.includes(t.id))),u=(e=[])=>s.filter((t=>l.includes(t.id)&&!c.has(t.id)&&!e.includes(t.id))),g=[a.grammar,a.rewrite,a.collect,a.pronounce,a.adjust_skill],h=[a.explain,a.translate,a.copy],m=(e=[])=>s.filter((t=>g.includes(t.id)&&!c.has(t.id)&&!e.includes(t.id))),p=(e=[])=>s.filter((t=>h.includes(t.id)&&!c.has(t.id)&&!e.includes(t.id))),_=e=>(e||s).filter((e=>o.includes(e.id))),v=s.reduce(((e,t)=>(e[t.id]=t,e)),{});const f=e=>!v[e]},15965:(e,t,n)=>{n.d(t,{B9:()=>l});var a=n(89586);const s=10485760,i=new RegExp("^https?:\\/\\/www\\.zhihu\\.com\\/question\\/\\d+");function o(){i.test(location.href)&&(a.Readability.prototype.REGEXPS.negative=/-ad-|^kfecollection-viprecommendcard$|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i)}const r={charThreshold:500,keepClasses:!1};function l(e){return new Promise((e=>{if("complete"===document.readyState||"interactive"===document.readyState)e();else{const t=()=>{document.removeEventListener("DOMContentLoaded",t),e()};document.addEventListener("DOMContentLoaded",t)}})).then((()=>function(e,t=s){const n=(e=e||document).cloneNode(!0);o();const i=new a.Readability(n,r).parse();return i&&i.content.length>t&&i.content.slice(0,t),i}(document,e)))}},64123:(e,t,n)=>{n.d(t,{AI:()=>g,ZV:()=>r,jv:()=>d,o:()=>c});var a=n(7685),s=n.n(a),i=n(4252);const o=(()=>{let e=null;return()=>(null===e&&(e="macos"===s().getParser(navigator.userAgent).getOSName(!0)),e)})();function r(e){const t=o();switch(e){case i.e.OpenSide:return t?`${l.Command}+K`:`${l.Ctrl}+K`;case i.e.TranslatePage:return t?`${l.Option}+1`:`${l.Alt}+1`;case i.e.ReadPage:return t?`${l.Option}+2`:`${l.Alt}+2`;case i.e.HoverTextTranslate:return t?`${l.Command}`:`${l.Ctrl}`;case i.e.ScreenCapture:return t?`${l.Option}+3`:`${l.Alt}+3`;case i.e.CollectPage:return t?`${l.Option}+4`:`${l.Alt}+4`;case i.e.TTSReadPage:return t?`${l.Option}+5`:`${l.Alt}+5`;case i.e.VoiceInput:return"B";case i.e.BilingualSubtitles:return"H";default:return""}}let l=function(e){return e.Command="Command",e.Windows="Windows",e.Ctrl="Ctrl",e.Alt="Alt",e.Option="Option",e.Shift="Shift",e}({});function c(e){return e.split("+").map((e=>{switch(e){case l.Command:return"Cmd";case l.Windows:return"Win";case l.Option:return"Opt";default:return e}})).join(" + ")}let d=function(e){return e.Command="Command",e.Option="Option",e}({});const u={[d.Command]:{macKey:l.Command,winKey:l.Ctrl},[d.Option]:{macKey:l.Option,winKey:l.Alt}},g=e=>{const t=u[e];return o()?t.macKey:t.winKey}},77591:(e,t,n)=>{n.d(t,{Fc:()=>R,MI:()=>N,TK:()=>L,bU:()=>B,gv:()=>E,lv:()=>C,n5:()=>D,pu:()=>H,tl:()=>j,ue:()=>O,vE:()=>T});var a,s=n(14065),i=n(44557),o=n(22234),r=n(97724),l=n(39415),c=n(88090),d=n(87648),u=n(31826),g=n(59186),h=n(53262),m=n(98801),p=n(10242),_=n(96638),v=n(44969),f=n(41753),b=n(29988),w=n(58980),y=n(12710);const A=(0,h.c)();let k=(0,c.wz)(A);k===v.Zn&&(k=v.LN);let S=A;S===v.Zn&&(S=v.LN);const x={vocabruaryDisableAll:!0,vocabruaryDisableHosts:[],vocabruaryHighlightColor:y.Bx[4][0],vocabruaryOnboarding:!0,videoSubtitleDisableAll:!1,videoSubtitleDisableHosts:[],videoImmersionDisableAll:!1,videoImmersionDisableHosts:[],videoSummaryDisableAll:!1,videoMemoDisableAll:!1,videoMemoDisableHosts:[],videoSummaryDisableHosts:[],podcastSummaryDisableAll:!1,podcastSummaryDisableHosts:[],chatFloatCardDisableAll:!1,chatFloatCardDisableHosts:[],sidebarButtonDisabledAll:!1,sidebarButtonDisabledHosts:[],searchDisabledAll:!1,searchDisabledHosts:[],disableSearchAddonsGlobal:!0,disableSearchAddonsHosts:[],autoTranslatePageHosts:[],disableGlobalGrammar:!(0,l.UP)(),disableGrammarHosts:[],InputAssistantDisabledAll:!1,InputAssistantDisabledHosts:[],replyAssistantDisabledAll:!1,replyAssistantDisabledHosts:[],sidebarButtonTop:.5,sidebarButtonPosition:"right",inputAssistantLang:"zh",quickDisabledAll:!1,quickDisabledHosts:[],translateLanguage:k,autoTranslateSubtitles:!0,subtitleTranslateLang:"system",selectBarOnlyIcon:!1,pageTranslateService:w.c$.MICROSOFT,selectTranslateService:w.c$.DOUBAO,pageTranslateShowUnderline:!1,linkPreviewDisabledAll:!1,linkPreviewDisabledHosts:[],hoverTranslateSetting:w.X0.NO_TRANSLATE,inputTranslateInfo:{isFirstUse:!0,language:"en",showInputInnerTips:!0,translateService:w.c$.HUOSHAN,hotKeyCode:w.WR.Space,disableAll:!0},readingPopupActions:{actionList:(0,_.Hh)(),moreActionList:(0,_.WN)()},editingPopupActions:{actionList:(0,_.I8)(),moreActionList:(0,_.fS)()},transPreferConfig:{tipShown:!1,langMap:{}},collectImageDisabledAll:!1,collectImageDisabledHosts:[],socialWebcollectDisabledAll:!1,mediaCardTranslateLanguage:S,readWebPageCtxConfig:{enabled:!0,hasWebPageContextDialogShow:!0,hasUserSwitched:!1}},I=(Object.keys(x),(0,i.A)((0,i.A)({},x),{},{uuid:"",installReason:"",synced:!1,authInfo:{isAuthenticated:!1},launchInfo:{},launchConfig:{},abTestValue:{},chatInfo:{},debugInfo:{isEnableDebug:!1,webEnv:"",extEnv:""},requestCommonParams:{},shortcutsConfig:p.A,actions:_.HO,themeMode:w.lG.AUTO,uiLanguage:A,voiceSpeaker:g.F,sidePanelEnabled:!0,hostId:"",PopupListMaxCount:4,onboardingActionRecord:(0,u.wG)(),isSelectbarMoreMenuClicked:!1,needOpenSideBar:!1,featureInfo:null,collectionConfig:(0,f.i)(),tabConversationMap:{},isHistoryChatsClicked:!1,appSettings:m.K,overseaAccessibility:{},doubaoNoticeKey:"",searchUsageTimesInfo:{},voiceSettingTipShown:!1,isArc:!1,dismissUpdateKey:"",navigatorLanguage:(null===(a=navigator)||void 0===a?void 0:a.language)||"",voiceInputShortcutTipShown:!1}));let M=()=>{};const C=function(){var e=(0,s.A)((function*(){M=yield(0,d.X)(I),I.synced=!0}));return function(){return e.apply(this,arguments)}}(),P=(e,t,n=!1)=>{const a=I[e];return I[e]=n?(0,r.A)(a,t):t,b.A.set(e,I[e])},T=P;function L(e){return I[e]}const j=e=>{const t=L("appSettings")[e];return(0,o.A)(t,m.K[e])},E=()=>I.shortcutsConfig;function R(){return I.authInfo}function N(){return I.debugInfo}function O(){return I.launchInfo}function D(){return I.chatInfo}function H(e,t=!1){return P("chatInfo",e,t)}function B(){return I.requestCommonParams}},5842:(e,t,n)=>{n.d(t,{IK:()=>_,hC:()=>m,u3:()=>p});var a=n(98502),s=n(12648),i=n(10484),o=n(75484),r=n(96092),l=n(77591),c=n(24337),d=(n(21559),n(47730)),u=n(82770),g=n(52833);const h=()=>o.pU.getState().addNewLocalConversation({conversation:{conversation_type:s.Cr.CocoWebSub},conversationId:void 0});const m=e=>{const{tabId:t}=g.on.getState().tabInfo;t?(((e,t,n)=>{if(!(0,l.TK)("authInfo").isAuthenticated)return;const a=(0,l.TK)("tabConversationMap");(0,l.vE)("tabConversationMap",Object.assign({},a,{[e]:{conversationId:t,conversationType:n}}))})(t,e,i.H.Conversation),g.on.getState().setTabInfo({tabId:t})):(0,c.z3)("[zx] tabId not valid",t)};function p(){const{tabId:e}=(0,g.on)((e=>e.tabInfo)),[t]=(0,d.Y)("authInfo"),[n]=(0,d.Y)("chatInfo"),{value:m}=(0,u.Tu)(u.FM.enableNewChat,!1);var p;if(!t.isAuthenticated||!m||!e)return{tabId:e,convId:null===(p=n.mainConversation)||void 0===p?void 0:p.conversation_id,convType:i.H.Conversation};const _=(0,l.TK)("tabConversationMap"),v=_?_[e]:void 0;var f;if(_||((0,c.z3)("[zx] tabConvMap not init"),(0,l.vE)("tabConversationMap",{})),v&&""!==v.conversationId)return v.conversationType!==i.H.NewThread||null!==(f=o.pU.getState().localConversationMap[v.conversationId])&&void 0!==f&&f.local||o.pU.setState((0,a.jM)((e=>{e.localConversationMap[v.conversationId]={local:{createStatus:r.Et.Pending},conversation_type:s.Cr.CocoWebSub}}))),{tabId:e,convId:v.conversationId,convType:v.conversationType};const b=h();return(0,l.vE)("tabConversationMap",Object.assign({},_,{[e]:{conversationId:b,conversationType:i.H.NewThread}})),{tabId:e,convId:b,convType:i.H.NewThread}}function _(){var e;const t=(0,l.TK)("authInfo"),{mainConversation:n}=(0,l.TK)("chatInfo"),a=(0,u.Mz)(u.FM.enableNewChat,!1),s=null==n?void 0:n.bot_id;if(!t.isAuthenticated||!a)return{convId:null==n?void 0:n.conversation_id,convType:i.H.Conversation,mainBotId:s};const{tabId:o}=g.on.getState().tabInfo;if(!o){return{convId:null==n?void 0:n.conversation_id,convType:i.H.Conversation,mainBotId:s}}const r=(0,l.TK)("tabConversationMap"),c=void 0===r[o]?i.H.NewThread:r[o].conversationType;return{convId:null===(e=r[o])||void 0===e?void 0:e.conversationId,convType:c,mainBotId:s}}},36897:(e,t,n)=>{n.d(t,{jB:()=>s});n(11855),n(77591);window.location.href;const a={youtube:/^https:\/\/www.youtube.com\/watch\?/,bilibili:/^https:\/\/www\.bilibili\.com\/video\/\w+/},s=e=>!!e&&a[e].test(location.href)},21811:(e,t,n)=>{n.d(t,{DT:()=>d,GT:()=>u});var a=n(44557),s=n(76813),i=n(67685),o=n(24228),r=n(16409),l=(n(24337),n(44969)),c=n(22074);const d=e=>{if(!location.href.includes(`${i.FI}${l.EP}`))if((0,c.nr)()){const{trackMeta:t}=e||{};window.open(function(e){const t={from:"ext"};return e&&(t.extra=btoa(JSON.stringify(e))),(0,s.ID)(`https://${i.FI}/browser-extension/login`,t)}({trackMeta:t}),"_blank")}else(0,r.cs)({name:"open-login-window",body:(0,a.A)((0,a.A)((0,a.A)({},(0,o.c)()),e),{},{clearWindow:(0,c.fv)()})})},u=()=>{window.location.hostname.endsWith(i.Ud)&&window.postMessage({name:"click_float_btn"})}},66351:(e,t,n)=>{n.d(t,{Ai:()=>Ft,Cy:()=>Ut,I:()=>Wt,Tf:()=>Bt,dd:()=>$t,gz:()=>At,pt:()=>zt,w_:()=>xt,wv:()=>it});var a=n(44557),s=(n(11855),n(54528)),i=n(47351),o=n(45041),r=n(59107),l=n(27398),c=n(70798),d=n(51405),u=n(79613),g=n(76360),h=n(89130),m=n(12508),p=n(34919),_=n(31442),v=n(93708),f=n(86617),b=n(70221),w=n(5960),y=n(67368),A=n(37730),k=n(21010),S=n(16593),x=n(3341),I=n(55615),M=n(98335),C=n(63751),P=n(90952),T=n(64390),L=n(4045),j=n(59799),E=n(34658),R=n(67455),N=n(27040),O=n(14089),D=n(24890),H=n(30961),B=n(21500),z=n(56317),U=n(52621),F=n(77355),$=n(27350),q=n(15440),G=n(23396),W=n(95633),K=n(15238),V=n(40643),Z=n(10360),X=n(31870),Y=n(67310),Q=n(61533),J=n(74772),ee=n(70279),te=n(36011),ne=n(15652),ae=n(56502),se=n(1519),ie=n(48231),oe=n(81621),re=n(6862),le=n(63904),ce=n(48158),de=n(5169),ue=n(52669),ge=n(3040),he=n(50077),me=n(26517),pe=n(55941),_e=n(63544),ve=n(67397),fe=n(96062),be=n(32574),we=n(96452),ye=n(4501),Ae=n(13217),ke=n(3225),Se=n(5654),xe=n(89488),Ie=n(47792),Me=n(75862),Ce=n(82787),Pe=n(93442),Te=n(26025),Le=n(67434),je=n(78802),Ee=n(98554),Re=n(22392),Ne=n(66408),Oe=n(8237),De=n(16367),He=n(39007),Be=n(70873),ze=n(11007),Ue=n(25568),Fe=n(9335),$e=n(53012),qe=n(47494),Ge=n(40549),We=n(92852),Ke=n(57810),Ve=n(2668),Ze=n(91985),Xe=n(47251),Ye=n(27834),Qe=n(28742),Je=n(93313),et=n(83112),tt=n(63610),nt=n(95960),at=n(28434),st=n(63159);const it=(0,d.a)((0,st.jsx)(Ie.h,{})),ot=((0,d.a)((0,st.jsx)(Se.h,{})),(0,d.a)((0,st.jsx)(Re.h,{})),(0,d.a)((0,st.jsx)(be.h,{})),(0,d.a)((0,st.jsx)(ze.h,{})),(0,d.a)((0,st.jsx)(Ue.h,{})),(0,d.a)((0,st.jsx)(Be.h,{})),(0,d.a)((0,st.jsx)(Fe.h,{})),(0,d.a)((0,st.jsx)(le.h,{}))),rt=((0,d.a)((0,st.jsx)(tt.h,{})),(0,d.a)((0,st.jsx)(Ke.h,{})),(0,d.a)((0,st.jsx)(ae.h,{})),(0,d.a)((0,st.jsx)(de.h,{})),(0,d.a)((0,st.jsx)(re.h,{}))),lt=(0,d.a)((0,st.jsx)(ee.h,{})),ct=(0,d.a)((0,st.jsx)(V.h,{})),dt=(0,d.a)((0,st.jsx)(F.h,{})),ut=(0,d.a)((0,st.jsx)(I.h,{})),gt=(0,d.a)((0,st.jsx)(S.h,{})),ht=(0,d.a)((0,st.jsx)(A.h,{})),mt=(0,d.a)((0,st.jsx)(w.h,{})),pt=(0,d.a)((0,st.jsx)(h.h,{})),_t=(0,d.a)((0,st.jsx)(Z.h,{})),vt=((0,d.a)((0,st.jsx)(Y.h,{})),(0,d.a)((0,st.jsx)(Q.h,{})),(0,d.a)((0,st.jsx)(k.h,{}))),ft=(0,d.a)((0,st.jsx)(J.h,{})),bt=(0,d.a)((0,st.jsx)(D.h,{})),wt=((0,d.a)((0,st.jsx)(T.h,{})),(0,d.a)((0,st.jsx)(C.h,{}))),yt=((0,d.a)((0,st.jsx)(P.h,{})),(0,d.a)((0,st.jsx)(W.h,{}))),At=(0,d.a)((0,st.jsx)(te.h,{})),kt=((0,d.a)((0,st.jsx)(G.h,{})),(0,d.a)((0,st.jsx)(ie.h,{}))),St=(0,d.a)((0,st.jsx)(R.h,{})),xt=(0,d.a)((0,st.jsx)(N.h,{})),It=(0,d.a)((0,st.jsx)(B.h,{})),Mt=(0,d.a)((0,st.jsx)(x.h,{})),Ct=(0,d.a)((0,st.jsx)(L.h,{})),Pt=(0,d.a)((0,st.jsx)(j.h,{})),Tt=((0,d.a)((0,st.jsx)(X.h,{})),(0,d.a)((0,st.jsx)(ue.h,{})),(0,d.a)((0,st.jsx)(f.h,{})),(0,d.a)((0,st.jsx)(b.h,{})),(0,d.a)((0,st.jsx)(v.h,{})),(0,d.a)((0,st.jsx)(q.h,{}))),Lt=((0,d.a)((0,st.jsx)(y.h,{})),(0,d.a)((0,st.jsx)(K.h,{}))),jt=((0,d.a)((0,st.jsx)(E.h,{})),(0,d.a)((0,st.jsx)(m.h,{}))),Et=(0,d.a)((0,st.jsx)(U.h,{})),Rt=(0,d.a)((0,st.jsx)(p.h,{})),Nt=((0,d.a)((0,st.jsx)(Ye.h,{})),(0,d.a)((0,st.jsx)(et.h,{})),(0,d.a)((0,st.jsx)(pe.h,{})),(0,d.a)((0,st.jsx)(De.h,{})),(0,d.a)((0,st.jsx)(He.h,{})),(0,d.a)((0,st.jsx)(we.h,{}))),Ot=((0,d.a)((0,st.jsx)($.h,{})),(0,d.a)((0,st.jsx)(Ae.h,{}))),Dt=((0,d.a)((0,st.jsx)(qe.h,{})),(0,d.a)((0,st.jsx)(Ge.h,{})),(0,d.a)((0,st.jsx)(ye.h,{}))),Ht=((0,d.a)((0,st.jsx)(M.h,{})),(0,d.a)((0,st.jsx)(z.h,{}))),Bt=((0,d.a)((0,st.jsx)(_.h,{})),(0,d.a)((0,st.jsx)(se.h,{})),(0,d.a)((0,st.jsx)(ne.h,{}))),zt=(0,d.a)((0,st.jsx)(H.h,{})),Ut=((0,d.a)((0,st.jsx)(O.h,{})),(0,d.a)((0,st.jsx)(ce.h,{})),(0,d.a)((0,st.jsx)($e.h,{}))),Ft=((0,d.a)((0,st.jsx)(Oe.h,{})),(0,d.a)((0,st.jsx)(he.h,{})),(0,d.a)((0,st.jsx)(_e.h,{})),(0,d.a)((0,st.jsx)(Le.h,{})),(0,d.a)((0,st.jsx)(Ne.h,{})),(0,d.a)((0,st.jsx)(fe.h,{})),(0,d.a)((0,st.jsx)(ge.h,{})),(0,d.a)((0,st.jsx)(Xe.h,{})),(0,d.a)((0,st.jsx)(Je.h,{})),(0,d.a)((0,st.jsx)(Te.h,{})),(0,d.a)((0,st.jsx)(Ve.h,{})),(0,d.a)((0,st.jsx)(me.h,{})),(0,d.a)((0,st.jsx)(We.h,{})),(0,d.a)((0,st.jsx)(ve.h,{})),(0,d.a)((0,st.jsx)(je.h,{}))),$t=(0,d.a)((0,st.jsx)(Ee.h,{})),qt=((0,d.a)((0,st.jsx)(Qe.h,{})),(0,d.a)((0,st.jsx)(Ze.h,{})),(0,d.a)((0,st.jsx)(ke.h,{})),(0,d.N)((0,g.Nf)())),Gt=((0,d.a)((0,st.jsx)(oe.h,{})),(0,d.a)((0,st.jsx)(Ce.h,{})),(0,d.a)((0,st.jsx)(xe.h,{})),(0,d.a)((0,st.jsx)(Pe.h,{})),(0,d.a)((0,st.jsx)(Me.h,{})),(0,d.a)((0,st.jsx)(nt.h,{})),(0,d.a)((0,st.jsx)(at.h,{})),(0,a.A)((0,a.A)({},u.M),{},{arrow:ot,avatar:rt,check:s.A,contact:lt,drag:ct,explain:i.A,instruct:dt,rewrite:ut,adjust_skill:o.A,search:gt,sider:ht,summarize:mt,translate:pt,del:_t,copy:r.A,conversation:ft,settings:vt,more:bt,regenerate:wt,expand:yt,close:At,cancel:kt,ok:St,messageFailed:It,right:Mt,IconRead:Ct,IconReadPage:Pt,global:Tt,expandDownFilled:Lt,IconTranslateOutline:jt,IconLangSettings:Et,IconTranslateOutlineActive:Rt,IconLink:Ht,cici:qt,searchToggleSize:Nt,searchMore:Ot,searchSource:Dt,collect:l.A,searchAI:c.A,IconPlayAudio:it})),Wt=(e,t)=>{const n=Gt[e];return n?(0,st.jsx)(n,(0,a.A)({},t)):(e=>{try{return new URL(e),!0}catch(t){return!1}})(e)?(0,st.jsx)("img",(0,a.A)({src:e},t)):(0,st.jsx)(Ht,(0,a.A)({},t))}},8391:(e,t,n)=>{n.d(t,{V_:()=>s});var a=n(77591);n(26472);function s(){const e=(0,a.TK)("featureInfo");null!=e&&e.version&&(e.dotVisibleVersion=e.version,e.cardVisibleVersion=e.version,(0,a.vE)("featureInfo",e))}},73717:(e,t,n)=>{n.d(t,{EX:()=>a,P9:()=>s});const a="https://sameerbajaj.com/jobs/#onboarding_have_a_try",s="https://36kr.com/p/997609012833538#onboarding_have_a_try"},50711:(e,t,n)=>{n.d(t,{f:()=>M});var a=n(10633),s=n(14065),i=n(49392),o=n(48485),r=n(24323),l=n.n(r),c=n(58447),d=n(27527),u=n(10484),g=n(42265),h=n(67685),m=n(97311),p=n(56397),_=n(93476),v=n(47881),f=n(77591),b=n(36245),w=n(24337),y=n(21559),A=n(17411),k=n(20825),S=n(77191);const x=(e,t,n)=>{const a=`${h.C1}/pdf/${e}/${encodeURIComponent(t)}?from_source=${n}&pdf_reading=1`;window.open(a),_.l.getState().isSidePanelMode&&(k._K.isInSidePanel?setTimeout((()=>{_.l.getState().setIsShowSidebar(!1,p.cz.other)}),150):_.l.getState().setIsShowSidebar(!1,p.cz.other))},I=function(){var e=(0,s.A)((function*(e){try{var t;const n=null===(t=(yield d.j.apiService.conversation.ConversationInfo({conversation_id:e})).data)||void 0===t||null===(t=t.conversation)||void 0===t?void 0:t.deleted;return!(0,i.A)(n)&&!n}catch(n){return!1}}));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=(0,s.A)((function*(e){var t,n;const{type:a,link:s,file:i,fromSource:r,opt:l={createNewConv:!1,sendReadMessage:!1}}=e,h="file"===a?null==i?void 0:i.key:null==s?void 0:s.url;if(!h)return void y.vF.persist.error({eventName:"AI PDF read: file url empty",error:new Error("file url empty")});const p=sessionStorage.getItem(h);if(p){if(yield I(p))return void x(p,h,r);sessionStorage.removeItem(h)}const _=(0,f.n5)();let b=null===(t=_.mainConversation)||void 0===t?void 0:t.conversation_id;const w=null===(n=_.mainConversation)||void 0===n?void 0:n.bot_id;if(l.createNewConv)try{var k;b=null===(k=(yield d.j.apiService.samantha.ThreadCreate({bot_id:w})).data)||void 0===k||null===(k=k.thread_info)||void 0===k||null===(k=k.conversation)||void 0===k?void 0:k.conversation_id}catch(C){y.vF.persist.error({eventName:"PDF-READ create convId fail",error:C})}if(b){if(l.sendReadMessage){var M;const e=A.F2.t("skill_read_file_shortcut1"),t=yield(0,S.M$)(),n=(null===(M=(0,o.A)(t.latest_skills,(e=>(null==e?void 0:e.skill_type)===c.K9.ReadPDF)))||void 0===M?void 0:M.skill_id)||"",a={answer_with_suggest:"1",input_skill:JSON.stringify({skill_id:n,skill_type:c.K9.ReadPDF}),source:"chat_action_bar",stream:"1"};if(h.startsWith("http")){const t={compositeContent:{text:e,links:[h]},extraExt:a,reportParams:{scene:m.sJ.chat_action_bar},ctx:(0,v.Pe)(u.H.Conversation,b,w)};(0,g.C)([t],{chatType:u.H.Conversation,botType:"Main"})}else{const t={compositeContent:{text:e,files:[{from:"click",key:h,file_name:null==i?void 0:i.name}]},extraExt:a,reportParams:{scene:m.sJ.chat_action_bar},preGeneratedLocalMessageId:null==i?void 0:i.localMsgId,ctx:(0,v.Pe)(u.H.Conversation,b,w)};(0,g.C)([t],{chatType:u.H.Conversation,botType:"Main"})}}x(b,h,r),sessionStorage.setItem(h,b)}else y.vF.persist.error({eventName:"PDF-READ convId empty",error:new Error("empty convId")})}));return function(t){return e.apply(this,arguments)}}();new class{constructor(){(0,a.A)(this,"blobChunkMap",{}),(0,a.A)(this,"port",null)}onFileChunk(e){var t=this;return(0,s.A)((function*(){const{id:n,chunkIndex:a=0,chunks:s=0,blobData:i,type:o,originMd5:r,error:c}=e||{},d=t.blobChunkMap[n];if(d){const[e,u]=d;if(c)return u(),void delete t.blobChunkMap[n];if(e[a]=new Uint8Array(i),a>=s){const a=new Blob(e.filter(Boolean),{type:o}),s=l()(new Uint8Array(yield a.arrayBuffer()));s!==r&&(0,w.z3)(`File transfer: md5 checks failed between origin(${r}) and chunks merged(${s})`),u(a),delete t.blobChunkMap[n]}}}))()}getFileBlob(e,t){const n=Math.random().toString(32).slice(2);this.blobChunkMap[n]=[[],t],this.port||(this.port=(0,b.c)("file-reader"),this.port.onMessage.addListener(this.onFileChunk.bind(this))),this.port.postMessage({body:{url:e,id:n}})}}},54422:(e,t,n)=>{n.d(t,{Cm:()=>i,F8:()=>d,Kn:()=>l,dZ:()=>o,lO:()=>r,ri:()=>c,sp:()=>a,ut:()=>s});const a="start_request_tts_stream",s="request_stop_tts_stream",i="request_tts_stream_with_text",o="finish_request_tts_stream",r="stop_all_audios",l="force_stop_tts_audio",c="register_tts_audio",d="receive_tts_audio"},93772:(e,t,n)=>{n(76360)},10080:(e,t,n)=>{var a=n(35278),s=n(82283);new a.G,new s.P},84943:(e,t,n)=>{n.d(t,{Dn:()=>s,M:()=>o,Sx:()=>i,wU:()=>a});const a=["ul:has(li)"],s=["block","flow-root","grid","list-item","flex","-webkit-box"],i="en-US",o=["mjx-container"]},9064:(e,t,n)=>{n.d(t,{$8:()=>c,Ch:()=>a,J7:()=>u,JP:()=>r,Mx:()=>s,NU:()=>d,Nt:()=>h,SB:()=>o,Sf:()=>i,nC:()=>m,pK:()=>g,x_:()=>l});const a="__Cici_translate_similar_text_content__",s="__Cici_translate_origin_node__",i="__Cici_translate_translated_inject_node__",o="__Cici_translate_need_wrapper__",r="lle-page-translate-retry",l="__Cici_translate_loading__",c="__Cici_translate_clamp_unset__",d="__Cici_translate_global_wrapper__",u="__Cici_translated_text_show_underline__",g="__Cici_translate_hide_origin_content_wrapper__",h="__Cici__translate__",m="__Cici_translate_Safari__"},10517:(e,t,n)=>{n.d(t,{Ip:()=>b,S2:()=>y,g$:()=>A,pz:()=>w});var a=n(14065),s=n(10633),i=n(59355),o=n(56422),r=n(84755),l=n(49278),c=n(12389),d=n(29988),u=n(44118),g=n(51727),h=n(69029),m=n(94953),p=n(88362),_=n(77591),v=n(47730);const f=new class{constructor(){var e=this;(0,s.A)(this,"translator",void 0),(0,s.A)(this,"prepareForMessageFromExtension",(()=>{r.A.on(c.$5,r.x.PAGE,(e=>{r.A.emit(c.Rx,r.x.PAGE,e)})),r.A.on(c.$x,r.x.PAGE,(e=>{e?this.translatePage():this.clearTranslate()})),r.A.on(c.FK,r.x.PAGE,(()=>{const{active:e}=l.I.getState();return r.A.emit(c.vb,r.x.PAGE,e),e})),r.A.on(c.oo,r.x.PAGE,(()=>{const e=p.IF.getState().url,t=new URL(e).hostname,n=(0,_.TK)("autoTranslatePageHosts"),a=(0,i.A)(n,t);r.A.emit(c.OH,r.x.PAGE,a)})),r.A.on(c.NZ,r.x.PAGE,(e=>{this.toggleCurrentPageAutoTranslate(e)})),r.A.on(c._m,r.x.PAGE,(()=>{const{showOrigin:e}=l.I.getState();r.A.emit(c.Yf,r.x.PAGE,e)})),r.A.on(c.bz,r.x.PAGE,(e=>{this.toggleShowOriginalContent(e)})),r.A.on(c.Qh,r.x.PAGE,(e=>{this.setTargetLangCode(e)}))})),(0,s.A)(this,"setTargetLangCode",(e=>{(0,(0,v.Y)("translateLanguage")[1])(e),d.A.set("translateLanguage",e);const{active:t}=l.I.getState();t&&this.translatePage()})),(0,s.A)(this,"toggleShowOriginalContent",(e=>{const{setShowOrigin:t}=l.I.getState();e?this.showOriginContent():this.hideOriginContent(),t(e)})),(0,s.A)(this,"toggleCurrentPageAutoTranslate",function(){var e=(0,a.A)((function*(e){const t=new URL(window.location.href).hostname,n=yield d.A.get("autoTranslatePageHosts"),a=e=>{d.A.set("autoTranslatePageHosts",e)};a(e?[...new Set([...n,t])]:(0,o.A)(n,(e=>e!==t)))}));return function(t){return e.apply(this,arguments)}}()),(0,s.A)(this,"translatePage",(0,a.A)((function*(){const t=yield d.A.get("translateLanguage"),n=yield d.A.get("pageTranslateService"),{setShowLangNotice:a,setActive:s}=l.I.getState();s(!0),e.pageTranslate({lang:t,translateService:(0,m.w)(n)});t===(yield(0,u.b)((0,u.T)()))&&a(!0)}))),(0,s.A)(this,"pageTranslate",(e=>{r.A.emit(c.P9,r.x.PAGE,!0);const{lang:t,translateService:n}=e;this.translator.start(t,n)})),(0,s.A)(this,"showOriginContent",(()=>{this.translator.showOriginContent()})),(0,s.A)(this,"translatedTextShowUnderline",(e=>{this.translator.translatedTextShowUnderline(e)})),(0,s.A)(this,"hideOriginContent",(()=>{this.translator.hideOriginContent()})),(0,s.A)(this,"clearTranslate",(()=>{const{setActive:e}=l.I.getState();r.A.emit(c.P9,r.x.PAGE,!1),this.translator.clearTranslate(),e(!1)})),(0,s.A)(this,"translatePartialPage",function(){var t=(0,a.A)((function*(t){const n=(0,_.TK)("translateLanguage"),a=yield d.A.get("pageTranslateService"),{setShowLangNotice:s}=l.I.getState();e.translator.startPartial({lang:n,service:(0,m.w)(a),container:t});n===(yield(0,u.b)((0,u.T)()))&&s(!0)}));return function(e){return t.apply(this,arguments)}}());const t=(0,h.sC)(),n=(0,h.c5)(),f=(0,h.qO)();this.translator=new g.r({strategyFilters:{traverse:t,paragraph:n,paragraphChild:f},onlyNeedIncludeSelectors:h.B2}),this.prepareForMessageFromExtension()}},{pageTranslate:b,showOriginContent:w,hideOriginContent:y,clearTranslate:A,translatedTextShowUnderline:k,translatePartialPage:S}=f},95830:(e,t,n)=>{n.d(t,{Gx:()=>l,cP:()=>c});var a=n(14065),s=n(67685),i=n(70405);const o="en",r="zh";function l(e,t){const{operation:n=0}=t||{};return(0,i.S6)({method:"POST",url:`${s.C1}/samantha/word_notes/delete`,data:{word:e,delete_operation:n,source_lang:o,target_lang:r}})}function c(e){return d.apply(this,arguments)}function d(){return(d=(0,a.A)((function*(e){const{status:t=0}=e||{},n=yield(0,i.S6)({method:"GET",url:`${s.C1}/samantha/word_notes/get`,params:{source_lang:o,target_lang:r,status:t}});if(n instanceof Error)throw n;return n}))).apply(this,arguments)}},99464:(e,t,n)=>{var a={};n.r(a),n.d(a,{addWebsiteToSkillHandler:()=>ie,checkPageReadyHandler:()=>z,checkSidePanelOpenHandler:()=>oe,continueInChatHandler:()=>q,readPDFHandler:()=>K,receiveTTSAudioHandler:()=>pe,refreshLatestMessageHandler:()=>ge,sendMessageToChatHandler:()=>Y,sendMessageWithFileBlobHandler:()=>ae,sidePanelTabActiveHandler:()=>J,stopTTSAudioHandler:()=>_e,updateZustandStateHandler:()=>Q});var s=n(44557),i=n(14065),o=n(75541),r=n(11855),l=n(31458),c=n(75683),d=n(57214),u=n(34870),g=n(45498);const h={result:"",responseStatus:"",searchEnd:!1},m=(0,g.vt)()((0,u.eh)((e=>(0,s.A)((0,s.A)({},h),{},{setResponseStatus:t=>e((()=>({responseStatus:t}))),setSearchResult:t=>e((()=>({result:t}))),setSearchEnd:t=>e((()=>({searchEnd:t})))}))));var p=n(49278),_=n(52833),v=n(93476),f=n(88225),b=n(16409),w=n(21559),y=n(20825),A=n(86855),k=n(88362),S=n(24337);const x={select:A.t_,layout:v.l,global:_.on,page:k.IF,translate:p.I},I={select:["barVisible","inputText","contextText","writeEnabled"],layout:["showTip","enterSidebarMode"],global:["floatingCardVisible"],page:["title","url","favicon","type"],translate:["active","showOrigin"]},M={layout:["showTip","enterSidebarMode"],global:["floatingCardVisible","summaryActionVisible","chatPageReady"],select:[],page:[],translate:["active","showOrigin"]},C={update:e=>{e.length&&(y._K.isInSidePanel?b.Iq:b.cs)({name:"update-zustand-state",body:e}).catch((e=>{w.vF.persist.error({error:e})}))}},P=(e,t,n,a={})=>{const s=("contentScript"===e?I:M)[t].reduce(((e,s)=>(a&&n[s]===a[s]||e.push({key:s,data:n[s],storeKey:t}),e)),[]);s.length&&C.update(s)},T=(e,t)=>e.subscribe(((n,a)=>{e.mutex||P(y._K.isInSidePanel?"sidePanel":"contentScript",t,n,a)}));var L=n(93804),j=n(17411),E=n(75022),R=n(10159),N=n(63159);const O=()=>{var e;(0,E.A)(null===(e=document.getElementById("ciciai-assistant"))||void 0===e?void 0:e.shadowRoot),v.l.setState({isShowSidebar:!0});const t=(0,r.useRef)(null),n=(0,j.Uk)();return(0,r.useEffect)((()=>{const e=[];return e.push(T(m,"select")),e.push(T(v.l,"layout")),e.push(T(_.on,"global")),e.push(T(p.I,"translate")),_.on.subscribe(((e,t)=>{e.chatPageReady!==t.chatPageReady&&(0,b.Iq)({name:"chat-page-ready"})})),()=>{e.forEach((e=>{e()}))}}),[]),(0,N.jsx)(l.Y.Provider,{value:w.vF,children:(0,N.jsx)(c.tH,{fallback:null,errorBoundaryName:"flow-ext-next",children:(0,N.jsx)(L.A.Provider,{value:{getPopupContainer:()=>t.current||document.body},children:(0,N.jsx)(d.C,{t:n,children:(0,N.jsxs)("div",{onMouseDown:R.N,className:"cici-ext-always-light semi-always-light",children:[(0,N.jsx)(f.A,{align:"right",visible:!0,scene:"sidePanel"}),(0,N.jsx)("div",{className:"cici-popup-container",ref:t})]})})})})})};var D=n(82770),H=n(43358);const B=e=>{var t,n;if(null!=e&&null!==(t=e.tab)&&void 0!==t&&t.active&&(null==e||null===(n=e.tab)||void 0===n?void 0:n.windowId)===y._K.windowId)return!0},z={name:"check-page-ready",handle:()=>new Promise((e=>{if(_.on.getState().chatPageReady)e(!0);else{const t=_.on.subscribe((e=>e.chatPageReady),(n=>{n&&(e(!0),t())}))}}))};var U=n(77526),F=n(75484),$=n(77591);const q={name:"continue-in-chat",handle:(G=(0,i.A)((function*(e){var t;_.on.getState().setTabInfo({tabId:_.on.getState().tabInfo.tabId});const{conversationId:n=""}=e||{},a=yield F.pU.getState().fetchUpdateConversationInfo(n);yield U.ozw.getState().initMessageList({conversationId:n,messageCursor:Number(null==a?void 0:a.message_cursor),messageIndex:Number(null==a?void 0:a.message_index),range:{start:Number(null==a?void 0:a.message_cursor),end:Number(null==a?void 0:a.message_index)},isGuest:!(null!==(t=(0,$.Fc)())&&void 0!==t&&t.isAuthenticated)})})),function(e){return G.apply(this,arguments)})};var G,W=n(73134);const K={name:"read-pdf",handle:e=>{(0,W.M)(e)}};var V=n(91689),Z=n(42265),X=n(74232);const Y={name:"send-message-to-chat",handle:e=>{if(e){var t;const n=(0,V.A)(e.msg)?e.msg:[e.msg];null!==(t=n[0])&&void 0!==t&&null!==(t=t.extraExt)&&void 0!==t&&t.browser_explain&&X.Qz.create("cici_summary_page_action_perf",!0),(0,Z.C)(n,{chatType:e.chatType,botType:"Main"})}}},Q={name:"update-zustand-state",preCheck:e=>{var t;return B(e)||(null==e||null===(t=e.url)||void 0===t?void 0:t.includes("background"))},handle:(e=[])=>{(e=>{e.forEach((e=>{const{key:t,data:n,storeKey:a}=e;(0,S.Rm)(`update state env.isInSidePanel=${y._K.isInSidePanel}\n       store=${a} key=${t} value=${n}`);const s=x[a];s&&s.getState()[t]!==n&&(s.mutex=!0,s.setState({[t]:n}),s.mutex=!1)}))})(e)}},J={name:"sidepanel-tab-active",preCheck:()=>!0,handle:e=>{void 0!==e&&void 0!==e.windowId&&e.windowId===y._K.windowId&&_.on.getState().setTabInfo({tabId:e.tabId})}};var ee=n(10484),te=n(1717),ne=n(2573);const ae={name:"send-message-with-file",handle:e=>{const{action:t,blobData:n,msg:a,chatType:i=ee.H.Conversation}=e||{},o=(0,te.I0)(n);if(o)switch(t){case"exercise-skill":(0,Z.C)([(0,s.A)({image:(0,te.ps)(o)},a)],{chatType:i,botType:"Main"});break;case"capture-ask":ne.A.emit("capture-ask",o)}}};var se=n(26094);const ie={name:"add-website-to-skill",handle:e=>{null!=e&&e.url&&(0,se.j)(null==e?void 0:e.url)}},oe={name:"check-side-panel-open",handle:()=>!0};var re=n(40967),le=n(10129),ce=n(61276),de=n(29988),ue=n(44969);const ge={name:"refresh-latest-message",handle:function(){var e=(0,i.A)((function*(){try{yield(0,U.CCM)({onlyLoadAssistantBot:!0,isReload:!1});const e=ce.Pv.get(le.aU.HttpChunk),t=yield de.A.get(ue.v),n=(0,re.A)(t.state.chunkTaskMap);e.resumeTask(n)}catch(e){}}));return function(){return e.apply(this,arguments)}}()};var he=n(8216),me=n(25563);const pe=(0,s.A)((0,s.A)({},he.J),{},{preCheck:()=>!0}),_e=(0,s.A)((0,s.A)({},me.Q),{},{preCheck:()=>!0});var ve=n(75882);const fe=()=>{const e=Object.keys(a).map((e=>(e=>(0,s.A)((0,s.A)({},e),{},{preCheck:e.preCheck||B}))(a[e])));(0,ve.c)(e)};var be=n(76021),we=n(90747),ye=n(13680),Ae=n(53884),ke=n(31826);const Se=function(){var e=(0,i.A)((function*(){var e,t;const n=yield(0,b.cs)("check-and-update-ttwid");null!=n&&n.success&&null!==(e=n.data)&&void 0!==e&&e.success&&null!==(t=n.data)&&void 0!==t&&t.updated&&(yield(0,$.pu)({}))}));return function(){return e.apply(this,arguments)}}();let xe=!1;function Ie(){return Me.apply(this,arguments)}function Me(){return(Me=(0,i.A)((function*(){var e,t;if(xe)return!0;xe=!0,yield Se();const n=yield(0,b.cs)("is-side-panel-enabled"),a=!!(0,ye.s)()||Boolean(null==n||null===(e=n.data)||void 0===e?void 0:e.enabled),s=yield(0,b.cs)("tab-info");_.on.getState().setTabInfo({tabId:null==s||null===(t=s.data)||void 0===t?void 0:t.tabId}),v.l.getState().setIsSidePanelMode(a),(0,b.cs)({name:"update-auth-info",body:{reason:"cs: load start"}}),yield Promise.all([(0,$.lv)()]),function(){const{setLocalActionRecordUpperLimit:e}=we.cj.getState();ke.bc.forEach((t=>{e(t,ke.zL)}))}()}))).apply(this,arguments)}(0,be.A)((()=>{(0,$.TK)("installReason")&&((0,Ae.s)("extension_install_success",{reason:(0,$.TK)("installReason")}),(0,$.vE)("installReason",""))}));var Ce=n(33522);window.inSidePanel=!0;const Pe=function(){var e=(0,i.A)((function*(){try{(0,H.F)(),chrome.runtime.connect({name:"sidePanel"}),(0,Ce.Ao)(),fe(),yield Promise.all([Ie(),(0,y.GR)()]),yield Promise.all([D.Ay.initTea(),(0,j.LE)()]),o.createRoot(document.getElementById("root")).render((0,N.jsx)(O,{}))}catch(e){w.vF.persist.info({eventName:"bootstrap_error",meta:(0,s.A)({},e)})}}));return function(){return e.apply(this,arguments)}}();Pe()},47881:(e,t,n)=>{n.d(t,{Pe:()=>i});var a=n(12648),s=n(10484);n(77526),n(93476),n(5842),n(77591),n(21559),n(20825),n(77191);function i(e,t,n){const i=e===s.H.NewThread;return{botId:n,conversationId:i?void 0:t,localConversationId:i?t:void 0,conversationType:i?a.Cr.CocoWebSub:void 0}}},29761:(e,t,n)=>{n.d(t,{z:()=>N});var a=n(44557),s=n(10633),i=n(79123),o=n(56642),r=n(15159),l=n(16100),c=n(15309),d=n(17834),u=n(43400),g=n(46077),h=n(77526),m=n(98302),p=n(11177),_=n(26206),v=n(15574),f=n(80177),b=n(26817),w=n(29537),y=n(78057),A=n(20682),k=n(83817),S=n(39500),x=n(73929),I=n(19773),M=n(67685),C=n(12038),P=n(47669),T=n(8522),L=n(25141),j=n(7246),E=n(77591);new class{constructor(){(0,s.A)(this,"ctxInit",!1),(0,s.A)(this,"msgProtocolInit",!1),(0,s.A)(this,"serviceCtx",null),(0,s.A)(this,"initMessageServiceCtx",(()=>{if(this.ctxInit)return;this.ctxInit=!0;const{chatBizPlugins:e,configServiceInitParams:t,teaServiceInitParams:n,botServiceInitParams:a}=N(),s=(0,d.c4)(n),o=(0,u.uk)(t),r=(0,g.V)(a),l=(0,h.TbE)({plugins:[c.g,v.m,...m.S,...f.U,...h.Qoi,...b.m,...h.ic8,...p.j,...(0,i.A)(e,(e=>e.chatMessage||[]))]}),y=(0,_.ay)({plugins:(0,i.A)(e,(e=>e.chatInput||[]))}),A={chatMessageService:l,chatConfigService:o,chatBotService:r,chatTeaService:s,chatFeedService:(0,w.Kl)(),chatInputService:y};for(const i of Object.values(A))i.ctx=A;this.serviceCtx=A})),(0,s.A)(this,"initMessageProtocolService",(()=>{var e;if(this.msgProtocolInit)return;const{messageProtocolServiceInitOptions:t}=N();t.config&&null!==(e=this.serviceCtx)&&void 0!==e&&e.chatMessageService&&(this.msgProtocolInit=!0,this.serviceCtx.chatMessageService.updateInitMessageProtocolServiceConfig(t),this.serviceCtx.chatMessageService.tryInitMessageProtocolService())}))}};const R=e=>(0,P.w)((t=>e?t.botMap[e]:void 0),o.A),N=()=>({teaServiceInitParams:{tracker:C.bs},configServiceInitParams:()=>{var e;return{appId:Number(M.sZ),userId:(0,E.Fc)().userId,loginSource:"flow-ext",createUploader:e=>new r.UploaderService((0,a.A)((0,a.A)({},e),{},{useDirectUpload:!0})),isGuest:!(null!==(e=(0,E.Fc)())&&void 0!==e&&e.isAuthenticated),localFeatureConfig:{enableMessageListVirtualScroll:!1,enableMessageDebug:!1},featureGating:(0,a.A)((0,a.A)({},u.CA),{},{enableSendFileMessage:!0,enableSendWithAttachmentArea:!0,enableSendOcrImage:!0,enableNewImageCreationSkill:!0,enableSkillPin:!1})}},asrServiceInitParams:{useAudioWorklet:!0},botServiceInitParams:{actions:P.w.getState(),useBotInfoHook:R},chatBizPlugins:[...(0,T.ov)(),...A.C,...I.O,...y.B,...S.d,...k.p,...x.I,...(0,T.Op)(),...j.U,...T.Ge],messageProtocolServiceInitOptions:{config:{},socketClient:L.Hv,reportEvent:(0,l.XB)({eventName:"ext_message_service"}),fetchStream:{baseURL:`https://${M.FI}`,deprecatedClient:L._v}}})},26225:(e,t,n)=>{n.d(t,{_:()=>d});var a=n(14065),s=n(1717),i=n(35791),o=n(16409),r=n(2573),l=n(20825);let c="";const d=function(){var e=(0,a.A)((function*(){const e=Math.random().toString(32).slice(3);let t;if(c=e,l._K.isInSidePanel){const n=yield(0,o.Iq)({name:"get-screen-capture",body:{requestId:e,mode:"only-capture"}},36e5);if(n.success&&n.data&&n.data.requestId===c){const e=n.data.data;t=(0,s.I0)(e)}}else{i.RT.getState().setReportParams({from:"chat_enter_bar"});const n=yield u(e,"only-capture",!1);(null==n?void 0:n.requestId)===e&&(t=n.data)}return t?(0,s.ps)(t):null}));return function(){return e.apply(this,arguments)}}(),u=(e,t,n=!0)=>(i.RT.setState({captureMode:t||"global",open:!0}),new Promise((t=>{r.A.once("get-screen-capture-done",(a=>{a?n?(0,s.ql)(a).then((n=>{t({data:n,requestId:e})})):t({data:a,requestId:e}):t({requestId:e})}))})))},90747:(e,t,n)=>{n.d(t,{BB:()=>u,OB:()=>d,cj:()=>h});var a=n(44557),s=(n(11855),n(34870)),i=n(45498),o=n(21811),r=n(77591),l=n(96638);n(47730),n(2573);const c="onboardingActionRecord",d=(e,t="web")=>{switch(e){case l.EU.ask:return`${t}_ask`;case l.EU.mail:return`${t}_gmail`;default:return`${t}_${e}`}},u=e=>{const{action:t,triggerLogin:n=!0,loginParams:a}=e,{isActionLimited:s,actionRecordUseOnce:i}=h.getState();return s(t||"")?(n&&(0,o.DT)(a),!0):(t&&i(t),!1)},g={actionRecordUpperLimit:new Map,limitedActionRecord:new Set,limitedBrowserPluginSkill:new Set},h=(0,i.vt)()((0,s.eh)(((e,t)=>(0,a.A)((0,a.A)({},g),{},{setLocalActionRecordUpperLimit:(n,a)=>e((()=>({actionRecordUpperLimit:t().actionRecordUpperLimit.set(n,a)}))),actionRecordUseOnce:e=>{var n;if(!t().actionRecordUpperLimit.has(e))return;const{count:a=0}=(null===(n=(0,r.TK)(c))||void 0===n?void 0:n[e])||{};(0,r.vE)(c,{[e]:{count:a+1}},!0)},addLimitedActionRecord:n=>e((()=>({limitedActionRecord:t().limitedActionRecord.add(n)}))),addLimitedBrowserPluginSkill:n=>e((()=>({limitedBrowserPluginSkill:t().limitedBrowserPluginSkill.add(n)}))),isActionLimited:e=>{var n;const{isAuthenticated:a}=(0,r.TK)("authInfo");if(a)return!1;if(t().limitedActionRecord.has(e))return!0;const{count:s=0}=(null===(n=(0,r.TK)(c))||void 0===n?void 0:n[e])||{},i=t().actionRecordUpperLimit.get(e);return void 0!==i&&s>i},isBrowserPluginSkillLimited:e=>{const{isAuthenticated:n}=(0,r.TK)("authInfo");return!n&&t().limitedBrowserPluginSkill.has(e)}}))));new Map([["explain","web_explain"],["search","web_search"],["youtube","web_video_summary"]])},70139:(e,t,n)=>{n.d(t,{Gq:()=>u,Jg:()=>r,R_:()=>c,S1:()=>o,eR:()=>d,j$:()=>g,mu:()=>l});var a=n(12038),s=n(56397),i=(n(36700),n(78503));let o=function(e){return e.NORMAL="normal",e.READ_PAGE="read_this_page",e}({});const r=({button_name:e})=>{(0,a.z8)(s.Ur.showChatAssistantPopoverSettings,{button_name:e})},l=({button_name:e,value:t})=>{(0,a.z8)(s.Ur.clickChatAssistantPopoverSettings,{value:t?"1":"0",button_name:e,click_from:s.Z5.chatAssistantPopoverSettings})},c=({button_name:e})=>{(0,a.z8)(s.Ur.showChatHeaderBtn,{current_page:i.$2.chat,button_name:e})},d=({button_name:e})=>{(0,a.z8)(s.Ur.clickChatHeaderBtn,{current_page:i.$2.chat,button_name:e})},u=({highlight_page_url:e,module_name:t})=>{(0,a.z8)(s.Ur.showChatFloatCard,{highlight_page:(0,a.M5)(e),module_name:t})},g=({highlight_page_url:e,module_name:t,button_name:n})=>{(0,a.z8)(s.Ur.clickChatFloatCard,{highlight_page:(0,a.M5)(e),module_name:t,button_name:n})}},36700:(e,t,n)=>{n.d(t,{p$:()=>s});var a=n(12038);n(56397);function s(){return(0,a.M5)(location.href)}},56397:(e,t,n)=>{n.d(t,{Ur:()=>o,Z5:()=>s,_h:()=>i,cz:()=>r,g6:()=>a});let a=function(e){return e.setting="setting",e.landing="landing",e.welcome="extension_welcome",e.login="login",e.uninstall="uninstall",e.extensionOther="extension_other",e.baidu="search_engine_baidu",e.google="search_engine_google",e.bing="search_engine_bing",e.toutiao="search_engine_toutiao",e.youtube="youtube",e.bilibili="bilibili",e.douyin="douyin",e.chat="chat",e.chatgpt="chatgpt",e.mail="mail_page",e.xiaoyuzhou="xiaoyuzhou",e.apple="apple",e.webOther="web_otherpage",e}({}),s=function(e){return e.onboarding="onboarding",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantMoreMenu="highlight_function_bar_dropdown",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.podcastAssistant="podcast_page_summarize",e.chatAssistantPopover="sidebar_action_popover",e.chatAssistantPopoverSettings="sidebar_action_popover_settings",e.sendMessageInChat="send_message_in_chat",e.mailCreate="mail_create",e.mailUpdate="mail_update",e.mailEntryButton="mail_entry_button",e.mailPositive="mail_positive",e.mailNegative="mail_negative",e.mailNeedMore="mail_need_more",e.arxiv="arxiv",e.pdf="pdf",e.context_menu="context_menu",e.shortcut="shortcut",e.inputText="input_text",e.collect="collect",e.searchResultPreview="search_result_preview",e.hyperlinkResultPreview="hyperlink_preview",e.deepSearchMode="deep_search_mode",e.podcast_show="podcast_summarize_show",e.podcast_click="podcast_summarize",e.quick_translate="quick_translate",e}({}),i=function(e){return e.insert="insert_below",e.replace="replace_selection",e.suggest="suggest",e.share="share",e.summarizeVideo="summarize_video",e.immersionGuideTips="immersion_guide_tips",e.immersionGuideIcon="immersion_guide_icon",e.summarizePodcast="summarize_podcast",e.translatePage="translate_this_page",e.summarizePage="summarize_this_page",e.languageSettings="language_settings",e.displayOriginalText="display_original_text",e.alwaysTranslatePage="always_translate_this_page",e.viewInWeb="view_in_web",e.settings="settings",e.historyChats="history_chats",e.collection="collection",e.allConversation="all_conversation",e.understandContext="understand_context",e.download="download",e.updateLog="update_log",e.highlightRecord="highlight_record",e.highlightSelectionBar="highlight_selection_bar",e.fold="fold",e.expand="expand",e.expanded="expanded",e.collapsed="collapsed",e.regeneration="regeneration",e.formalize="formalize",e.elaborate="elaborate",e.shorten="shorten",e.write="help_me_write",e.rewrite="rewrite",e.changeReplyLang="change_reply_lang",e.hideUntilNext="hide_until_next",e.closeWritingAssistant="close_writing_assistant",e.closeGrammerCheck="close_grammar_check",e.writingLanguage="language_setting",e.btnCopy="copy",e.btnInsert="insert",e.btnReplace="replace",e.helpMeReply="help_me_reply",e.gotIt="got_it",e.save="save",e.targetLanguage="target_language",e.shortcut="shortcut",e.translateService="translate_service",e.dismiss="dismiss",e.understandContextOn="understand_context_on",e.understandContextOff="understand_context_off",e.screenCapture="screenshot",e.searchButton="search",e.voiceInput="voice_input",e.translateRead="read",e.translateEdit="edit",e.translateCopyOrigin="copy_origin",e}({}),o=function(e){return e.copy="copy",e.regenerate="click_regenerate",e.continueInChat="continue_in_chat",e.retry="retry",e.enterPage="enter_page",e.generationFailure="generation_failure",e.share="share",e.viewDAU="view_dau",e.activeDAU="active_dau",e.sendMessage="send_message",e.showSelectAssistantMenu="highlight_function_bar_show",e.showSelectAssistantBtn="highlight_function_bar_function_show",e.clickSelectAssistantMenuBtn="highlight_function_bar_click",e.showSelectAssistantResult="highlight_result_show",e.clickSelectAssistantResultBtn="highlight_result_action",e.closeSelectAssistantResult="highlight_result_close",e.showChatAssistant="side_bar_entrance_show",e.clickChatAssistant="side_bar_entrance_click",e.showChatAssistantPopover="show_side_bar_popover",e.clickChatAssistantPopover="click_side_bar_popover",e.showChatAssistantPopoverSettings="show_side_bar_settings_popover_button",e.clickChatAssistantPopoverSettings="click_side_bar_settings_popover_button",e.showChatHeaderBtn="show_chat_header_button",e.clickChatHeaderBtn="click_chat_header_button",e.showChatFloatCard="highlight_action_module_sidebarshow",e.clickChatFloatCard="highlight_action_module_sidebarclick",e.showSearchAssistant="search_result_card_show",e.searchResultCardClick="search_result_card_click",e.showSearchAssistantSuggest="show_suggested_prompt",e.showSearchAssistantSuggestQuestion="show_suggested_prompt_single_question",e.clickSearchAssistantSuggest="click_suggested_prompt",e.closeSearchAssistant="search_result_card_disappear",e.showDeepSearchAssistant="search_summarize_result_show",e.showSources="sources_show",e.clickSources="sources_click",e.collapseDeepSearchCard="search_card_collapse",e.showDeepSearchBtn="deep_search_button_show",e.clickDeepSearchBtn="deep_search_button_click",e.showVideoAssistant="video_summarize_module_show",e.clickVideoAssistantSummarizeBtn="video_summarize_module_click",e.showVideoAssistantSummarizeResult="video_summarize_result_show",e.clickVideoAssistantSummarizeResult="video_summarize_result_click",e.showVideoAssistantHighlightsTimeline="highlights_timeline_singleshow",e.clickVideoAssistantHighlightsTimeline="highlights_timeline_singleclick",e.clickVideoImmersion="video_immersion_click",e.showVideoImmersion="video_immersion_show",e.immersionTimeLine="immersion_timeline",e.showVideoImmersionGuideTips="video_immersion_guide_tips_show",e.clickVideoImmersionGuideTips="video_immersion_guide_tips_click",e.showVideoImmersionGuideIcon="video_immersion_guide_icon_show",e.clickVideoImmersionGuideIcon="video_immersion_guide_icon_click",e.showPodcastAssistant="podcast_summarize_module_show",e.clickPodcastAssistantSummarizeBtn="podcast_summarize_module_click",e.showPodcastAssistantSummarizeResult="podcast_summarize_result_show",e.clickPodcastAssistantSummarizeResult="podcast_summarize_result_click",e.showMailEntryButton="mail_entry_button_show",e.clickMailEntryButton="mail_entry_button_click",e.clickInputBar="input_bar_click",e.showMailThreadResult="mail_thread_result_show",e.clickMailThreadResult="mail_thread_result_click",e.insertMailThreadResult="mail_thread_result_insert",e.closeMailThreadResult="mail_thread_result_close",e.quickReplyButtonShow="ai_reply_button_show",e.hoverQuickReplyButton="hover_ai_reply_button",e.showPdfAssistant="pdf_read_show",e.clickReadPdfBtn="pdf_read_click",e.showDisableMenu="disable_menu_show",e.clickDisableMenu="confirm_close_function",e.chooseLanguage="choose_language_result",e.shortcutClick="shortcut_click",e.newSkillAdd="new_skill_add",e.skillEditClick="skill_edit_click",e.skillEditDelete="skill_edit_delete",e.skillPopupSave="skill_popup_save",e.skillPopupIconClick="skill_popup_icon_click",e.skillPopupCancel="skill_popup_cancel",e.skillPopupClose="skill_popup_close",e.exampleClick="example_click",e.examplePopupClose="example_popup_close",e.collectionButtonShow="collection_button_show",e.collectionButtonClickSave="collection_button_click_save",e.collectionButtonClickSaveStatus="collection_button_click_save_status",e.seeCollectionButtonShow="see_collection_button_show",e.collectionSettingClick="collection_setting_click",e.writingSettingClick="mail_entry_setting_click",e.writingSkilShow="skill_module_show",e.writingSkillClick="click_suggested_content",e.writingAssistantResultClick="writing_assistant_result_click",e.searchLinkPreviewEntryShow="search_result_preview_icon_show",e.searchLinkPreviewResultShow="search_result_preview_result_show",e.searchLinkPreviewResultClick="search_result_preview_result_click",e.hyperLinkPreviewEntryShow="hyperlink_preview_icon_show",e.hyperLinkPreviewResultShow="hyperlink_preview_result_show",e.hyperLinkPreviewResultClick="hyperlink_preview_result_click",e.doubaoDownloadPopupShow="doubao_download_popup_show",e.doubaoDownloadPopupClick="doubao_download_popup_click",e.takeNoteShow="take_note_show",e.takeNotePadShow="take_note_pad_show",e.takeNotePadClick="take_note_pad_click",e.takeNoteBtnClick="video_tool_bar_take_note_click",e.takeNoteStatus="take_note_pad_click_status",e.quickTranslatePopupShow="quick_translate_popup_show",e.quickTranslatePopupClick="quick_translate_popup_click",e.quickTranslate="quick_translate",e.quickTranslateSettingClick="quick_translate_setting_click",e.chooseMouseHoverResult="choose_mouse_hover_result",e.doubaoUpdatePopupShow="doubao_update_popup_show",e.doubaoUpdatePopupClick="doubao_update_popup_click",e.videoSettingClick="video_setting_click",e.translationCardShow="translation_card_show",e.translationCardClick="translation_card_click",e}({}),r=function(e){return e.clickSidebar="click_side_bar",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.podcastAssistant="podcast_page_summarize",e.onboarding="onboarding",e.chatHeader="chat_header",e.disableMenu="close_function",e.screenCapture="screen_capture",e.searchPreview="search_preview",e.other="other",e.default="default",e}({})},17933:(e,t,n)=>{n.d(t,{Bq:()=>h,Su:()=>p,jk:()=>m,jv:()=>c});var a=n(88090),s=n(12038),i=n(56397),o=n(78503);let r=function(e){return e.page="disable_page",e.global="disable_all",e.temp="hide_till_next_time",e}({}),l=function(e){return e.drop_down_box="drop_down_box",e}({}),c=function(e){return e.translate_this_page="translate_this_page",e.highlight_result_choose="highlight_result_choose",e.youtube_page_summary="youtube_page_summary",e.settings="settings",e.mail="gmail",e}({});const d={[o.lf.chatAssistant]:"side_bar_entrance",[o.lf.searchAssistant]:"search_card",[o.lf.selectAssistant]:"highlight_function",[o.lf.searchAddons]:"search_recommend",[o.lf.linkPreview]:"search_preview",[o.lf.videoSummary]:"video_summarize_card",[o.lf.videoSubtitle]:"video_subtitle",[o.lf.podcastSummary]:"podcast_summarize_card",[o.lf.sidebarFloatCard]:"side_panel",[o.lf.grammar]:"writing_assistant_grammar",[o.lf.inputAssistant]:"writing_assistant",[o.lf.videoImmersion]:"video_immersion",[o.lf.replyAssistant]:"reply_assistant",[o.lf.vocabruary]:"highlight_mark",[o.lf.collectionImage]:"webimage_collect",[o.lf.collectionPage]:"web_collect",[o.lf.videoMemo]:"video_memo"},u=e=>d[e]||"",g=e=>{let t="";switch(e){case o.iI.temp:t=r.temp;break;case o.iI.page:t=r.page;break;case o.iI.global:t=r.global}return t},h=e=>{(0,s.z8)(i.Ur.showDisableMenu,{enter_method:u(e)})},m=(e,t)=>{(0,s.z8)(i.Ur.clickDisableMenu,{enter_method:u(t),button_name:g(e)})},p=({before_language_result:e,after_language_result:t,scene:n})=>{(0,s.z8)(i.Ur.chooseLanguage,{choose_way:l.drop_down_box,before_language_result:(0,a.wz)(e),after_language_result:(0,a.wz)(t),scene:n})}},78503:(e,t,n)=>{n.d(t,{$2:()=>i,Fc:()=>c,WR:()=>d,X0:()=>l,c$:()=>o,iI:()=>s,lf:()=>a,th:()=>r});let a=function(e){return e.chatAssistant="sidebarButton",e.searchAssistant="search",e.selectAssistant="quick",e.grammar="grammar",e.inputAssistant="input",e.replyAssistant="reply",e.searchAddons="search-addons",e.videoSummary="videoSummary",e.videoSubtitle="videoSubtitle",e.videoImmersion="videoImmersion",e.videoMemo="videoMemo",e.podcastSummary="podcastSummary",e.linkPreview="linkPreview",e.sidebarFloatCard="sidebarFloatCard",e.vocabruary="vocabruary",e.collectionImage="collectionImage",e.collectionPage="collectionPage",e}({}),s=function(e){return e.temp="temp",e.page="page",e.global="global",e}({}),i=function(e){return e.youtube="youtube",e.chat="chat",e}({}),o=function(e){return e.HUOSHAN="huoshan",e.DOUBAO="doubao",e.GPT="gpt",e.GOOGLE="google",e.MICROSOFT="microsoft",e.DEEPL="deepl",e}({}),r=function(e){return e.HUOSHAN="0",e.LLM="1",e.GOOGLE="2",e.MICROSOFT="3",e}({}),l=function(e){return e.NO_TRANSLATE="no_translate",e.TRANSLATE_DIRECTLY="translate_directly",e.TRANSLATE_BY_COMMAND="translate_by_command",e.TRANSLATE_BY_OPTION="translate_by_option",e.TRANSLATE_BY_CUSTOM_SHORTCUT="translate_by_custom_shortcut",e}({}),c=function(e){return e[e.PageTranslate=1]="PageTranslate",e[e.AIReader=2]="AIReader",e[e.ChooseWordsTranslate=3]="ChooseWordsTranslate",e[e.ScreenShotTranslate=4]="ScreenShotTranslate",e[e.ImageTextExtraction=5]="ImageTextExtraction",e[e.HoverTranslate=6]="HoverTranslate",e[e.InputFieldInstantTranslate=7]="InputFieldInstantTranslate",e[e.ToutiaoSearchCard=8]="ToutiaoSearchCard",e[e.SearchRecommendCard=9]="SearchRecommendCard",e[e.CommentReply=10]="CommentReply",e}({}),d=function(e){return e.Space="Space",e.Comma="Comma",e.Slash="Slash",e.Equal="Equal",e}({})},58980:(e,t,n)=>{n.d(t,{Fc:()=>s.Fc,WR:()=>s.WR,X0:()=>s.X0,c$:()=>s.c$,lG:()=>a.l,th:()=>s.th});var a=n(15959),s=n(78503)},49299:(e,t,n)=>{n.d(t,{EY:()=>a});n(10080),n(77259);function a(e){if(!document.head){const e=document.createElement("head");document.documentElement.appendChild(e)}document.head.appendChild(e)}},67685:(e,t,n)=>{n.d(t,{C1:()=>r,FI:()=>s,Ud:()=>g,Vl:()=>u,_E:()=>m,eG:()=>h,gH:()=>l,kD:()=>d,lx:()=>c,nD:()=>o,sZ:()=>i,zs:()=>p});var a=n(78503);const s="www.doubao.com",i="586864",o="production",r="https://www.doubao.com",l=420,c="web",d=`https://${s}/samantha`,u=`https://${s}/chat/collection`,g="doubao.com",h="release_version",m=[{name:"flow_web_ext_sidebar_hide_1",key:a.iI.temp,id:1},{name:"flow_web_ext_sidebar_hide_2",key:a.iI.page,id:2},{name:"flow_web_ext_sidebar_hide_3",key:a.iI.global,id:3}],p={[a.lf.sidebarFloatCard]:{global:"chatFloatCardDisableAll",page:"chatFloatCardDisableHosts"},[a.lf.videoSubtitle]:{global:"videoSubtitleDisableAll",page:"videoSubtitleDisableHosts"},[a.lf.videoSummary]:{global:"videoSummaryDisableAll",page:"videoSummaryDisableHosts"},[a.lf.videoMemo]:{global:"videoMemoDisableAll",page:"videoMemoDisableHosts"},[a.lf.podcastSummary]:{global:"podcastSummaryDisableAll",page:"podcastSummaryDisableHosts"},[a.lf.chatAssistant]:{global:"sidebarButtonDisabledAll",page:"sidebarButtonDisabledHosts"},[a.lf.searchAssistant]:{global:"searchDisabledAll",page:"searchDisabledHosts"},[a.lf.selectAssistant]:{global:"quickDisabledAll",page:"quickDisabledHosts"},[a.lf.grammar]:{global:"disableGlobalGrammar",page:"disableGrammarHosts"},[a.lf.inputAssistant]:{global:"InputAssistantDisabledAll",page:"InputAssistantDisabledHosts"},[a.lf.searchAddons]:{global:"disableSearchAddonsGlobal",page:"disableSearchAddonsHosts"},[a.lf.linkPreview]:{global:"linkPreviewDisabledAll",page:"linkPreviewDisabledHosts"},[a.lf.videoImmersion]:{global:"videoImmersionDisableAll",page:"videoImmersionDisableHosts"},[a.lf.replyAssistant]:{global:"replyAssistantDisabledAll",page:"replyAssistantDisabledHosts"},[a.lf.vocabruary]:{global:"vocabruaryDisableAll",page:"vocabruaryDisableHosts"},[a.lf.collectionImage]:{global:"collectImageDisabledAll",page:"collectImageDisabledHosts"}}},28328:(e,t,n)=>{n.d(t,{d:()=>i,u9:()=>s});var a=n(76360);let s=function(e){return e.web="web",e.pdf="pdf",e}({});const i=()=>{const e=document.body.firstElementChild;return{type:"EMBED"===(null==e?void 0:e.nodeName)&&"application/pdf"===(null==e?void 0:e.type)?s.pdf:s.web,url:window.location.href,title:document.title,favicon:(0,a.p2)(window.location.host,window.location.protocol)}}},67976:(e,t,n)=>{n.d(t,{AP:()=>o,XQ:()=>r});var a=n(77793),s=n(88090),i=n(77591);"undefined"!=typeof window?window:self;performance.timeOrigin.toString(36);const o=()=>(0,a.A)();function r(e="en"){var t;return null!==(t=(0,s.wz)((0,i.TK)("uiLanguage")).replace(/-.*$/,""))&&void 0!==t?t:e}},35661:(e,t,n)=>{n.d(t,{A2:()=>s,hT:()=>a});const a={li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},a:{attrs:[{key:"href",getter:e=>e.href}]},code:{},strong:{},i:{},em:{},cite:{},ol:{}},s=Object.keys(a)},64802:(e,t,n)=>{n.d(t,{l$:()=>c});var a=n(89380),s=(n(43714),n(35661)),i=n(24693);function o(e,t=[]){const n=(0,a.A)(e);let r="";for(const a of n){if((0,i.DC)(a))continue;if(!(a instanceof HTMLElement)){r+=a.textContent||"";continue}const e=a.tagName.toLowerCase();if(s.A2.includes(e)){const n=s.hT[e],l={};for(const{key:e,getter:t}of(null==n?void 0:n.attrs)||[]){const n=t?t(a):a.getAttribute(e);n&&(l[e]=n)}t.push({tag:e,originContent:(0,i.UU)(a.textContent||""),attrs:l});const c=t.length-1,{output:d}=o(Array.from(a.childNodes),t);r+=`<b${c}>${d}</b${c}>`;continue}const{output:n}=o(Array.from(a.childNodes),t);r+=n}return{output:(0,i.UU)(r),metaInfo:t}}var r=n(12312);n(46514),n(96638);let l;function c(e){if(e.commonAncestorContainer instanceof Element){(0,r.M)(e.commonAncestorContainer);const t=e.cloneContents(),n=(0,r.u)(Array.from(t.childNodes));l=[];return n.map((e=>o(e,l))).map((e=>e.output)).join("\n")}l=void 0}},52289:(e,t,n)=>{function a(e){const t=e.getAttribute("data-cici-select-uid");if(t){const e=document.querySelector(`[data-cici-select-uid="${t}"]`);if(e)return getComputedStyle(e)}}n.d(t,{D6:()=>a})},76813:(e,t,n)=>{n.d(t,{H2:()=>r,ID:()=>o,Os:()=>u,id:()=>c,tY:()=>l,yf:()=>d});var a=n(44557),s=n(67685),i=n(77591);function o(e,t={}){const n=e.includes("?"),a=Object.keys(t).reduce(((e,n)=>{const a=void 0===t[n]||null===t[n]?"":String(t[n]);return e=`${e}&${`${encodeURIComponent(n)}=${encodeURIComponent(a)}`}`}),"");return n?`${e}${a}`:`${e}?${a.replace(/^&/,"")}`}function r(e,t={},n){const{isEnableDebug:r,webEnv:l}=(0,i.MI)(),c=(0,a.A)({from:"ext",extId:encodeURIComponent(chrome.runtime.id)},t);return n&&!c.extra&&(c.extra=btoa(JSON.stringify(n))),r&&l&&(c["x-flow-env"]=l),o(`https://${s.FI}${e}`,c)}function l(){const{hostname:e}=window.location;return!!e.startsWith("youtube.com")||e.indexOf(".youtube.com")>0}function c(){const{hostname:e}=window.location;return!!e.startsWith("bilibili.com")||e.indexOf(".bilibili.com")>0}function d(){return/douyin.com/.test(location.hostname)}function u(e){try{const t=new URL(e);return t.hash="",t.href}catch(t){return""}}},41772:(e,t,n)=>{n.d(t,{j:()=>s});var a=n(82854);function s(e,t){const n=a.ozw.getState(),s=n.messageLinkMap[e];if(!s)return[];const i=s.slice(Math.max(0,s.length-t)),o=(0,a.A4i)((0,a.tvN)(n,e));return i.map(o).filter(Boolean)}},62887:(e,t,n)=>{n.d(t,{I0:()=>d,KH:()=>g,eb:()=>h,gk:()=>u});var a=n(44557),s=n(48485),i=n(92431),o=n(98502),r=n(16100),l=n(81435),c=n(82854);const d=(e,t)=>{var n;const s=c.ozw.getState().regenerateMessageMap[e];if(!s){const n=(0,r.XB)({eventName:t});return c.ozw.setState((0,o.jM)((a=>(a.regenerateMessageMap[e]={messageMap:{},reportEvents:{[t]:n}},a)))),n}if(null==s||null===(n=s.reportEvents)||void 0===n||!n[t]){const n=(0,r.XB)({eventName:t});return c.ozw.setState((0,o.jM)((i=>(i.regenerateMessageMap[e].reportEvents=(0,a.A)((0,a.A)({},s.reportEvents),{},{[t]:n}),i)))),n}return s.reportEvents[t]},u=e=>({setRegenMessageInActive:({messageId:t})=>{const{draftMessageMap:{[t]:n},draftRegenerateMessageMap:{messageMap:{[t]:s}={}}={},draftRegenerateMessageMap:o}=e;{var r;const e=null!=s?s:(0,i.A)(n);null==s||null===(r=s.ext)||void 0===r||delete r.regen_active,(null==e?void 0:e.ext)&&(e.ext.regen="1"),o.messageMap=(0,a.A)((0,a.A)({},o.messageMap),{},{[t]:e})}n.ext&&(n.ext.regen="1"),(0,c.Jij)(n)||(n.status=l.q7.InVisible)},setRegenMessageActive:t=>{const{messageId:n}=t,{draftMessageMap:s,draftRegenerateMessageMap:{messageMap:{[n]:o}={}}}=e;o&&(s[n]=(0,a.A)((0,a.A)({},s[n]),(0,i.A)(o)),o.ext&&(o.ext.regen_active="1"))}}),g=(e,t)=>{if(!e||!t.reply_id)return!1;const n=t.reply_id,a=c.ozw.getState(),i=a.messageLinkMap[e],o=(0,c.A4i)({messageMap:a.messageMap[e],localMessageMap:a.localMessageMap[e]}),r=(0,c.rUA)({messageLinks:i,replyId:n,getMessage:o});if(1===(null==r?void 0:r.length))return!0;return(0,s.A)(r,(e=>{const t=o(e);return t&&(0,c.oQq)(t)}))},h=(e,t)=>{var n,a,s;if(!e||!t.messageId)return!1;const i=c.ozw.getState(),o=null===(n=i.messageMap[e])||void 0===n?void 0:n[null==t?void 0:t.messageId],r=null!==(a=null==o?void 0:o.reply_id)&&void 0!==a?a:"",l=null===(s=i.messageMap[e])||void 0===s?void 0:s[r];return((0,c.UGb)(o)||(0,c.aN2)(l))&&((0,c.pu_)(o)||(0,c.UQm)(o))}},94984:(e,t,n)=>{n.d(t,{$q:()=>b,Gm:()=>f,O2:()=>h,TU:()=>m,dk:()=>_,eT:()=>p,uX:()=>v});var a=n(44557),s=n(40967),i=n(37814),o=n(20177),r=n(70593),l=n(16100),c=n(94268),d=n(46219),u=n(1456),g=n(10129);function h(e,{conversationId:t,replyId:n}){const a=(0,i.A)(e.localMessageMap[t],(e=>(null==e?void 0:e.reply_id)===n));return(0,s.A)(a)}function m(e,{conversationId:t,localMessageId:n}){var a;return null===(a=e.localMessageMap[t])||void 0===a?void 0:a[n]}function p(e){var t;const{conversationType:n,isRegenerate:s,immerUpdateMessage:i,newLocalMessageId:o,conversationId:r,replyId:u,messageId:g,sectionId:h,message:m={},timeout:p=0,regenHead:_,localMessageStatus:v,createdFrom:f,reportParams:b}=e,[w]=i,y=(0,a.A)({conversation_id:r,reply_id:u,message_id:g,local_message_id:o,is_regenerate:s,conversation_type:n},b);if("ack"===f){const e=w.draftMessageReportEventMap[u];w.draftMessageReportEventMap[u]={reportParams:(null==e?void 0:e.reportParams)||{},reportEvents:(0,a.A)((0,a.A)({},(null==e?void 0:e.reportEvents)||{}),{},{receive_total_messages:(0,l.XB)({eventName:"receive_total_messages",meta:y})})}}if("send_message"!==f&&"replace_temporary_message"!==f){const e=w.draftMessageReportEventMap[o];w.draftMessageReportEventMap[o]={reportParams:(null==e?void 0:e.reportParams)||{},reportEvents:(0,a.A)((0,a.A)({},(null==e?void 0:e.reportEvents)||{}),{},{receive_message:(0,l.XB)({eventName:"receive_message",meta:y}),receive_message_package:(0,l.XB)({eventName:"receive_message_package",meta:y})})}}w.draftLocalMessageMap[o]=(0,c.xf)({prevMessageId:s?null===(t=(0,c.WZ)(w.draftMessageLinks,(e=>e.regen_head===_&&!e.isLocalMessage)))||void 0===t?void 0:t.messageId:u,localMessageStatus:v,message:(0,a.A)((0,a.A)({},m),{},{conversation_id:r,section_id:h,local_message_id:o,reply_id:u}),failedExpired:Date.now()+(1e3*Number(p)||d.dc),messageLinks:w.draftMessageLinks,isRegenerate:s})}function _(e){const{isRegenerate:t,immerUpdateMessage:n,newLocalMessageId:s,regenHead:i,messageKey:r}=e,[l]=n,c=(0,o.A)(l.draftMessageLinks,(e=>e.messageId===s));if(c)c.regen_head=i;else{const e=(0,a.A)({isLocalMessage:!0,messageId:s},r?{messageKey:r}:{});t&&(e.regen_head=i),l.draftMessageLinks.push(e)}}function v(e){const{immerUpdateMessage:t,newLocalMessageId:n,isSearchMessage:s=!1}=e,[i]=t,o=(0,r.A)(i.draftMessageLinks,(e=>e.messageId===n));o&&s&&(i.draftMessageLinks[o]=(0,a.A)((0,a.A)({},i.draftMessageLinks[o]),{},{messageKey:"search_".concat(n)}))}const f=(e,t)=>{var n;return(null===(n=e.userOgfQuota)||void 0===n?void 0:n.nextMessageUseOgf)?(0,a.A)((0,a.A)({},t),{},{llm_model_type:"2"}):t};function b(e){const[t]=e,{draftLocalMessageMap:n,draftMessageLinks:a,draftMessageMap:s}=t;a.filter((({isLocalMessage:e,messageId:t})=>{var a;return e&&(null===(a=n[t])||void 0===a||null===(a=a.local)||void 0===a?void 0:a.status)===g.FQ.ReceivingFirstPackage})).sort(((e,t)=>(0,c.rV)(s[n[t.messageId].reply_id||""],s[n[e.messageId].reply_id||""]))).forEach(((e,n)=>{n&&(0,u.k)(t,e)}))}},36682:(e,t,n)=>{n.d(t,{gI:()=>U,Z$:()=>C,ZU:()=>B,BR:()=>i.B,hJ:()=>x,lv:()=>T,Rk:()=>A,gW:()=>P,ic:()=>D,UQ:()=>M,JX:()=>k,uj:()=>y,AG:()=>S,KR:()=>H,a1:()=>q,MH:()=>G,kA:()=>R,tb:()=>E,Pm:()=>F,fK:()=>z.f,P9:()=>I,zQ:()=>$});var a=n(82854),s=n(56642),i=n(21890),o=n(44557),r=n(49392),l=n(20716),c=n(72372),d=n(47997),u=n(22358),g=n(11855),h=n(81626),m=n(78821),p=n(75484),_=n(46219),v=n(89361),f=n(47389);const b=(0,i.B)(((e,t)=>e.messageLinkMap[t]||[])),w=(0,i.B)(((e,t)=>e.messageListStatusMap[t]||{})),y=(0,i.B)(((e,t)=>{const n=w.raw(e,t),a=b.raw(e,t),s=w.raw(e,_.i9),i=b.raw(e,_.i9),o=(0,m.VN)(p.pU.getState(),t);return(null==o?void 0:o.conversation_type)===d.Cr.Coco&&0===a.length?{status:s,messageLinks:i,resolveConversationId:_.i9}:{status:n,messageLinks:a,resolveConversationId:t}})),A=(e,t)=>{const{updateMessageFeedback:n}=a.ozw.getState(),{liked:s,disliked:i,detail:d,remoteFeedbackType:m,localFeedbackType:p}=(0,a.ozw)((n=>{var a,s;const{feedback:i}=null!==(a=(0,h.Tc)(e,{isLocalMessage:!1,messageId:t},n))&&void 0!==a?a:{},r=null===(s=n.messageFeedbackMap[e])||void 0===s?void 0:s[t],l=(0,c.A)((0,o.A)({},r),{feedback_type:i});return{liked:l.feedback_type===u.MW.Like,disliked:l.feedback_type===u.MW.Unlike,detail:l,remoteFeedbackType:i,localFeedbackType:null==r?void 0:r.feedback_type}}),l.A);return(0,g.useEffect)((()=>{(0,r.A)(m)||p===m||n({conversationId:e,messageId:t,detail:{feedback_type:m},onlyLocal:!0})}),[m]),{liked:s,disliked:i,detail:d}},k=((0,i.B)(((e,t)=>e.messageMap[t]||{})),(0,i.B)(((e,t)=>e.localMessageMap[t]||{})),(0,i.B)(((e,t,n)=>{var a;if(!n)return;return null===(a=(n.isLocalMessage?e.localMessageMap:e.messageMap)[t])||void 0===a?void 0:a[n.messageId]}))),S=(0,i.B)(((e,t,n)=>{const s=(0,a.A4i)((0,a.tvN)(e,t)),i=[];for(const a of n){const e=s(a);e&&i.push(e)}return i})),x=((0,i.B)(((e,t,n)=>{var a;return n?null===(a=e.localMessageMap[t])||void 0===a?void 0:a[n]:void 0})),(0,i.B)(((e,t,n)=>{var s,i,r;const{regenerateMessageMap:{[t]:l},messageLinkMap:{[t]:c},messageMap:{[t]:d}}=e,u=(0,a.tP$)(e,t,n),g=(()=>{if(null!=u&&u.reply_id&&(0,a.oQq)(u))return(0,a.Jij)(u)?(0,a.rUA)({messageLinks:c,replyId:u.reply_id,getMessage:(0,a.A4i)({localMessageMap:e.localMessageMap[t],messageMap:e.messageMap[t]})}):n.regen_head?null==c?void 0:c.filter((e=>e.regen_head===n.regen_head||e.messageId===n.regen_head)).map((e=>(0,o.A)((0,o.A)({},e),{},{regen_head:e.regen_head||e.messageId}))):void 0})(),h=null===(s=[n,...null!=g?g:[]].map((e=>{var t;return null!==(t=null==d?void 0:d[e.messageId])&&void 0!==t?t:null})).find((e=>null==e?void 0:e.reply_id)))||void 0===s?void 0:s.reply_id;return{activeRegenerateMessage:null!=g&&g.length?null==l||null===(i=l.messageMap)||void 0===i?void 0:i[n.messageId]:void 0,regenerateActiveIndex:null==g?void 0:g.findIndex((({messageId:e})=>e===n.messageId)),isRegenerateHead:Boolean(n.regen_head&&n.messageId),isRegenerateTail:Boolean(n.regen_head&&(null==g||null===(r=g[g.length-1])||void 0===r?void 0:r.messageId)===n.messageId),regenerateMessageLinks:g,replyFromMessage:h&&d[h]||void 0}}))),I=(0,i.B)(((e,t,n)=>{const a=e.suggestMessageMap[t];return(null==a?void 0:a.replyId)===n?a:void 0})),M=e=>(0,p.pU)((t=>t.lastSectionIdMap[e]),s.x),C=((0,i.B)(((e,t)=>e.lastMessageMap[t])),(e,t)=>{try{const n=e.messageLinkMap[t],s=n[n.length-1];if(!s)return!0;const i=e.messageMap[t][s.messageId];return!i||!(0,a.oSs)(i)}catch(n){return!0}}),P=(0,i.B)(C),T=()=>{const{conversationDisabledParams:e}=(0,v.Y_)(),{isLimited:t,limitTips:n}=(()=>{const{limitExpired:e,limitTips:t,isLimited:n}=(0,a.ozw)((e=>e.rateLimitConfig),s.x);(0,g.useEffect)((()=>{i(e)}),[e]);const{setExpired:i}=(0,f.G)((()=>{a.ozw.getState().updateRateLimitConfig({isLimited:!1,limitExpired:void 0,limitTips:""})}));return{limitTips:t,isLimited:n}})();return null!=e&&e.isDisabled?(0,o.A)({},e):{disabledText:t?n:void 0,isDisabled:!!t}};var L=n(37357),j=n(16100);const E=({sendMessage:e,messageLink:t,conversationId:n})=>()=>{if(!t)return;const a={conversation_id:n,message_id:null==t?void 0:t.messageId,is_local_message:null==t?void 0:t.isLocalMessage};L.v.persist.info({eventName:"retry_send_message_start",meta:a});try{e([{reportParams:{scene:"resend"},operation:{resend:{messageLink:t}}}])}catch(s){L.v.persist.error({eventName:"retry_send_message_failed",meta:a,error:s})}},R=({sendMessage:e,messageLink:t,conversationId:n})=>()=>{if(!t||!n)return;const a=(0,h.Tc)(n,t),s=(0,j.XB)({eventName:"retry_receive_message",meta:{conversation_id:n,reply_id:null==a?void 0:a.reply_id,message_id:null==a?void 0:a.message_id}}),{reply_id:i}=a||{};if(!i)return void s.error({reason:"reply_id is null, retry failed"});const o={isLocalMessage:!1,messageId:i},r=(0,h.Tc)(n,o);try{e([{operation:{replace:{messageLink:o}},reportParams:{scene:"resend"}}]),s.successIfIdle(3e3)}catch(l){s.error({reason:"send message happen error, retry failed",error:l,meta:{content_type:null==r?void 0:r.content_type,is_local_message:null==o?void 0:o.isLocalMessage}})}};var N=n(40967),O=n(90321);const D=e=>(0,a.ozw)((t=>{if((0,O.A)(t.messageMap,e)){const n=t.messageMap[e];return!!(0,N.A)(n).every((e=>(0,a.RRO)(e)))}return!0}),s.x),H=e=>{var t;const[n,s]=(0,g.useState)(null===(t=a.ozw.persist)||void 0===t?void 0:t.hasHydrated);return(0,g.useEffect)((()=>{const t=a.ozw.persist.onHydrate((()=>s(!1))),n=a.ozw.persist.onFinishHydration((()=>{s(!0),null==e||e()}));return s(a.ozw.persist.hasHydrated()),a.ozw.persist.hasHydrated()&&(null==e||e()),()=>{t(),n()}}),[]),n},B=()=>a.ozw.persist.hasHydrated()?Promise.resolve():new Promise((e=>{a.ozw.persist.onFinishHydration((()=>{e()}))}));var z=n(30875);const U=(e=a.ozw.getState())=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.secUserId},F=()=>(0,a.ozw)(U),$=()=>(0,a.ozw)((e=>{var t;return null===(t=e.userInfo)||void 0===t?void 0:t.userNickName})),q=()=>(0,a.ozw)((e=>e.userOgfQuota),s.x),G=()=>(0,a.ozw)((e=>e.userOgf),s.x)},79279:(e,t,n)=>{n.d(t,{P:()=>f});var a=n(44557),s=n(5099),i=n(42579),o=n.n(i),r=n(16100),l=n(37357),c=n(81435),d=n(27527),u=n(94268),g=n(9057),h=n(49944),m=n(88138),p=n(81626),_=n(83664);function v(e,t,n,i){if(!n||!(0,u.xX)(n)||!n.local_message_id||(0,u.wt)(n))return;const{message_id:g,local_message_id:v,reply_id:f}=n,b=e.getState();if((0,u.e1)(n)||(0,u.ET)(n))return b.finishSendMessageTask(v),b.updateMessageList({conversationId:t,immerUpdate:e=>{const{draftLocalMessageMap:t}=e,a=t[(null==n?void 0:n.local_message_id)||""];a&&(a.local.hasBroken=!0)}}),(0,m.PF)({localMessageId:null==n?void 0:n.local_message_id}),void _.B.emit("chat.localBreak");if(!(0,u.oS)(n)||(0,u.Ys)(n)){const e=(0,p.Tc)(t,{isLocalMessage:!1,messageId:f||""});(0,m.PF)({replyId:f||"",localMessageId:null==e?void 0:e.local_message_id}),(0,u.Wi)(n)?b.updateMessageList({conversationId:t,immerUpdate:({draftLocalMessageMap:e})=>{const t=e[v||""];t&&(t.local.hasBroken=!0,t.status=c.q7.InVisible)}}):(0,u.ln)(n)&&g&&(0,h.P)((0,a.A)((0,a.A)({conversation_id:t,message_id:g},(0,s.A)(n,["local","local_message_id"])),{},{status:c.q7.Broken,chunk_seq:"999999",is_finish:!0})),_.B.emit("chat.localBreak");const w=f||g,y=(0,r.XB)({eventName:"break_message"});if(!function(e){if(null==e||!e.create_time)return!1;const t=(0,u.Qw)(Number(e.create_time));return o()().isBefore(o()(t).add(10,"minute"))}(n)||!w||null!=t&&t.startsWith("local")||(0,u.xT)(n))return void l.v.persist.log({eventName:"break_message_invalid",meta:{replyId:String(w),conversation_id:String(t),is_finished:String(n.is_finish),create_time:String(n.create_time),message_type:String(n.message_type),content_type:String(n.content_type),status:String(n.status),localMessageStatus:String(n.local.status)}});d.j.apiService.message.MessageReport({reply_id:w,conversation_id:t,action:"break"}).then((()=>{y.addDurationPoint("success"),y.success()}),(e=>{y.error({reason:"break message failed",error:e,meta:{replyId:String(w),conversation_id:String(t),is_finished:String(n.is_finish),create_time:String(n.create_time),message_type:String(n.message_type),content_type:String(n.content_type),status:String(n.status),localMessageStatus:String(n.local.status)}}),null==i||i()}))}}function f(e,t){const n=e.getState();v(e,t,(0,g.qo)(n,t));const a=(0,g.qo)(n,t);(0,u.nt)(a)&&v(e,t,a)}},17003:(e,t,n)=>{n.d(t,{Aj:()=>s.A,BF:()=>r.BF,EM:()=>i.EM,Ej:()=>a.Ej,I6:()=>o.I,ZH:()=>a.ZH,c5:()=>a.c5,hT:()=>a.hT,k:()=>a.k,pl:()=>l.p,u1:()=>i.u1});var a=n(1456),s=n(35119),i=n(68503),o=n(19867),r=n(51239),l=n(45576)},46346:(e,t,n)=>{n.d(t,{YJ:()=>d,Zw:()=>g,bR:()=>s,mf:()=>u,qQ:()=>l,qo:()=>r,tP:()=>o,vW:()=>c});var a=n(94268);const s=(e,t)=>{const n=e.messageLinkMap[t]?i(e,t,e.messageLinkMap[t]):void 0;return{lastAvailableMessage:n?o(e,t,n):void 0,lastAvailableMessageLink:n}},i=(e,t,n)=>{for(let s=n.length-1;s>=0;s--){const i=n[s],r=n[s-1],l=o(e,t,i),c=o(e,t,r);if((0,a.i8)(l)&&(0,a.i8)(c))return(0,a.hd)(l)?r:i;if((0,a.$4)(l))return i}},o=(e,t,n)=>(0,a.A4)((0,a.tv)(e,t))(n),r=(e,t)=>{const{message:n}=l(e,t,e.messageLinkMap[t],(({messageLink:e})=>e.isLocalMessage&&!!e.messageId));return n&&(0,a.xX)(n)?n:void 0},l=(e,t,n,s)=>{const i=(0,a.A4)((0,a.tv)(e,t)),o=(0,a.WZ)(n||[],(e=>s({messageLink:e,getMessage:()=>i(e)})));return{messageLink:o,message:o?i(o):void 0}},c=(e,{conversationId:t,replyId:n})=>{const s=(0,a.ci)({messageLinks:e.messageLinkMap[t],replyId:n,getMessage:(0,a.A4)((0,a.tv)(e,t))});return s?o(e,t,s):void 0},d=(e,t,n)=>{var a;return(null===(a=e.localMessageMap[t])||void 0===a?void 0:a[n])||{}},u=(e,t)=>e.preprocessTaskMap[t].key,g=(e,t,n)=>{const a=e.messageMap[t],s=a[n];if(!s)return[];const i=!s.reply_id||"0"===s.reply_id?n:s.reply_id,o=a[null!=i?i:""],r=Object.keys(a).filter((e=>{var t;return(null===(t=a[e])||void 0===t?void 0:t.reply_id)===i})).map((e=>Number(a[e].index)));return[...o?[Number(o.index)]:[],...r]}},56570:(e,t,n)=>{n.d(t,{k:()=>v});var a=n(62693),s=n(21511),i=n(76779),o=n(16350),r=n(45498),l=n(81435),c=n(20592),d=n(46219),u=n(37357),g=n(46346),h=n(82205),m=n(34870),p=n(64873);const _=[l.cM.Text,l.cM.Music,l.cM.Video,l.cM.Image,l.cM.File,l.cM.PluginSearchResult,l.cM.Composite,l.cM.Nested,l.cM.CopilotCard,l.cM.LyricsToSongMusic,l.cM.LyricsToSongLyric,l.cM.Outline],v=(0,r.vt)()((0,m.eh)(((e,t)=>({scene:void 0,isSelectMode:!1,messageIndexList:[],contentTypeWhiteList:_,preShareId:"",preMessageIndexList:[],preShareType:c.I9.All,shareType:c.I9.All,extraInfo:{},setContentTypeWhiteList:(t=_)=>{e({contentTypeWhiteList:t})},enterSelectMode:({scene:n,extraInfo:a={},data:s})=>{var i,o,r,l,d,u,g;const{isSelectMode:h,scene:m}=t();h&&n===m||e({extraInfo:a,scene:n,isSelectMode:!0,preShareId:null!==(i=null==s||null===(o=s.share_info)||void 0===o?void 0:o.share_id)&&void 0!==i?i:"",preMessageIndexList:2===(null==s||null===(r=s.share_info)||void 0===r?void 0:r.share_status)&&null!==(l=null==s||null===(d=s.share_info)||void 0===d?void 0:d.message_index_list)&&void 0!==l?l:[],preShareType:(null==s||null===(u=s.share_info)||void 0===u?void 0:u.share_type)||c.I9.All,shareType:(null==s||null===(g=s.share_info)||void 0===g?void 0:g.share_type)||c.I9.All})},exitSelectMode:()=>{t().isSelectMode&&e({scene:void 0,isSelectMode:!1,messageIndexList:[],preShareId:"",preMessageIndexList:[],extraInfo:{}})},toggleMessage:({conversationId:n,messageIndex:a,state:i})=>{var r;const{messageIndexList:l,getIsCheckboxDisabled:c,_findMessageByIndex:u}=t(),h=l.includes(a),m=u({conversationId:n,state:i,messageIndex:a}),p=(0,g.Zw)(i,n,null!==(r=null==m?void 0:m.message_id)&&void 0!==r?r:""),[_,...v]=p;if(h)return!(a===_)&&v.filter((e=>l.includes(e))).length>1?void e({messageIndexList:(0,o.A)(l,a)}):void e({messageIndexList:(0,o.A)(l,...p)});if(c({conversationId:n,messageIndex:a,state:i}))return;const f=p.filter((e=>!c({conversationId:n,messageIndex:e,state:i})));l.length+f.length>d.fV?e({messageIndexList:[...l,a].sort(((e,t)=>e-t))}):e({messageIndexList:(0,s.A)([...l,...f]).sort(((e,t)=>e-t))})},selectAll:n=>{const{_getSelectAllIndexList:a}=t();e({messageIndexList:a(n)})},deselectAll:()=>{e({messageIndexList:[]})},_findMessageByIndex:({conversationId:e,state:t,messageIndex:n})=>{var a,s;const i=t.messageMap[e],o=t.messageLinkMap[e];if(!i||!o)return;const r=Number(null===(a=i[null===(s=o[0])||void 0===s?void 0:s.messageId])||void 0===a?void 0:a.index),l=o[n-r];if(l){const a=(0,h.Tc)(e,l,t);if((null==a?void 0:a.index)===n)return a}const c=Object.keys(i).find((e=>{var t;return Number(null===(t=i[e])||void 0===t?void 0:t.index)===n}));return c?i[c]:void 0},_getSelectAllIndexList:({conversationId:e,state:n,lastMessageIndex:s})=>{var o,r,l,c;const{getIsCheckboxDisabled:d}=t(),u=n.messageMap[e],g=n.messageLinkMap[e];if(!u||!g)return[];const h=Number(null===(o=u[null===(r=g[0])||void 0===r?void 0:r.messageId])||void 0===o?void 0:o.index),m=Number(null===(l=u[null===(c=g[g.length-1])||void 0===c?void 0:c.messageId])||void 0===l?void 0:l.index);return(0,i.A)(1,s+1).filter((t=>!(0,a.A)(t,h,m+1)||!d({conversationId:e,messageIndex:t,state:n})))},getIsSelectAllChecked:e=>{const{messageIndexList:n,_getSelectAllIndexList:a}=t(),s=a(e);return n.length>0&&n.length>=s.length},getIsCheckboxDisabled:({conversationId:e,state:n,messageIndex:a})=>{const{messageIndexList:s,_findMessageByIndex:i,_isMessageDisableSelect:o,contentTypeWhiteList:r}=t();if(s.includes(a))return!1;const l=i({state:n,messageIndex:a,conversationId:e}),c=o(l);var d;c&&u.v.persist.info({eventName:"thread_share_checkbox_disabled",meta:{messageIndex:null==l?void 0:l.index,messageId:null==l?void 0:l.message_id,messageStatus:null==l?void 0:l.status,messageContentType:null==l?void 0:l.content_type,contentTypeWhiteList:r,isOnboarding:null==l||null===(d=l.ext)||void 0===d?void 0:d.onboarding,listLength:s.length}});return c},_isMessageDisableSelect:e=>{var n;const{messageIndexList:a,contentTypeWhiteList:s}=t();return!e||(!!(0,p.Tq)(e)||(e.status===l.q7.InVisible||("1"===(null===(n=e.ext)||void 0===n?void 0:n.onboarding)||(a.length>=d.fV||(!e.content_type||!s.includes(e.content_type))))))},updateMessageIndexList:n=>{const{messageIndexList:a,_isMessageDisableSelect:s}=t(),i=[];for(const e of Object.values(n)){-1!==a.indexOf(Number(e.index))&&s(e)&&i.push(Number(e.index))}const o=a.filter((e=>!i.includes(e)));e({messageIndexList:o})},setShareType:t=>{e({shareType:t})}}))))},74125:(e,t,n)=>{n.d(t,{ke:()=>a});n(51239);var a={Share:"Share",Collection:"Collection"}},98673:(e,t,n)=>{n.d(t,{A4:()=>d,AC:()=>_,Kj:()=>l,Ww:()=>p,i0:()=>m,kI:()=>h,rJ:()=>g,tv:()=>c,uT:()=>r,um:()=>u});var a=n(28159),s=n(81435),i=n(64873),o=(n(51239),n(10129));const r=({messageLinks:e,getMessage:t,range:n})=>{var a;const s=Number(null===(a=t(e[0]))||void 0===a?void 0:a.index)||0;return{hasMore:s>n.start,lastCursor:s,loading:!1}},l=({messageLinks:e,getMessage:t,size:n})=>{if(Array.isArray(e)&&e.length>0){var a;const s=Number(null===(a=t(e[0]))||void 0===a?void 0:a.index)||0,i=e.length>=n;return{hasMore:s>1&&i,lastCursor:s,loading:!1}}return{hasMore:!1,lastCursor:0,loading:!1}},c=(e,t)=>({messageMap:e.messageMap[t],localMessageMap:e.localMessageMap[t],messageLinks:e.messageLinkMap[t],messageListStatus:e.messageListStatusMap[t]}),d=e=>t=>{var n,a;if(!t)return;const{isLocalMessage:s,messageId:i}=t;return s?null===(n=e.localMessageMap)||void 0===n?void 0:n[i]:null===(a=e.messageMap)||void 0===a?void 0:a[i]},u=e=>`replyTo${e}`,g=e=>e?(0,i.Ji)(e)?"pic":(0,i.ze)(e)?"video":(0,i.dz)(e)?"music":(0,i.ml)(e)?"file":(0,i._n)(e)?"search_card":(0,i.TQ)(e)?"lyrics_to_song_lyric":(0,i.lT)(e)||(0,i.A9)(e)?"lyrics_to_song_music":"text":"text",h=e=>{if(e&&(0,i.pu)(e)){const{text:t}=e.content_obj||{};return(0,a.A)(t)?t.length:0}return 0},m=e=>{if(e&&(0,i.pu)(e)){const{text:t}=e.content_obj||{};return(0,a.A)(t)&&t.includes("coco://sendMessage")?1:0}return 0};function p(e){const{Xt:t}=s;return e.next_connection_type===t.WebSocket?o.aU.Socket:e.next_connection_type===t.HttpChunk?o.aU.HttpChunk:null===(n=e.local_info)||void 0===n?void 0:n.from;var n}function _(e){var t,n,a,s,i,o,r;return{conversation_id:e.conversation_id,message_id:e.message_id,from:null===(t=e.local_info)||void 0===t?void 0:t.from,local_message_id:null==e?void 0:e.local_message_id,is_regenerate:"local"in e&&(null==e||null===(n=e.local)||void 0===n?void 0:n.isRegenerate),has_err:null===(a=e.error_details)||void 0===a?void 0:a.error_code,log_id:null===(s=e.local_info)||void 0===s?void 0:s.log_id,inner_log_id:null==e||null===(i=e.ext)||void 0===i?void 0:i.log_id,trace_id:null===(o=e.local_info)||void 0===o?void 0:o.trace_id,retried:null==e||null===(r=e.local_info)||void 0===r?void 0:r.retried,next_connection_type:null==e?void 0:e.next_connection_type}}},32618:(e,t,n)=>{n.d(t,{D6:()=>l,P5:()=>r,YF:()=>c,nD:()=>d,oM:()=>o});var a=n(28159),s=n(2633),i=n(64873);const o=e=>{var t,n;if(e&&((0,i.pu)(e)||(0,i.UQ)(e))&&(0,a.A)(null==e||null===(t=e.content_obj)||void 0===t?void 0:t.text))return null==e||null===(n=e.content_obj)||void 0===n?void 0:n.text},r=(e,t,n)=>{if(!e)return;const r=o(e);return(0,a.A)(r)?r:(0,i.HN)(e)||(0,i.Ji)(e)?void 0:t?(0,s.A)(null==e?void 0:e.content_obj)?`${n} message.content\uff1a${null==e?void 0:e.content}`:`${n} message.content\uff1a\n\n\`\`\`json\n${JSON.stringify(null==e?void 0:e.content_obj,void 0,2)}\n\`\`\`\n\n`:n},l=e=>{const t=null==e?void 0:e.match(/\[(\S*?)\](?=\(coco:\/\/sendMessage)/g);return null!=t&&t.length?t.map((e=>e.split(/[\[\]]/).join(""))):[]},c=e=>{var t;return(0,i.TQ)(e)&&(null==e||null===(t=e.content_obj)||void 0===t?void 0:t.text)||""},d=e=>(0,i.rI)(e)?"simple_search":(0,i.C9)(e)?"deep_search":(0,i.XV)(e)?"complex_search":"ai_search"},94363:(e,t,n)=>{n.d(t,{z:()=>s});var a=n(14065);n(27527),n(82854),n(37357);function s(){return i.apply(this,arguments)}function i(){return(i=(0,a.A)((function*(){}))).apply(this,arguments)}},51067:(e,t,n)=>{n.d(t,{P:()=>s});var a=n(170);const s=[a.nc,a.VX,a.P9]},59076:(e,t,n)=>{n.d(t,{rd:()=>o,w8:()=>r});var a=n(10633),s=n(8607);class i{constructor(e){(0,a.A)(this,"ctx",void 0),(0,a.A)(this,"_chatProtocolPluginEntries",void 0),(0,a.A)(this,"_chatProtocolPluginInstances",{});const{plugins:t=[]}=e;this._chatProtocolPluginEntries=t}getChatProtocolPlugin(e){var t;const n=null===(t=this._chatProtocolPluginEntries)||void 0===t?void 0:t.filter((t=>t.matchContentType(e)));if(null==n||!n.length)return;return n.map((e=>(this._chatProtocolPluginInstances[e.pluginId]||(this._chatProtocolPluginInstances[e.pluginId]=new e.Plugin),this._chatProtocolPluginInstances[e.pluginId])))}}const o=(0,s.p)(),r=e=>(o.service||(o.service=new i(e)),o.service)},964:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var a=n(14065),s=n(44557),i=n(10633),o=n(17837),r=n(5394),l=n(5947),c=n(59181),d=n(58871),u=n(68560),g=n(32512);const h=class{constructor(e){var t=this;if((0,i.A)(this,"config",void 0),(0,i.A)(this,"recorderInstance",null),(0,i.A)(this,"wsProxy",void 0),(0,i.A)(this,"wsInstance",null),(0,i.A)(this,"isAsrRecordingOrLoading",(e=>e===o.rE.RECORDING||e===o.rE.PAUSED||e===o.rE.LOADING)),(0,i.A)(this,"initWsService",(()=>{this.wsInstance=new g.A({wsConfig:(0,s.A)((0,s.A)({},this.config.wsConfig),{},{onWsConnectError:()=>{var e,t;null===(e=this.config.wsConfig)||void 0===e||null===(t=e.onWsConnectError)||void 0===t||t.call(e),this.stopAsrSession()},onWsConnectClose:()=>{var e,t;null===(e=this.config.wsConfig)||void 0===e||null===(t=e.onWsConnectClose)||void 0===t||t.call(e),this.stopAsrSession()}}),wsProxy:this.wsProxy})})),(0,i.A)(this,"startAsr",(0,a.A)((function*(){if(!t.isAsrRecordingOrLoading(u.A.getCurrentAsrStatus())){u.A.setAsrStatus(o.rE.LOADING);try{const e=yield navigator.mediaDevices.getUserMedia({audio:!0});t.initWsService();const n=new AudioContext({sampleRate:16e3});t.recorderInstance=yield t.createRecorderInstance(n,e),t.recorderInstance.startRecording()}catch(a){var e,n;null===(e=t.config)||void 0===e||null===(n=e.onPermissionDenied)||void 0===n||n.call(e),t.stopAsrSession()}}}))),(0,i.A)(this,"stopAsr",(()=>{this.stopAsrSession()})),(0,i.A)(this,"getAsrMessageSubscription",(()=>u.A.getAsrResultObservable())),(0,i.A)(this,"getAsrStatusSubscription",(()=>u.A.getAsrStatusObservable())),(0,i.A)(this,"getAudioVolumeSubscription",(()=>u.A.getVolumeObservable())),(0,i.A)(this,"stopAsrSession",(()=>{var e,t;u.A.setAsrStatus(o.rE.DESTROYED),null===(e=this.recorderInstance)||void 0===e||e.stopRecorder(),this.recorderInstance=null,null===(t=this.wsInstance)||void 0===t||t.stopWsConnection(),this.wsInstance=null})),(0,i.A)(this,"destroyAsr",(()=>{this.stopAsrSession(),u.A.destroy(!1)})),(0,i.A)(this,"enterMuteMode",(()=>{var e;null===(e=this.recorderInstance)||void 0===e||e.enterMuteMode()})),(0,i.A)(this,"exitMuteMode",(()=>{var e;null===(e=this.recorderInstance)||void 0===e||e.exitMuteMode()})),this.config=e,this.recorderInstance=null,e.wsProxy)this.wsProxy=e.wsProxy;else{const t=new c.k({commonParams:e.wsConfig.commonParams});this.wsProxy=t}}createRecorderInstance(e,t){var n=this;return(0,a.A)((function*(){if(n.config.audioWorklet&&(yield(0,r.eu)()))return new l.A({audioCtx:e,stream:t,wsInstance:n.wsInstance});{const a=e.createMediaStreamSource(t);return new d.A({source:a,audioCtx:e,stream:t,wsInstance:n.wsInstance})}}))()}}},38080:(e,t,n)=>{n.d(t,{fG:()=>o});var a=n(44557),s=n(14065),i=n(64462);const o=function(){var e=(0,s.A)((function*(e,t){let n=null;try{const s='@font-face { font-family: Inter, -apple-system, "system-ui", "Segoe UI", "SF Pro SC", "SF Pro Display", "SF Pro Icons", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif; src: url(""); unicode-range: U+0; }';n=yield(0,i.mo)(e,(0,a.A)({fontEmbedCSS:s},t))}catch(s){}return n}));return function(t,n){return e.apply(this,arguments)}}()},41349:(e,t,n)=>{n.d(t,{EL:()=>l,Pg:()=>r,e8:()=>c,fG:()=>d,kE:()=>i,zS:()=>o});var a=n(13322),s=n(4044);const i=e=>e.type===a.b.Select,o=e=>e.type===a.b.Text,r=e=>e.type===a.b.Placeholder,l=e=>e.map(((t,n)=>{if((0,s.vq)(t)){if((0,s.je)(t)){const{children:s}=t;return l(s).concat(n===e.length-1?[]:[{type:a.b.Text,text:"\n"}])}if((0,s.KI)(t)){const{children:e,placeholder:n,key:i,clickable:o}=t;return{type:a.b.Placeholder,placeholder:n,text:(0,s.Ae)(e),key:i,clickable:o}}if((0,s.q6)(t)){const{value:e,options:n,title:s,key:i}=t;return{type:a.b.Select,title:s,key:i,optionList:n,value:e}}}const{text:i}=t;return{type:a.b.Text,text:i}})).flat(),c=e=>{if(!e.length)return[{type:"paragraph",children:[{text:""}]}];const t=[{type:"paragraph",children:[]}];for(const n of e)if(n.type===a.b.Text&&"\n"===n.text)t.push({type:"paragraph",children:[]});else if(r(n)){const{text:e,placeholder:a,key:s,clickable:i}=n;t[t.length-1].children.push({type:"labeled_input",children:[{text:e}],placeholder:a,key:s,clickable:i})}else if(i(n)){const{optionList:e,value:a,title:s,key:i}=n;t[t.length-1].children.push({type:"labeled_select",title:s,key:i,options:e,value:a,children:[{text:""}]})}else if(o(n)){const{text:e}=n;t[t.length-1].children.push({text:e})}return t},d=(e,t={})=>{const{stringifyItem:n}=t;return e.map((e=>{return r(e)?e.text||e.placeholder:i(e)?null!==(t=null==n?void 0:n(e))&&void 0!==t?t:e.value:o(e)?e.text:void 0;var t})).join("")}},39415:(e,t,n)=>{n.d(t,{F_:()=>u,Fr:()=>o,M:()=>_,Mx:()=>d,UP:()=>h,Z5:()=>v,gm:()=>g,jc:()=>c,nr:()=>m,ps:()=>f,w_:()=>p});var a=n(7685),s=n.n(a);let i;const o=()=>s().getParser(navigator.userAgent).getPlatformType(!0).includes("mobile");let r;let l;const c=()=>{if(void 0===l){const{userAgent:e}=navigator,t=/iPad/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;l=t||n}return l},d=()=>(void 0===i&&(i=o()),i||(()=>{if("undefined"==typeof document)return!1;if(void 0===r){const{userAgent:e}=navigator,t=/iPad|iPhone|iPod/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;r=t||n}return r})()),u=()=>"function"==typeof window.webkitConvertPointFromNodeToPage,g=()=>navigator.userAgent.toLowerCase().includes("firefox"),h=()=>/edge?\//.test(navigator.userAgent.toLowerCase()),m=()=>navigator.userAgent.indexOf("Safari")>-1&&-1===navigator.userAgent.indexOf("Chrome"),p=()=>u()&&!d();const _="undefined"!=typeof window,v=()=>{if("undefined"==typeof navigator)return;const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(null===e||5!==e.length)return;const[,t,n,a,s]=e.map((e=>parseInt(e,10)));return{major:t,minor:n,build:a,patch:s}},f=()=>{if("undefined"!=typeof window){const{userAgent:e}=navigator;return/Samantha/.test(e)}return!1}},39779:(e,t,n)=>{n.d(t,{AY:()=>a});n(80160);const a=(e,t={})=>{try{var n;const a=new URL(e);return(!t.allowedProtocols||t.allowedProtocols.includes(a.protocol))&&(!t.allowedExtensions||t.allowedExtensions.map((e=>e.toLowerCase())).includes(null!==(n=a.pathname.split(".").pop())&&void 0!==n?n:""))&&(!t.allowedHosts||t.allowedHosts.includes(a.host))}catch(a){return!1}}},85379:(e,t,n)=>{n.d(t,{A:()=>a});const a={"cici-ext-container":"cici-ext-container-ZsL3N4",ciciExtContainer:"cici-ext-container-ZsL3N4","inactivelink-hover-animation":"inactivelink-hover-animation-uqtsZZ",inactivelinkHoverAnimation:"inactivelink-hover-animation-uqtsZZ","notactivelink-hover-animation":"notactivelink-hover-animation-qIF7Pk",notactivelinkHoverAnimation:"notactivelink-hover-animation-qIF7Pk","light-click-animation":"light-click-animation-aP0sBM",lightClickAnimation:"light-click-animation-aP0sBM","click-animation":"click-animation-m_aVOk",clickAnimation:"click-animation-m_aVOk","semi-animation-rotate":"semi-animation-rotate-guIq9p",semiAnimationRotate:"semi-animation-rotate-guIq9p","inactive-btn-hover-animation":"inactive-btn-hover-animation-p55iH4",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-p55iH4","cici-ext-always-dark":"cici-ext-always-dark-cZEcux",ciciExtAlwaysDark:"cici-ext-always-dark-cZEcux","cici-ext-always-light":"cici-ext-always-light-asgCmn",ciciExtAlwaysLight:"cici-ext-always-light-asgCmn",ellipsis:"ellipsis-crsBmL",wrapper:"wrapper-hUZARQ",translateServicePopover:"translateServicePopover-hsdsA4",translatePanel:"translatePanel-zEvg3V",options:"options-Sqt4ba",translatePanelTitle:"translatePanelTitle-aF2p_o",translatePanelText:"translatePanelText-tZn2Vm","translate-panel-checkbox":"translate-panel-checkbox-zBRKCS",translatePanelCheckbox:"translate-panel-checkbox-zBRKCS",translatePanelSelectTitle:"translatePanelSelectTitle-PuACPl",translatePanelSelectList:"translatePanelSelectList-CM7MDK",translatePanelSelectItem:"translatePanelSelectItem-Hjf6Y1",nameWrapper:"nameWrapper-Ie1kv0",locName:"locName-jenbnm",active:"active-yOqMUg",name:"name-b4vXqU",checkbox:"checkbox-yjLP5c",selectedHoverTranslateSetting:"selectedHoverTranslateSetting-VF9aq0","language-notice-wrapper":"language-notice-wrapper-jvVOm3",languageNoticeWrapper:"language-notice-wrapper-jvVOm3","placement-left":"placement-left-rpzGBS",placementLeft:"placement-left-rpzGBS","language-notice":"language-notice-mWw7Vf",languageNotice:"language-notice-mWw7Vf",icon:"icon-C9iS8d",content:"content-TpyY49","activelink-hover-animation":"activelink-hover-animation-pD7DOP",activelinkHoverAnimation:"activelink-hover-animation-pD7DOP"}}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={id:e,loaded:!1,exports:{}};return a[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=a,i.amdO={},e=[],i.O=(t,n,a,s)=>{if(!n){var o=1/0;for(d=0;d<e.length;d++){for(var[n,a,s]=e[d],r=!0,l=0;l<n.length;l++)(!1&s||o>=s)&&Object.keys(i.O).every((e=>i.O[e](n[l])))?n.splice(l--,1):(r=!1,s<o&&(o=s));if(r){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[n,a,s]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var s=Object.create(null);i.r(s);var o={};t=t||[null,n({}),n([]),n(n)];for(var r=2&a&&e;"object"==typeof r&&!~t.indexOf(r);r=n(r))Object.getOwnPropertyNames(r).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(s,o),s},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={945:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var a,s,[o,r,l]=n,c=0;if(o.some((t=>0!==e[t]))){for(a in r)i.o(r,a)&&(i.m[a]=r[a]);if(l)var d=l(i)}for(t&&t(n);c<o.length;c++)s=o[c],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(d)},n=self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.O(void 0,[126,627,685,419,295,962,736,773,866,896],(()=>i(37894)));var o=i.O(void 0,[126,627,685,419,295,962,736,773,866,896],(()=>i(99464)));o=i.O(o);