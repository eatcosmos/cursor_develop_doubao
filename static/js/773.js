(self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[]).push([[773],{92174:(e,t,s)=>{s.d(t,{A:()=>ee});var i=function(){return(i=Object.assign||function(e){for(var t,s=1,i=arguments.length;s<i;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function n(e,t){var s="function"==typeof Symbol&&e[Symbol.iterator];if(!s)return e;var i,n,a=s.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)o.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(s=a.return)&&s.call(a)}finally{if(n)throw n.error}}return o}function a(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e}var o,r,l,c,d,u=function(){function e(){this._hooks={},this._cache=[],this._hooksCache={}}return e.prototype.on=function(e,t){e&&t&&"function"==typeof t&&(this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t))},e.prototype.once=function(e,t){var s=this;e&&t&&"function"==typeof t&&this.on(e,(function i(n){t(n),s.off(e,i)}))},e.prototype.off=function(e,t){if(e&&this._hooks[e]&&this._hooks[e].length)if(t){var s=this._hooks[e].indexOf(t);-1!==s&&this._hooks[e].splice(s,1)}else this._hooks[e]=[]},e.prototype.emit=function(e,t,s){if(s){if(!e)return;-1!==this._cache.indexOf(s)?this._emit(e,t):(this._hooksCache.hasOwnProperty(s)||(this._hooksCache[s]={}),this._hooksCache[s].hasOwnProperty(e)||(this._hooksCache[s][e]=[]),this._hooksCache[s][e].push(t))}else this._emit(e,t)},e.prototype._emit=function(e,t){e&&this._hooks[e]&&this._hooks[e].length&&a(this._hooks[e]).forEach((function(e){try{e(t)}catch(e){}}))},e.prototype.set=function(e){e&&-1===this._cache.indexOf(e)&&this._cache.push(e)},e}(),h=function(e){return null!=e&&"[object Object]"==Object.prototype.toString.call(e)},_=(o=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return o+=1}),g=function(e){return function(e,t,s){if("string"==typeof e&&"number"==typeof s){var i,n=[];s=s<=25?s:s%25;var a=String.fromCharCode(s+97);i=e.split(a);for(var o=0;o<i.length;o++){var r=parseInt(i[o],s);r=1*r^64;var l=String.fromCharCode(r);n.push(l)}return n.join("")}}(e,0,25)},p=function(e){var t=document.createElement("a");return t.href=e,t},m=function(e){var t={};try{var s=p(e).search;if(!s)return t;(s=s.slice(1)).split("&").forEach((function(e){var s,i,n=e.split("=");n.length&&(s=n[0],i=n[1]);try{t[s]=decodeURIComponent(void 0===i?"":i)}catch(e){t[s]=i}}))}catch(e){}return t},f=function(e){for(var t=0,s=0,i=(e+="").length,n=0;n<i;n++)((t=31*t+e.charCodeAt(s++))>0x7fffffffffff||t<-0x800000000000)&&(t&=0xffffffffffff);return t<0&&(t+=0x7ffffffffffff),t},v=(function(e){var t;t=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var s=arguments[e];for(var i in s)t[i]=s[i]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function s(i){function n(){}function a(t,s,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},n.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var o=JSON.stringify(s);/^[\{\[]/.test(o)&&(s=o)}catch(e){}s=i.write?i.write(s,t):encodeURIComponent(String(s)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var r="";for(var l in a)a[l]&&(r+="; "+l,!0!==a[l]&&(r+="="+a[l].split(";")[0]));return document.cookie=t+"="+s+r}}function o(e,s){if("undefined"!=typeof document){for(var n={},a=document.cookie?document.cookie.split("; "):[],o=0;o<a.length;o++){var r=a[o].split("="),l=r.slice(1).join("=");s||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(r[0]);if(l=(i.read||i)(l,c)||t(l),s)try{l=JSON.parse(l)}catch(e){}if(n[c]=l,e===c)break}catch(e){}}return e?n[e]:n}}return n.set=a,n.get=function(e){return o(e,!1)},n.getJSON=function(e){return o(e,!0)},n.remove=function(t,s){a(t,"",e(s,{expires:-1}))},n.defaults={},n.withConverter=s,n}((function(){}))},e.exports=t()}(r={exports:{}}),r.exports),y=function(e,t){try{return e?v.get(e,{domain:t||document.domain}):v.get()}catch(e){return""}},b=function(e,t,s,i){try{var n=i||document.domain,a=+new Date+(s||6048e5);v.set(e,t,{expires:new Date(a),path:"/",domain:n})}catch(e){}},S=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e.prototype.getCookie=function(e,t){return y(e,t)},e.prototype.setCookie=function(e,t,s,i){b(e,t,s,i)},e}(),A={getItem:function(e){try{var t=localStorage.getItem(e),s=t;try{t&&"string"==typeof t&&(s=JSON.parse(t))}catch(e){}return s||{}}catch(e){}return{}},setItem:function(e,t){try{var s="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,s)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return y(e,t)},setCookie:function(e,t,s,i){b(e,t,s,i)},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(d){return!1}}()},k={getItem:function(e){try{var t=sessionStorage.getItem(e),s=t;try{t&&"string"==typeof t&&(s=JSON.parse(t))}catch(e){}return s||{}}catch(e){}return{}},setItem:function(e,t){try{var s="string"==typeof t?t:JSON.stringify(t);sessionStorage.setItem(e,s)}catch(e){}},removeItem:function(e){try{sessionStorage.removeItem(e)}catch(e){}},getCookie:function(e,t){return y(e,t)},setCookie:function(e,t,s,i){b(e,t,s,i)},isSupportSession:function(){try{return sessionStorage.setItem("_ranger-test-key","hi"),sessionStorage.getItem("_ranger-test-key"),sessionStorage.removeItem("_ranger-test-key"),!0}catch(d){return!1}}()},w=function(){function e(e,t){this._storage=t&&"session"===t?k:!e&&A.isSupportLS?A:new S}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e,t){return this._storage.getCookie(e,t)},e.prototype.setCookie=function(e,t,s,i){this._storage.setCookie(e,t,s,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),E=function(){function e(e,t,s){this.appid=e,this.domain=t,this.userAgent=window.navigator.userAgent,this.appVersion=window.navigator.appVersion,this.cookie_expire=s}return e.prototype.init=function(){var e=window.navigator.userAgent,t=window.navigator.language,s=document.referrer,i=s?p(s).hostname:"",n=m(window.location.href),a=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(this.appVersion)?"wap":"web";this.utm=function(e,t,s,i){var n=new w(!1),a=new w(!1,"session"),o=e?"_tea_utm_cache_"+e:"_tea_utm_cache",r=e?"_$utm_from_url_"+e:"_$utm_from_url",l={},c=["tr_shareuser","tr_admaster","tr_param1","tr_param2","tr_param3","tr_param4","$utm_from_url"],d={ad_id:Number(t.ad_id)||void 0,campaign_id:Number(t.campaign_id)||void 0,creative_id:Number(t.creative_id)||void 0,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,utm_term:t.utm_term,utm_content:t.utm_content,tr_shareuser:t.tr_shareuser,tr_admaster:t.tr_admaster,tr_param1:t.tr_param1,tr_param2:t.tr_param2,tr_param3:t.tr_param3,tr_param4:t.tr_param4};try{var u=!1;for(var h in d)d[h]&&(-1!==c.indexOf(h)?(l.hasOwnProperty("tracer_data")||(l.tracer_data={}),l.tracer_data[h]=d[h]):l[h]=d[h],u=!0);if(u)a.setItem(r,"1"),n.setCookie(o,JSON.stringify(l),i,s);else{var _=n.getCookie(o,s);_&&(l=JSON.parse(_))}a.getItem(r)&&(l.hasOwnProperty("tracer_data")||(l.tracer_data={}),l.tracer_data.$utm_from_url=1)}catch(e){return d}return l}(this.appid,n,this.domain,this.cookie_expire);var o=this.browser(),r=this.os();return{browser:o.browser,browser_version:o.browser_version,platform:a,os_name:r.os_name,os_version:r.os_version,userAgent:e,screen_width:window.screen&&window.screen.width,screen_height:window.screen&&window.screen.height,device_model:this.getDeviceModel(r.os_name),language:t,referrer:s,referrer_host:i,utm:this.utm,latest_data:this.last(s,i)}},e.prototype.last=function(e,t){var s="",i="",n="",a=location.hostname,o=!1;if(e&&t&&a!==t){s=e,i=t,o=!0;var r=m(e);r.keyword&&(n=r.keyword)}return{$latest_referrer:s,$latest_referrer_host:i,$latest_search_keyword:n,isLast:o}},e.prototype.browser=function(){var e,t,s="",i=""+parseFloat(this.appVersion),n=this.userAgent,a=/\sSamantha(\w+)\/(.*?)(\s|$)/i.exec(n);return a?{browser:a[1],browser_version:a[2]}:(-1!==n.indexOf("Edge")||-1!==n.indexOf("Edg")?(s="Microsoft Edge",-1!==n.indexOf("Edge")?(e=n.indexOf("Edge"),i=n.substring(e+5)):(e=n.indexOf("Edg"),i=n.substring(e+4))):-1!==(e=n.indexOf("MSIE"))?(s="Microsoft Internet Explorer",i=n.substring(e+5)):-1!==(e=n.indexOf("MetaSr"))?(s="sougoubrowser",i=n.substring(e+7,e+10)):-1!==n.indexOf("MQQBrowser")||-1!==n.indexOf("QQBrowser")?(s="qqbrowser",-1!==n.indexOf("MQQBrowser")?(e=n.indexOf("MQQBrowser"),i=n.substring(e+11,e+15)):-1!==n.indexOf("QQBrowser")&&(e=n.indexOf("QQBrowser"),i=n.substring(e+10,e+25))):-1!==n.indexOf("Chrome")?-1!==(e=n.indexOf("MicroMessenger"))?(s="weixin",i=n.substring(e+15,e+20)):-1!==(e=n.indexOf("360"))?(s="360browser",i=n.substring(n.indexOf("Chrome")+7)):-1!==n.indexOf("baidubrowser")||-1!==n.indexOf("BIDUBrowser")?(-1!==n.indexOf("baidubrowser")?(e=n.indexOf("baidubrowser"),i=n.substring(e+13,e+16)):-1!==n.indexOf("BIDUBrowser")&&(e=n.indexOf("BIDUBrowser"),i=n.substring(e+12,e+15)),s="baidubrowser"):-1!==(e=n.indexOf("xiaomi"))?-1!==n.indexOf("openlanguagexiaomi")?(s="openlanguage xiaomi",i=n.substring(e+7,e+13)):(s="xiaomi",i=n.substring(e-7,e-1)):-1!==(e=n.indexOf("TTWebView"))?(s="TTWebView",i=n.substring(e+10,e+23)):(-1!==(e=n.indexOf("Chrome"))||-1!==(e=n.indexOf("Chrome")))&&(s="Chrome",i=n.substring(e+7)):-1!==n.indexOf("Safari")?-1!==(e=n.indexOf("QQ"))?(s="qqbrowser",i=n.substring(e+10,e+16)):-1!==(e=n.indexOf("Safari"))&&(s="Safari",i=n.substring(e+7),-1!==(e=n.indexOf("Version"))&&(i=n.substring(e+8))):-1!==(e=n.indexOf("Firefox"))?(s="Firefox",i=n.substring(e+8)):-1!==(e=n.indexOf("MicroMessenger"))?(s="weixin",i=n.substring(e+15,e+20)):-1!==(e=n.indexOf("QQ"))&&(s="qqbrowser",i=n.substring(e+3,e+8)),-1!==(t=i.indexOf(";"))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(" "))&&(i=i.substring(0,t)),-1!==(t=i.indexOf(")"))&&(i=i.substring(0,t)),{browser:s,browser_version:i})},e.prototype.os=function(){for(var e="",t="",s=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0|Windows NT 10.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"chromeOS",r:/CrOS/},{s:"Linux",r:/(Linux|X11)/},{s:"Sun OS",r:/SunOS/}],i=0;i<s.length;i++){var n=s[i];if(n.r.test(this.userAgent)){"Mac OS X"===(e=n.s)&&this.isNewIpad()&&(e="iOS");break}}var a,o,r=function(e,t){var s=e.exec(t);return s&&s[1]?s[1]:""},l=function(e,t){var s=RegExp("(?:^|[^A-Z0-9-_]|[^A-Z0-9-]_|sprd-)(?:"+e+")","i").exec(t);return s?s.slice(1)[0]:""};switch(/Windows/.test(e)&&(t=r(/Windows (.*)/,e),e="windows"),e){case"Mac OS X":t=l("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent),e="mac";break;case"Android":(o=r(/Android ([\.\_\d]+)/,a=this.userAgent))||(o=r(/Android\/([\.\_\d]+)/,a)),t=o,e="android";break;case"iOS":t=this.isNewIpad()?l("Mac[ +]OS[ +]X(?:[ /](?:Version )?(\\d+(?:[_\\.]\\d+)+))?",this.userAgent):(t=/OS (\d+)_(\d+)_?(\d+)?/.exec(this.appVersion))?t[1]+"."+t[2]+"."+(0|t[3]):"",e="ios";break;case"chromeOS":var c=this.userAgent.indexOf("x86_64");t=this.userAgent.substring(c+7,c+16)}return{os_name:e,os_version:t}},e.prototype.getDeviceModel=function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach((function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))}));else if("ios"===e||"mac"===e||"windows"===e)if(this.isNewIpad())t="iPad";else{var s=navigator.userAgent.replace("Mozilla/5.0 (",""),i=s.indexOf(";");t=s.slice(0,i)}}catch(e){return t.trim()}return t.trim()},e.prototype.isNewIpad=function(){return void 0!==this.userAgent&&"MacIntel"===navigator.platform&&"number"==typeof navigator.maxTouchPoints&&navigator.maxTouchPoints>1},e}(),R={cn:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az1gz22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz22z1mz19z1jz1mz1ez4az22z1mz19z21z1lz21z21z1bz1iz4az1az1mz1k"},T={cn:"1fz22z22z1nz21z4mz4bz4bz1kz1az21z4az28z1gz1hz1gz1cz18z1nz1gz4az1az1mz1k",sg:"1fz22z22z1nz21z4mz4bz4bz21z1ez18z1jz1gz49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k",va:"1fz22z22z1nz21z4mz4bz4bz1kz18z1jz1gz24z18z49z1kz1az21z4az19z27z22z1cz1mz24z1cz20z21z1cz18z4az1az1mz1k"},M="5.1.19",z=(g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z1cz1bz1gz22z1mz20z49z20z18z1lz1ez1cz20z21z4az1hz21"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1az1mz20z1cz4az1hz21"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz24z1gz21z23z18z1jz49z18z19z49z1jz1mz18z1bz1cz20z4az1hz21"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1fz1cz18z22z1kz18z1nz49z1az1mz20z1c"),g("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1bz18z22z18z4az24z1mz1jz1az1az1bz1lz4az1az1mz1kz4bz1mz19z1hz4bz1bz18z22z18z49z21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz22z1cz21z22z1cz20z49z1cz24z1cz1lz22z49z1gz1lz21z1nz1cz1az22z1mz20"),function(){function e(e,t){this.collector=e,this.config=t,this.eventNameWhiteList=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure"],this.paramsNameWhiteList=["$inactive","$inline","$target_uuid_list","$source_uuid","$is_spider","$source_id","$is_first_time","_staging_flag"],this.regStr=new RegExp("^[a-zA-Z0-9][a-z0-9A-Z_.-]{1,255}$")}return e.prototype.checkVerify=function(e){var t=this;if(!e||!e.length)return!1;var s=e[0];if(!s)return!1;var i=s.events,n=s.header;if(!i||!i.length)return!1;var a=!0;return i.forEach((function(e){if(!e)return a=!1,void(e.checkEvent="\u4e8b\u4ef6\u5f02\u5e38");t.checkEventName(e.event)||(a=!1,e.checkEvent="\u4e8b\u4ef6\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934"),t.checkEventParams(e.params)||(a=!1,e.checkParams="\u5c5e\u6027\u540d\u4e0d\u80fd\u4ee5 $ or __\u5f00\u5934")})),this.checkEventParams(n)||(a=!1),a},e.prototype.checkEventName=function(e){return!!e&&this.calculate(e,"event")},e.prototype.checkEventParams=function(e){var t=e;if("string"==typeof e&&(t=JSON.parse(t)),!Object.keys(t).length)return!0;for(var s in t)return!(!this.calculate(s,"params")||"string"==typeof t[s]&&t[s].length>1024);return!0},e.prototype.calculate=function(e,t){return-1!==("event"===t?this.eventNameWhiteList:this.paramsNameWhiteList).indexOf(e)||!new RegExp("^\\$").test(e)&&!new RegExp("^__").test(e)||!1},e}());(d=l||(l={})).Init="init",d.Config="config",d.Start="start",d.Ready="ready",d.UnReady="un-ready",d.TokenComplete="token-complete",d.TokenStorage="token-storage",d.TokenFetch="token-fetch",d.TokenError="token-error",d.ConfigUuid="config-uuid",d.ConfigWebId="config-webid",d.ConfigDomain="config-domain",d.CustomWebId="custom-webid",d.TokenChange="token-change",d.TokenReset="token-reset",d.ConfigTransform="config-transform",d.EnvTransform="env-transform",d.SessionReset="session-reset",d.SessionResetTime="session-reset-time",d.SetSessionId="set-session-id",d.Event="event",d.Events="events",d.EventNow="event-now",d.CleanEvents="clean-events",d.BeconEvent="becon-event",d.SubmitBefore="submit-before",d.SubmitScuess="submit-scuess",d.SubmitAfter="submit-after",d.SubmitError="submit-error",d.SubmitVerify="submit-verify",d.Stay="stay",d.ResetStay="reset-stay",d.StayReady="stay-ready",d.SetStay="set-stay",d.RouteChange="route-change",d.RouteReady="route-ready",d.Ab="ab",d.AbVar="ab-var",d.AbAllVars="ab-all-vars",d.AbConfig="ab-config",d.AbExternalVersion="ab-external-version",d.AbVersionChangeOn="ab-version-change-on",d.AbVersionChangeOff="ab-version-change-off",d.AbOpenLayer="ab-open-layer",d.AbCloseLayer="ab-close-layer",d.AbReady="ab-ready",d.AbComplete="ab-complete",d.AbTimeout="ab-timeout",d.Profile="profile",d.ProfileSet="profile-set",d.ProfileSetOnce="profile-set-once",d.ProfileUnset="profile-unset",d.ProfileIncrement="profile-increment",d.ProfileAppend="profile-append",d.ProfileClear="profile-clear",d.Autotrack="autotrack",d.AutotrackReady="autotrack-ready",d.CepReady="cep-ready",d.TracerReady="tracer-ready",d.sessionRecord="session-record",d.SessionRecordStart="session-record-start",d.SessionRecordPause="session-record-pause",d.SessionRecordEnd="session-record-end",d.SessionRecordReport="session-record-report",d.DestoryInstance="destory-instance",d.VisualCollectReady="visual-collect-ready",d.VisualApiReady="visual-api-ready",d.VisualApiUpdate="visual-api-update",function(e){e.DEBUGGER_MESSAGE="debugger-message",e.DEBUGGER_MESSAGE_SDK="debugger-message-sdk",e.DEBUGGER_MESSAGE_FETCH="debugger-message-fetch",e.DEBUGGER_MESSAGE_FETCH_RESULT="debugger-message-fetch-result",e.DEBUGGER_MESSAGE_EVENT="debugger-message-event",e.DEVTOOL_WEB_READY="devtool-web-ready"}(c||(c={}));var C,x=l,L=void 0,U=(new Date).getTimezoneOffset(),B=parseInt(""+-U/60,10),I=60*U,O=function(){function e(e,t){this.is_first_time=!0,this.configPersist=!1,this.initConfig=t,this.collect=e;var s=new E(t.app_id,t.cookie_domain||"",t.cookie_expire||7776e6).init();this.eventCheck=new z(e,t);var i="__tea_cache_first_"+t.app_id;this.configKey="__tea_cache_config_"+t.app_id,this.sessionStorage=new w(!1,"session"),this.localStorage=new w(!1,"local"),t.configPersist&&(this.configPersist=!0,this.storage=1===t.configPersist?this.sessionStorage:this.localStorage);var n=this.localStorage.getItem(i);n&&1==n?this.is_first_time=!1:(this.is_first_time=!0,this.localStorage.setItem(i,"1")),this.envInfo={user:{user_unique_id:L,user_type:L,user_id:L,user_is_auth:L,user_is_login:L,device_id:L,web_id:L,ip_addr_id:L,user_unique_id_type:L},header:{app_id:L,app_name:L,app_install_id:L,install_id:L,app_package:L,app_channel:L,app_version:L,ab_version:L,os_name:s.os_name,os_version:s.os_version,device_model:s.device_model,ab_client:L,traffic_type:L,client_ip:L,device_brand:L,os_api:L,access:L,language:s.language,region:L,app_language:L,app_region:L,creative_id:s.utm.creative_id,ad_id:s.utm.ad_id,campaign_id:s.utm.campaign_id,log_type:L,rnd:L,platform:s.platform,sdk_version:M,sdk_lib:"js",province:L,city:L,timezone:B,tz_offset:I,tz_name:L,sim_region:L,carrier:L,resolution:s.screen_width+"x"+s.screen_height,browser:s.browser,browser_version:s.browser_version,referrer:s.referrer,referrer_host:s.referrer_host,width:s.screen_width,height:s.screen_height,screen_width:s.screen_width,screen_height:s.screen_height,utm_term:s.utm.utm_term,utm_content:s.utm.utm_content,utm_source:s.utm.utm_source,utm_medium:s.utm.utm_medium,utm_campaign:s.utm.utm_campaign,tracer_data:JSON.stringify(s.utm.tracer_data),custom:{},wechat_unionid:L,wechat_openid:L}},this.ab_version="",this.evtParams={},this.reportErrorCallback=function(){},this.isLast=!1,this.setCustom(s),this.initDomain(),this.initABData()}return e.prototype.initDomain=function(){var e=this.initConfig.channel_domain;if(e)this.domain=e;else{var t=this.initConfig.channel;this.domain=g(T[t])}},e.prototype.setDomain=function(e){this.domain=e},e.prototype.getDomain=function(){return this.domain},e.prototype.initABData=function(){var e="__tea_sdk_ab_version_"+this.initConfig.app_id,t=null;if(this.initConfig.ab_cross){var s=this.localStorage.getCookie(e,this.initConfig.ab_cookie_domain);t=s?JSON.parse(s):null}else t=this.localStorage.getItem(e);this.setAbCache(t)},e.prototype.setAbCache=function(e){this.ab_cache=e},e.prototype.getAbCache=function(){return this.ab_cache},e.prototype.setAbVersion=function(e){this.ab_version=e},e.prototype.getAbVersion=function(){return this.ab_version},e.prototype.clearAbCache=function(){this.ab_version="",this.ab_cache={}},e.prototype.getUrl=function(e){var t="";switch(e){case"event":t="/list";break;case"webid":t="/webid";break;case"tobid":t="/tobid"}var s="";return this.initConfig.caller&&(s="?sdk_version="+M+"&sdk_name=web&app_id="+this.initConfig.app_id+"&caller="+this.initConfig.caller),""+this.getDomain()+t+s},e.prototype.setCustom=function(e){if(e&&e.latest_data&&e.latest_data.isLast)for(var t in delete e.latest_data.isLast,this.isLast=!0,e.latest_data)this.envInfo.header.custom[t]=e.latest_data[t]},e.prototype.set=function(e){var t=this;Object.keys(e).forEach((function(s){void 0!==e[s]&&null!==e[s]||t.delete(s);try{t.eventCheck.calculate(s,"config")}catch(d){}if("traffic_type"===s&&t.isLast&&(t.envInfo.header.custom.$latest_traffic_source_type=e[s]),"evtParams"===s)t.evtParams=i(i({},t.evtParams||{}),e.evtParams||{});else if("_staging_flag"===s)t.evtParams=i(i({},t.evtParams||{}),{_staging_flag:e._staging_flag});else if("reportErrorCallback"===s&&"function"==typeof e[s])t.reportErrorCallback=e[s];else{var n="",a="";if(s.indexOf(".")>-1){var o=s.split(".");n=o[0],a=o[1]}n?"user"===n||"header"===n?t.envInfo[n][a]=e[s]:t.envInfo.header.custom[a]=e[s]:Object.hasOwnProperty.call(t.envInfo.user,s)?["user_type","ip_addr_id"].indexOf(s)>-1?t.envInfo.user[s]=e[s]?Number(e[s]):e[s]:["user_id","web_id","user_unique_id","user_unique_id_type"].indexOf(s)>-1?t.envInfo.user[s]=e[s]?String(e[s]):e[s]:["user_is_auth","user_is_login"].indexOf(s)>-1?t.envInfo.user[s]=Boolean(e[s]):"device_id"===s&&(t.envInfo.user[s]=e[s]):Object.hasOwnProperty.call(t.envInfo.header,s)?t.envInfo.header[s]=e[s]:t.envInfo.header.custom[s]=e[s]}}))},e.prototype.get=function(e){try{return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this[e]:Object.hasOwnProperty.call(this.envInfo.user,e)?this.envInfo.user[e]:Object.hasOwnProperty.call(this.envInfo.header,e)?this.envInfo.header[e]:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.setStore=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};if(t&&Object.keys(e).length){var s=Object.assign(e,t);this.storage.setItem(this.configKey,s)}}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.getStore=function(){try{if(!this.configPersist)return null;var e=this.storage.getItem(this.configKey)||{};return e&&Object.keys(e).length?e:null}catch(e){return this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message}),null}},e.prototype.delete=function(e){try{if(!this.configPersist)return;var t=this.storage.getItem(this.configKey)||{};t&&Object.hasOwnProperty.call(t,e)&&(delete t[e],this.storage.setItem(this.configKey,t))}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}(),P=function(){function e(e,t){this.isLog=t||!1,this.name=e||""}return e.prototype.info=function(e){this.isLog},e.prototype.warn=function(e){this.isLog},e.prototype.error=function(e){this.isLog},e.prototype.throw=function(e){throw this.error(this.name),new Error(e)},e}(),q=function(){function e(){this.spiderBot=["Baiduspider","googlebot","360Spider","haosouspider","YoudaoBot","Sogou News Spider","Yisouspider","Googlebot","Headless","Applebot","Bingbot","PetalBot"]}return e.prototype.checkSpider=function(e){if(!e.enable_spider)return!1;var t=window.navigator.userAgent;if(!t)return!0;var s=!1;return this.spiderBot.forEach((function(e){-1!==t.indexOf(e)&&(s=!0)})),s},e}(),G=function(){function e(e,t){this.collect=e,this.native=t}var t=e.prototype;return t.bridgeInject=function(){try{return!!this.native&&!!AppLogBridge}catch(e){return!1}},t.bridgeReady=function(){var e=this;return new Promise((function(t,s){try{e.bridgeInject()?AppLogBridge.hasStarted((function(e){e?t(!0):s(!1)})):s(!1)}catch(e){s(!1)}}))},t.setNativeAppId=function(e){try{AppLogBridge.setNativeAppId(JSON.stringify(e))}catch(e){}},t.setConfig=function(e){var t=this;try{Object.keys(e).forEach((function(s){"user_unique_id"===s?t.setUserUniqueId(e[s]):e[s]?t.addHeaderInfo(s,e[s]):t.removeHeaderInfo(s)}))}catch(e){}},t.setUserUniqueId=function(e){try{AppLogBridge.setUserUniqueId(e)}catch(e){}},t.addHeaderInfo=function(e,t){try{AppLogBridge.addHeaderInfo(e,t)}catch(e){}},t.setHeaderInfo=function(e){try{AppLogBridge.setHeaderInfo(JSON.stringify(e))}catch(e){}},t.removeHeaderInfo=function(e){try{AppLogBridge.removeHeaderInfo(e)}catch(e){}},t.reportPv=function(e){this.onEventV3("predefine_pageview",e)},t.onEventV3=function(e,t){try{AppLogBridge.onEventV3(e,t),this.collect.emit(DebuggerMesssge.DEBUGGER_MESSAGE,{type:DebuggerMesssge.DEBUGGER_MESSAGE_EVENT,info:"bridge\u57cb\u70b9\u4e0a\u62a5",time:Date.now(),data:[{events:[{event:e,params:t}]}],code:200,status:"success"})}catch(e){}},t.profileSet=function(e){try{AppLogBridge.profileSet(e)}catch(e){}},t.profileSetOnce=function(e){try{AppLogBridge.profileSetOnce(e)}catch(e){}},t.profileIncrement=function(e){try{AppLogBridge.profileIncrement(e)}catch(e){}},t.profileUnset=function(e){try{AppLogBridge.profileUnset(e)}catch(e){}},t.profileAppend=function(e){try{AppLogBridge.profileAppend(e)}catch(e){}},e}(),D=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},N=function(){function e(){}return e.prototype.apply=function(e,t){var s=this;this.collect=e,this.storage=new w(!1,"session"),this.sessionKey="__tea_session_id_"+t.app_id,this.expireTime=t.expireTime||18e5,this.disableSession=t.disable_session,this.disableSessionTimeCheck=t.disable_session_check,this.disableSession||(this.setSessionId(),this.collect.on(x.SessionReset,(function(e){s.resetSessionId(e)})),this.collect.on(x.SessionResetTime,(function(){s.updateSessionIdTime()})))},e.prototype.updateSessionIdTime=function(){var e=this.storage.getItem(this.sessionKey);if(e&&e.sessionId){var t=e.timestamp;Date.now()-t>this.expireTime?e={sessionId:D(),timestamp:Date.now()}:e.timestamp=Date.now(),this.storage.setItem(this.sessionKey,e),this.resetExpTime()}},e.prototype.setSessionId=function(){var e=this,t=this.storage.getItem(this.sessionKey);t&&t.sessionId?t.timestamp=Date.now():t={sessionId:D(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,t),this.disableSessionTimeCheck||(this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.getSessionId=function(){var e=this.storage.getItem(this.sessionKey);return this.disableSession?"":e&&e.sessionId?e.sessionId:""},e.prototype.resetExpTime=function(){var e=this;this.sessionExp&&(clearInterval(this.sessionExp),this.sessionExp=setInterval((function(){e.checkEXp()}),this.expireTime))},e.prototype.resetSessionId=function(e){var t={sessionId:e||D(),timestamp:Date.now()};this.storage.setItem(this.sessionKey,t)},e.prototype.checkEXp=function(){var e=this.storage.getItem(this.sessionKey);e&&e.sessionId&&Date.now()-e.timestamp+30>=this.expireTime&&(e={sessionId:D(),timestamp:Date.now()},this.storage.setItem(this.sessionKey,e))},e}(),j=function(){function e(){this.eventLimit=50,this.enable_ttwebid=!1,this.eventCache=[],this.beconEventCache=[]}return e.prototype.apply=function(e,t){var s=this;this.collect=e,this.config=t,this.configManager=e.configManager,this.eventCheck=new z(e,t),this.cacheStorgae=new w(!0),this.localStorage=new w(!1),this.maxReport=t.max_report||10,this.reportTime=t.reportTime||t.report_time||30,this.timeout=t.timeout||1e5,this.enable_ttwebid=t.enable_ttwebid,this.reportUrl=t.report_url||this.configManager.getUrl("event"),this.eventKey="__tea_cache_events_"+this.configManager.get("app_id"),this.beconKey="__tea_cache_events_becon_"+this.configManager.get("app_id"),this.abKey="__tea_sdk_ab_version_"+this.configManager.get("app_id"),this.refer_key="__tea_cache_refer_"+this.configManager.get("app_id"),this.pageId=D(),this.collect.on(x.Ready,(function(){s.reportAll(!1)})),this.collect.on(x.ConfigDomain,(function(){s.reportUrl=s.configManager.getUrl("event")})),this.collect.on(x.Event,(function(e){s.event(e)})),this.collect.on(x.BeconEvent,(function(e){s.beconEvent(e)})),this.collect.on(x.CleanEvents,(function(){s.reportAll(!1)}));var i=this.linster();this.collect.on(x.DestoryInstance,(function(){i&&i()}))},e.prototype.linster=function(){var e=this,t=function(){e.reportAll(!0)};try{window.addEventListener("unload",t,!1)}catch(e){}!function(e){navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?window.addEventListener("pagehide",e,!1):window.addEventListener("beforeunload",e,!1)}(t);var s=function(){"hidden"===document.visibilityState&&e.reportAll(!0)};return document.addEventListener("visibilitychange",s,!1),function(){window.removeEventListener("unload",t),window.removeEventListener("pagehide",t,!1),window.removeEventListener("beforeunload",t,!1),document.removeEventListener("visibilitychange",s,!1)}},e.prototype.reportAll=function(e){this.report(e),this.reportBecon()},e.prototype.event=function(e){var t=this;try{if(this.collect.destroy)return;if(this.collect.sdkStop)return;var s=a(e,this.cacheStorgae.getItem(this.eventKey)||[]);if(this.cacheStorgae.setItem(this.eventKey,s),this.reportTimeout&&clearTimeout(this.reportTimeout),s.length>=this.maxReport)this.report(!1);else{var i=this.reportTime;this.reportTimeout=setTimeout((function(){t.report(!1),t.reportTimeout=null}),i)}}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e){if(!this.collect.destroy&&!this.collect.sdkStop){var t=a(e,this.cacheStorgae.getItem(this.beconKey)||[]);this.cacheStorgae.setItem(this.beconKey,t),this.collect.tokenManager.getReady()&&this.collect.sdkReady&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(t)),!0))}},e.prototype.reportBecon=function(){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var e=this.cacheStorgae.getItem(this.beconKey)||[];e&&e.length&&(this.cacheStorgae.removeItem(this.beconKey),this.send(this.split(this.merge(e)),!0))}},e.prototype.report=function(e){if(!this.collect.destroy&&!this.collect.sdkStop&&this.collect.tokenManager.getReady()&&this.collect.sdkReady){var t=this.cacheStorgae.getItem(this.eventKey)||[];t.length&&(this.cacheStorgae.removeItem(this.eventKey),this.sliceEvent(t,e))}},e.prototype.sliceEvent=function(e,t){if(e.length>this.eventLimit)for(var s=0;s<e.length;s+=this.eventLimit){var i;i=e.slice(s,s+this.eventLimit);var n=this.split(this.merge(i));this.send(n,t)}else n=this.split(this.merge(e)),this.send(n,t)},e.prototype.handleRefer=function(){var e="";try{if(this.config.spa||this.config.autotrack){var t=this.localStorage.getItem(this.refer_key)||{};e=t.routeChange?t.refer_key:this.configManager.get("referrer")}else e=this.configManager.get("referrer")}catch(t){e=document.referrer}return e},e.prototype.merge=function(e,t){var s=this,n=this.configManager.get(),a=n.header,o=n.user;this.config.enable_pageid&&(a.custom.page_id=this.pageId),a.referrer=this.handleRefer(),a.custom=JSON.stringify(a.custom);var r=this.configManager.get("evtParams"),l=this.configManager.get("user_unique_id_type"),u=e.map((function(e){try{Object.keys(r).length&&!t&&(e.params=i(i({},r),e.params)),l&&(e.params.$user_unique_id_type=l);var n=s.configManager.getAbCache(),a=o[s.config.ab_user_mode]||o.user_unique_id;return n&&n.uuid&&n.uuid===a&&s.configManager.getAbVersion()&&(e.ab_sdk_version=s.configManager.getAbVersion()),e.session_id=s.collect.sessionManager.getSessionId(),e.params=JSON.stringify(e.params),e}catch(d){return s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:d.message}),e}})),h=JSON.parse(JSON.stringify({events:u,user:o,header:a}));h.local_time=Math.floor(Date.now()/1e3),h.user_unique_type=this.config.enable_ttwebid?this.config.user_unique_type:void 0,h.verbose=1;var _=[];return _.push(h),_},e.prototype.split=function(e){return e.map((function(e){var t=[];return t.push(e),t}))},e.prototype.send=function(e,t){var s=this;e.length&&(this.config.disable_track_event||e.forEach((function(e){try{var i=JSON.parse(JSON.stringify(e));s.config.filter&&(i=s.config.filter(i)),s.collect.eventFilter&&i&&(i=s.collect.eventFilter(i));var n=i||e,a=JSON.parse(JSON.stringify(n));if(s.eventCheck.checkVerify(a),!n.length)return;var o=!0;if(n.forEach((function(e){e.events.length||(o=!1)})),!o)return;s.collect.emit(x.SubmitBefore,n),s.collect.requestManager.useRequest({url:s.reportUrl,data:n,success:function(e,t){e&&0!==e.e?(s.collect.emit(x.SubmitError,{type:"f_data",eventData:t,errorCode:e.e,response:e}),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u5931\u8d25",time:Date.now(),data:a,code:e.e,failType:"\u6570\u636e\u5f02\u5e38\u5931\u8d25",status:"fail"})):(s.collect.emit(x.SubmitScuess,{eventData:t,res:e}),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:a,code:200,status:"success"}))},fail:function(e,t){s.configManager.get("reportErrorCallback")(e,t),s.collect.emit(x.SubmitError,{type:"f_net",eventData:e,errorCode:t}),s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u7f51\u7edc\u5f02\u5e38",time:Date.now(),data:a,code:t,failType:"\u7f51\u7edc\u5f02\u5e38\u5931\u8d25",status:"fail"})},timeout:s.timeout,useBeacon:t,withCredentials:s.enable_ttwebid}),s.collect.emit(x.SubmitAfter,n)}catch(e){s.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}})))},e}(),F=function(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e)}().replace(/-/g,"").slice(0,19)},V=function(){function e(){this.cacheToken={},this.enableCookie=!1,this.enable_ttwebid=!1,this.enableCustomWebid=!1}return e.prototype.apply=function(e,t){var s=this;this.collect=e,this.config=t,this.configManager=this.collect.configManager,this.storage=new w(!1),this.tokenKey="__tea_cache_tokens_"+t.app_id,this.enable_ttwebid=t.enable_ttwebid,this.enableCustomWebid=t.enable_custom_webid,this.collect.on(x.ConfigUuid,(function(e){s.setUuid(e)})),this.collect.on(x.ConfigWebId,(function(e){s.setWebId(e)})),this.enableCookie=t.cross_subdomain,this.expiresTime=t.cookie_expire||6048e5,this.cookieDomain=t.cookie_domain||"",this.checkStorage()},e.prototype.checkStorage=function(){var e=this;if(this.enableCookie){var t=this.storage.getCookie(this.tokenKey,this.cookieDomain);this.cacheToken=t&&"string"==typeof t?JSON.parse(t):{}}else this.cacheToken=this.storage.getItem(this.tokenKey)||{};this.tokenType=this.cacheToken&&this.cacheToken._type_?this.cacheToken._type_:"default","custom"!==this.tokenType||this.enableCustomWebid?this.enableCustomWebid?this.collect.on(x.CustomWebId,(function(){e.tokenReady=!0,e.collect.emit(x.TokenComplete)})):this.checkEnv()||(this.enable_ttwebid?this.completeTtWid(this.cacheToken):this.check()):this.remoteWebid()},e.prototype.check=function(){this.cacheToken&&this.cacheToken.web_id?this.complete(this.cacheToken):this.config.disable_webid?this.complete({web_id:F(),user_unique_id:this.configManager.get("user_unique_id")||F()}):this.remoteWebid()},e.prototype.checkEnv=function(){var e=window.navigator.userAgent;if(-1!==e.indexOf("miniProgram")||-1!==e.indexOf("MiniProgram")){var t=m(window.location.href);return!(!t||!t.Web_ID||(this.complete({web_id:""+t.Web_ID,user_unique_id:this.configManager.get("user_unique_id")||""+t.Web_ID}),0))}return!1},e.prototype.remoteWebid=function(){var e=this,t=this.configManager.getUrl("webid"),s={app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:window.navigator.userAgent,referer:document.referrer,user_unique_id:""};this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77WEBID\u8bf7\u6c42",logType:"fetch",level:"info",time:Date.now(),data:s}),this.collect.requestManager.useRequest({url:t,data:s,success:function(t){var s;if(t&&0===t.e)s=t.web_id,e.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u6210\u529f",logType:"fetch",level:"info",time:Date.now(),data:t});else{var i=F();s=i,e.collect.configManager.set({localWebId:i}),e.collect.emit(x.TokenError),e.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u8fd4\u56de\u503c\u5f02\u5e38",logType:"fetch",level:"warn",time:Date.now(),data:t}),e.collect.logger.warn("appid: "+e.config.app_id+" get webid error, use local webid~")}e.complete({web_id:e.configManager.get("web_id")||s,user_unique_id:e.configManager.get("user_unique_id")||s})},fail:function(){var t=F();e.complete({web_id:e.configManager.get("web_id")||t,user_unique_id:e.configManager.get("user_unique_id")||t}),e.collect.configManager.set({localWebId:t}),e.collect.emit(x.TokenError),e.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"WEBID\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",logType:"fetch",level:"error",time:Date.now(),data:null}),e.collect.logger.warn("appid: "+e.config.app_id+", get webid error, use local webid~")},timeout:3e5})},e.prototype.complete=function(e){var t=e.web_id,s=e.user_unique_id;e.timestamp=Date.now(),this.collect.configManager.set({web_id:t,user_unique_id:s}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(x.TokenComplete)},e.prototype.completeTtWid=function(e){var t=e.user_unique_id||"",s=this.configManager.get("user_unique_id");(s||t)&&this.configManager.set({user_unique_id:s||t}),this.setStorage(e),this.tokenReady=!0,this.collect.emit(x.TokenComplete)},e.prototype.setUuid=function(e){if(e&&-1===["null","undefined","Null","None"].indexOf(e)){var t=String(e),s=this.configManager.get("user_unique_id"),i=this.cacheToken&&this.cacheToken.user_unique_id;if(t===s&&t===i)return;this.configManager.set({user_unique_id:t}),this.cacheToken||(this.cacheToken={}),this.cacheToken.user_unique_id=t,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken),this.collect.emit(x.TokenChange,"uuid"),this.collect.emit(x.SessionReset)}else this.clearUuid()},e.prototype.clearUuid=function(){this.config.enable_ttwebid||this.configManager.get("web_id")&&this.configManager.get("user_unique_id")!==this.configManager.get("web_id")&&(this.configManager.set({user_unique_id:this.configManager.get("web_id")}),this.cacheToken&&this.cacheToken.web_id&&(this.cacheToken.user_unique_id=this.cacheToken.web_id,this.cacheToken.timestamp=Date.now(),this.setStorage(this.cacheToken)),this.collect.emit(x.TokenReset,"uuid"))},e.prototype.setWebId=function(e){if(e&&!this.config.enable_ttwebid){this.cacheToken&&this.cacheToken.web_id?this.cacheToken.web_id!==e&&(this.cacheToken.user_unique_id=this.cacheToken.web_id===this.cacheToken.user_unique_id?e:this.cacheToken.user_unique_id,this.cacheToken.web_id=e):(this.cacheToken={},this.cacheToken.web_id=e,this.cacheToken.user_unique_id=e),this.cacheToken.timestamp=Date.now();var t=this.configManager.get("web_id"),s=this.configManager.get("user_unique_id");s&&s!==t||(this.configManager.set({user_unique_id:e}),this.collect.emit(x.TokenChange,"uuid")),t!==e&&(this.configManager.set({web_id:e}),this.collect.emit(x.TokenChange,"webid")),this.setStorage(this.cacheToken)}},e.prototype.setStorage=function(e){e._type_=this.enableCustomWebid?"custom":"default",delete e["diss".split("").reverse().join("")],this.enableCookie||this.enable_ttwebid?(this.storage.setCookie(this.tokenKey,e,this.expiresTime,this.cookieDomain),this.enable_ttwebid&&(delete e.web_id,this.storage.setItem(this.tokenKey,e))):this.storage.setItem(this.tokenKey,e),this.cacheToken=e},e.prototype.getReady=function(){return this.tokenReady},e.prototype.getTobId=function(){var e=this;return new Promise((function(t){e.collect.requestManager.useRequest({url:e.configManager.getUrl("tobid"),data:{app_id:e.config.app_id,user_unique_id:e.configManager.get("user_unique_id"),web_id:e.configManager.get("web_id"),user_unique_id_type:e.configManager.get("user_unique_id_type")},success:function(e){e&&0===e.e?t(e.tobid):t("")},fail:function(){t("")},time:3e4,withCredentials:e.enable_ttwebid})}))},e}(),H=function(){function e(e,t){this.collector=e,this.config=t,this.requestType=t.request_type||"xhr",this.supportBeacon=!(!window.navigator||!window.navigator.sendBeacon),this.errorCode={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001,TIMEOUT:5005},this.customHeader=t.custom_request_header||{}}return e.prototype.useFetch=function(e){var t=e.url,s=e.data,i=e.method,n=e.success,a=e.fail,o={"Content-Type":"application/json; charset=utf-8"};if(Object.keys(this.customHeader).length)for(var r in this.customHeader)o[r]=this.customHeader[r];window.fetch?fetch(t,{method:i||"POST",headers:o,body:JSON.stringify(s)}).then((function(e){return e.json()})).then((function(e){n&&n(e)})).catch((function(e){a&&a(s,e)})):(this.requestType="xhr",this.useRequest({url:t,data:s,method:i,success:n,fail:a}))},e.prototype.useBeacon=function(e){var t=e.url,s=e.data,i=e.success,n=e.fail;window.navigator.sendBeacon(t,JSON.stringify(s))?i&&i():n&&n(s,this.errorCode.BEACON_FALSE)},e.prototype.useRequest=function(e){var t=this,s=e.url,i=e.data,n=e.method,a=e.success,o=e.fail,r=e.timeout,l=e.useBeacon,c=e.withCredentials,d=e.app_key,u=e.forceXhr;if(l&&this.supportBeacon)this.useBeacon({url:s,data:i,method:n,success:a,fail:o});else if("fetch"!==this.requestType||u)try{var h=new XMLHttpRequest,_=n||"POST";if(h.open(_,""+s,!0),h.setRequestHeader("Content-Type","application/json; charset=utf-8"),d&&h.setRequestHeader("X-MCS-AppKey",""+d),Object.keys(this.customHeader).length)for(var g in this.customHeader)h.setRequestHeader(g,this.customHeader[g]);c&&(h.withCredentials=!0),r&&(h.timeout=r,h.ontimeout=function(){o&&o(i,t.errorCode.TIMEOUT)}),h.onload=function(){if(a){var e=null;if(h.responseText){try{e=JSON.parse(h.responseText)}catch(t){e={}}a(e,i)}}},h.onerror=function(){h.abort(),o&&o(i,t.errorCode.XHR_ON)},h.send(JSON.stringify(i))}catch(e){}else this.useFetch({url:s,data:i,method:n,success:a,fail:o})},e}(),K=function(){function e(e,t){if(this.devToolReady=!1,this.devToolOrigin="*",this.sendAlready=!1,this.eventVerifyReady=!1,t.enable_debug){var s=e.adapters.storage;this.collect=e,this.config=t,this.app_id=t.app_id,this.cacheStorgae=new s(!1,"session"),this.eventVerifyInfo=[],this.sdk_type=M.includes("tob")?"tob":"inner",this.filterEvent=["__bav_page","__bav_beat","__bav_page_statistics","__bav_click","__bav_page_exposure","bav2b_page","bav2b_beat","bav2b_page_statistics","bav2b_click","bav2b_page_exposure","_be_active","predefine_pageview","__profile_set","__profile_set_once","__profile_increment","__profile_unset","__profile_append","predefine_page_alive","predefine_page_close","abtest_exposure"],this.load()}}return e.prototype.loadScript=function(e){try{var t=document.createElement("script");t.src=e,t.onerror=function(){},t.onload=function(){},document.getElementsByTagName("body")[0].appendChild(t)}catch(e){}},e.prototype.parseUrl=function(){var e={};try{var t=window.location.href.split("?")[1].split("&");t.length&&t.forEach((function(t){var s=t.split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}))}catch(e){}return e},e.prototype.load=function(){return e=this,s=function(){var e,t;return function(e,t){var s,i,n,a,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(s)throw new TypeError("Generator is already executing.");for(;o;)try{if(s=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,i=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(n=(n=o.trys).length>0&&n[n.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){o.label=a[1];break}if(6===a[0]&&o.label<n[1]){o.label=n[1],n=a;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(a);break}n[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(e){a=[6,e],i=0}finally{s=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}}(this,(function(s){switch(s.label){case 0:if(s.trys.push([0,2,,3]),(e=this.parseUrl()).open_devtool_web&&e.app_id){if(parseInt(e.app_id)!==this.app_id)return[2]}else if(!this.getStorage())return[2];return this.loadBaseInfo(),this.loadHook(),this.setStorage(),this.addLintener(),this.loadDebuggerModule(),this.loadDevTool(),[4,this.fetchEventInfo()];case 1:return t=s.sent(),this.sendData("devtool:web:verify",t.verifyStatus),this.eventVerifyInfo=t.data,[3,3];case 2:return s.sent(),[3,3];case 3:return[2]}}))},new((t=void 0)||(t=Promise))((function(i,n){function a(e){try{r(s.next(e))}catch(e){n(e)}}function o(e){try{r(s.throw(e))}catch(e){n(e)}}function r(e){e.done?i(e.value):new t((function(t){t(e.value)})).then(a,o)}r((s=s.apply(e,[])).next())}));var e,t,s},e.prototype.getStorage=function(){var e=this.cacheStorgae.getItem("__applog_devtool_web");return e&&parseInt(e)===this.app_id},e.prototype.setStorage=function(){this.cacheStorgae.setItem("__applog_devtool_web",this.app_id)},e.prototype.loadDevTool=function(){this.loadScript(g("1fz22z22z1nz21z4mz4bz4bz1jz1dz4fz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4b")+"debug-web.0.0.2.js")},e.prototype.loadBaseInfo=function(){var e=this;this.info=[{title:"\u57fa\u672c\u4fe1\u606f",type:1,infoName:{app_id:this.config.app_id,channel:this.config.channel,\u4e0a\u62a5\u57df\u540d:this.collect.configManager.getDomain(),SDK\u7248\u672c:M,SDK\u5f15\u5165\u65b9\u5f0f:"npm"}},{title:"\u7528\u6237\u4fe1\u606f",type:2,infoName:{uuid:this.collect.configManager.get("user").user_unique_id||"",web_id:this.collect.configManager.get("user").web_id||"",ssid:"\u70b9\u51fb\u83b7\u53d6SSID"}},{title:"\u516c\u5171\u53c2\u6570\u4fe1\u606f",type:2,infoName:{\u6d4f\u89c8\u5668:this.collect.configManager.get("browser"),\u6d4f\u89c8\u5668\u7248\u672c:this.collect.configManager.get("browser_version"),\u5e73\u53f0:this.collect.configManager.get("platform"),\u8bbe\u5907\u578b\u53f7:this.collect.configManager.get("device_model"),\u64cd\u4f5c\u7cfb\u7edf:this.collect.configManager.get("os_name"),\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c:this.collect.configManager.get("os_version"),\u5c4f\u5e55\u5206\u8fa8\u7387:this.collect.configManager.get("resolution"),\u6765\u6e90:this.collect.configManager.get("referrer"),\u81ea\u5b9a\u4e49\u4fe1\u606f:""}},{title:"\u914d\u7f6e\u4fe1\u606f",type:3,infoName:{\u5168\u57cb\u70b9:!!this.config.autotrack,\u505c\u7559\u65f6\u957f:!!this.config.enable_stay_duration}},{title:"A/B\u914d\u7f6e\u4fe1\u606f",type:4,infoName:{"A/B\u5b9e\u9a8c":!!this.config.enable_ab_test}},{title:"\u5ba2\u6237\u7aef\u4fe1\u606f",type:3,infoName:{\u6253\u901a\u5f00\u5173:!!this.config.Native}}],this.log=[],this.event=[],this.collect.on(x.Ready,(function(){e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id,e.info[2].infoName["\u81ea\u5b9a\u4e49\u4fe1\u606f"]=JSON.stringify(e.collect.configManager.get("custom")),e.config.enable_ab_test&&(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["A/B\u57df\u540d"]=e.config.ab_channel_domain||g(R[e.config.channel]),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()),e.config.Native&&(e.info[5].infoName["\u662f\u5426\u6253\u901a"]=!!e.collect.bridgeReport)}))},e.prototype.loadHook=function(){var e=this;this.collect.stop(),this.collect.on(c.DEBUGGER_MESSAGE,(function(t){switch(t.type){case c.DEBUGGER_MESSAGE_SDK:var s={time:t.time,type:t.logType||"sdk",level:t.level,name:t.info,show:!0,levelShow:!0,needDesc:!!t.data};return t.data&&(s.desc={content:JSON.stringify(t.data)}),e.updateLog(s),t.secType&&"AB"===t.secType?(e.info[4].infoName["\u5df2\u66dd\u5149VID"]=e.collect.configManager.getAbVersion(),e.info[4].infoName["\u5168\u90e8\u914d\u7f6e"]=e.collect.configManager.getAbData()):"USER"===t.secType&&(e.info[1].infoName.uuid=e.collect.configManager.get("user").user_unique_id,e.info[1].infoName.web_id=e.collect.configManager.get("user").web_id),void e.updateInfo();case c.DEBUGGER_MESSAGE_EVENT:if(t.data&&t.data.length){var i=t.data[0],n=i.events,a=i.header;if(a.custom=JSON.parse(a.custom),!n.length)return;n.forEach((function(s){s.checkShow=!0,s.searchShow=!0,s.type=-1!==e.filterEvent.indexOf(s.event)?"sdk":"cus",s.type=e.collect.bridgeReport?"bridge":s.type,s.params=JSON.parse(s.params),"fail"===t.status&&(s.info={message:"code: "+t.code+"\uff0c msg: "+t.failType},s.failType=t.failType);var i=!1,n=!1,a=[];e.eventVerifyInfo&&e.eventVerifyInfo.length&&(e.eventVerifyInfo.forEach((function(e){e.eventStatus=!1})),e.eventVerifyInfo.forEach((function(t){s.event===t.name&&(n=!0,i=!0,s.verifyStatus=t.status,Object.keys(s.params).forEach((function(i){if("event_index"!==i){var o={};o.paramsKey=i,o.paramsKeyValue=s.params[""+i],o.paramsStatus=!1,o.paramsStatusInfo="\u5c5e\u6027\u672a\u5f55\u5165",t.params.forEach((function(t){i===t.name&&(t.checked=!0,typeof s.params[""+i]!==e.formatParamsType(t.value_type)?o.paramsStatusInfo="\u5c5e\u6027\u7c7b\u578b\u9519\u8bef\uff0c\u5e94\u4e3a"+e.formatParamsType(t.value_type):(o.paramsStatus=!0,o.paramsStatusInfo=""))})),a.push(o),o.paramsStatusInfo&&(n=!1)}})),t.params.forEach((function(e){e.checked||(n=!1,a.push({paramsKey:e.name,paramsStatus:!1,paramsStatusInfo:"\u7f3a\u5c11\u5c5e\u6027"+e.name}))})))}))),s.reportStatus="success"===t.status,s.paramsInfo=a,s.eventStatus=n&&"success"===t.status,s.eventRecord=i})),e.updateEvent(i)}return}}))},e.prototype.formatParamsType=function(e){switch(e){case 0:return"string";case 1:case 2:return"number";case 3:return"boolean"}},e.prototype.fetchEventInfo=function(){var e=this;try{return new Promise((function(t){var s=g("1fz22z22z1nz21z4mz4bz4bz18z1nz1nz1jz1mz1ez1fz1mz1kz1cz4az19z27z22z1cz1bz18z1lz1az1cz4az1lz1cz22z4bz18z1nz1nz1jz1mz1ez1bz1cz24z22z1mz1mz1jz21z4bz1mz1nz1cz1lz18z1nz1gz4bz24z4dz4bz18z1nz1nz16z1jz1mz1ez16z1kz1cz22z18")+"?app_id="+e.app_id+"&t="+e.sdk_type+"&nc=false";e.collect.requestManager.useRequest({url:s,method:"GET",success:function(s){e.eventVerifyReady=!0,e.collect.reStart(),t({data:s.data,verifyStatus:!0})},fail:function(){e.eventVerifyReady=!0,e.collect.reStart(),t({data:[],verifyStatus:!1})},timeout:3e3})}))}catch(e){return{data:[],verifyStatus:!1}}},e.prototype.addLintener=function(){var e=this;window.addEventListener("message",(function(t){if(t.origin===location.origin){if(t&&t.data&&"devtool:web:ready"===t.data.type){if(e.devToolOrigin=t.origin,e.devToolReady=!0,e.sendAlready)return;e.sendData("devtool:web:init",{info:e.info,log:e.log,event:e.event,appid:e.app_id}),e.sendAlready=!0}t&&t.data&&"devtool:web:ssid"===t.data.type&&e.collect.getToken((function(t){e.info[1].infoName.ssid=t.tobid,e.updateInfo()})),t&&t.data&&t.data.type}}))},e.prototype.sendData=function(e,t){try{var s={type:e,payload:t};(window.opener||window.parent).postMessage(s,this.devToolOrigin)}catch(e){}},e.prototype.updateInfo=function(){this.devToolReady&&this.sendData("devtool:web:info",this.info)},e.prototype.updateLog=function(e){this.devToolReady?this.sendData("devtool:web:log",e):this.log.push(e)},e.prototype.updateEvent=function(e){this.devToolReady||this.eventVerifyReady?this.sendData("devtool:web:event",e):this.event.push(e)},e.prototype.loadDebuggerModule=function(){var e="#debugger-applog-web {\n      position: fixed;\n      width: 50px;\n      height: 50px;\n      background-image: url("+g("1fz22z22z1nz21z4mz4bz4bz1jz1dz49z1az1bz1lz49z22z1mz21z4az19z27z22z1cz21z1az1kz4az1az1mz1kz4bz1mz19z1hz4bz21z22z18z22z1gz1az4bz1jz1mz1ez49z21z1bz1iz4bz1az1mz1jz1jz1cz1az22z4bz1bz1cz24z22z1mz1mz1jz4bz18z1nz1nz1jz1mz1ez4az1nz1lz1e")+");\n      bottom: 5%;\n      right: 10%;\n      cursor: pointer;\n      z-index:100;\n      background-size: 50px;\n    }",t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.appendChild(document.createTextNode(e)),t.appendChild(s);var i=document.createElement("div");i.innerHTML='<div id="debugger-applog-web" class="debugger-applog-web"></div>';var n=document.createElement("div");n.innerHTML='<div id="debugger-container" class="debugger-container"></div>',document.getElementsByTagName("body")[0].appendChild(i),document.getElementsByTagName("body")[0].appendChild(n),document.getElementById("debugger-applog-web").addEventListener("click",(function(){(window.opener||window.parent).postMessage({type:"devtool:web:open-draw"},location.origin)}))},e}(),W={autotrack:{src:{cn:"",sg:"",va:""},object:"LogAutoTrack"},ab:{src:{cn:"",sg:"",va:""},object:"LogAb"},stay:{src:{cn:"",sg:"",va:""},object:"LogStay"},route:{src:{cn:"",sg:"",va:""},object:"LogRoute"},cep:{src:{cn:"",sg:"",va:""},object:"LogCep"},tracer:{src:{cn:"",sg:"",va:""},object:"LogTracer"},retry:{src:{cn:"",sg:"",va:""},object:"LogRetry"},visual:{src:{cn:"",sg:"",va:""},object:"LogVisual"}},J=["ab","autotrack","Stay","store","et","profile","cep","heartbeat","monitor","route","tracer"],Q=function(){function e(e){this.disableAutoPageView=!1,this.bridgeReport=!1,this.staging=!1,this.pluginInstances=[],this.sended=!1,this.started=!1,this.destroy=!1,this.sdkReady=!1,this.adapters={},this.loadType="base",this.sdkStop=!1,this.name=e,this.hook=new u,this.remotePlugin=new Map,this.Types=x,this.adapters.storage=w,this.loadType="full"}return e.usePlugin=function(t,s,i){if(s){for(var n=!1,a=0,o=e.plugins.length;a<o;a++)if(e.plugins[a].name===s){e.plugins[a].plugin=t,e.plugins[a].options=i||{},n=!0;break}n||e.plugins.push({name:s,plugin:t,options:i})}else e.plugins.push({plugin:t})},e.prototype.usePlugin=function(e,t,s){e&&("full"===this.loadType&&J.includes(e)||(t?"string"==typeof t?this.remotePlugin.get(e)||this.remotePlugin.set(e,{src:t,call:s}):this.remotePlugin.get(e)||this.remotePlugin.set(e,{instance:t}):this.remotePlugin.get(e)||this.remotePlugin.set(e,"sdk")))},e.prototype.init=function(t){var s,i=this;this.logger=new P(this.name,t.log),this.inited?this.logger.warn("[instance: "+this.name+"], every instance's api: init,  can be call only one time!"):t&&h(t)?t.app_id&&"number"==typeof(s=t.app_id)&&!isNaN(s)?!t.app_key||function(e){return"string"==typeof e}(t.app_key)?(t.channel_domain||-1!==["cn","sg","va"].indexOf(t.channel)||(this.logger.warn("channel must be `cn`, `sg`,`va` !"),t.channel="cn"),this.spider=new q,this.spider.checkSpider(t)?this.logger.warn("your env may be a spider, can not report!"):(this.appBridge=new G(this,t.enable_native),this.requestManager=new H(this,t),this.bridgeReport=this.appBridge.bridgeInject(),this.configManager=new O(this,t),this.debugger=new K(this,t),this.initConfig=t,this.emit(x.Init),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cINIT",data:t,level:"info",time:Date.now()}),this.destroy=!1,t.disable_auto_pv&&(this.disableAutoPageView=!0),this.bridgeReport||(this.configManager.set({app_id:t.app_id}),this.eventManager=new j,this.tokenManager=new V,this.sessionManager=new N,Promise.all([new Promise((function(e){i.once(x.TokenComplete,(function(){e(!0)}))})),new Promise((function(e){i.once(x.Start,(function(){e(!0)}))}))]).then((function(){try{e.plugins.reduce((function(e,t){var s=t.plugin,n=t.options,a=Object.assign(i.initConfig,n),o=new s;return o.apply(i,a),e.push(o),e}),i.pluginInstances)}catch(t){i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}i.sdkReady=!0,i.emit(x.Ready),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u521d\u59cb\u5316\u5b8c\u6210",time:Date.now(),level:"info",data:i.configManager.get("user")}),i.logger.info("appid: "+t.app_id+", userInfo:"+JSON.stringify(i.configManager.get("user"))),i.logger.info("appid: "+t.app_id+", sdk is ready, version type is "+i.loadType+", version is "+M+", you can report now !!!"),t.disable_auto_pv&&(i.disableAutoPageView=!0);try{"full"===i.loadType&&(t.enable_ab_test||t.autotrack)&&(window.opener||window.parent).postMessage("[tea-sdk]ready","*")}catch(t){i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}i.pageView(),i.on(x.TokenChange,(function(e){"webid"===e&&i.pageView(),i.logger.info("appid: "+t.app_id+" token change, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u8bbe\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(x.TokenReset,(function(){i.logger.info("appid: "+t.app_id+" token reset, new userInfo:"+JSON.stringify(i.configManager.get("user"))),i.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u91cd\u7f6e\u4e86\u7528\u6237\u4fe1\u606f",time:Date.now(),secType:"USER",level:"info",data:i.configManager.get("user")})})),i.on(x.RouteChange,(function(e){e.init||t.disable_route_report||i.pageView()}))})),this.tokenManager.apply(this,t),this.eventManager.apply(this,t),this.sessionManager.apply(this,t)),this.inited=!0)):this.logger.warn("app_key param is error, must be string, please check!"):this.logger.warn("app_id param is error, must be number, please check!"):this.logger.warn("init params error,please check!")},e.prototype.config=function(e){if(this.inited&&e&&h(e))if(this.bridgeReport)this.appBridge.setConfig(e);else{e._staging_flag&&1===e._staging_flag&&(this.staging=!0),e.disable_auto_pv&&(this.disableAutoPageView=!0,delete e.disable_auto_pv);var t=i({},e),s=this.initConfig.configPersist||this.initConfig.config_persist||!1;if(this.initConfig&&s){var n=this.configManager.getStore();n&&(t=Object.assign(n,e)),this.configManager.setStore(e)}t.web_id,t.user_unique_id;var a=function(e,t){var s={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(s[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(i=Object.getOwnPropertySymbols(e);n<i.length;n++)t.indexOf(i[n])<0&&(s[i[n]]=e[i[n]])}return s}(t,["web_id","user_unique_id"]);this.configManager.set(a),t.hasOwnProperty("web_id")&&this.emit(x.ConfigWebId,t.web_id),t.hasOwnProperty("user_unique_id")&&this.emit(x.ConfigUuid,t.user_unique_id),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cCONFIG",level:"info",time:Date.now(),data:t})}},e.prototype.setUserUniqueID=function(e){this.config({user_unique_id:e})},e.prototype.setHeaderInfo=function(e,t){var s={};s[e]=t,this.config(s)},e.prototype.removeHeaderInfo=function(e){var t={};t[e]=void 0,this.config(t)},e.prototype.setDomain=function(e){this.configManager&&this.configManager.setDomain(e),this.emit(x.ConfigDomain)},e.prototype.getConfig=function(e){return this.configManager.get(e)},e.prototype.send=function(){this.start()},e.prototype.start=function(){this.inited&&!this.sended&&(this.sended=!0,this.started=!0,this.emit(x.Start),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cSTART",level:"info",time:Date.now()}),this.bridgeReport&&(this.pageView(),this.emit(x.Ready)))},e.prototype.event=function(e,t){var s=this;try{var i=[];if(Array.isArray(e))e.forEach((function(e){var t=s.processEvent(e[0],e[1]||{});t&&i.push(t)}));else{var n=this.processEvent(e,t);if(!n)return;i.push(n)}this.bridgeReport?i.forEach((function(e){var t=e.event,i=e.params;s.appBridge.onEventV3(t,JSON.stringify(i))})):i.length&&(this.emit(x.Event,i),this.emit(x.SessionResetTime))}catch(e){this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.beconEvent=function(e,t){if(Array.isArray(e));else{var s=[],i=this.processEvent(e,t||{});i&&(s.push(i),s.length&&(this.emit(x.BeconEvent,s),this.emit(x.SessionResetTime)))}},e.prototype.beaconEvent=function(e,t){this.beconEvent(e,t)},e.prototype.processEvent=function(e,t){void 0===t&&(t={});try{if(!e)return null;var s=e;/^event\./.test(e)&&(s=e.slice(6));var i=t;"object"!=typeof i&&(i={}),i.profile?delete i.profile:i.event_index=_();var n=void 0;return i.local_ms?(n=i.local_ms,delete i.local_ms):n=+new Date,{event:s,params:i,local_time_ms:n,is_bav:this.initConfig&&this.initConfig.autotrack?1:0}}catch(s){return this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:s.message}),{event:e,params:t}}},e.prototype.filterEvent=function(e){this.eventFilter=e},e.prototype.on=function(e,t){this.hook.on(e,t)},e.prototype.once=function(e,t){this.hook.once(e,t)},e.prototype.off=function(e,t){this.hook.off(e,t)},e.prototype.emit=function(e,t,s){this.hook.emit(e,t,s)},e.prototype.set=function(e){this.hook.set(e)},e.prototype.stop=function(){this.sdkStop=!0},e.prototype.reStart=function(){this.sdkStop=!1},e.prototype.pageView=function(){this.disableAutoPageView||this.predefinePageView()},e.prototype.predefinePageView=function(e){if(void 0===e&&(e={}),this.inited){var t={time:Date.now(),$is_first_time:""+(this.configManager&&this.configManager.is_first_time||!1)},s=i(i({},t),e);this.event("predefine_pageview",s)}},e.prototype.clearEventCache=function(){this.emit(x.CleanEvents)},e.prototype.setWebIDviaUnionID=function(e){if(e){var t=f(e);this.config({web_id:""+t,wechat_unionid:e}),this.emit(x.CustomWebId)}},e.prototype.setWebId=function(e){this.config({web_id:""+e})},e.prototype.setWebIDviaOpenID=function(e){if(e){var t=f(e);this.config({web_id:""+t,wechat_openid:e}),this.emit(x.CustomWebId)}},e.prototype.setNativeAppId=function(e){this.bridgeReport&&this.appBridge.setNativeAppId(e)},e.prototype.getSessionId=function(){return D()},e.prototype.setSessionId=function(e){this.emit(x.SessionReset,e)},e.prototype.resetStayDuration=function(e,t,s){this.emit(x.ResetStay,{url_path:e,title:t,url:s},x.Stay)},e.prototype.resetStayParams=function(e,t,s){void 0===e&&(e=""),void 0===t&&(t=""),void 0===s&&(s=""),this.emit(x.SetStay,{url_path:e,title:t,url:s},x.Stay)},e.prototype.getToken=function(e,t){var s=this;if(this.inited){var n=!1,a=function(t){if(!n){n=!0;var a=s.configManager.get().user;return t&&(a.tobid=t,a["diss".split("").reverse().join("")]=t),e(i({},a))}},o=function(){s.tokenManager.getTobId().then((function(e){a(e)}))};this.sdkReady?o():(t&&setTimeout((function(){a()}),t),this.on(x.Ready,(function(){o()})))}},e.prototype.profileSet=function(e){this.bridgeReport?this.appBridge.profileSet(JSON.stringify(e)):this.emit(x.ProfileSet,e,x.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSet",level:"info",time:Date.now(),data:e})},e.prototype.profileSetOnce=function(e){this.bridgeReport?this.appBridge.profileSetOnce(JSON.stringify(e)):this.emit(x.ProfileSetOnce,e,x.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileSetOnce",level:"info",time:Date.now(),data:e})},e.prototype.profileIncrement=function(e){this.bridgeReport?this.appBridge.profileIncrement(JSON.stringify(e)):this.emit(x.ProfileIncrement,e,x.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileIncrement",level:"info",time:Date.now(),data:e})},e.prototype.profileUnset=function(e){this.bridgeReport?this.appBridge.profileUnset(e):this.emit(x.ProfileUnset,e,x.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileUnset",level:"info",time:Date.now(),data:e})},e.prototype.profileAppend=function(e){this.bridgeReport?this.appBridge.profileAppend(JSON.stringify(e)):this.emit(x.ProfileAppend,e,x.Profile),this.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u6267\u884cprofileAppend",level:"info",time:Date.now(),data:e})},e.prototype.setExternalAbVersion=function(e){this.emit(x.AbExternalVersion,"string"==typeof e&&e?(""+e).trim():null,x.Ab)},e.prototype.getVar=function(e,t,s){this.emit(x.AbVar,{name:e,defaultValue:t,callback:s},x.Ab)},e.prototype.getABconfig=function(e,t){this.emit(x.AbConfig,{params:e,callback:t},x.Ab)},e.prototype.getAbSdkVersion=function(){return this.configManager.getAbVersion()},e.prototype.onAbSdkVersionChange=function(e){var t=this;return this.emit(x.AbVersionChangeOn,e,x.Ab),function(){t.emit(x.AbVersionChangeOff,e,x.Ab)}},e.prototype.offAbSdkVersionChange=function(e){this.emit(x.AbVersionChangeOff,e,x.Ab)},e.prototype.openOverlayer=function(){this.emit(x.AbOpenLayer,"",x.Ab)},e.prototype.closeOverlayer=function(){this.emit(x.AbCloseLayer,"",x.Ab)},e.prototype.getAllVars=function(e){this.emit(x.AbAllVars,e,x.Ab)},e.prototype.destoryInstace=function(){this.destroy||(this.destroy=!0,this.off(x.TokenComplete),this.emit(x.DestoryInstance))},e.prototype.destroyInstance=function(){this.destroy||(this.destroy=!0,this.off(x.TokenComplete),this.emit(x.DestoryInstance))},e.plugins=[],e}(),Y="__rangers_ab_style__";!function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(C||(C={}));var X=function(){function e(){this.fetchStatus="no",this.refreshFetchStatus="complete",this.versions=[],this.extVersions=[],this.mulilinkVersions=[],this.enable_multilink=!1,this.enable_ab_visual=!1,this.editMode=!1,this.callbacks=[],this.data=null,this.changeListener=new Map,this.readyStatus=!1,this.exposureCache=[]}return e.prototype.apply=function(e,t){var s=this;if(t.enable_ab_test){this.collect=e,this.config=t;var i=t.enable_multilink,n=t.ab_channel_domain,a=t.enable_ab_visual,o=t.ab_cross,r=t.ab_cookie_domain,l=t.ab_timeout,c=n||g(R[t.channel||"cn"]),d=e.adapters.storage,u=this.collect.Types;this.types=u,this.cacheStorgae=new d(!1),this.timeout=l||3e3,this.enable_multilink=i,this.enable_ab_visual=a,this.abKey="__tea_sdk_ab_version_"+t.app_id,this.ab_cross=o,this.ab_cookie_domain=r||"",this.fetchUrl=c+"/service/2/abtest_config/",this.reportUrl=""+e.configManager.getUrl("event"),this.exposureLimit=t.exposure_limit||20,this.ab_batch_time=t.ab_batch_time||500,this.ab_user_mode=t.ab_user_mode||"user_unique_id",this.collect.on(u.TokenChange,(function(e){"uuid"===e&&s.readyStatus&&(s.clearCache(),s.fetchAB())})),this.collect.on(u.TokenReset,(function(e){"uuid"===e&&s.readyStatus&&(s.clearCache(),s.fetchAB())})),this.collect.on(u.AbVar,(function(e){var t=e.name,i=e.defaultValue,n=e.callback;s.getVar(t,i,n)})),this.collect.on(u.AbAllVars,(function(e){s.getAllVars(e)})),this.collect.on(u.AbConfig,(function(e){var t=e.params,i=e.callback;s.getABconfig(t,i)})),this.collect.on(u.AbExternalVersion,(function(e){s.setExternalAbVersion(e)})),this.collect.on(u.AbOpenLayer,(function(){s.openOverlayer()})),this.collect.on(u.AbCloseLayer,(function(){s.closeOverlayer()})),this.collect.on(u.AbVersionChangeOn,(function(e){s.changeListener.set(e,e)})),this.collect.on(u.AbVersionChangeOff,(function(e){s.changeListener.get(e)&&s.changeListener.delete(e)})),this.loadMode(),(this.enable_ab_visual||this.enable_multilink)&&this.openOverlayer(this.config.multilink_timeout_ms||500),this.checkLocal(),this.ready("ab"),this.readyStatus||(this.fetchAB(),this.readyStatus=!0),this.collect.emit(u.AbReady)}},e.prototype.ready=function(e){var t=this;if(this.collect.set(e),this.collect.hook._hooksCache.hasOwnProperty(e)){var s=this.collect.hook._hooksCache[e];if(!Object.keys(s).length)return;var i=function(e){s[e].length&&s[e].forEach((function(s){t.collect.hook.emit(e,s)}))};for(var n in s)i(n)}},e.prototype.loadMode=function(){var e=function(){try{return JSON.parse(atob(window.name))||void 0}catch(e){return}}(),t="";if(e){var s=e.scenario,i=e.href;s?(this.editMode=!0,t=s):!i||-1===i.indexOf("datatester")&&-1===i.indexOf("visual-editor")||(this.editMode=!0,t="visual-editor")}this.enable_ab_visual&&"visual-editor"===t&&this.collect.destoryInstace()},e.prototype.checkLocal=function(){var e=this.getABCache(),t=e.ab_version,s=e.ab_ext_version,i=e.ab_version_multilink,n=e.data,a=this.checkFromUrl();a?this.mulilinkVersions.push(a):this.mulilinkVersions=i||[],this.extVersions=s||[],this.versions=t||[],this.data=n;var o=this.versions.concat(this.extVersions);this.enable_multilink&&(o=o.concat(this.mulilinkVersions)),this.configVersions(o.join(","))},e.prototype.checkFromUrl=function(){var e=m(window.location.href);return e&&e.vid?e.vid:""},e.prototype.updateVersions=function(){var e=this.extVersions.length?this.versions.concat(this.extVersions):this.versions;this.enable_multilink&&(e=e.concat(this.mulilinkVersions)),this.configVersions(e.join(",")),this.updateABCache(),this.changeListener.size>0&&this.changeListener.forEach((function(t){"function"==typeof t&&t(e)}))},e.prototype.configVersions=function(e){this.collect.configManager.setAbVersion(e)},e.prototype.getVar=function(e,t,s){if(!e)throw new Error("variable must not be empty");if(void 0===t)throw new Error("variable no default value");if("function"!=typeof s)throw new Error("callback must be a function");var i={name:e,defaultValue:t,callback:s,type:C.Var};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealVar(i,e):this.callbacks.push(i)},e.prototype.getRealVar=function(e,t){var s=e.name,i=e.defaultValue,n=e.callback,a=this.data;if(a){if(h(a[s])){var o=a[s].vid;return"$ab_url"===t?this.mulilinkVersions.includes(o)||this.mulilinkVersions.push(o):this.versions.includes(o)||this.versions.push(o),this.updateVersions(),this.fechEvent(o,t,i),n(a[s].val),void this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u66dd\u5149\u4e86\u5b9e\u9a8c"+s,level:"info",time:Date.now(),data:a[s]})}this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getVar",level:"info",time:Date.now(),data:i}),n(i)}else n(i)},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("callback must be a function");var t={callback:e,type:C.All};"complete"===this.fetchStatus&&"complete"===this.refreshFetchStatus?this.getRealAllVars(t):this.callbacks.push(t)},e.prototype.getRealAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{}),this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"SDK \u8c03\u7528getAllVars",level:"info",time:Date.now(),data:this.data})},e.prototype.fechEvent=function(e,t,s){try{if(this.config.disable_track_event)return;if(!e)return;var i=this.collect.configManager.get(),n=i.header,a=i.user,o=this.getABCache(),r=a[this.ab_user_mode]||a.user_unique_id;if(o&&o.uuid&&o.uuid!==r)return;var l={event:"abtest_exposure",ab_sdk_version:""+e,params:JSON.stringify({app_id:this.config.appId,ab_url:"$ab_url"===t?s:window.location.href}),local_time_ms:Date.now()};n.custom=JSON.stringify(n.custom);var d={events:[l],user:a,header:n};this.reportExposure(d,t)}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.reportExposure=function(e,t){var s=this;this.exposureCache.push(e),this.reportTimeout&&clearTimeout(this.reportTimeout),this.exposureCache.length>=this.exposureLimit?this.report(t):this.reportTimeout=setTimeout((function(){s.report(t),clearTimeout(s.reportTimeout)}),this.ab_batch_time)},e.prototype.report=function(e){var t=this;this.collect.requestManager.useRequest({url:this.reportUrl,data:this.exposureCache,timeout:2e4,useBeacon:"$ab_url"===e}),this.exposureCache.forEach((function(e){t.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_EVENT,info:"\u57cb\u70b9\u4e0a\u62a5\u6210\u529f",time:Date.now(),data:[e],code:200,status:"success"})})),this.exposureCache=[]},e.prototype.setExternalAbVersion=function(e){this.extVersions=[e],this.updateVersions()},e.prototype.getABconfig=function(e,t){var s=Object.keys(e);s&&s.length&&this.collect.configManager.set(e),this.fetchAB(t)},e.prototype.get=function(e){if(this.ab_cross){var t=this.cacheStorgae.getCookie(e,this.ab_cookie_domain);return t?JSON.parse(t):{}}return this.cacheStorgae.getItem(e)},e.prototype.set=function(e,t){this.ab_cross?this.cacheStorgae.setCookie(e,t,2592e6,this.ab_cookie_domain):this.cacheStorgae.setItem(e,t),this.collect.configManager.setAbCache(t)},e.prototype.getABCache=function(e){var t={ab_version:[],ab_ext_version:[],ab_version_multilink:[],data:null,timestamp:+new Date,uuid:""};return t=this.get(this.abKey)||t,e?t[e]:t},e.prototype.updateABCache=function(){var e=this.getABCache();e.ab_version_multilink=this.mulilinkVersions,e.ab_ext_version=this.extVersions,e.ab_version=this.versions,e.timestamp=Date.now(),this.set(this.abKey,e)},e.prototype.setAbCache=function(e){var t=this.getABCache();t.data=this.data,t.uuid=e,t.timestamp=Date.now(),this.set(this.abKey,t)},e.prototype.clearCache=function(){this.refreshFetchStatus="ing",this.data={},this.extVersions=[],this.mulilinkVersions=[],this.versions=[],this.collect.configManager.clearAbCache()},e.prototype.openOverlayer=function(e){var t=this;if(function(){if(!document.getElementById(Y)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.id=Y,s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e)),t.appendChild(s)}}(),e)var s=setTimeout((function(){t.closeOverlayer(),clearTimeout(s)}),e)},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(Y))&&e.parentElement.removeChild(e)},e.prototype.fetchComplete=function(e,t){var s=this;try{if(e&&"[object Object]"==Object.prototype.toString.call(e)){this.data=e,this.setAbCache(t);var i=[];Object.keys(e).forEach((function(t){var s=e[t].vid;s&&i.push(s)})),this.versions=this.versions.filter((function(e){return i.includes(e)}));var n=e.$ab_url,a=e.$ab_modification;if(a&&a.val&&this.enable_ab_visual){if(this.collect.destroy)return}else if(n&&this.enable_multilink){this.mulilinkVersions=this.mulilinkVersions.filter((function(e){return i.includes(e)}));var o=n.val,r=n.vid;o&&r&&this.getVar("$ab_url",o,(function(){s.editMode||(o!==window.location.href?setTimeout((function(){if(!s.collect.destroy){var e=""+o;e=-1===e.indexOf("http")?"https://"+e:e,p(e).host!==location.host?e=e+"&vid="+r:window.history.replaceState("","",e),window.location.href=e}}),100):s.closeOverlayer())}))}this.updateVersions()}else this.closeOverlayer();this.callbacks.forEach((function(e){return s[e.type===C.Var?"getRealVar":"getRealAllVars"](e,"")})),this.callbacks=[]}catch(e){}},e.prototype.fetchAB=function(e){var t=this,s=this.collect.configManager.get(),n={header:i(i(i({aid:this.config.app_id},s.user||{}),s.header||{}),{ab_sdk_version:this.collect.configManager.getAbVersion(),ab_url:window.location.href})};this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"SDK \u53d1\u8d77AB\u5b9e\u9a8c\u8bf7\u6c42",level:"info",logType:"fetch",time:Date.now(),data:n});var a=s.user[this.ab_user_mode]||s.user.user_unique_id;this.collect.requestManager.useRequest({url:this.fetchUrl,data:n,success:function(s){t.fetchStatus="complete",t.refreshFetchStatus="complete";var i=s.data;"success"===s.message?(t.fetchComplete(i,a),e&&e(i)):(t.fetchComplete(null,a),e&&e(null)),t.collect.emit(t.types.AbComplete,i),t.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u6210\u529f",level:"info",logType:"fetch",time:Date.now(),data:i})},fail:function(){t.fetchStatus="complete",t.refreshFetchStatus="complete",t.fetchComplete(null,a),t.collect.emit(t.types.AbTimeout),e&&e(null),t.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,secType:"AB",info:"AB\u5b9e\u9a8c\u8bf7\u6c42\u7f51\u7edc\u5f02\u5e38",level:"error",logType:"fetch",time:Date.now()})},timeout:this.timeout})},e}(),Z="undefined"!=typeof window?(window.LogPluginObject||(window.LogPluginObject={}),window.LogPluginObject):null,$=function(){function e(){}return e.prototype.apply=function(e,t){this._plugin={},this.config=t,this.collect=e,this.channel=t.channel||"cn",this.loadExtend()},e.prototype.loadExtend=function(){var e=this;try{this.collect.remotePlugin.forEach((function(t,s){if("sdk"===t){if(W.hasOwnProperty(s)){var i=W[s].object,n=W[s].src[e.channel]+"?query="+Date.now();e.exist(s,i,n)}}else"object"==typeof t&&(t.src?e.exist(s,t.call,t.src):e.process(s,t.instance,"INSTANCE"))}))}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e.prototype.exist=function(e,t,s){var i=this;Z[t]?this.process(e,Z[t]):this.loadPlugin(e,s,(function(){i.process(e,Z[t])}),(function(){}))},e.prototype.process=function(e,t,s){try{if(s){var i=new t;i.apply&&i.apply(this.collect,this.config)}else t&&t(this.collect,this.config)}catch(t){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:t.message})}},e.prototype.loadPlugin=function(e,t,s,i){var n=this;try{var a=document.createElement("script");a.src=t,this._plugin[e]||(this._plugin[e]=[]),this._plugin[e].push(s),a.onerror=function(){i(t)},a.onload=function(){n._plugin[e].forEach((function(e){e()}))},document.getElementsByTagName("head")[0].appendChild(a)}catch(e){this.collect.emit(c.DEBUGGER_MESSAGE,{type:c.DEBUGGER_MESSAGE_SDK,info:"\u53d1\u751f\u4e86\u5f02\u5e38",level:"error",time:Date.now(),data:e.message})}},e}();Q.usePlugin($,"extend"),Q.usePlugin(X,"ab");const ee=new Q("default")},66714:(e,t,s)=>{s.d(t,{L:()=>r});var i=s(11855),n=s(79724);const a="audio-loading-qtTWhc";var o=s(63159);const r=({size:e})=>{const t=(0,i.useRef)(null),s=(0,n.Q)(t.current,e);return(0,o.jsx)("div",{"data-testid":"audio-loading",ref:t,className:a,style:{width:e,height:e},children:Array.from({length:4}).map(((e,t)=>(0,o.jsx)("span",{style:{width:s}},t)))})}},79724:(e,t,s)=>{s.d(t,{d:()=>d,Q:()=>c});var i=s(41967),n=s(11855),a=s(29019),o=s.n(a);const r="audio-playing-tioBXU";var l=s(63159);const c=(e,t)=>{const[s,a]=(0,n.useState)();return(0,n.useEffect)((()=>{try{let s=t;if(!s&&e&&(s=parseInt(getComputedStyle(e).fontSize)),(0,i.A)(s)){const e=2/22*s,t=Math.trunc(e),i=Math.floor((e-t)/.25);a(t+.25*(i%2==0?i:i+1))}}catch(s){}}),[t,e]),s},d=({size:e,className:t,onClick:s})=>{const i=(0,n.useRef)(null),a=c(i.current,e);return(0,l.jsx)("div",{"data-testid":"audio-playing",ref:i,className:o()(r,t),style:{width:e,height:e},onClick:s,children:Array.from({length:4}).map(((e,t)=>(0,l.jsx)("span",{style:{width:a}},t)))})}},36080:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(36245);const n=e=>{const t=(0,i.c)(e);return{onMessage:{addListener:t.onMessage.addListener.bind(t.onMessage)},postMessage:t.postMessage.bind(t),formatMessage:e=>e}}},47730:(e,t,s)=>{s.d(t,{Y:()=>a});var i=s(4297),n=s(77591);const a=e=>(0,i.r)(e,(0,n.TK)(e))},36481:(e,t,s)=>{s.d(t,{H:()=>n});var i=s(11855);function n(e,t){const s=(0,i.useRef)(!1);(0,i.useEffect)((()=>{s.current=!0}),[]),(0,i.useEffect)((()=>{if(!s.current)return e();s.current=!1}),t)}},59865:(e,t,s)=>{s.d(t,{G:()=>o,r:()=>r});var i=s(58980),n=s(77591),a=s(64123);const o=(e,t)=>{const s=(0,a.o)((0,a.AI)(a.jv.Command)),o=(0,a.o)((0,a.AI)(a.jv.Option));switch(t){case i.X0.NO_TRANSLATE:return{desc:e("flow_web_ext_sidebar_settings_translate_mouse_hover_nothing","\u4e0d\u505a\u4efb\u4f55\u4e8b")};case i.X0.TRANSLATE_BY_COMMAND:return{desc:e("flow_web_ext_sidebar_settings_translate_mouse_hover_shortcut",{shortcut:s})};case i.X0.TRANSLATE_BY_OPTION:return{desc:e("flow_web_ext_sidebar_settings_translate_mouse_hover_shortcut",{shortcut:o})};case i.X0.TRANSLATE_BY_CUSTOM_SHORTCUT:{var r;const t=null===(r=(0,n.TK)("shortcutsConfig").HoverTextTranslate)||void 0===r?void 0:r.key;return{desc:e("flow_web_ext_sidebar_settings_translate_mouse_hover_shortcut",{shortcut:(0,a.o)(t)})}}case i.X0.TRANSLATE_DIRECTLY:return{desc:e("flow_web_ext_sidebar_settings_translate_mouse_hover_translate","\u76f4\u63a5\u7ffb\u8bd1\u8be5\u6bb5\u843d")};default:return}},r=(e=!1)=>{const t=!e&&(()=>{var e;const t=null===(e=(0,n.TK)("shortcutsConfig").HoverTextTranslate)||void 0===e?void 0:e.key;return t!==(0,a.AI)(a.jv.Command)&&t!==(0,a.AI)(a.jv.Option)})(),s=[i.X0.NO_TRANSLATE,i.X0.TRANSLATE_BY_COMMAND,i.X0.TRANSLATE_BY_OPTION];return t?[...s,i.X0.TRANSLATE_BY_CUSTOM_SHORTCUT,i.X0.TRANSLATE_DIRECTLY]:[...s,i.X0.TRANSLATE_DIRECTLY]}},24337:(e,t,s)=>{s.d(t,{R8:()=>n,Rm:()=>i,z3:()=>a});const i=(...e)=>{},n=(...e)=>{},a=(...e)=>{}},36245:(e,t,s)=>{s.d(t,{c:()=>a});var i=s(76360);const n=new Map,a=e=>{const t=n.get(e);if(t)return t;const s=(0,i.Gj)().connect({name:e});return n.set(e,s),s}},74232:(e,t,s)=>{s.d(t,{Qz:()=>r});var i=s(44557),n=s(10633),a=s(33522);class o{constructor(e){(0,n.A)(this,"markersInOrder",[]),(0,n.A)(this,"performanceMeasureAcc",(e=>this.performanceMeasure(e,this._startMarker))),(0,n.A)(this,"performanceMeasure",((e,t)=>{try{return performance.measure(this.name,this.getMarkName(t),this.getMarkName(e)).duration}catch(s){return-1}})),(0,n.A)(this,"eventName",""),(0,n.A)(this,"name",""),(0,n.A)(this,"_startTime",0),(0,n.A)(this,"_startMarker","mark_start"),(0,n.A)(this,"_endMarker","mark_end"),this.eventName=e,this.name=`${e}_${Math.random().toString(32).slice(2,6)}`}get markEntries(){return this.markersInOrder.forEach((e=>performance.getEntriesByName(e)))}getMarkName(e){return`${this.name}:${e}`}get measureEntries(){return performance.getEntriesByName(this.name)}clean(){this.markersInOrder.forEach((e=>performance.clearMarks(e))),performance.clearMeasures(this.name),this.markersInOrder=[]}get origin(){return performance.timeOrigin}now(){return performance.timeOrigin+performance.now()}get startTime(){return this._startTime}start(e=this._startMarker){this.clean();const t=this.mark(e);this._startTime=t.startTime,this._startMarker=e}mark(e){return this.markersInOrder.push(e),performance.mark(this.getMarkName(e))}end(e=this._endMarker,t={}){this.mark(e),this._endMarker=e,this.report(t)}get timing(){const e={startTime:this.startTime,origin:this.origin,duration:this.duration};if(this.markersInOrder.length>=1)for(let t=1;t<this.markersInOrder.length;t++){const s=this.markersInOrder[t];e[s]=this.performanceMeasureAcc(s)}return e}get duration(){return this.performanceMeasureAcc(this._endMarker)}toJSON(){return JSON.stringify(this.timing)}toMetrics(){return this.timing}toCategories(){return this.markersInOrder.reduce(((e,t)=>(0,i.A)((0,i.A)({},e),{},{[t]:t})),{})}report(e={}){const t=(0,a.Gl)();null==t||t.reportCustomPerfEvent({name:this.eventName,metrics:this.toMetrics(),categories:e})}}const r=new class{constructor(){(0,n.A)(this,"recorders",void 0),this.recorders=new Map}create(e,t=!1){this.remove(e);const s=new o(e);return t&&s.start(),this.recorders.set(e,s),s}get(e){return this.recorders.get(e)}remove(e){this.recorders.delete(e)}report(e){const t=this.get(e);t&&t.report()}};window._perfRecorder=r},87648:(e,t,s)=>{s.d(t,{X:()=>l});var i=s(44557),n=s(14065),a=s(22234),o=s(54096),r=s(29988);const l=function(){var e=(0,n.A)((function*(e){const t=Object.keys(e),s=Object.values(e),n=yield Promise.all(t.map((e=>r.A.get(e))));for(let i=0;i<t.length;i++)if(void 0!==n[i]){const r=n[i];let c=r;if(null!==(l=r)&&"object"==typeof l&&!Array.isArray(l)){const e=Object.assign({},r);c=(0,a.A)(e,s[i])}(0,o.A)(e,t[i],c)}var l;const c=t.reduce(((t,s)=>(0,i.A)((0,i.A)({},t),{},{[s]:t=>{(0,o.A)(e,s,t.newValue)}})),{});return r.A.watch(c),()=>{r.A.unwatch(c)}}));return function(t){return e.apply(this,arguments)}}()},53884:(e,t,s)=>{s.d(t,{s:()=>a});var i=s(44557),n=s(82770);const a=(e,t)=>{var s;null===(s=n.Ay.Tea)||void 0===s||s.event(e,(0,i.A)({},t))}},6784:(e,t,s)=>{s.d(t,{E:()=>d,L:()=>c});var i=s(44557),n=(s(11855),s(63159));const a=e=>(0,n.jsxs)("svg",(0,i.A)((0,i.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:[(0,n.jsx)("path",{fill:"#F25022",d:"M4.871 4.871h6.489v6.489H4.871z"}),(0,n.jsx)("path",{fill:"#00A4EF",d:"M4.871 12.64h6.489v6.489H4.871z"}),(0,n.jsx)("path",{fill:"#7FBA00",d:"M12.641 4.871h6.489v6.489h-6.489z"}),(0,n.jsx)("path",{fill:"#FFB900",d:"M12.641 12.64h6.489v6.489h-6.489z"})]})),o=e=>(0,n.jsxs)("svg",(0,i.A)((0,i.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:[(0,n.jsx)("path",{fill:"url(#huoshan_logo_svg__a)",d:"M5.413 8.645 2.436 13.8a3.244 3.244 0 0 0 2.808 4.866h10.173L9.626 8.645a2.432 2.432 0 0 0-4.213 0"}),(0,n.jsx)("path",{fill:"url(#huoshan_logo_svg__b)",d:"M5.413 8.645 2.436 13.8a3.244 3.244 0 0 0 2.808 4.866h10.173L9.626 8.645a2.432 2.432 0 0 0-4.213 0"}),(0,n.jsx)("path",{fill:"#fff",d:"M10.353 12.177v-.384a.19.19 0 0 0-.123-.19.2.2 0 0 0-.079-.012H8.1v-.547a.2.2 0 0 0-.203-.192h-.384a.19.19 0 0 0-.202.192v.545H5.25a.2.2 0 0 0-.138.06.2.2 0 0 0-.053.142v.384a.2.2 0 0 0 .192.203h.723a4.95 4.95 0 0 0 1.135 2.056 5.5 5.5 0 0 1-1.728.875.19.19 0 0 0-.136.248l.106.384a.19.19 0 0 0 .253.138 6.2 6.2 0 0 0 2.1-1.09 6.2 6.2 0 0 0 2.102 1.09q.039.012.08.008a.2.2 0 0 0 .173-.146l.106-.384a.203.203 0 0 0-.138-.248 5.5 5.5 0 0 1-1.728-.875 4.9 4.9 0 0 0 1.134-2.056h.726a.2.2 0 0 0 .194-.201M7.7 13.904a4.2 4.2 0 0 1-.896-1.518h1.792a4.15 4.15 0 0 1-.896 1.518"}),(0,n.jsx)("path",{fill:"url(#huoshan_logo_svg__c)",d:"M21.426 13.8 17.32 6.684a2.705 2.705 0 0 0-4.682 0l-5.567 9.65c-1.36 2.355-3.013 2.086-3.292 1.99.454.228.954.345 1.461.344h13.383a3.244 3.244 0 0 0 2.804-4.866"}),(0,n.jsx)("path",{fill:"#fff",d:"M17.202 15.903h.728a.18.18 0 0 0 .163-.258l-2.618-5.524a.4.4 0 0 0-.361-.228h-.418a.4.4 0 0 0-.361.228l-2.613 5.524a.18.18 0 0 0 .011.174.18.18 0 0 0 .152.083h.728a.19.19 0 0 0 .163-.103l.641-1.36h2.975l.642 1.36a.19.19 0 0 0 .168.104m-3.36-2.363 1.057-2.246 1.062 2.246z"}),(0,n.jsxs)("defs",{children:[(0,n.jsxs)("linearGradient",{id:"huoshan_logo_svg__a",x1:6.154,x2:15.901,y1:19.801,y2:5.716,gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#00DEEC"}),(0,n.jsx)("stop",{offset:1,stopColor:"#00FFBE"})]}),(0,n.jsxs)("linearGradient",{id:"huoshan_logo_svg__b",x1:7.231,x2:11.987,y1:20.058,y2:9.236,gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#00DEEC"}),(0,n.jsx)("stop",{offset:1,stopColor:"#00F3CE"})]}),(0,n.jsxs)("linearGradient",{id:"huoshan_logo_svg__c",x1:9.585,x2:25.902,y1:22.064,y2:-1.519,gradientUnits:"userSpaceOnUse",children:[(0,n.jsx)("stop",{stopColor:"#2C55FF"}),(0,n.jsx)("stop",{offset:.21,stopColor:"#2E51FF"}),(0,n.jsx)("stop",{offset:.43,stopColor:"#3444FF"}),(0,n.jsx)("stop",{offset:.65,stopColor:"#3F30FF"}),(0,n.jsx)("stop",{offset:.88,stopColor:"#4D13FF"}),(0,n.jsx)("stop",{offset:1,stopColor:"#5700FF"})]})]})]}));var r=s(58980),l=s(76360);const c={[r.c$.HUOSHAN]:{logo:(0,n.jsx)(o,{}),label:"flow_web_ext_sidebar_settings_translateservice_volcengine"},[r.c$.DOUBAO]:{logo:(0,n.jsx)("img",{src:(0,l.Nf)(),width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_doubao"},[r.c$.GPT]:{logo:(0,n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAYJSURBVHgBxVhtTJNXFH7a+gEzYmFDtzHX/nEfCcSqoONDKSzROIiZLnHRiZQIOjcmTPwzIxEWXDP3A00QUJxFBH+4H8qmYROx4ATRaZRM5zCQlrIoCBH4wZDPs3tv62vp+pYWIT7Jad/33vPe+9xzzj3nfa8CvkPL5GMmi5nomagdwtHLxOqQOibnHNfTAgMTMxPyUW47np0y6JlYJkHEVSwvSoy7IX8KiLhKPp672GtoYTc1TZNYHHN4TcYyjWQ8klK43Ksdlvmfoitmz/ZDdHQUFi1ahOHhYdTXN+DBg2YQEXzAHSZxsO9Ot/AqZnZ+vpN6enrIFdev3yCtVjuZmHILgzcD7N+/X0xuNpspPj6eQkLeotDQMDIYUshisZCtzUbHjh2j0tJSMhq/p4iI5d6Q0rsjZJnoQd1inSCTn59PCoVSamd+p3Xr1lF7e7vo7+rqEuSGhobEPScXFBg0UTx5bx0FFBQVGUW/VlWJiQLF4ArRHhoaSrW1tWLiRuayuLg4RlYh+ufODaCsrCx737VGmjVrtidSBmdCsltco9FQdXW1FCdnz54V7cGvBVNRYZFoe/jwIaWnf2UnqXgu/J7rrl+/Xuhxd3sgZH5GRiunFBQUJCzCA3jvN3tpdHSUioqKHLGUQ/39/ZSb+y0FqgNFm1qtppycHGpqaqLdu3fTzJmzJFI85lpbWyeKJc4FmXIKRwqOiJXFxMSIFXMcKSgQfXxio9EoxVBCQgJ1dHbQ5cuX6eTJk0KXL2bTpk1CJ2vPHtHm7+fniVCmkv3Ewg14gkrauhVlZWW4erVeaicXrSW6Jaitq8P58+dh/M6I+PgPkZycjBUrPhAap0+fRmXlz1AHzBP3SpUKHsDfINzHT1hYmFjR2jVr7FZwWKjAyUKPWOxwd+7alUEpbNtbrTYymUzjclFKij0dcHR3dztiy/Nu63HXGR4eLgZZvXq1RGiM3RcWFom44IS4exYsWCA9s3DhQqq+VMO2fTcL8nTyc7hH87aGLly4IMbju9UDoR7uMreV12ptE/+RkZFS29OBp5g/P1iqN9carqGz87HUz/IQ6q/+jps3b2Lt2gTcv38fSUlJaLPZ8Nnmzbh39x4OHz4ED1Ar5Xq6u7tQx2IjLS0NbBeJGrWdXS9btgwXqy9Cq9FijMbcPmuztSEx8SPxPHMhlEolevv6UHy0GOEREWAulZsWnJBsYWNJDSEhISg7VSYGKa8oZ8X0HZw58xMSEhOxatUq1q6R9FmawNKlSzE2NgZeY61WK1QsiBXCpAo03WkSenxRMuj1SOjWrVtobm5mq00Uq922LRWjoyMoKSnB8uURYMHKqnw9a9+GL79IR0tLC3Q6HewFn1xGI6hm2HfYkydP5Ka08p9SyJYMiEA8WlxMFRUVUm7hdUshSgdox/YdUrGNjY0VwV5YWCgFPodSqRLjHT9+XCRXf39/uaA+xy10R44u1xgZGYWt/R9s2bIFGzZ8ItorKytxqrwcl2pqkHfgAMtXyYiPixNW5OAucwVLIyI/saSJgYEBuSlr+Y8WHtL59Rt/EJvoudVYlc/IyBDlITc316lsBFIOKyd9fX108OAPUq7iyM7OFvmKW9c5TUCmdHCY5ZQyMzPFoKlp28lel5zF/iaQlppKNptN6JlOmOj1N950uOhHqSjX1NRM9PJ229lUBk9W4gmQY9++bAp6NViq5nq9nq5cuSL6+H9M9EqJ6IwZM4VF+JsC13vW7kEMrv6zyCkHBMyj4qMlYmIWU9Ta0kodjzrE/WP2MrZx46fjLMetlpeXJ/p5xp+AiFQyOJwrXRNkPuQGBwdZ8fyFSRV6envxdHAId+/+yfJOIIaHhtDY2IgR9qKvUqoQwRKfyXRCFGYWY6K4eoGvIbO5DnmxGkl4TFT9Vkeu6OjodLyweTXOuFri7jPIzEQHH/Due+8jKnolXpkzB3//dQ8NDfUY+Lffm0etTJbAQ3Lm0OIlfii+LFJefYy6grvPp5jyUg5hEocNzjBg6o5j9JhCGDC5ExEzfDgXUsB3aGE/0ot1XHNxPtLjUgt7XvP5SO8/7DMsUnMU7ywAAAAASUVORK5CYII=",width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_gpt"},[r.c$.GOOGLE]:{logo:(0,n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAeJSURBVHgBzVdbbFzVFV3nPmY8tmPHj8Rx4jiOUWnkJig1tOAquAlRWgKojSJSq8pH04fUj0pV+9GPfoHgC4EEgg+QkFAkkEDig4+IlwLilUgBQghgDCYxBGdiEht7nHg8nse9Z7PPOfde3zvjQD5GiG2d+zhzfPY6e6/9uMBPTET4cOjhpb6Chb9ZEBn1LhFeeUiL71aw0uMZM0f8VrTpvRf/s+p51EkcdRl59NJ1echjrGGdZC0UW0Ck3sgA42fSZ2AwwsC1PRrjW90AWUZp898F0boAQtWIoOk/RFdlXoIUGNj/QLYHdRLjB6qktBqiBAQg5tOVhNjBsFG2Vx1CPQFpvlS5KoIjrCQGJNcpwEKk/oR6AsJKQNTQ2msBJd8kr/S2HXh0YQ3qIE5CkSZGACByn0Q1VIp+t6KZDc2Fx85NZt93eMq2be1py7JISinCu1oYf1f3SqVSdF33xe7u7nMxQFbgMgFBuCpxqt1lwAptxbkCjZSW/BG3KRUuESpChVA3EsFdgQzBGos4Dhjcfdls9vqenp5ZMyutmFLSoU4rgIHaSwR4hVDwDSA+xXypGV9dLCK/VBBSwVhmQ3g8EUhiXwWUwbXz439jFvKCR6raQ81IXNch8PMNHlK2jdnLEh+cBxbKKV7lJzb/LJdBV+tlOOz2xqbMVSM0tFpMmTJhOgIktcuqrMKnbuecfWiHxMB6tYnk33397/sXLDx9UuLkl0lFH19oxHDfFRSLRVhMo4aGdAggsS4GpubdWEgmg0nxKMN7/et3ApvaJObyFt792sXiIltrrcSGThvnc2Ve6CZINVdM40LORV+HT4VCQeGgdDpdbajvYWkIKAysYHef33+9qYi+1S4u5FN48AgwX/Rh+y6k7SHTQCgsqZLnx4+pg2JiNo2NbYvC4nArFkuaM6lUKrQSVVunWgJShxFk6SGkxO3b0/D41yeOVjC/xHNkw2UgGWUUxtHgVJBx2NnCj46tdJ3+phGeilipQpxQYvcVimUseRWOpquDCYEGFlKIHIQh1MBKWxsFyp7ANzlWqhTw/L93VzDQbSJLBKd4/B0bJ87CLODZuXIjpnI2NnX42ijEB3n3o1G8efpj3PPPv6pcoEhFGr2otZghNZuCLJv3lJo/Fc+QyuUwdxgcH1DLzGVC1jVuXdsu4DrKSa42R1QWOf8dn/Awe2lCJUgmNzD57RwkG/L4qTFzeAHtwJ6uNWLj2s6g/OgMuJyp4+JzBH5yvojBPoG921y8cErqyn74uMOgLXQ2+bh/fxm25WI8W2IUJppULub4xfh0BpcmPocryjrzk3B0InztxPvMQdtkKbbUzsFt6GVANRaqdSjw6qiLm3p9/HG7h4q0cXS0gnJZYEObjX8MA+mUi9EskFsMeyNlf9+ET3ot9gzegY6GIrraW9DU4OgoPjE2gWMnP8Tdu3+LX1zfqwNhZQ4lsWg/n5kGDjM/Dg57uPuXPvZtT8FnTrmpsqb+zIKNw2+52gJSUyIoI6rU8u+fXHQwf+YNbPlZL24fGkQ+X8FHo6PobGnG5o1reC8PDlsrBqjKZURR2BtQAm+eJUzMA/tuALbxgWzmzxz3uSfO+jjyIVCoqJV+7KAieCbMFtuxpb8fo+Pj2NzdibNT01xWlvD7W4e0u6TvE0ejcBy71mVSnU7UdkOKqJPfOnj4dc4lVOETWSgx4SVzTIQAVPbRUbjcR6oxxfnrtq1bKDt1QRw59gFUnv/VDQPYvN50Karam+JrMnlY5Fbuh0joJEdBP6T6Qk+ksOTbTHg3yFlRI5LMuxR0npxGJvOtYlNPL3yfUwczvr+riy2QbGd831fg9KgFRCKoISEgMxDcKazuWM7qiGCJyGJh131qknB67At0tLSgMZPBkbffw6XcAmraPOXCakAUHZNiLYj5k6FNCNEAVmp54yJwRa5GY9s6HNj9Gxy86zbuAgjPvPIOLuaugK7y38uAyFSm4Ess/PBJPovlUdMvqVpBVd2ldLC+/1Y0ptNYlQL+ctdupJm1z776Nmbm88EnlpGEhbhFKiGKsO+tfdcmoZs5AYzPrtLJVDJnM5kUjezdiTRXgE/PfB3UP6rlUIn8J4kqc9euMMg7VRZZloCLDGp2IcURZ8FW2VlYor25iQ7euRM7bhzQ+S5oc5dbWnV55f9t5/bdm7vRsxfvJNvOWD+AR+q8HD7z6RfnbqL5/IgBG1301ef6OD2TRl+7a2jP+luamqM22Qq6x9BCdfAPsPfAS2u485k2ILiB0e5SCjzsGe7EH3Z1QNiS85hDumszTb8BYHKQGg/19/f/74eMcU3y8vN3zHAROaUKttpQJUnV8u7Z0cljNfdHvsq+OhkGn0MJQisJ5+sCSCuQeEEGH5cWA9h1SyuGb2lhRT7XXN2eULzNiEt8rn6AnPmnhPRUrGP45iYG1MwE9UjFlyV0wmS/WGFDlgCl5pjUuboCOvrcn6f4e3Rs11Azdg21MnmlbvBcjh5GBPN9SKG7qr86LvLtGfXsoI6yd6j13sHB9M3SK6k0KVQjolpuV7rk+7aocpeyiuoqC8yfR7Zu3XrtaefHlO8AA96ovNGXCxkAAAAASUVORK5CYII=",width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_google"},[r.c$.MICROSOFT]:{logo:(0,n.jsx)(a,{}),label:"flow_web_ext_sidebar_settings_translateservice_microsoft"},[r.c$.DEEPL]:{logo:(0,n.jsx)("img",{src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAPySURBVHgBzZh7SFNRHMe/V8t0c2pm1tbUWkZpIBbR448sDKR3WbMolWwlPVYzizIFTaUXPczSGqX4CAmxLLMHFpMwyuhNUiY1a5llSSRlL3Pudu7AaDndfQV94MLuvWeHL+f8zu/3/V2KJuA/oh8E0tb2GacqDfAe6IElc8Ph7OQEQdACKLtooIPCo2nPsRHWa+yMGPrcpWpaCBSfLbv/qAFJe/S497jB7vvpk0ORlZoAVYACXOEk6OOndmRmF6DkbBXMXZY+xzJbty4mEtq4RZD7+kBUQZ1mM7KPlyKn5Cw+t38FFxgxKdpYREdGwIlFfDkUZLhxD9v36mE0NUMIo1T+OJqZiImhweAl6Fljk1VIde19UBQFsVgyOxwpuhUYrhwK1oJyi8tJrBTiZ2cn/gXenjIkrFqKBE0UHApqNL3B+DkrHa6KVOKK7z86YLHwy6tSV1c8v14KicTN5nmPKGtt++RQTPL6GJhuluNOZT78FEPAh/Zv3/GFXH/DOa2q/ORIWh+L/v37IXC4Ejs2aSAmnAX96OiwuZ8QMgZKuS/EgrOgt60fkXYwD89emFBz6yEqqq7jctEBJMQthkWEOt0jqG89rMes2ERwwY+s0NY10ZhGSkbqgTxUGm5Yt9SFpvDVbP+kMofBSILa18fb5rngas/wuqUVuvRDCCLJT79nG6JmTsWUSeMwyMsDhwvPID0rn/VcAr2CLU9fNCFMrcUwhRw+Az2tp3UTyTVeMhnrOUQVZJ3QmYKx6c3ve6YOdtEW1v8XZcu6CQoMwLa10ai5/QDuUleM9FMiu7AM7V/YF2TegpiT0J0+PT3csXGFGotnT8ORgjKUlF9F0ekq8IGXoPjl87F62Tw0Njbjdl094pctQMWVGoRFbeC0GqII8h3kjX3JWjDVZfQIfwSPUSFyTQqek4AWA85BLXFzwZ+lrq7BKJoYu4L85YP77BxMze+wK6fI+vtlUwsyDhaAD1K3ASTwJT2e2/VDu3OKse9EKYnc3o+rM+VMfLUZlBN38yYh1iVDtxLxMQvZCWJ4RVYiZf9xXKquhVjQpFxERkzF7uR1UAyxb/wdeupzF64h82gxXja3QAgTQoKQtjEOYVNC+xzHquswm7ugL6lAbtFpvP/QBi7IZO7ISNQgTj1LnK7jT1ref8DO3JPWvsyRq2S2R0ssCZO5vUjiZAuvzpVpiXRpWah98KTXMTPDJqP0WAa4wqu4Mtb18sks5KTrevXUXFZFsKBuYtVzcLNcjy2apXAZ4GL7kmcrJ9h+eMikSN2swd3zeVCTzzFCEc0PBZBONH9vEgynsqFSKkDx7Nd4BTUb6uqNCAkOBFf+mSC+/AIWMfZBAp6MNgAAAABJRU5ErkJggg==",width:18,height:18}),label:"flow_web_ext_sidebar_settings_translateservice_deepl"}},d=[r.c$.HUOSHAN,r.c$.DOUBAO,r.c$.MICROSOFT]},79309:(e,t,s)=>{s.d(t,{$:()=>a});var i=s(11855),n=s(99277);const a=e=>{const[t,s]=(0,i.useState)(!1),[a,o]=(0,i.useState)({playing:!1,loading:!1}),r=(0,i.useRef)(null);(0,i.useEffect)((()=>{const e=()=>{r.current=new n.L,r.current.onLoadStart((()=>{o({loading:!0,playing:!1})})),r.current.onPlayStart((()=>{o({loading:!1,playing:!0})})),r.current.onPlayPause((()=>{o({loading:!1,playing:!1})})),r.current.onPlayEnd((()=>{o({loading:!1,playing:!1}),s(!1),e()}))};return e(),()=>{var e;null===(e=r.current)||void 0===e||e.destroy()}}),[e]);return{audioStatus:a,togglePlay:()=>{var i,n,a;t||(null===(n=r.current)||void 0===n||n.readText(e),null===(a=r.current)||void 0===a||a.finishSendingText(),s(!0));null===(i=r.current)||void 0===i||i.togglePlay()}}}},77259:(e,t,s)=>{s.d(t,{j:()=>o});var i=s(10633),n=s(75943),a=s(44969);const o=new class{constructor(){(0,i.A)(this,"containers",new Map)}getAssistantContainer(){return this.getContainerById(a.Yq)}getAssistantShadowContent(){return this.getShadowRootContainerByID(a.Yq)}getContainerById(e){var t;return null===(t=this.containers.get(e))||void 0===t?void 0:t.container}getShadowRootById(e){var t;return null===(t=this.containers.get(e))||void 0===t?void 0:t.shadowRoot}getShadowRootContainerByID(e){var t;return null===(t=this.containers.get(e))||void 0===t?void 0:t.shadowContent}getCommonPopupContainer(){return this.getShadowRootContainerByID("common-inner-popup-container")}getCommonPopupRootContainer(){return this.getContainerById("common-inner-popup-container")}recordAssistantContainer(e,t,s){this.recordContainer(a.Yq,e,t,s)}recordContainer(e,t,s,i){const n=this.containers.get(e)||{};Object.assign(n,{container:t}),s&&Object.assign(n,{shadowRoot:s}),i&&Object.assign(n,{shadowContent:i}),this.containers.set(e,n)}release(){this.containers.clear()}};(0,n.A)((()=>{o.release()}))},89669:(e,t,s)=>{s.d(t,{v:()=>c});var i=s(14065),n=s(88090),a=s(6522),o=s(76360),r=s(77191);const l=function(){var e=(0,i.A)((function*(e){try{const{infos:t}=yield(0,r.jI)(e);return t.map((e=>e.lang_code))}catch(t){}}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=(0,i.A)((function*(e=""){let t="";try{if(e.length<200){var s;t=(null===(s=yield l([e]))||void 0===s?void 0:s[0])||""}else{const s=yield(0,o.od)(e);var i;if(s.isReliable)t=s&&(0,a.S)(s)||"";else t=(null===(i=yield l([e]))||void 0===i?void 0:i[0])||""}}catch(r){return""}return(0,n.wz)(t)}));return function(){return e.apply(this,arguments)}}()},25218:(e,t,s)=>{s.d(t,{k:()=>o});var i=s(97724),n=s(77591),a=s(22074);const o=e=>{const t={user_context:{locale:(0,n.TK)("uiLanguage"),timezone:(0,a.O)()}};return(0,i.A)(t,e)}},46514:(e,t,s)=>{s.d(t,{_:()=>E,y:()=>R});var i=s(44557),n=s(72106),a=s(49392),o=s(44300),r=s(88090),l=s(21559),c=s(25218),d=s(94953),u=s(82770),h=s(6918),_=s(67976),g=s(67685),p=s(58980),m=s(12038),f=s(5842),v=s(77591),y=s(96638),b=s(74232),S=s(24337),A=s(12365),k=s(44969);const w=e=>{var t;const{prompt:s="search",language:n=navigator.language,answerWithSuggest:a=!1,replyLang:o,userQueryContent:l="",browser_language:u,browser_youtube_transcript:h,browser_plugin_info:_,flag_page_translate:g,browser_mail:m="",input_skill:f="",isUserCustomSkill:b=!1,contextText:S="",translateService:A=p.c$.HUOSHAN,sceneId:k}=e,w=null!==(t=(0,r.wz)((0,v.TK)("uiLanguage")))&&void 0!==t?t:navigator.language,E={origin:location.origin,stream:"1",answer_with_suggest:a?"1":"0",flag_browser_plugin:"1",browser_language:null!=o?o:w};if(S&&(E.samantha_context=JSON.stringify((0,c.k)({query_context:{web_content:S}}))),b)return(0,i.A)((0,i.A)({},E),{},{browser_plugin_info:JSON.stringify({frontend_source:"plugin",custom_prompt_skill_id:s,lang:null!=o?o:w})});if(s===y.EU.adjust_skill)return(0,i.A)((0,i.A)({},E),{},{browser_plugin_info:_||""});if(s===y.EU.youtube)return E.browser_plugin_info=e.browser_plugin_info||"",(0,i.A)((0,i.A)({},E),{},{browser_language:null!=u?u:w},h);let R="{}";return s===y.EU.translate?(E.browser_plugin_info=JSON.stringify({translate_service:(0,d.w)(A),frontend_source:"plugin",scene_id:k}),R=n):s===y.EU.ask?R=JSON.stringify({query:l}):s===y.EU.mail?R=m:s===y.EU.browser_plugin_info?R=_||"":s===y.EU.input_skill&&(R=f||""),(0,i.A)((0,i.A)({},E),{},{[s]:R,flag_page_translate:g?"1":"0"})};function E(e,t){var s,r,c;const{text:d="",prompt:p="search",replyId:E="",isRegenerate:R=!1,enter_chat_method:T,scene:M="",sec_scene:z,trackEvent:C=!0}=e,x=e.current_page||(0,m.M5)(location.href),L=(0,_.AP)(),U={id:L},B=(0,n.A)({translate_service:e.translateService},a.A),I=b.Qz.create("cici_stream_reply_perf");null==I||I.start("request_start");const O={event_type:1,message:{conversation_id:"0",section_id:"0",local_message_id:L,content_type:1,content:JSON.stringify({text:d}),reply_id:E,ext:w(e),local_conversation_id:"0",bot_id:null!==(s=null===(r=(0,v.ue)())||void 0===r?void 0:r.assistantBotId)&&void 0!==s?s:"7241547611541340167",meta_infos:[]}};var P,q;((null===(c=O.message)||void 0===c||null===(c=c.ext)||void 0===c?void 0:c.translate)===k.Zn&&(O.message.ext.translate=k.LN),(0,S.Rm)("sendMessage",O),R)&&(null!==(P=O.message)&&void 0!==P&&P.ext&&(O.message.ext.regen="1"));C&&(null===(q=u.Ay.Tea)||void 0===q||q.event("send_message",(0,i.A)({conversation_id:(0,f.IK)().convId,enter_chat_method:T,current_page:x,scene:M,sec_scene:z},B)));return A.B.fetch({req:{url:`https://${g.FI}/alice/message/stream_call_bot`,body:{payload:(0,o.lF)(JSON.stringify(O))}}},{id:L,onOpen:e=>{var s;Object.assign(U,e),null==I||I.mark("response_open"),null==t||null===(s=t.onOpen)||void 0===s||s.call(t,e,U)},onUpdate:e=>{var s,n;const{message_id:a="",reply_id:o="",content:r="{}"}=(null===(s=e.body)||void 0===s?void 0:s.message)||{};if("0"===o){var c,d;if(C)null===(d=u.Ay.Tea)||void 0===d||d.event("send_message_status",(0,i.A)({message_id:a,enter_chat_method:T,current_page:x,scene:M,sec_scene:z,success:1},B));return null==I||I.mark("response_first_message"),void(null==t||null===(c=t.onUpdate)||void 0===c||c.call(t,e,U))}let{text:h="",suggests:_=[]}=U;try{var g;const e=JSON.parse(r);e.text&&(h=`${h}${e.text}`),null!==(g=e.suggest)&&void 0!==g&&g.length&&(0===_.length&&(null==I||I.mark("response_first_suggest")),_=_.concat(e.suggest))}catch(p){l.vF.persist.info({eventName:"[SEARCH_CORE] - UPDATE",meta:(0,i.A)({},p)})}Object.assign(U,(0,i.A)((0,i.A)({},e),{},{text:h,suggests:_})),null==t||null===(n=t.onUpdate)||void 0===n||n.call(t,e,U)},onDone:s=>{var i,n,a,o;C&&(null===(a=u.Ay.Tea)||void 0===a||a.event("receive_stream",{message_id:null===(o=U.body)||void 0===o||null===(o=o.message)||void 0===o?void 0:o.message_id,message_type:"text",scene:M,success:1}));const r=p===y.EU.browser_plugin_info&&"search"===(0,h.O)(e.browser_plugin_info,{}).skill_name?"search":p;null==I||I.end("response_end",{prompt:r,hasSuggest:""+(null!=U&&null!==(i=U.suggests)&&void 0!==i&&i.length?1:0)}),null==t||null===(n=t.onDone)||void 0===n||n.call(t,s,U)},onError:e=>{var s,n,a;(l.vF.persist.info({eventName:"[SEARCH_CORE] - ERROR",meta:(0,i.A)({},new Error(`search error - id: ${U.id} - msg: ${U.text}`))}),C)&&(null===(n=u.Ay.Tea)||void 0===n||n.event("send_message_status",(0,i.A)({message_id:null===(a=U.body)||void 0===a||null===(a=a.message)||void 0===a?void 0:a.message_id,enter_chat_method:T,current_page:x,scene:M,sec_scene:z,success:0},B)));null==t||null===(s=t.onError)||void 0===s||s.call(t,e,U)},onAbort:e=>{var s;l.vF.persist.info({eventName:"[SEARCH_CORE] - ABORT",meta:(0,i.A)({},U)}),null==t||null===(s=t.onAbort)||void 0===s||s.call(t,e,U)}}),L}function R(e,t){A.B.abort(e,t)}},93476:(e,t,s)=>{s.d(t,{l:()=>d});var i=s(44557),n=s(34870),a=s(45498),o=s(56397),r=s(75943),l=s(44963);const c={isShowSidebar:!1,isShowSidebarBtn:!0,isShowSearch:!0,isShowQuick:!0,isShowLinkPreview:!0,isShowVideo:!0,enterSidebarMode:o.cz.default,showTip:!0,isSidePanelMode:!1,isShowReplyBtn:!0},d=(0,a.vt)()((0,n.eh)(((e,t)=>(0,i.A)((0,i.A)({},c),{},{setIsShowSidebar:(s,i)=>e((()=>t().isSidePanelMode?((0,l.c)(s?"open-side-panel":"close-side-panel"),{isShowSidebar:!1,enterSidebarMode:i}):{isShowSidebar:s,enterSidebarMode:i})),toggleShowSidebar:s=>e((e=>{if(t().isSidePanelMode)return(0,l.c)("toggle-side-panel"),{isShowSidebar:!1,enterSidebarMode:s};return{isShowSidebar:!e.isShowSidebar,enterSidebarMode:s}})),setIsShowSidebarBtn:t=>e((()=>({isShowSidebarBtn:t}))),setIsShowSearch:t=>e((()=>({isShowSearch:t}))),setIsShowQuick:t=>e((()=>({isShowQuick:t}))),setIsShowLinkPreview:t=>e((()=>({isShowLinkPreview:t}))),setIsShowVideo:t=>e((()=>({isShowVideo:t}))),setTipVisible:t=>e((()=>({showTip:t}))),setIsSidePanelMode:t=>e({isSidePanelMode:t}),setIsShowReplyBtn:t=>e({isShowReplyBtn:t})}))));r.m.getInstance().registerStore("useLayoutStore",d)},60296:(e,t,s)=>{s.d(t,{P:()=>g});var i=s(44557),n=s(34870),a=s(45498),o=s(81435),r=s(6918),l=s(24337),c=s(21559),d=s(2573),u=s(44969),h=s(46514);const _={messages:{},pushMessages:{}},g=(0,a.vt)()((0,n.eh)(((e,t)=>(0,i.A)((0,i.A)({},_),{},{sendMessage:s=>{const n=(0,h._)(s,{onOpen:t=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)((0,i.A)({},e.messages[n]),t),{},{isOpen:!0,originParam:s})})})))},onUpdate:t=>{e((e=>{var s;const{message_id:a="",reply_id:r="",content:l="{}",content_type:d}=(null===(s=t.body)||void 0===s?void 0:s.message)||{};var u;if("0"===r)return{pushMessages:(0,i.A)((0,i.A)({},e.pushMessages),{},{[a]:null===(u=t.body)||void 0===u?void 0:u.message})};let h={};var _;e.pushMessages[a]||(h=(0,i.A)((0,i.A)({},e.pushMessages),{},{[a]:null===(_=t.body)||void 0===_?void 0:_.message}));let{text:g="",suggests:p=[],searchCardData:m={}}=e.messages[n]||{};try{const e=JSON.parse(l);var f;if(d===o.cM.PluginSearchResult)m=e;else e.text&&(g=`${g}${e.text}`),null!==(f=e.suggest)&&void 0!==f&&f.length&&(p=p.concat(e.suggest))}catch(v){c.vF.persist.error({message:"parse message content error",error:v})}return(0,i.A)({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)((0,i.A)({},e.messages[n]),t),{},{text:g,suggests:p,searchCardData:m})})},h)}))},onDone:()=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)({},e.messages[n]),{},{isDone:!0})})})))},onError:({code:t,message:a})=>{var o;const c=`${null===(o=(0,r.O)(a,""))||void 0===o?void 0:o.code}`,h=[u.BW,u.Be].some((e=>e===c));h&&d.A.emit("stream-call-bot-unAuthorized",{params:s,resMessage:a}),(0,l.Rm)("stream call bot error: ",a,t),e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)({},e.messages[n]),{},{code:t,message:a,isError:!0,isUnAuthorized:h})})})))},onAbort:()=>{e((e=>({messages:(0,i.A)((0,i.A)({},e.messages),{},{[n]:(0,i.A)((0,i.A)({},e.messages[n]),{},{isAborted:!0})})})))}});return e((()=>({messages:(0,i.A)((0,i.A)({},t().messages),{},{[n]:{id:n,isOpen:!1,isDone:!1,isError:!1,isAborted:!1,isUnAuthorized:!1,text:"",suggest:[]}})}))),n},abortMessage:(s,n)=>{const a=t().messages[s];!a||null!=a&&a.isAborted||null!=a&&a.isDone||null!=a&&a.isError||((0,h.y)(s,n),e((()=>({messages:(0,i.A)((0,i.A)({},t().messages),{},{[s]:{id:s,isAborted:!0}})}))))}}))))},97311:(e,t,s)=>{s.d(t,{_o:()=>a,g6:()=>i,sJ:()=>n});let i=function(e){return e.search_engine="search_engine",e.chat="chat",e.welcome="extension_welcome",e.landing="landing",e.setting="setting",e.web_otherpage="web_otherpage",e}({}),n=function(e){return e.search_engine="search_engine",e.search_related_suggested_prompt="search_related_suggested_prompt",e.highlight_search_result_tool="highlight_search_result_tool",e.highlight_search_result_tool_edit="highlight_search_result_tool_edit",e.chat_action_bar="chat_action_bar",e.suggested_prompts="suggested_prompts",e.onboarding_suggestion="onboarding_suggestion",e.resend="resend",e.edit="edit",e.side_bar_popover_summarize="side_bar_popover_summarize",e.highlight_search_result_go_chat="highlight_search_result_go_chat",e.side_bar_popover_click="side_bar_popover_click",e.webpage_sidebar_link="webpage_sidebar_link",e.video_click="video_click",e.video_go_chat="video_go_chat",e.highlight_in_siderbar_chat="highlight_in_siderbar_chat",e.mail="mail",e.podcast="podcast",e.writing_assistant="writing_assistant",e.link_preview="link_preview",e.translate_card="translate_card",e}({}),a=function(e){return e.highlight_search_result_ask="highlight_search_result_ask",e.highlight_search_result_translate="highlight_search_result_translate",e.side_bar_popover_click_summarize="side_bar_popover_click_summarize",e.side_bar_popover_click_translate="side_bar_popover_click_translate",e.webpage_sidebar_link_summarize="webpage_sidebar_link_summarize",e.video_click_summarize="video_click_summarize",e.video_go_chat="video_go_chat",e.highlight_in_sidebar_chat_explain="highlight_in_sidebar_chat_explain",e.highlight_in_sidebar_chat_translate="highlight_in_sidebar_chat_translate",e.podcast_click_summary="podcast_click_summary",e.mind_note="mind_note",e.video_highlight_tag_click="video_highlight_tag_click",e.podcast_highlight_tag_click="podcast_highlight_tag_click",e}({})},82275:(e,t,s)=>{s.d(t,{K:()=>i});let i=function(e){return e.UPPER_RIGHT="upper_right",e.SUBSCRIBED="subscribed",e.ONBOARDING="onboarding",e.IMMERSION_FULLSCREEN_BTN="fullscreen_click",e.VIDEO_DB_CLICK="video_dbclick",e.IMMERSION_FULLSCREEN_SHORT_CUT="shortcut",e.IMMERSION_BTN="immersion_click",e.WATCH_RELAY="watch_relay",e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e}({})},6522:(e,t,s)=>{s.d(t,{S:()=>n});var i=s(48485);function n(e,t=70){const{languages:s,isReliable:n}=e;if(!n)return;const a=(0,i.A)(s,(e=>e.percentage>=t));return a?a.language:void 0}},6918:(e,t,s)=>{s.d(t,{O:()=>i});const i=(e,t)=>{try{return e?JSON.parse(e):t}catch(s){return t}}},12312:(e,t,s)=>{s.d(t,{M:()=>r,u:()=>d});var i=s(77793),n=s(52289),a=s(24693);const o=["block","flow-root","grid","list-item","flex","-webkit-box","table","table-row-group","table-row"],r=e=>{const t=(0,i.A)();e.setAttribute("data-cici-select-uid",t);for(const s of e.children)r(s)};function l(e){const t=(0,n.D6)(e);return o.includes((null==t?void 0:t.display)||"inline")||"br"===e.tagName.toLowerCase()}function c(e){for(const t of e.children){if(l(t))return!0;if(t.children.length>0)return c(t)}return!1}const d=e=>{const t=[];let s=[];return function e(i){for(const n of i)(0,a.mp)(n)&&(n instanceof Text&&(/^[\n\s]*$/.test(n.textContent||"")||s.push(n)),n instanceof Element&&(l(n)&&!c(n)?(s.push(n),t.push(s),s=[]):c(n)?e(Array.from(n.childNodes)):(/^[\n\s]|[\n\s]*$/.test(n.textContent||"")&&s.length>0&&(t.push(s),s=[]),s.push(n))))}(e),s.length&&t.push(s),t}},99277:(e,t,s)=>{s.d(t,{L:()=>g});var i=s(14065),n=s(10633),a=s(77793),o=s(64747),r=s(76021);const l=e=>new Promise((t=>{setTimeout(t,e)}));class c{constructor(){var e=this;(0,n.A)(this,"looping",!1),(0,n.A)(this,"stopped",!1),(0,n.A)(this,"startTime",0),(0,n.A)(this,"stopReason",""),(0,n.A)(this,"played",!1),(0,n.A)(this,"paused",!0),(0,n.A)(this,"destroyed",!1),(0,n.A)(this,"audioCtx",void 0),(0,n.A)(this,"errorBufferIndex",-1),(0,n.A)(this,"handlePlayEnd",void 0),(0,n.A)(this,"handlePlayStart",void 0),(0,n.A)(this,"handleFirstPlayStart",void 0),(0,n.A)(this,"handlePlayPause",void 0),(0,n.A)(this,"handleLoadStart",void 0),(0,n.A)(this,"handleTextChange",void 0),(0,n.A)(this,"textList",[]),(0,n.A)(this,"audioDataList",[]),(0,n.A)(this,"totalBufferCount",-1),(0,n.A)(this,"currentDataOrder",0),(0,n.A)(this,"trySuspend",(()=>{try{var e;null===(e=this.audioCtx)||void 0===e||e.suspend()}catch(t){}})),(0,n.A)(this,"handleBufferEnd",(e=>{var t;if(!this.stopped){var s,i,n,a;if(null===(t=this.handleTextChange)||void 0===t||t.call(this,this.textList[e+1]),this.errorBufferIndex>=0&&e===this.errorBufferIndex-1)return this.paused=!0,null===(s=this.audioCtx)||void 0===s||s.close(),void(null===(i=this.handlePlayEnd)||void 0===i||i.call(this,this.stopReason));if(e===this.totalBufferCount-1)this.paused=!0,null===(n=this.audioCtx)||void 0===n||n.close(),null===(a=this.handlePlayEnd)||void 0===a||a.call(this,this.stopReason)}})),(0,n.A)(this,"playAudioBuffer",((e,t,s)=>{if(this.stopped)return!1;const i=e.createBufferSource();if(i.buffer=t,i.loop=!1,i.onended=()=>{this.handleBufferEnd(s)},this.paused||this.stopped)return!1;var n,a,o;(i.connect(e.destination),i.start(this.startTime),0===this.startTime)&&(this.played=!0,null===(n=this.handlePlayStart)||void 0===n||n.call(this),null===(a=this.handleTextChange)||void 0===a||a.call(this,this.textList[0]),null===(o=this.handleFirstPlayStart)||void 0===o||o.call(this));return this.startTime+=t.duration,!0})),(0,n.A)(this,"loopPlay",(0,i.A)((function*(){if(e.looping||e.stopped||e.destroyed)return;if(e.looping=!0,e.totalBufferCount===e.currentDataOrder)return void(e.looping=!1);if(e.audioDataList.length<=e.currentDataOrder)return yield l(300),e.looping=!1,void e.loopPlay();const t=e.audioDataList[e.currentDataOrder];e.audioCtx||(e.audioCtx=new AudioContext);let s=null;if(t.audioData)s=t.audioData;else try{s=yield e.audioCtx.decodeAudioData(t.buffer)}catch(i){return 0===e.currentDataOrder&&e.stop("error"),e.errorBufferIndex=e.currentDataOrder,void(e.looping=!1)}if(!s)return e.errorBufferIndex=e.currentDataOrder,void(e.looping=!1);t.audioData=s;if(!e.playAudioBuffer(e.audioCtx,s,e.currentDataOrder))return yield l(300),e.looping=!1,void e.loopPlay();e.currentDataOrder+=1,e.looping=!1,e.loopPlay()}))),(0,n.A)(this,"addData",((e,t)=>{this.stopped||this.destroyed||(this.textList.push(t),this.audioDataList.push({order:this.audioDataList.length,buffer:e}))})),(0,n.A)(this,"reset",(()=>{this.audioDataList=[],this.totalBufferCount=0,this.handlePlayEnd=void 0,this.paused=!0,this.played=!1;try{var e,t;null===(e=this.audioCtx)||void 0===e||e.suspend(),null===(t=this.audioCtx)||void 0===t||t.close()}catch(s){}this.audioCtx=void 0})),(0,n.A)(this,"togglePlay",(()=>{this.paused?this.play():this.pause()})),(0,n.A)(this,"play",(0,i.A)((function*(){var t,s,i;if(e.stopped)throw new Error("[AudioStreamManager] STOPPED. please use new instance");if(e.destroyed)throw new Error("[AudioStreamManager] DESTROYED. please use new instance");e.played?null===(s=e.handlePlayStart)||void 0===s||s.call(e):null===(i=e.handleLoadStart)||void 0===i||i.call(e);e.paused=!1,null===(t=e.audioCtx)||void 0===t||t.resume(),yield e.loopPlay()}))),(0,n.A)(this,"pause",(()=>{var e;this.paused=!0,this.trySuspend(),null===(e=this.handlePlayPause)||void 0===e||e.call(this)})),(0,n.A)(this,"stop",((e="")=>{var t;this.stopReason=e,this.stopped=!0,this.trySuspend(),null===(t=this.handlePlayEnd)||void 0===t||t.call(this,e)})),(0,n.A)(this,"onLoadStart",(e=>{this.handleLoadStart=e})),(0,n.A)(this,"onPlayEnd",(e=>{this.handlePlayEnd=(0,r.A)(e)})),(0,n.A)(this,"onCurrentText",(e=>{this.handleTextChange=e})),(0,n.A)(this,"onPlayStart",(e=>{this.handlePlayStart=e})),(0,n.A)(this,"onFirstPlayStart",(e=>{this.handleFirstPlayStart=e})),(0,n.A)(this,"onPlayPause",(e=>{this.handlePlayPause=e})),(0,n.A)(this,"setTotalBufferCount",(e=>{this.totalBufferCount=e})),(0,n.A)(this,"destroy",(()=>{this.reset(),this.destroyed=!0}))}}var d=s(54422),u=s(16409),h=s(20825);class _{constructor(e){var t=this;(0,n.A)(this,"id",""),(0,n.A)(this,"running",!1),(0,n.A)(this,"finished",!1),(0,n.A)(this,"speakerId",""),(0,n.A)(this,"handleStartSuccess",void 0),(0,n.A)(this,"msgCallback",void 0),(0,n.A)(this,"stopFetchSound",(0,i.A)((function*(){yield(0,u.cs)({name:d.ut,body:{receiverId:t.id}}),t.running=!1}))),(0,n.A)(this,"startFetchSound",(0,i.A)((function*(){var e;if(t.finished)throw new Error("REQUEST TTS FINISHED, PLZ USE NEW INSTANCE");const{success:s}=yield(0,u.cs)({name:d.sp,body:{receiverId:t.id,speakerId:t.speakerId,scene:h._K.isInSidePanel?"sidepanel":"content-script"}});if(!s)throw new Error("REQUEST TTS SEND TO BACKGROUND ERROR");t.running=!0,null===(e=t.handleStartSuccess)||void 0===e||e.call(t),o.s.on(t.id,t.msgCallback)}))),(0,n.A)(this,"sendText",(e=>(0,u.cs)({name:d.Cm,body:{text:e,receiverId:this.id,scene:h._K.isInSidePanel?"sidepanel":"content-script"}}))),(0,n.A)(this,"readText",function(){var e=(0,i.A)((function*(e,s){t.running||(t.msgCallback=s,yield t.startFetchSound()),yield t.sendText(e)}));return function(t,s){return e.apply(this,arguments)}}()),(0,n.A)(this,"reset",(0,i.A)((function*(){yield t.stopFetchSound(),t.msgCallback=void 0}))),this.id=e}setSpeakerId(e){this.speakerId=e}finish(){this.running?(this.finished=!0,(0,u.cs)({name:d.dZ,body:{receiverId:this.id,scene:h._K.isInSidePanel?"sidepanel":"content-script"}})):this.handleStartSuccess=this.finish}}class g{constructor(){var e=this;(0,n.A)(this,"id",void 0),(0,n.A)(this,"running",!1),(0,n.A)(this,"audioPlayer",new c),(0,n.A)(this,"speakerId",""),(0,n.A)(this,"finished",!1),(0,n.A)(this,"audioStreamLoader",void 0),(0,n.A)(this,"handleStreamUpdate",function(){var t=(0,i.A)((function*(t,s){const i=yield fetch(t),n=yield i.arrayBuffer();e.audioPlayer.addData(n,s)}));return function(e,s){return t.apply(this,arguments)}}()),(0,n.A)(this,"handleStreamEnd",(e=>{this.audioPlayer.setTotalBufferCount(e)})),(0,n.A)(this,"handleAudioData",(e=>{const{type:t,content:s}=e;if("update"===t){const{url:e,text:t}=s;this.handleStreamUpdate(e,t||"")}"finished"===t&&this.handleStreamEnd(s),"error"===t&&this.stop("error")})),(0,n.A)(this,"stopOtherAudios",(()=>{(0,u.cs)({name:d.ri,body:{id:this.id,scene:h._K.isInSidePanel?"sidepanel":"content-script"}}),this.stopAllOtherAudios()})),(0,n.A)(this,"readText",function(){var t=(0,i.A)((function*(t){if(e.finished)throw new Error("[AudioStreamManager] FINISHED, PLZ USE NEW INSTANCE");e.running=!0,e.audioStreamLoader.setSpeakerId(e.speakerId),yield e.audioStreamLoader.readText(t,e.handleAudioData)}));return function(e){return t.apply(this,arguments)}}()),(0,n.A)(this,"finishSendingText",(()=>{this.finished=!0,this.audioStreamLoader.finish()})),(0,n.A)(this,"destroy",(()=>{this.stop(),this.audioPlayer.destroy()})),(0,n.A)(this,"setSpeaker",(e=>{this.speakerId=e})),(0,n.A)(this,"play",(0,i.A)((function*(){e.stopOtherAudios(),yield e.audioPlayer.play()}))),(0,n.A)(this,"togglePlay",(()=>{this.stopOtherAudios(),this.audioPlayer.togglePlay()})),(0,n.A)(this,"pause",(()=>{this.audioPlayer.pause()})),(0,n.A)(this,"stop",((e="")=>{this.running&&(this.audioPlayer.stop(e),this.audioStreamLoader.reset(),this.id=(0,a.A)(),this.audioStreamLoader=new _(this.id))})),(0,n.A)(this,"stopAllOtherAudios",(()=>{(0,u.cs)({name:d.lO,body:{id:this.id}})})),(0,n.A)(this,"onPlayEnd",this.audioPlayer.onPlayEnd),(0,n.A)(this,"onPlayStart",this.audioPlayer.onPlayStart),(0,n.A)(this,"onFirstPlayStart",this.audioPlayer.onFirstPlayStart),(0,n.A)(this,"onLoadStart",this.audioPlayer.onLoadStart),(0,n.A)(this,"onPlayPause",this.audioPlayer.onPlayPause),(0,n.A)(this,"onCurrentText",this.audioPlayer.onCurrentText),this.id=(0,a.A)(),o.s.on(this.id,(e=>{"stop"===e.type&&this.stop("interrupted")})),this.audioStreamLoader=new _(this.id)}}},64747:(e,t,s)=>{s.d(t,{s:()=>i});const i=new(s(60588).A)},60313:(e,t,s)=>{s.d(t,{Y:()=>n});var i=s(77591);const n=()=>{const e=(0,i.TK)("uuid");if(e)return e;const t=(()=>{const e=Math.floor(1e8+9e8*Math.random()),t=Math.floor(1e8+9e8*Math.random());return String(e)+String(t)})();return(0,i.vE)("uuid",t),t}},80483:(e,t,s)=>{s.d(t,{n:()=>i});const i=e=>{var t;return(null==e||null===(t=e._meta)||void 0===t?void 0:t.logId)||""}},1524:(e,t,s)=>{s.d(t,{CB:()=>l,Qo:()=>r,cL:()=>o});var i=s(90895),n=s(75484),a=s(1713);const o=e=>(0,i.tY)(n.pU.getState(),e),r=(e,t)=>(0,i.Xc)(n.pU.getState(),e,t),l=(e="",t,s,i)=>(0,a.D)(n.pU.getState(),e,t,s,i)},1713:(e,t,s)=>{s.d(t,{D:()=>l});var i=s(14587),n=s(90895),a=s(29537);const o=(e,t)=>{if(t)return t===e;const s=a.Xy.get("chatConfigService");return(null==s?void 0:s.userId)===e};let r=function(e){return e.default="default",e.defaultNew="default_new",e.otherDefault="other_default",e.selfCreated="self_created",e.othersCreated="others_created",e}({});const l=(e,t,s,a,l)=>{var c,d;const{conversation:u,botInfo:h}=(0,n.tY)(e,s);return(0,i.if)(u)||(0,i.Sx)(l)?r.default:(0,i.aj)(u)||(0,i.i1)(l)?r.defaultNew:o((null==u||null===(c=u.bot_creator_info)||void 0===c?void 0:c.creator_id)||"",t)||o((null==a||null===(d=a.creator_info)||void 0===d?void 0:d.creator_id)||"",t)?r.selfCreated:(0,i.vM)(null==u?void 0:u.bot_type)||(0,i.vM)(null==h?void 0:h.bot_type)||(0,i.vM)(null==a?void 0:a.bot_type)?r.othersCreated:(0,i.dG)(null==u?void 0:u.bot_type)||(0,i.dG)(null==h?void 0:h.bot_type)||(0,i.dG)(null==a?void 0:a.bot_type)?r.otherDefault:(0,i.AU)(null==h?void 0:h.bot_type)||(0,i.AU)(null==a?void 0:a.bot_type)?r.default:""}},42265:(e,t,s)=>{s.d(t,{C:()=>f});var i=s(44557),n=s(2633),a=s(77526),o=s(49392),r=s(58447),l=s(69406),c=s(13242),d=s(52525),u=s(57756),h=s(78014);var _=s(45091),g=s(75484),p=s(78821),m=s(14587);const f=(e,t)=>{const s=c.BN.getState(),f=(0,a.p8b)((0,a.c89)(e));if(!f)return;const v=f[0].resolved.conversationId||"",{isRegenerate:y}=f[0].resolved;if(f.some((({ctx:e,resolved:t})=>(0,a.Azp)({ctx:e,resolved:t},g.pU.getState()))))return;const b=(0,p.Gl)(g.pU.getState(),v)||(0,p.VN)(g.pU.getState(),v);if(b&&(0,m.gm)(b,t.chatType)){const t=(0,_._)(e),a=s.activeSkillTypeMap[v];(0,n.A)(t)?f&&!y&&f.forEach((e=>{e.resolved.localCreateExt=(0,i.A)((0,i.A)({},(({conversationId:e})=>{var t;const s=(0,l.Y)(c.BN.getState(),r.K9.ReadPDF),n=null===(t=(0,d.R)(u.vf.getState(),e))||void 0===t?void 0:t.refContents;if(!n)return{};const a={};if(!(0,o.A)(s)){const e=(0,i.A)({skill_id:s,skill_type:r.K9.ReadPDF},(0,h.hg)(n[0])?{template_key:"query_with_reference",variables:{reference_text:n[0].text}}:{});a.input_skill=JSON.stringify(e)}return a})({conversationId:v})),e.resolved.localCreateExt)})):u.vf.getState().setRefContents({refContents:t,channel:a?`skill_${a}`:"default"},v)}(0,a.vmW)(f,t)}},69406:(e,t,s)=>{s.d(t,{Y:()=>i});const i=(e,t)=>t.toString()},57756:(e,t,s)=>{s.d(t,{vf:()=>l});var i=s(34870),n=s(45498),a=s(44557),o=s(98502);const r={refContentMap:{}},l=(0,n.vt)()((0,i.eh)(((e,t)=>(0,a.A)((0,a.A)({},r),{},{setRefContents:(s,i)=>{const{refContents:n,channel:a,source:r}=s;0!==n.length?e((0,o.jM)((e=>{e.refContentMap[i]={refContents:n,channel:a,source:r}}))):t().clearRefContents(i)},clearRefContents:t=>{e((0,o.jM)((e=>{delete e.refContentMap[t]})))},moveRefContents:(t,s)=>{e((0,o.jM)((i=>{const n=i.refContentMap[t];n&&(i.refContentMap[s]=n,setTimeout((()=>{e((0,o.jM)((e=>{delete e.refContentMap[t]})))}),3e4))})))}}))))},52525:(e,t,s)=>{s.d(t,{R:()=>n});var i=s(2633);const n=(e,t)=>{const s=e.refContentMap[t];if(s&&!(0,i.A)(s.refContents))return s}},45091:(e,t,s)=>{s.d(t,{_:()=>h});var i=s(35754),n=s(36225),a=s(77526),o=s(69902);const r=e=>{if("image_key"in e)return{type:"attachment",fileKey:e.image_key,fileName:"Image"};if("image"in e&&e.local_key){const t=(0,a.mf0)(a.ozw.getState(),e.local_key);if(t)return{type:"attachment",fileKey:t,fileName:(0,o.p)("name")(e.image)||"Image"}}},l=e=>{if("file_key"in e){const t=e.file_name||"";return{type:"attachment",fileKey:e.file_key,fileName:t||"File"}}if("file"in e&&e.local_key){const t=(0,o.p)("name")(e.file),s=(0,a.mf0)(a.ozw.getState(),e.local_key);if(!s)return;return{type:"attachment",fileKey:s,fileName:t||"File"}}},c=e=>{const{images:t}=e.compositeContent;if(0===t.length)return;const s=t[0];if("key"in s)return{type:"attachment",fileKey:s.key,fileName:"Image"};if("blob"in s&&s.local_key){const e=(0,a.mf0)(a.ozw.getState(),s.local_key);if(!e)return;return{type:"attachment",fileKey:e,fileName:(0,o.p)("name")(s.blob)||"Image"}}},d=e=>{const{files:t}=e.compositeContent;if(0===t.length)return;const s=t[0];if("key"in s){const e="file_name"in s&&s.file_name||"";return{type:"attachment",fileKey:s.key,fileName:e||"File"}}if("blob"in s&&s.local_key){const e=(0,o.p)("name")(s.blob),t=(0,a.mf0)(a.ozw.getState(),s.local_key);if(!t)return;return{type:"attachment",fileKey:t,fileName:e||"File"}}},u=e=>{const{enableRefContent:t=!0}=e;return t?(0,a.JGj)(e)?[r(e)].filter(n.q3):(0,a.QP5)(e)?[l(e)].filter(n.q3):(0,a.frm)(e)?[c(e)].filter(n.q3):(0,a.kkt)(e)?[d(e)].filter(n.q3):(0,a.YVR)(e)?(e=>{const{links:t}=e.compositeContent;return t.map((e=>({type:"link",link:e})))})(e):(0,a.BuH)(e)?(e=>e.nestedItems.map((e=>({type:"attachment",fileName:e.fileName,fileKey:e.fileKey}))).filter(n.q3))(e):(0,a.HZ9)(e)?(e=>{const{websites:t}=e.compositeContent;return t.map((e=>({type:"link",link:e.url})))})(e):[]:[]},h=e=>(0,i.A)(e.map((e=>u(e))))},60100:(e,t,s)=>{s.d(t,{$2:()=>y,Az:()=>p,Qe:()=>f,aK:()=>v,uV:()=>_,yz:()=>g,zO:()=>b});var i=s(44557),n=s(94654),a=s(81435),o=s(82854),r=s(46219),l=s(81626),c=s(75484),d=s(37357),u=s(73014),h=s(10129);const _=()=>(0,n.A)(),g=({ctx:{conversationId:e,localConversationId:t}})=>{const s=t||e;if(!s)throw new Error("conversationId is empty");return s},p=({ctx:e,resolved:t},s=c.pU.getState())=>{const{cancelReason:i}=m({store:o.ozw.getState(),conversation:s.conversationMap[t.conversationId]});if(i)return d.v.persist.info({eventName:"send_message_cancel",meta:{local_message_id:t.localMessageId,from:h.aU.Socket,conversation_id:e.conversationId,conversation_type:e.conversationType,reason:i}}),Boolean(i)},m=({store:e,conversation:t})=>{const s=u.gO.get("chatBotService"),i=null!=t&&t.bot_id?null==s?void 0:s.getBot(t.bot_id):{};return null!=i&&i.disabled?{cancelReason:"bot deleted"}:e.rateLimitConfig.isLimited?{cancelReason:"rate limit"}:{}};function f({conversationId:e,store:t}){const{lastAvailableMessageLink:s}=(0,l.to)(e);null!=s&&s.regen_head&&t.updateMessageList({conversationId:e,immerUpdate(e){const{draftMessageLinks:t,draftRegenerateMessageMap:i,draftMessageMap:n,draftLocalMessageMap:a}=e,r=(0,o.A4i)({localMessageMap:a,messageMap:n});t.forEach((t=>{if(t.regen_head===s.regen_head){var n;delete t.regen_head,(null===(n=i.messageMap)||void 0===n?void 0:n[t.messageId])&&delete i.messageMap[t.messageId];const s=t.isLocalMessage?r(t):void 0;s&&(0,o.HN1)(s)&&(0,o.kap)(e,t)}}))}})}const v=(e,t)=>{const{resolved:s,reportParams:{scene:n}}=e,{replace:a,remove:r,regenerate:c,resume:d}=e.operation||{},h=u.gO.get("chatConfigService"),_=function({conversationId:e,store:t}){var s;const i=(0,l.WP)(e);if(!i)return;if((0,o.Jij)(i))return;const n=(0,o.WZZ)(t.messageLinkMap[e],(s=>Boolean(s.regen_head)&&(0,o.$4u)((0,l.Tc)(e,s,t))));return!n||null!=n&&n.isLocalMessage||(null===(s=(0,l.Tc)(e,n,t))||void 0===s?void 0:s.reply_id)!==i.reply_id?void 0:n.messageId}({store:t,conversationId:s.conversationId});return(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({stream:"1"},(null==h?void 0:h.featureGating.answerWithSuggest)&&{answer_with_suggest:"1"}),(null==h?void 0:h.featureGating.namedEntityHighlight)&&{wiki:"2"}),(null==h?void 0:h.featureGating.answerWithVideo)&&{media_search_type:"1"}),a?{replace:"1"}:{}),r?{delete:"1"}:{}),c?{regen:"1"}:{}),d?{resume:"1"}:{}),a||d||r||c||!_?{}:{lastRegenerateSelectedMessageId:_}),"onboarding_suggestion"===n?{onboarding_v2:"1"}:{}),"keyboard_unlog"===n?{scene:n}:{}),s.localCreateExt)},y=(e,t)=>{var s;return t?null===(s=e.find((({resolved:e})=>{return(null==(s=e)||null===(i=s.local_content)||void 0===i?void 0:i.preprocess_key)===t;var s,i})))||void 0===s?void 0:s.resolved.localMessageId:void 0},b=(e,t)=>e?Date.now()+r.hn:t!==a.cM.File?Date.now()+r._q:void 0},19664:(e,t,s)=>{s.d(t,{c:()=>o});var i=s(35754),n=s(82854),a=s(82205);const o=e=>{const t=n.ozw.getState();return(0,i.A)(e.map((e=>{var s;const{conversationId:i}=e.ctx;if(!i)return e;if(e.operation&&"replace"in e.operation&&null!==(s=e.operation.replace)&&void 0!==s&&s.messageLink){var o,r;const s=(0,a.Tc)(i,null===(o=e.operation)||void 0===o||null===(o=o.replace)||void 0===o?void 0:o.messageLink,t),l=null==s||null===(r=s.ext)||void 0===r?void 0:r.collection_id;if(!l||!(0,n.pu_)(s))return e;const c=t.messageLinkMap[i],d=t.messageMap[i];return c.filter((e=>{var s;return(0,n.c84)(d[e.messageId],t.userInfo.secUserId)&&(null===(s=d[e.messageId])||void 0===s||null===(s=s.ext)||void 0===s?void 0:s.collection_id)===l})).map((t=>t.messageId===s.message_id?e:{ctx:e.ctx,reportParams:e.reportParams,operation:{replace:{messageLink:t}}}))}return e})))}},68005:(e,t,s)=>{s.d(t,{O:()=>o});var i=s(14065),n=s(17834),a=s(73014);const o=function(){var e=(0,i.A)((function*(){const e=a.gO.get("chatConfigService"),t=a.gO.get("chatTeaService");if(!e||!t)return;return yield(0,n.Mz)({key:"enable_samantha_protocol_stage",featureGatingKey:"enableSamanthaProtocolStage",defaultValue:-1,chatConfigService:e,chatTeaService:t})}));return function(){return e.apply(this,arguments)}}()},69424:(e,t,s)=>{s.d(t,{p:()=>z});var i=s(44557),n=s(76398),a=s(2633),o=s(35754),r=s(92431),l=s(94654),c=s(69902),d=s(36225),u=s(37357),h=s(81435),_=s(69052),g=s(60100),p=s(82854),m=s(81626),f=s(1524),v=s(34558),y=s(73014),b=s(20661),S=s(72041);const A={onboarding_first_met:"onboarding_first_met_sug",onboarding_welcome_back:"onboarding_welcome_back_sug"},k=e=>{const{blob:t,type:s,from:i,store:n,botId:a,localKey:o,localMessageId:r}=e;var l;if(o)return{localKey:o,key:(null===(l=n.preprocessTaskMap[o])||void 0===l?void 0:l.key)||""};{const e=n.preprocessFile(t,s,{moduleActionId:"",conversationId:"",chatType:"other_default",skillType:0,skillId:"",uploadFrom:"upload_pinbutton",botId:a,from:i,uploadCollectionWay:"single",uploadId:r,uploadWay:"browse folder"},{preHandle:{version:"pre_handle"}});return{localKey:e.local_key,key:e.key}}},w={parseTextPayload:(e,t,s)=>({content_type:h.cM.Text,content_obj:{text:e.text.trim()},isReady:!0,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:s})}),parseImagePayload:(e,t,s,n,a)=>{const o=[];let r,l=!1;if("image_key"in e)o.push({key:e.image_key,image_ori:e.image_ori,image_thumb:e.image_thumb}),l=!0;else{const{localKey:i,key:n}=k({type:"image",blob:e.image,localKey:e.local_key,botId:s,store:t,from:e.reportParams.from,localMessageId:a});o.push({key:n}),r={preprocess_key:i},l=Boolean(n)}return{content_type:h.cM.Image,content_obj:{image_list:o},isReady:l,local_content:r,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:n})}},parseFilePayload:(e,t,s,n,a)=>{const o=[];let r,l=!1;if("file_key"in e)o.push({file_name:e.file_name,key:e.file_key}),l=!0;else{const{localKey:i,key:n}=k({type:"file",blob:e.file,localKey:e.local_key,botId:s,store:t,from:e.reportParams.from,localMessageId:a});o.push({file_name:(0,c.p)("name")(e.file),key:n||""}),r={preprocess_key:i},l=Boolean(n)}return{content_type:h.cM.File,content_obj:{file_list:o},isReady:l,local_content:r,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:n})}},parseCompositePayload:(e,t,s,n,a)=>{let o,r=!0;const l=e=>{const i=[];return e.forEach(((e,n)=>{if("key"in e)i.push(e);else{const{localKey:l,key:d}=k({type:"file",blob:e.blob,localKey:e.local_key,botId:s,store:t,from:e.from,localMessageId:a});i.push({file_name:(0,c.p)("name")(e.blob),key:d||""}),0===n&&(o={preprocess_key:l}),r&&(r=Boolean(d))}})),i};return{content_obj:(0,_.fr)(e)?{text:e.compositeContent.text,image_model:{image_list:l(e.compositeContent.images)}}:(0,_.kk)(e)?{text:e.compositeContent.text,file_model:{file_list:l(e.compositeContent.files)}}:(0,_.YV)(e)?{text:e.compositeContent.text,link_model:{url:e.compositeContent.links[0]}}:(0,_.HZ)(e)?{text:e.compositeContent.text,website_model:{pages:e.compositeContent.websites}}:{},content_type:h.cM.Composite,isReady:r,local_content:o,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:n})}},parseNestedPayload:(e,t)=>{const{nestedItems:s,text:n}=e,a=s.map((e=>{if(e.type===S.WR.Image){return{entity_type:e.type,entity_content:{image:e.image||{}},identifier:e.identifier,file_parse_state:e.parseState,file_name_state:e.reviewState}}return{entity_type:S.WR.File,entity_content:{file:{file_name:e.fileName,key:e.fileKey,size:e.size,file_type:e.fileType,md5:e.md5,image:e.image}},identifier:e.identifier,file_parse_state:e.parseState,file_name_state:e.reviewState}}),[]);return 0===a.length?{content_type:h.cM.Text,content_obj:{text:n.trim()},isReady:!0,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:t})}:{content_type:h.cM.Nested,content_obj:{text:n.trim(),entities:a},isReady:!0,localCreateExt:(0,i.A)((0,i.A)({},e.extraExt),{},{source:t})}},parseCopySendPayload:(e,t,s)=>{if(!e.operation||!("copySend"in e.operation))return;const{messageLink:n}=e.operation.copySend||{},a=n?(0,m.Tc)(s,n,t):void 0;return(0,p.xYz)(a)?E.parseNestedMessage(a,(0,i.A)({},e.extraExt)):{content_type:null==a?void 0:a.content_type,content_obj:null==a?void 0:a.content_obj,local_content:a&&"localContent"in a?null==a?void 0:a.localContent:void 0,isReady:!0,localCreateExt:(0,i.A)({},e.extraExt)}},parseSinglePayload:(e,t,s,i,n,a)=>{var o;return(0,_.Bu)(e)?w.parseNestedPayload(e,n):"text"in e?w.parseTextPayload(e,t,n):"image"in e||"image_key"in e?w.parseImagePayload(e,t,s,n,a):"file"in e||"file_key"in e?w.parseFilePayload(e,t,s,n,a):(0,_.Fh)(e)?w.parseCompositePayload(e,t,s,n,a):"copySend"in e.operation&&null!==(o=e.operation)&&void 0!==o&&o.copySend?w.parseCopySendPayload(e,t,i):void 0}},E={parseTextMessage:(e,t,s)=>({content_type:h.cM.Text,isReady:!0,content_obj:{text:(0,p.P5b)(e)},localCreateExt:(0,i.A)({},s)}),parseImageMessage:(e,t,s)=>{var n,a,o;const r=(null===(n=e.content_obj)||void 0===n?void 0:n.data[0].key)||(null===(a=t.preprocessTaskMap[(null==e||null===(o=e.local_content)||void 0===o?void 0:o.preprocess_key)||""])||void 0===a?void 0:a.key);return{content_type:h.cM.Image,isReady:Boolean(r),content_obj:{image_list:[{key:r}]},local_content:e.local_content,localCreateExt:(0,i.A)({},s)}},parseFileMessage:(e,t,s)=>{var n,a,o,r;const l=(null===(n=e.content_obj)||void 0===n?void 0:n.file_list[0].key)||(null===(a=t.preprocessTaskMap[(null==e||null===(o=e.localContent)||void 0===o?void 0:o.preprocess_key)||""])||void 0===a?void 0:a.key);return{content_type:h.cM.File,isReady:Boolean(l),content_obj:{file_list:[{key:l,file_name:null===(r=e.content_obj)||void 0===r||null===(r=r.file_list)||void 0===r||null===(r=r[0])||void 0===r?void 0:r.file_name}]},local_content:e.localContent,localCreateExt:(0,i.A)({},s)}},parseCompositeMessage:(e,t,s)=>{var n,a,o,r,l,d,u,_;if((0,p.U9e)(e))return{content_type:h.cM.Composite,content_obj:{text:(null===(l=e.content_obj.text)||void 0===l?void 0:l.trim())||"",link_model:{url:(null===(d=e.content_obj.link_model)||void 0===d?void 0:d.url)||""}},isReady:!0,localCreateExt:(0,i.A)({},s)};if((0,p.jFY)(e))return{content_type:h.cM.Composite,content_obj:{text:(null===(u=e.content_obj.text)||void 0===u?void 0:u.trim())||"",website_model:{pages:(null===(_=e.content_obj.website_model)||void 0===_?void 0:_.pages)||[]}},isReady:!0,local_content:e.localContent,localCreateExt:(0,i.A)({},s)};const g=(0,p.zlu)(e),m=(0,p.aXB)(e),f=g?null===(n=e.content_obj.image_model)||void 0===n?void 0:n.image_list:m?null===(a=e.content_obj.file_model)||void 0===a?void 0:a.file_list:void 0;var v;if(null==f||!f[0])return{content_type:h.cM.Text,content_obj:{text:(null===(v=e.content_obj.text)||void 0===v?void 0:v.trim())||""},isReady:!0,localCreateExt:(0,i.A)({},s)};const y=f.map((({key:s})=>{var i,n;return s||(null===(i=t.preprocessTaskMap[(null==e||null===(n=e.local_content)||void 0===n?void 0:n.preprocess_key)||""])||void 0===i?void 0:i.key)}));return{content_obj:g?{text:(null===(o=e.content_obj.text)||void 0===o?void 0:o.trim())||"",image_model:{image_list:y.map((e=>({key:e})))}}:m?{text:(null===(r=e.content_obj.text)||void 0===r?void 0:r.trim())||"",file_model:{file_list:f.map(((e,t)=>({file_name:(0,c.p)("file_name")(e),key:y[t]||""})))}}:{},content_type:h.cM.Composite,isReady:y.every((e=>!!e)),local_content:e.local_content,localCreateExt:(0,i.A)({},s)}},parseNestedMessage:(e,t)=>{const s=(0,r.A)(e.content_obj);return null==s||s.entities.forEach((e=>{delete e.file_name_state,delete e.file_parse_state})),{content_type:h.cM.Nested,content_obj:s,isReady:!0,localCreateExt:(0,i.A)({},t)}},parseSingleMessage:(e,t,s)=>{const a=(0,i.A)({source:s},(0,n.A)(null==e?void 0:e.ext,["msg_template_id","collection_id","input_skill","need_create_thread","ugc_plugin_auth_infos","reference_content","immersive_reading_files","pdf_hover_position","samantha_context"]));return(0,p.pu_)(e)&&(0,p.P5b)(e)?E.parseTextMessage(e,t,a):(0,p.Jij)(e)?E.parseImageMessage(e,t,a):(0,p.Bvk)(e)?E.parseCompositeMessage(e,t,a):(0,p.xYz)(e)?E.parseNestedMessage(e,a):(0,p.mlu)(e)?E.parseFileMessage(e,t,a):void 0}},R=(e,t,s,i)=>{var n,o;let r=A[e.reportParams.scene]||e.reportParams.scene;const l=e.ctx.botId||(0,f.Qo)(e.ctx.conversationId)||"",c=w.parseSinglePayload(e,s,l,t,r,i);if(c)return[c];const{replace:h,resume:_,remove:g,regenerate:v,resend:y,newChat:b}=e.operation||{},S=null!==(n=null===(o=h||_||g||y||b)||void 0===o?void 0:o.messageLink)&&void 0!==n?n:v?{messageId:v.sentMessageId,isLocalMessage:!1,regen_head:v.regenerateHeadMessageId}:void 0,k=(null==b?void 0:b.conversationId)||t,R=S?(0,m.Tc)(k,S,s):void 0,T=v?((e,t)=>{var s;if(!e)return[];const i=null==e||null===(s=e.ext)||void 0===s?void 0:s.collection_id;if(!i)return[e];const n=p.ozw.getState(),a=n.messageLinkMap[t],o=n.messageMap[t];return a.filter((e=>{var t;return(0,p.c84)(o[e.messageId],n.userInfo.secUserId)&&(null===(t=o[e.messageId])||void 0===t||null===(t=t.ext)||void 0===t?void 0:t.collection_id)===i})).map((e=>(0,m.Tc)(t,e,n))).filter(d.q3)})(R,k):[R].filter(d.q3),M=T.map((t=>{var i;const n=(null==t||null===(i=t.ext)||void 0===i?void 0:i.source)||e.reportParams.scene;r=v||h&&"edit"!==e.reportParams.scene||y?n:e.reportParams.scene;const a=E.parseSingleMessage(t,s,r);var o,l,c,d;_&&null!=a&&a.localCreateExt&&(a.localCreateExt.ugc_plugin_auth_infos=null!==(o=null===(l=e.extraExt)||void 0===l?void 0:l.ugc_plugin_auth_infos)&&void 0!==o?o:"");b&&null!=a&&a.localCreateExt&&(a.localCreateExt.need_create_thread=null!==(c=null===(d=e.extraExt)||void 0===d?void 0:d.need_create_thread)&&void 0!==c?c:"");return a})).filter(d.q3);if(!(0,a.A)(M))return M;throw u.v.persist.warning("sendMsgUnsupportedTypeOrScene"),Error("Unsupported MessageType")},T=(e,t)=>{var s;const i=t.botId||(0,f.Qo)(t.conversationId)||"",n=y.gO.get("chatBotService"),a=null==n?void 0:n.getBot(i),o=null!==(s=t.conversationType)&&void 0!==s?s:(0,v.e)(t.conversationId),r=(0,f.CB)("",t.conversationId,a,o);let l=function(e){return e.Text="text",e.Picture="pic",e.File="file",e}({});const c={[h.cM.Text]:l.Text,[h.cM.Image]:l.Picture,[h.cM.File]:l.File};return{bot_id:i,chat_type:r,conversation_type:o,message_type:(d=e.content_type,d&&c[d]||l.Text)};var d},M=e=>{var t;const s=p.ozw.getState(),{operation:n={},preGeneratedLocalMessageId:a}=e,o=a||"regenerate"in n&&(null==n||null===(t=n.regenerate)||void 0===t?void 0:t.sentLocalMessageId)||(0,g.uV)(),r=(0,g.yz)(e),l=R(e,r,s,o);return"replace"in n&&(null==n?void 0:n.replace)&&l.forEach((e=>{e.localCreateExt&&delete e.localCreateExt.collection_id})),l.map((t=>(0,i.A)((0,i.A)({},e),{},{resolved:(0,i.A)((0,i.A)({},t),{},{localMessageId:o,conversationId:r,isRegenerate:Boolean("regenerate"in n&&(null==n?void 0:n.regenerate))},T(t,e.ctx))})))},z=e=>{if(e.length<=0)return;e.forEach((e=>{e.reportParams=(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({},e.reportParams),(0,b.t)(e)),(0,b.bT)(e)),(0,b.Xv)(e)),(0,b.Kq)(e))}));const t=(0,o.A)(e.map(M)).filter(d.q3);if(0===t.length)return;if(1===t.length)return t;if(t.every((e=>{var t;return!(null===(t=e.resolved.localCreateExt)||void 0===t||!t.collection_id)})))return t;const s=(0,l.A)();return t.map((e=>(e.resolved.localCreateExt=(0,i.A)((0,i.A)({},e.resolved.localCreateExt),{},{collection_id:s}),e)))}},31160:(e,t,s)=>{s.d(t,{cZ:()=>w,iY:()=>E,R1:()=>A});var i=s(14065),n=s(37357),a=s(13655),o=s(82854),r=s(46219),l=s(61276),c=s(10129),d={Diff:0,Release:1},u=s(68005),h=s(73014);const _=()=>{let e,t;return{promise:new Promise(((s,i)=>{e=s,t=i})),resolve:e,reject:t}},g=e=>!!e.local_message_id,p=e=>!!e.local_conversation_id||!!e.conversation_id,m=e=>(t,s)=>new Promise(((i,a)=>{const l=o.ozw.getState();if(!t.every(g))return n.v.console.info("local_message_id is empty, skip to send message"),i("skip");if(!t.every(l.hasSendMessageTask))return n.v.console.info("task is empty, skip to send message"),i("skip");if(t.some(l.isSendMessageExpired))return i("skip");null==e||e(t);const c=t.map(_);t.forEach(((e,t)=>l.updateSendMessageTaskFinishFn(e,c[t].resolve)));const d=setTimeout((()=>a(new Error("timeout"))),s||r.Sf),u=c.map((e=>e.promise));Promise.all(u).then((()=>{i("finish"),clearTimeout(d)}))})),f=m((e=>{var t;null===(t=l.Pv.get(c.aU.Socket))||void 0===t||t.sendMessage((0,l.Yr)(e))})),v=m((e=>{var t;null===(t=l.Pv.get(c.aU.HttpLongPolling))||void 0===t||t.sendMessage((0,l.Yr)(e))})),y=function(){var e=(0,i.A)((function*(e){var t;const s=yield(0,u.O)();return null===(t=l.Pv.get(c.aU.SamanthaChatCompletion))||void 0===t||t.sendMessage((0,l.u_)(e,{launch_stage:s})),Promise.resolve()}));return function(t){return e.apply(this,arguments)}}(),b=(e,t)=>{const s=t||e,i=(t,n)=>e(t,n).catch((e=>s(t,n).catch((e=>i(t,n)))));return i},S=({messages:e,customSendWaitTimeout:t,protocolType:s,botType:l,skillId:c,isCollectionScene:d})=>{const h=function(){var e=(0,i.A)((function*(e,t){const i=(e=>e.some((e=>{var t,s;return a.A.length(`${(null==e?void 0:e.content)||""}${(null==e||null===(t=e.ext)||void 0===t?void 0:t.browser_explain)||""}${(null==e||null===(s=e.ext)||void 0===s?void 0:s.samantha_context)||""}`)>r.dO})))(e)||"http"===s,n="socket"===s;let o;const h=yield(0,u.O)();return!function({botType:e,stage:t,skillId:s=0,isCollectionScene:i}){return"Main"===e&&E(t)&&!i&&k.includes(s)}({botType:l,stage:h,skillId:c,isCollectionScene:d})?(o=i?b(v):n?b(f):b(f,v),function({stage:e,skillId:t=0,botType:s,isCollectionScene:i}){return"Main"===s&&w(e)&&!i&&k.includes(t)}({botType:l,stage:h,skillId:c,isCollectionScene:d})&&y(e)):o=y,o(e,t)}));return function(t,s){return e.apply(this,arguments)}}();return((e,t,s)=>{const i=o.ozw.getState();return e.every(g)?e.every(p)?(e.forEach((e=>i.finishSendMessageTask(e.local_message_id))),e.forEach(i.addSendMessageTask),t(e,s)):(n.v.console.info("local_conversation_id or conversation_id is empty, skip sending message"),Promise.resolve()):(n.v.console.info("local_message_id is empty, skip sending message"),Promise.resolve())})(e,h,t)},A=(...e)=>{const t=h.gO.service;null!=t&&t._messageServiceIsInitialed?S(...e):null==t||t.tryInitMessageProtocolService().then((({isInitialed:t})=>{t&&S(...e)}))},k=[0,1,3,4,5,6,7];function w(e){return e===d.Diff}function E(e){return e===d.Release}},17209:(e,t,s)=>{s.d(t,{v:()=>L});var i=s(44557),n=s(20716),a=s(75484),o=s(93270),r=s(60100),l=s(63379),c=s(16100),d=s(82854),u=s(46219),h=s(10129),_=s(61276);var g=s(9012),p=s(18590),m=s(81435);const f=(e,t,s,i={})=>{var n;const{imageWidth:a,imageHeight:o}=i,l=(0,r.$2)(s,e);if(!l)return"";const c=null===(n=s.find((({resolved:e})=>e.localMessageId===l)))||void 0===n?void 0:n.resolved;return c?c.content_type===m.cM.Image?((e,t={})=>{const{imageWidth:s,imageHeight:i}=t,n={image_list:[{key:e,image_ori:{width:s,height:i}}]};return JSON.stringify(n)})(t,{imageHeight:o,imageWidth:a}):c.content_type===m.cM.File?((e,t)=>(0,p.e)({src:"user-sent",file_list:[{key:e,file_name:(0,g.A)(t,"content_obj.file_list[0].file_name","")}]}))(t,c):"":""};var v=s(72975);var y=s(31160),b=s(20661);const S=(e,t,s,i)=>{const[n]=e,a=d.ozw.getState();var o,r,l;((0,d.hTZ)(n),t.isReady)&&((0,b.eT)({isRegenerate:t.isRegenerate,immerUpdateMessage:e,conversationId:null!==(o=s.conversation_id)&&void 0!==o?o:"",replyId:t.isRegenerate?null!==(r=null==i?void 0:i.sentMessageId)&&void 0!==r?r:"":t.localMessageId,messageId:"",newLocalMessageId:u.rR,sectionId:s.section_id,timeout:null==s||null===(l=s.ext)||void 0===l?void 0:l.timeout,localMessageStatus:h.FQ.WaitingAck,createdFrom:"send_message",message:{ext:(0,b.Gm)(a)}}),(0,b.dk)({isRegenerate:t.isRegenerate,immerUpdateMessage:e,newLocalMessageId:u.rR,regenHead:null==i?void 0:i.regenerateHeadMessageId}))},A=(e,t,s,i)=>{t.updateMessageList({conversationId:e.conversationId,immerUpdate:(...t)=>{const[n]=t,{draftMessageLinks:a,draftLocalMessageMap:o}=n;o[e.localMessageId]=s;const r={isLocalMessage:!0,messageId:e.localMessageId};e.isRegenerate||a.push(r),S(t,e,s,i)}})},k=(e,t)=>{e.updateMessageList({conversationId:t.conversationId,immerUpdate:({draftLocalMessageMap:{[t.localMessageId]:e}})=>{null!=e&&e.local&&(e.local.failed=!0,e.local.status=h.FQ.PreprocessFailed)}})},w=(e,t,s)=>{t&&e.updateMessageList({conversationId:t.conversationId,immerUpdate:(...e)=>{const[i]=e,{draftLocalMessageMap:{[t.localMessageId]:n},draftMessageLinks:a}=i;null!=n&&n.local&&(n.local.failedExpired=Date.now()+u.hn,n.local.status=s?h.FQ.SendingRegenerate:h.FQ.Sending),n.create_time=Date.now();const o=a.findIndex((e=>e.messageId===t.localMessageId));~o&&o!==a.length-1&&a.push(...a.splice(o,1)),S(e,t,n,s)}})};var E=s(57387),R=s(28087),T=s(73014),M=s(82205);const z=e=>!(null==e||!e.key),C=e=>!e||e.failed,x=e=>{var t;const{sendingMessages:s,beforeSendMessage:i,customSendWaitTimeout:n,protocolType:a,botType:o,skillId:r=0}=e;null==i||i(s),s.forEach((e=>{var t,s;return null===(t=T.gO.service)||void 0===t||null===(t=t.getMessageLifeCycle(e))||void 0===t||null===(s=t.sendMessageBefore)||void 0===s?void 0:s.call(t,e)})),s.forEach((e=>{var t,s;return null===(t=T.gO.service)||void 0===t||null===(t=t.getMessageLifeCycleMiddleware())||void 0===t||null===(s=t.sendMessageBefore)||void 0===s?void 0:s.call(t,e)}));const l=!(null==s||null===(t=s[0])||void 0===t||null===(t=t.ext)||void 0===t||!t.collection_id);(0,y.R1)({messages:s,customSendWaitTimeout:n,protocolType:a,botType:o,skillId:r,isCollectionScene:l}),s.forEach((e=>{var t,s;return null===(t=T.gO.service)||void 0===t||null===(t=t.getMessageLifeCycle(e))||void 0===t||null===(s=t.sendMessageStart)||void 0===s?void 0:s.call(t,e)})),s.forEach((e=>{var t,s;return null===(t=T.gO.service)||void 0===t||null===(t=t.getMessageLifeCycleMiddleware())||void 0===t||null===(s=t.sendMessageStart)||void 0===s?void 0:s.call(t,e)})),function(e){const t=d.ozw.getState(),{sendingMessages:s,localMessages:i,payloads:n}=e;if(i.forEach((e=>E.QO.logSendMessage(e))),n.some((({reportParams:{scene:e}})=>"onboarding"===e)))return void E.QO.trackOnBoardingMessageSentEvent();n.forEach(((e,t)=>E.QO.trackSendMessageEvent(e,i[t]))),s.forEach(((e,t)=>E.QO.trackSendMessageStartEvent(e,{skill_id:n[t].reportParams.skill_id}))),n.forEach((e=>{E.QO.trackUploadParseStatus(t,e)}))}(e)};const L=(e,{chatType:t,beforeSendMessage:s,customSendWaitTimeout:g,protocolType:y,botType:b})=>{const S=d.ozw.getState(),E=e[0].resolved.conversationId||"",T=e.every((({resolved:e})=>e.isReady));(0,d.P7$)(d.ozw,E),e.forEach((({operation:e={}})=>{var t,s,i,n,a,o;if("resend"in e&&null!==(t=e.resend)&&void 0!==t&&null!==(t=t.messageLink)&&void 0!==t&&t.messageId)S.logicalDeleteMessage({conversationId:E,messageLink:null===(o=e.resend)||void 0===o?void 0:o.messageLink});else if("replace"in e&&null!==(s=e.replace)&&void 0!==s&&null!==(s=s.messageLink)&&void 0!==s&&s.messageId){var r,l,c;S.logicalDeleteMessage({conversationId:E,messageLink:null===(r=e.replace)||void 0===r?void 0:r.messageLink,deleteReply:!0});const t=(0,M.Tc)(E,{isLocalMessage:!1,messageId:null===(l=e.replace)||void 0===l||null===(l=l.messageLink)||void 0===l?void 0:l.messageId});(0,R.PF)({replyId:null===(c=e.replace)||void 0===c||null===(c=c.messageLink)||void 0===c?void 0:c.messageId,localMessageId:null==t?void 0:t.local_message_id})}else if("resume"in e&&null!==(i=e.resume)&&void 0!==i&&null!==(i=i.messageLink)&&void 0!==i&&i.messageId){var d,u,h;const t=(0,M.Tc)(E,{isLocalMessage:!1,messageId:null===(d=e.resume)||void 0===d||null===(d=d.messageLink)||void 0===d?void 0:d.messageId});S.logicalDeleteMessage({conversationId:E,messageLink:null===(u=e.resume)||void 0===u?void 0:u.messageLink,deleteReply:!0}),(0,R.PF)({replyId:null===(h=e.resume)||void 0===h||null===(h=h.messageLink)||void 0===h?void 0:h.messageId,localMessageId:null==t?void 0:t.local_message_id})}else if("remove"in e&&null!==(n=e.remove)&&void 0!==n&&null!==(n=n.messageLink)&&void 0!==n&&n.messageId){var _,g,p;const t=(0,M.Tc)(E,{isLocalMessage:!1,messageId:null===(_=e.remove)||void 0===_||null===(_=_.messageLink)||void 0===_?void 0:_.messageId});S.logicalDeleteMessage({conversationId:E,messageLink:null===(g=e.remove)||void 0===g?void 0:g.messageLink,deleteReply:!0}),S.updateMessageList({conversationId:E,immerUpdate:(t,s)=>{var i,n;return(null===(i=e.remove)||void 0===i||null===(i=i.messageLink)||void 0===i?void 0:i.messageId)&&s.resetMessageLink(null===(n=e.remove)||void 0===n||null===(n=n.messageLink)||void 0===n?void 0:n.messageId)}}),(0,R.PF)({replyId:null===(p=e.remove)||void 0===p||null===(p=p.messageLink)||void 0===p?void 0:p.messageId,localMessageId:null==t?void 0:t.local_message_id})}else if("regenerate"in e&&null!==(a=e.regenerate)&&void 0!==a&&a.sentMessageId){var m,f;const t=(0,M.Tc)(E,{isLocalMessage:!1,messageId:null===(m=e.regenerate)||void 0===m?void 0:m.sentMessageId});(0,R.PF)({replyId:null===(f=e.regenerate)||void 0===f?void 0:f.sentMessageId,localMessageId:null==t?void 0:t.local_message_id})}})),e.some((({resolved:e})=>e.isRegenerate))||(0,r.Qe)({store:S,conversationId:E}),S.clearSuggestMessage(E);const L=e.map((e=>(({ctx:e,operation:t,reportParams:{content_source:s,content_source_template_id:n},resolved:a,messageStatus:o},r)=>{var l;const{replace:c,remove:d,regenerate:u,resume:h}=t||{};return(0,i.A)((0,i.A)((0,i.A)((0,i.A)({local_conversation_id:e.localConversationId,bot_id:e.botId,conversation_id:e.conversationId,section_id:r.lastSectionIdMap[a.conversationId]||"",local_message_id:a.localMessageId,message_type:m.Go.Message,content_type:a.content_type,content:(0,p.e)(a.content_obj),create_time:Date.now()},c||d||h?{message_id:null===(l=c||d||h)||void 0===l||null===(l=l.messageLink)||void 0===l?void 0:l.messageId}:{}),u?{reply_id:u.sentMessageId,local_message_id:u.sentLocalMessageId}:{}),a.content_type===m.cM.Text?{content_source:s||v.Z.Other,template_id:n}:{}),{},{ext:a.localCreateExt,status:o})})(e,a.pU.getState()))),U=L.map(((s,n)=>{const{regenerate:a}=e[n].operation||{};return(e=>{var t,s,n,a,o;const{msgPayload:g,resolved:p,messageExt:m,regenerate:f,store:v,ctx:y,reportEvents:b,chatType:S,reportParams:A,is_ogf:k}=e,w=(0,i.A)({start_local_conversation_id:y.localConversationId,start_conversation_id:y.conversationId,start_bot_id:y.botId,start_local_message_id:p.localMessageId,ext:m,conversation_type:y.conversationType,content_type:p.content_type,enter_from:y.enterFrom,is_ogf:k,chat_type:S},A);d.ozw.getState().setReportEvents(p.conversationId,p.localMessageId,(0,i.A)((0,i.A)({},b),{},{send_message:(0,c.XB)({eventName:"send_message",meta:w,once:!0}),biz_message:(0,c.XB)({eventName:"biz_message",meta:w})}),A);const E=[],R=[...(0,_.KS)(g.ext)],T=(0,i.A)((0,i.A)({},g),{},{reply_id:f?"0":g.reply_id,content_obj:p.content_obj,sec_sender:u.tL,attachments:E,references:R});var M,z;return null!==(t=p.content_obj)&&void 0!==t&&t.file_model&&E.push(...(0,_.TU)(null===(M=p.content_obj)||void 0===M?void 0:M.file_model)),null!==(s=p.content_obj)&&void 0!==s&&s.link_model&&E.push((0,_.kv)(p.content_obj.link_model)),null!==(n=p.content_obj)&&void 0!==n&&n.image_model&&E.push(...(0,_.KF)(p.content_obj.image_model)),null!==(a=p.content_obj)&&void 0!==a&&a.entities&&E.push(...(0,_.r8)(p.content_obj.entities)),(0,d.LQ9)(g)&&E.push(...(0,_.KF)(p.content_obj)),(0,d.sDT)(g)&&E.push(...(0,_.TU)(p.content_obj)),((0,d.pu_)(T)||(0,d.Jij)(T))&&(0,l.A)(T,{content_extra:(0,i.A)((0,i.A)({},(0,_.FU)(g.ext)),(0,_.q6)(g.ext))}),null!==(o=T.content_obj)&&void 0!==o&&o.image_list&&((0,l.A)(T.content_obj,{data:T.content_obj.image_list}),null===(z=T.content_obj)||void 0===z||delete z.image_list),(0,d.xfl)({localMessageStatus:p.isReady?f?h.FQ.SendingRegenerate:h.FQ.Sending:h.FQ.Preprocessing,message:T,failedExpired:(0,r.zO)(p.isReady,p.content_type),sendLoadingExpired:Date.now()+u.On,messageLinks:v.messageLinkMap[p.conversationId],isRegenerate:p.isRegenerate,prevMessageId:p.isRegenerate?null==f?void 0:f.regenerateTailMessageId:void 0,localContent:p.local_content,enterFrom:y.enterFrom})})({is_ogf:(0,o.h)(),msgPayload:s,resolved:e[n].resolved,messageExt:(0,r.aK)(e[n],S),store:S,ctx:e[n].ctx,reportEvents:e[n].reportEvents,reportParams:e[n].reportParams,regenerate:a,chatType:t})}));if(U.forEach(((t,s)=>{const{remove:i,regenerate:n}=e[s].operation||{};i||A(e[s].resolved,S,t,n)})),T){var B;const t=Number(null===(B=e[0])||void 0===B||null===(B=B.reportParams)||void 0===B?void 0:B.skill_id)||0;x({sendingMessages:L.map(((t,s)=>(0,i.A)((0,i.A)({},t),{},{ext:(0,r.aK)(e[s],S)}))),localMessages:U,payloads:e,beforeSendMessage:s,customSendWaitTimeout:g,protocolType:y,botType:b,skillId:t})}else{const t=e.map((({resolved:e})=>{var t;return(null===(t=e.local_content)||void 0===t?void 0:t.preprocess_key)||""})).filter((e=>!!e));t.forEach((t=>{const s=S.preprocessTaskMap[t],i=e.find((e=>{var s;return(null===(s=e.resolved.local_content)||void 0===s?void 0:s.preprocess_key)===t}));var n;null!=s&&s.failed&&i&&S.reUpload(t,null!==(n=i.ctx.botId)&&void 0!==n?n:"")}));const a=d.ozw.subscribe((e=>t.map((t=>e.preprocessTaskMap[t]))),(t=>{if(t.some(C))return e.forEach((({resolved:e})=>k(S,e))),void a();if(t.every(z)){var n;const o=new Map(t.map((t=>{const{ImageWidth:s,ImageHeight:i}=t.uploadResult||{};return[(0,r.$2)(e,t.local_key),f(t.local_key,t.key,e,{imageWidth:s,imageHeight:i})]})));o.forEach(((t,s)=>{const n=((e,t)=>t?e.find((e=>e.resolved.localMessageId===t)):void 0)(e,s),a=null!=n&&n.operation&&"regenerate"in n.operation?n.operation.regenerate:void 0;w(S,n?(0,i.A)((0,i.A)({},null==n?void 0:n.resolved),{},{isReady:!0}):void 0,a)}));const l=L.map(((t,s)=>(0,i.A)((0,i.A)({},t),{},{ext:(0,r.aK)(e[s],S)},o.has(t.local_message_id)?{content:o.get(t.local_message_id)}:{})));(0,d.P7$)(d.ozw,E),S.clearSuggestMessage(E);const c=Number(null===(n=e[0])||void 0===n||null===(n=n.reportParams)||void 0===n?void 0:n.skill_id)||0;x({payloads:e,localMessages:U,sendingMessages:l,beforeSendMessage:s,customSendWaitTimeout:g,protocolType:y,botType:b,skillId:c}),a()}}),{equalityFn:n.A})}}},69052:(e,t,s)=>{s.d(t,{Bu:()=>d,Fh:()=>a,HZ:()=>c,JG:()=>i,QP:()=>n,YV:()=>l,fr:()=>o,kk:()=>r});const i=e=>"image"in e||"image_key"in e,n=e=>"file"in e||"file_key"in e,a=e=>"compositeContent"in e,o=e=>a(e)&&"images"in e.compositeContent&&!!e.compositeContent.images,r=e=>a(e)&&"files"in e.compositeContent&&!!e.compositeContent.files,l=e=>a(e)&&"links"in e.compositeContent&&!!e.compositeContent.links,c=e=>a(e)&&"websites"in e.compositeContent&&!!e.compositeContent.websites,d=e=>"nestedItems"in e},86228:(e,t,s)=>{s.d(t,{r:()=>r});var i=s(37357),n=s(22358),a=s(73014);const{TouristReachThreadLimit:o}=n.HK,r=e=>{var t;const s=e.cmd_type,n=(e=>e.cmd_type===o?e.conversation_id||"0":e.conversation_id)(e);if(!n||!s)return void i.v.console.warning({namespace:"socket",message:"ConversationAdd: invalid conversation_id"});e.conversation_id=n;const r=null===(t=a.gO.service)||void 0===t?void 0:t.getCmdLifeCycle(s);null!=r&&r.length?r.forEach((t=>t.receiveCmdEnd(e))):i.v.console.warning({namespace:"socket",message:`SKIP: cmdType=${s}`})}},43718:(e,t,s)=>{s.d(t,{Z2:()=>n});var i=s(22358),n={State_Unknown:0,ReviewState:1,ParseState:2};n.State_Unknown,n.ReviewState,n.ParseState,i.hI.ParseState_Default,i.hI.ParseState_Success,i.hI.ParseState_Failed,i.hI.ParseState_Processing,i.Cp.ReviewState_Default,i.Cp.ReviewState_Access,i.Cp.ReviewState_NotCompliant,i.Cp.ReviewState_Processing},60702:(e,t,s)=>{s.d(t,{f:()=>b});var i=s(44557),n=s(76398),a=s(82914),o=s(41967),r=s(37357),l=s(57387),c=s(20661),d=s(94268),u=s(10129),h=s(9057),_=s(1456),g=s(90895),p=s(75484),m=s(73014),f=s(65471),v=s(82854);const y=e=>{var t;return null===(t=e.ext)||void 0===t?void 0:t.collection_id},b=e=>{var t,s,b,S,A,k;const w=v.ozw.getState(),{service:E}=m.gO,R={namespace:null===(t=e.local_info)||void 0===t?void 0:t.from,meta:{message:e}};r.v.console.info((0,i.A)((0,i.A)({},R),{},{message:"Ack Message"}));const{conversation_id:T,message_id:M,local_message_id:z,local_conversation_id:C,section_id:x}=e;if(!z)return void r.v.console.warning((0,i.A)((0,i.A)({},R),{},{message:"Invalid Ack Message: local_message_id"}));w.finishSendMessageTask(z);const L=C||T,U=!(null===(s=(0,h.YJ)(v.ozw.getState(),L,z).local)||void 0===s||!s.isRegenerate),B=w.getReportEvents(L,z)||{},I=w.getReportParams(L,z)||{};if(!M){const t=null==E?void 0:E.getErrorLifeCycles(e),s=(0,d.HN)(e);return null!=t&&t.length&&t.forEach((t=>{var s;return null==t||null===(s=t.sendMessageError)||void 0===s?void 0:s.call(t,e)})),void(s?(0,l.TP)(v.ozw.getState(),e,{reportEvents:B,isRegenerate:U,reportParams:I}):r.v.console.warning((0,i.A)((0,i.A)({},R),{},{message:"Invalid Ack Message: message_id"})))}if(!function(e,t){var s;const i=e=>{var s;r.v.persist.warning({namespace:null===(s=t.local_info)||void 0===s?void 0:s.from,message:"Invalid Ack Message",meta:{reason:e,message:t}})};if(!e)return i("local_sending_message is not exist"),!1;if(!(0,d.xX)(e))return i("local_sending_message was received ack"),!1;if((null==e||null===(s=e.local)||void 0===s?void 0:s.status)===u.FQ.SentInLocalConversation)return i("local_sending_message was received ack"),!1;return!0}((0,c.TU)(w,{conversationId:L,localMessageId:z}),e))return;const O=(0,c.O2)(v.ozw.getState(),{conversationId:L,replyId:M}),P=(null===(b=(0,a.A)(O))||void 0===b?void 0:b.local_message_id)||(0,d.um)(M);d.Cd.addDuration(B,"ack",!1),null==E||null===(S=E.getMessageLifeCycle(e))||void 0===S||null===(A=S.sendMessageEnd)||void 0===A||A.call(S,e),(0,f.o3)(e)||w.updateMessageList({conversationId:T,immerUpdate:(...t)=>{var s,i,a;const[r]=t,m=r.draftLocalMessageMap[z],f=(0,d.oQ)(m);(0,l._s)(v.ozw.getState(),e,{reportEvents:(0,n.A)(B,["send_message"]),reportParams:I,isRegenerate:f}),f||(0,_.sK)({draft:r,localMessage:m,message:e,useRemoteMessageKey:!1}),(0,_.ZH)({draft:r,localMessage:m,message:e,omitReportEventProperty:["send_message"]});const b=(0,_.hT)(r);if(!f&&((0,h.vW)(v.ozw.getState(),{conversationId:T,replyId:M})||y(e)&&!(e=>{var t,s;if(!y(e))return!1;const i=null===(t=e.local_info)||void 0===t?void 0:t.message_list_count,n=null===(s=e.local_info)||void 0===s?void 0:s.in_message_list_pos;return(0,o.A)(i)&&(0,o.A)(n)&&n===i-1})(e)))return;const{draftMessageMap:S}=r;M&&(0,d.up)(S[M])||((0,c.eT)({conversationType:(0,g.Rx)(p.pU.getState(),T),isRegenerate:f,regenHead:null==b||null===(s=b[0])||void 0===s?void 0:s.regen_head,immerUpdateMessage:t,newLocalMessageId:P,conversationId:T,replyId:M,messageId:"",sectionId:x,timeout:null==e||null===(i=e.ext)||void 0===i?void 0:i.timeout,reportParams:I,localMessageStatus:u.FQ.ReceivingFirstPackage,createdFrom:"ack",message:{ext:(0,c.Gm)(w)}}),(0,c.dk)({isRegenerate:f,immerUpdateMessage:t,newLocalMessageId:P,regenHead:null==b||null===(a=b[0])||void 0===a?void 0:a.regen_head}),(0,c.$q)(t))}}),null==E||null===(k=E.getMessageLifeCycleMiddleware())||void 0===k||k.sendMessageEnd(e)}},22042:(e,t,s)=>{s.d(t,{C:()=>_});var i=s(44557),n=s(5099),a=s(36225),o=s(18590),r=s(20661),l=s(67666),c=s(94268),d=s(82854);var u=s(73014),h=s(37357);const _=e=>{var t;const s=d.ozw.getState(),{service:_}=u.gO,{content_obj:g,conversation_id:p,reply_id:m,message_id:f,section_id:v}=e,y=(0,c.w5)(e);h.v.console.info({namespace:null===(t=e.local_info)||void 0===t?void 0:t.from,message:"Suggest Message",meta:{message:e}});const{suggest:b}=g||{},S=(0,a.Bo)(b)?b:[];var A;if(!m)return void h.v.console.warning({namespace:null===(A=e.local_info)||void 0===A?void 0:A.from,message:"invalid suggest message: expect reply_id but found undefined/null"});const k=(0,i.A)((0,i.A)({},s.getReportEvents(p,m)),s.getReportEvents(p,f)),w=s.getReportParams(p,m)||{},{message_receive_suggests:E}=k;y&&m&&function(e,t,s,i){e.updateMessageList({conversationId:t,immerUpdate:e=>{const{draftMessageMap:t}=e,n=t[s];n&&(n.ext?n.ext.sp=i:n.ext={sp:i})}})}(s,p,f,JSON.stringify(S)),s.updateSuggestMessage(p,(t=>{var s,i,n,a;return"1"===(null===(s=e.ext)||void 0===s?void 0:s.onboarding)||"2"===(null===(i=e.ext)||void 0===i?void 0:i.onboarding)?{replyId:m,loading:!1,failed:!1,expired:void 0,suggests:S}:(null==t?void 0:t.replyId)===m?(null!=t&&null!==(n=t.suggests)&&void 0!==n&&n.length||null==E||E.addDurationPoint("first_suggest_item"),null==E||E.addDurationPoint("last_suggest_item",!0),{replyId:m,loading:!1,failed:!1,expired:void 0,suggests:S}):(h.v.console.warning({namespace:null===(a=e.local_info)||void 0===a?void 0:a.from,message:"ignore suggest message: non-match reply_id"}),t)}));const R=u.gO.get("chatTeaService");if(y){var T,M,z,C,x,L,U,B,I,O,P,q,G,D,N,j,F,V,H,K,W;null==_||null===(T=_.getMessageLifeCycle(e))||void 0===T||null===(M=T.receiveMessageEnd)||void 0===M||M.call(T,e),null==_||null===(z=_.getMessageLifeCycleMiddleware())||void 0===z||null===(C=z.receiveMessageEnd)||void 0===C||C.call(z,e);const{biz_message:t,receive_total_messages:s}=k;null==R||R.trackEvent("message_total_answers_end",{type:e.message_type,from:null===(x=e.local_info)||void 0===x?void 0:x.from,next_connection_type:e.next_connection_type,content_type:e.content_type,success:1,section_id:null==e?void 0:e.section_id,reply_id:m,duration:null==s||null===(L=s.getDuration())||void 0===L?void 0:L.success,conversation_id:p,skill_id:(null===(U=(0,o.O)(null===(B=e.ext)||void 0===B?void 0:B.input_skill,{}))||void 0===U?void 0:U.skill_id)||"0",is_include_suggest:1,retried:null!=e&&null!==(I=e.local_info)&&void 0!==I&&I.retried?1:0,bot_id:e.bot_id,llm_intention:null==t||null===(O=t.getMeta())||void 0===O?void 0:O.llm_intention,llm_intention_detail:null==t||null===(P=t.getMeta())||void 0===P?void 0:P.llm_intention_detail});const a=(null==t||null===(q=t.getDuration())||void 0===q?void 0:q.first_text)||(null==t||null===(G=t.getDuration())||void 0===G?void 0:G.first)||0;null==R||R.trackEvent("message_receive_first_package",{conversation_id:p,status:0,error_code:0,duration:a,retried:null!=e&&null!==(D=e.local_info)&&void 0!==D&&D.retried?1:0,message_id:f,from:null===(N=e.local_info)||void 0===N?void 0:N.from,next_connection_type:e.next_connection_type,content_type:null==e?void 0:e.content_type,skill_id:(null===(j=(0,o.O)(null==e||null===(F=e.ext)||void 0===F?void 0:F.input_skill,{}))||void 0===j?void 0:j.skill_id)||"0",bot_id:e.bot_id,llm_intention:null==t||null===(V=t.getMeta())||void 0===V?void 0:V.llm_intention,llm_intention_detail:null==t||null===(H=t.getMeta())||void 0===H?void 0:H.llm_intention_detail}),l.C.success((0,n.A)(k,["receive_message","receive_message_package"]),{meta:(0,i.A)((0,i.A)({},(0,r.BX)({message:e,reportParams:w})),{},{is_include_suggests:!0})}),null==R||R.trackEvent("receive_prompt",(0,i.A)((0,i.A)({duration:null==E||null===(K=E.getDuration())||void 0===K?void 0:K.last,conversation_id:p,section_id:v},null!=S&&S.length?{success:1,quantity:(null==S?void 0:S.length)||0}:{success:0,result:"prompt_empty"}),{},{message_id:f,is_cache:"1"===String(null==e||null===(W=e.ext)||void 0===W?void 0:W.is_from_cache)?1:0}))}}},77813:(e,t,s)=>{s.d(t,{Y:()=>v});var i=s(44557),n=s(49392),a=s(2633),o=s(40967),r=s(37814),l=s(72106),c=s(85371),d=s(20661),u=s(67666),h=s(94268),_=s(1456),g=s(46219),p=s(61276),m=s(10129),f=s(82854);const v=e=>{const t=f.ozw.getState(),{conversation_id:s,reply_id:v=""}=e,y=(0,h.HN)(e),b=(0,h.Wr)(e)||(0,h.tG)(e)||(0,h.Y4)(e)||(0,h.t6)(e);b&&t.updateSearchResultStatus(v,!1),t.updateMessageList({conversationId:s,immerUpdate:(...f)=>{const[S]=f,{draftLocalMessageMap:A}=S,k=(0,h.um)(v),w=t.getReportParams(s,v)||{},E=(0,o.A)((0,r.A)(A,(e=>(null==e?void 0:e.reply_id)===v)));if(v&&(0,a.A)(E)){var R,T,M,z;const t=(0,_.hT)(S);(0,d.eT)({isRegenerate:Boolean(null==t||null===(R=t[0])||void 0===R?void 0:R.regen_head),regenHead:null==t||null===(T=t[0])||void 0===T?void 0:T.regen_head,immerUpdateMessage:f,newLocalMessageId:k,conversationId:s,replyId:v,messageId:"",sectionId:e.section_id,localMessageStatus:m.FQ.ReceivingStream,createdFrom:"thinking",reportParams:w}),(0,d.dk)({isRegenerate:Boolean(null==t||null===(M=t[0])||void 0===M?void 0:M.regen_head),immerUpdateMessage:f,newLocalMessageId:k,regenHead:null==t||null===(z=t[0])||void 0===z?void 0:z.regen_head})}v&&!(0,a.A)(E)&&(0,d.uX)({immerUpdateMessage:f,newLocalMessageId:k,isSearchMessage:b});const C=A[k];if(C){var x,L,U,B;if((0,p.up)(C,e))return;const a=(0,i.A)((0,i.A)({},t.getReportEvents(s,k)),t.getReportEvents(s,v||"")),{biz_message:o}=a;(0,n.A)(null==o||null===(x=o.getDuration())||void 0===x?void 0:x.receive_first_socket_packet)&&(null===(L=e.local_info)||void 0===L?void 0:L.from)===m.aU.Socket&&u.C.addDuration(a,"receive_first_socket_packet",!1);(0,n.A)(null==o||null===(U=o.getDuration())||void 0===U?void 0:U.receive_first_chunk_packet)&&(null===(B=e.local_info)||void 0===B?void 0:B.from)===m.aU.HttpChunk&&u.C.addDuration(a,"receive_first_chunk_packet",!1),y?u.C.error(a,{reason:"thinking-error",meta:(0,d.BX)({message:e,localReceiveMessage:C,reportParams:w})}):u.C.addDuration(a,"thinking",!1),A[k]=(0,i.A)((0,i.A)({},C),{},{local:(0,i.A)((0,i.A)({},C.local),{},{failed:!1,failedExpired:y?void 0:Date.now()+g.dc})},(0,l.A)(e,c.A))}}})}},49944:(e,t,s)=>{s.d(t,{P:()=>T});var i=s(44557),n=s(76398),a=s(72106),o=s(5099),r=s(49392),l=s(85371),c=s(92431),d=s(63379),u=s(37357),h=s(16100),_=s(20661),g=s(46219),p=s(67666),m=s(94268),f=s(9057),v=s(1456),y=s(90895),b=s(75484),S=s(65471),A=s(73014),k=s(18590),w=s(61276),E=s(10129),R=s(82854);const T=e=>{var t,s,T;const M=R.ozw.getState(),{conversation_id:z,message_id:C,reply_id:x=""}=e,L=(0,y.Rx)(b.pU.getState(),z),U=(0,m.oS)(e),B=(0,m.HN)(e),I=(0,m.KU)(e),O=(0,m.RR)(e),P=(0,m.oQ)(e),q=(0,m.w5)(e),G=(0,m.Et)(e),D=A.gO.get("chatTeaService"),{service:N}=A.gO,j=O?g.sq:x,F=M.getReportParams(z,j||"")||{};let V=!1;const H=null==N?void 0:N.getErrorLifeCycles(e);if(null!=H&&H.length&&(H.forEach((t=>{var s;return null==t||null===(s=t.receiveMessageError)||void 0===s?void 0:s.call(t,e)})),u.v.persist.warning({message:"receive message failed",meta:{message:e}})),M.updateMessageList({conversationId:z,immerUpdate:(...t)=>{var s,h;const[f]=t,A={},{draftLocalMessageMap:R,draftMessageMap:T,draftMessageLinks:M,draftRegenerateMessageMap:x}=f,I=Boolean(T[C]),O=(0,m.um)(j),H=R[O];let K=R[C];if(!I&&!K&&!H){var W,J;const s=(0,v.hT)(f);(0,_.eT)({isRegenerate:P,regenHead:null==s||null===(W=s[0])||void 0===W?void 0:W.regen_head,immerUpdateMessage:t,newLocalMessageId:C,messageId:"",conversationId:z,replyId:j,message:e,sectionId:e.section_id,localMessageStatus:E.FQ.ReceivingStream,createdFrom:"message",conversationType:L,reportParams:F}),(0,_.dk)({isRegenerate:P,immerUpdateMessage:t,newLocalMessageId:C,regenHead:null==s||null===(J=s[0])||void 0===J?void 0:J.regen_head}),K=R[C],V=!0}if(!I&&H){(0,m.Wi)(H)&&(V=!0);const s=(0,v.iv)(f,{isLocalMessage:!0,messageId:O});if(-1!==s){var Q,Y;const n=M.splice(s,1),a=G?{messageKey:null==n?void 0:n[0].messageKey}:{};(0,v.ZH)({draft:f,localMessage:H,message:e}),(0,_.eT)({isRegenerate:P,regenHead:null==n||null===(Q=n[0])||void 0===Q?void 0:Q.regen_head,immerUpdateMessage:t,newLocalMessageId:C,conversationId:z,replyId:j,message:e,messageId:C,sectionId:e.section_id,localMessageStatus:E.FQ.ReceivingStream,createdFrom:"replace_temporary_message",conversationType:L,reportParams:F}),(0,_.dk)((0,i.A)({isRegenerate:P,immerUpdateMessage:t,newLocalMessageId:C,regenHead:null==n||null===(Y=n[0])||void 0===Y?void 0:Y.regen_head},a))}K=R[C]}(0,d.A)(A,(0,i.A)((0,i.A)({},null===(s=f.draftMessageReportEventMap[C||""])||void 0===s?void 0:s.reportEvents),null===(h=f.draftMessageReportEventMap[j||""])||void 0===h?void 0:h.reportEvents));const X=A.receive_message,Z=A.biz_message;if(!I&&K){var $,ee,te,se,ie,ne,ae,oe,re;const t=(0,_.BX)({message:e,localReceiveMessage:K,reportParams:F});if(p.C.updateMeta(A,t),V){var le,ce,de,ue,he,_e;if(null==N||null===(le=N.getMessageLifeCycle(e))||void 0===le||null===(ce=le.receiveMessageStart)||void 0===ce||ce.call(le,e,A),null==N||null===(de=N.getMessageLifeCycleMiddleware())||void 0===de||null===(ue=de.receiveMessageStart)||void 0===ue||ue.call(de,e),B){const e={reason:"first-pkg-error",meta:{is_include_suggests:!1}};p.C.error(A,e)}const t=(0,r.A)(null==Z||null===(he=Z.getDuration())||void 0===he?void 0:he.first);var ge,pe,me,fe,ve,ye,be,Se,Ae,ke;if((0,r.A)(null==Z||null===(_e=Z.getDuration())||void 0===_e?void 0:_e.first_text)&&(0,m.pu)(e))p.C.addDuration(A,"first_text",!1),p.C.updateMeta(A,{receive_first_text_content_len:null==e||null===(ge=e.content_obj)||void 0===ge||null===(ge=ge.text)||void 0===ge?void 0:ge.length});if(t)if(p.C.addDuration(A,"first",!1),p.C.reportDurationPoint(A,"first",!0),p.C.updateMeta(A,{llm_intention:null===(pe=e.ext)||void 0===pe?void 0:pe.llm_intention,llm_intention_detail:null===(me=e.ext)||void 0===me?void 0:me.llm_intention_detail}),!B)null==D||D.trackEvent("receive_answer",(0,i.A)({duration:null==X||null===(fe=X.getDuration())||void 0===fe?void 0:fe.first,from:null===(ve=e.local_info)||void 0===ve?void 0:ve.from,next_connection_type:e.next_connection_type,content_type:e.content_type,success:1,conversation_id:z,bot_id:(0,y.Xc)(b.pU.getState(),z),message_id:C,section_id:null==e?void 0:e.section_id,scene:F.scene,message_type:(0,m.rJ)(e),is_cache:"1"===String(null==e||null===(ye=e.ext)||void 0===ye?void 0:ye.is_from_cache)?1:0},F)),null==D||D.trackEvent("message_answer_start",(0,i.A)({stream:1,from:null===(be=e.local_info)||void 0===be?void 0:be.from,next_connection_type:e.next_connection_type,retried:null!=e&&null!==(Se=e.local_info)&&void 0!==Se&&Se.retried?1:0,content_type:e.content_type,section_id:null==e?void 0:e.section_id,reply_id:j,conversation_id:z,skill_id:(null===(Ae=(0,k.O)(null==e||null===(ke=e.ext)||void 0===ke?void 0:ke.input_skill,{}))||void 0===Ae?void 0:Ae.skill_id)||"0",bot_id:e.bot_id},F))}if(!V&&B){const e={reason:U?"error":"stream-error",meta:{is_include_suggests:!1}};p.C.error(A,e)}if((0,w.up)(K,e))return;if((0,r.A)(null==Z||null===($=Z.getDuration())||void 0===$?void 0:$.receive_first_socket_packet)&&(null===(ee=e.local_info)||void 0===ee?void 0:ee.from)===E.aU.Socket&&p.C.addDuration(A,"receive_first_socket_packet",!1),null!==(te=e.local_info)&&void 0!==te&&te.received_first_chunk_packet_by_sse){var we;const t=null===(we=e.local_info)||void 0===we?void 0:we.received_first_chunk_packet_by_sse;p.C.addDuration(A,"received_first_chunk_packet_by_sse",!1,t)}if(null!==(se=e.local_info)&&void 0!==se&&se.decode_first_chunk_packet_by_sse){var Ee;const t=null===(Ee=e.local_info)||void 0===Ee?void 0:Ee.decode_first_chunk_packet_by_sse;p.C.addDuration(A,"decode_first_chunk_packet_by_sse",!1,t)}if(null!==(ie=e.local_info)&&void 0!==ie&&ie.merge_first_chunk_packet_by_sse){var Re;const t=null===(Re=e.local_info)||void 0===Re?void 0:Re.merge_first_chunk_packet_by_sse;p.C.addDuration(A,"merge_first_chunk_packet_by_sse",!1,t)}if(null!==(ne=e.local_info)&&void 0!==ne&&ne.fetch_stream_open){var Te;const t=null===(Te=e.local_info)||void 0===Te?void 0:Te.fetch_stream_open;p.C.addDuration(A,"fetch_stream_open",!1,t)}if(null!==(ae=e.local_info)&&void 0!==ae&&ae.received_first_text_packet_by_sse){var Me;const t=null===(Me=e.local_info)||void 0===Me?void 0:Me.received_first_text_packet_by_sse;p.C.addDuration(A,"received_first_text_packet_by_sse",!1,t)}var ze,Ce,xe;if((0,r.A)(null==Z||null===(oe=Z.getDuration())||void 0===oe?void 0:oe.receive_first_chunk_packet)&&(null===(re=e.local_info)||void 0===re?void 0:re.from)===E.aU.HttpChunk)p.C.addDuration(A,"receive_first_chunk_packet",!1),null==D||D.trackEvent("receive_first_chunk_packet",(0,i.A)({conversation_id:z,status:B?1:0,error_code:null==t?void 0:t.has_err,duration:null==X||null===(ze=X.getDuration())||void 0===ze?void 0:ze.receive_first_chunk_packet,message_id:C,retried:null==e||null===(Ce=e.local_info)||void 0===Ce?void 0:Ce.retried,from:null===(xe=e.local_info)||void 0===xe?void 0:xe.from,next_connection_type:e.next_connection_type,content_type:null==e?void 0:e.content_type},F));if(R[C]=(0,i.A)((0,i.A)((0,i.A)({},K),{},{local:(0,i.A)((0,i.A)({},K.local),{},{status:E.FQ.ReceivingStream,failed:!1,failedExpired:U||B?void 0:Date.now()+g.F6})},(0,a.A)(e,l.A)),{},{local_message_id:K.local_message_id}),U){var Le,Ue,Be,Ie,Oe,Pe,qe,Ge,De,Ne;if(u.v.console.info({namespace:null===(Le=e.local_info)||void 0===Le?void 0:Le.from,message:"replaceLocalMessageByRemote",meta:t}),(0,v.sK)({draft:f,localMessage:K,message:e,useRemoteMessageKey:!G,useOriginalMessageKey:!!G}),K.local.isRegenerate){const t=(0,c.A)(e);t.ext&&(t.ext.regen="1"),t.ext&&(t.ext.regen_active="1"),x.messageMap=(0,i.A)((0,i.A)({},x.messageMap),{},{[C]:t})}if(j)null===(Ne=w.Pv.get(E.aU.HttpLongPolling))||void 0===Ne||Ne.abortMessage(j);B||(p.C.addDuration(A,"success"),p.C.success((0,n.A)(A,["receive_message","receive_message_package"])));const s=A.receive_message;null==D||D.trackEvent("receive_stream",(0,i.A)((0,i.A)({duration:null==s||null===(Ue=s.getDuration())||void 0===Ue?void 0:Ue.success,from:null===(Be=e.local_info)||void 0===Be?void 0:Be.from,next_connection_type:e.next_connection_type,content_type:e.content_type,success:1,conversation_id:z,bot_id:(0,y.Xc)(b.pU.getState(),z),message_id:C,reply_id:j,section_id:null==e?void 0:e.section_id,scene:F.scene,is_onboarding:(0,m.RR)(e)?1:0,is_soft_link:(0,m.i0)(e),message_type:(0,m.rJ)(e),is_cache:"1"===String(null==e||null===(Ie=e.ext)||void 0===Ie?void 0:Ie.is_from_cache)?1:0},(0,S.EO)(e)),F)),null==D||D.trackEvent("message_answer_end",(0,i.A)({type:e.message_type,from:null===(Oe=e.local_info)||void 0===Oe?void 0:Oe.from,next_connection_type:e.next_connection_type,content_type:e.content_type,success:1,stream:1,section_id:null==e?void 0:e.section_id,result:void 0,reply_id:j,message_id:C,retried:null!=e&&null!==(Pe=e.local_info)&&void 0!==Pe&&Pe.retried?1:0,duration:null==s||null===(qe=s.getDuration())||void 0===qe?void 0:qe.success,conversation_id:z,skill_id:(null===(Ge=(0,k.O)(null===(De=e.ext)||void 0===De?void 0:De.input_skill,{}))||void 0===Ge?void 0:Ge.skill_id)||"0",bot_id:e.bot_id},F))}}else{var je;if(V=!I,T[C]=e,I||M.push({isLocalMessage:!1,messageId:C}),U)u.v.persist.info({namespace:null===(je=e.local_info)||void 0===je?void 0:je.from,message:"Receive Non-local Finished Message",meta:{message_id:C,conversation_id:z,is_exist:I}})}if(q){var Fe,Ve,He,Ke,We,Je,Qe,Ye,Xe,Ze,$e,et,tt,st,it,nt,at,ot,rt;null==N||null===(Fe=N.getMessageLifeCycleMiddleware())||void 0===Fe||null===(Ve=Fe.receiveMessageEnd)||void 0===Ve||Ve.call(Fe,e),null==N||null===(He=N.getMessageLifeCycle(e))||void 0===He||null===(Ke=He.receiveMessageEnd)||void 0===Ke||Ke.call(He,e,A);const{receive_total_messages:t}=A;null==D||D.trackEvent("message_total_answers_end",(0,i.A)({type:e.message_type,content_type:e.content_type,success:B?0:1,section_id:null==e?void 0:e.section_id,reply_id:j,duration:null==t||null===(We=t.getDuration())||void 0===We?void 0:We.success,conversation_id:z,skill_id:(null===(Je=(0,k.O)(null===(Qe=e.ext)||void 0===Qe?void 0:Qe.input_skill,{}))||void 0===Je?void 0:Je.skill_id)||"0",is_include_suggest:0,retried:null!=e&&null!==(Ye=e.local_info)&&void 0!==Ye&&Ye.retried?1:0,bot_id:e.bot_id,llm_intention:null===(Xe=e.ext)||void 0===Xe?void 0:Xe.llm_intention,llm_intention_detail:null===(Ze=e.ext)||void 0===Ze?void 0:Ze.llm_intention_detail},F));const s=(null==Z||null===($e=Z.getDuration())||void 0===$e?void 0:$e.first_text)||(null==Z||null===(et=Z.getDuration())||void 0===et?void 0:et.first)||0;null==D||D.trackEvent("message_receive_first_package",(0,i.A)({conversation_id:z,status:B?1:0,error_code:null==e||null===(tt=e.error_details)||void 0===tt?void 0:tt.error_code,duration:s,retried:null!=e&&null!==(st=e.local_info)&&void 0!==st&&st.retried?1:0,message_id:C,from:null===(it=e.local_info)||void 0===it?void 0:it.from,next_connection_type:e.next_connection_type,content_type:null==e?void 0:e.content_type,skill_id:(null===(nt=(0,k.O)(null==e||null===(at=e.ext)||void 0===at?void 0:at.input_skill,{}))||void 0===nt?void 0:nt.skill_id)||"0",bot_id:e.bot_id,llm_intention:null===(ot=e.ext)||void 0===ot?void 0:ot.llm_intention,llm_intention_detail:null===(rt=e.ext)||void 0===rt?void 0:rt.llm_intention_detail},F)),B||p.C.success((0,o.A)(A,["receive_message","receive_message_package"]),{is_include_suggest:!1})}}}),e.section_id&&V&&!I){const t=O?void 0:(0,f.tP)(R.ozw.getState(),z,{isLocalMessage:!1,messageId:j});(null==t?void 0:t.section_id)!==e.section_id&&b.pU.getState().updateLastSectionId(z,e.section_id)}const K=(0,m.Wp)(e);if(U&&K&&e.reply_id){if(!M.hasReportEvent(z,e.reply_id,"message_receive_suggests")){const t=(0,h.XB)({eventName:"message_receive_suggests",meta:{message_id:e.message_id,reply_id:e.reply_id,conversation_type:L}});t.errorIfIdle(g.so,{reason:"timeout"}),M.mergeReportEvents(z,e.reply_id,{message_receive_suggests:t})}M.updateSuggestMessage(z,(()=>({replyId:x,loading:!0,failed:!1,expired:Date.now()+g.so,suggests:[]})))}U&&(0,m.pu)(e)&&M.updateSearchResultStatus(j,!0),null==N||null===(t=N.getMessageLifeCycleMiddleware())||void 0===t||t.receiveMessageUpdate(e);const W=(0,i.A)((0,i.A)({},M.getReportEvents(z,x)),M.getReportEvents(z,C));if(null==N||null===(s=N.getMessageLifeCycle(e))||void 0===s||null===(T=s.receiveMessageUpdate)||void 0===T||T.call(s,e,W),B){var J,Q;null==N||null===(J=N.getMessageLifeCycle(e))||void 0===J||null===(Q=J.receiveMessageFailed)||void 0===Q||Q.call(J,e,W);const t=null==N?void 0:N.getErrorLifeCycles(e);null==t||t.forEach((t=>{var s;return null==t||null===(s=t.receiveMessageFailed)||void 0===s?void 0:s.call(t,e)}))}}},10092:(e,t,s)=>{s.d(t,{B:()=>a});var i=s(44557),n=s(18590);const a=({message:e,localReceiveMessage:t,reportParams:s})=>{var a,o,r,l,c,d,u,h,_,g;return(0,i.A)({conversation_id:e.conversation_id,message_id:e.message_id,from:null===(a=e.local_info)||void 0===a?void 0:a.from,local_message_id:null==t?void 0:t.local_message_id,is_regenerate:null==t?void 0:t.local.isRegenerate,has_err:null===(o=e.error_details)||void 0===o?void 0:o.error_code,log_id:null===(r=e.local_info)||void 0===r?void 0:r.log_id,inner_log_id:null==e||null===(l=e.ext)||void 0===l?void 0:l.log_id,trace_id:null===(c=e.local_info)||void 0===c?void 0:c.trace_id,retried:null==e||null===(d=e.local_info)||void 0===d?void 0:d.retried,reply_id:null==e?void 0:e.reply_id,next_connection_type:null==e?void 0:e.next_connection_type,content_type:String(e.content_type),skill_id:null===(u=(0,n.O)(null===(h=e.ext)||void 0===h?void 0:h.input_skill,{}))||void 0===u?void 0:u.skill_id,skill_type:null===(_=(0,n.O)(null===(g=e.ext)||void 0===g?void 0:g.input_skill,{}))||void 0===_?void 0:_.skill_type},s)}},57387:(e,t,s)=>{s.d(t,{Kq:()=>E,QO:()=>M,TP:()=>z,Xv:()=>w,_s:()=>x,bT:()=>T,t:()=>R});var i=s(44557),n=s(5099),a=s(9012),o=s(18590),r=s(13734),l=s(37357),c=s(22358),d=s(81435),u=s(81626),h=s(42800),_=s(90895),g=s(75484),p=s(1713),m=s(1524),f=s(72975),v=s(10129),y=s(73014),b=s(36225),S=s(98673),A=s(69902),k=s(67666);const w=e=>e.reportParams.preset_prompt_type?{prompt_type:"default_prompt",default_prompt_type:e.reportParams.preset_prompt_type}:{prompt_type:"customized_prompt"},E=e=>{var t;let s=!0;return(0,h.Bu)(e)&&""===(null==e?void 0:e.text)&&(s=!1),((0,h.kk)(e)||(0,h.fr)(e))&&""===(null==e||null===(t=e.compositeContent)||void 0===t?void 0:t.text)&&(s=!1),(0,h.JG)(e)&&(s=!1),{used_prompt:s?1:0}},R=e=>{try{if((0,h.Bu)(e)&&e.nestedItems.length>=0){var t;const s=e.nestedItems,i=s.map((e=>e.fileKey)),n=s.map((e=>(0,r.ti)((0,r.GO)(e.fileName)))),a=s.map((e=>e.size||0)),l=new Set(n).size>1;return{upload_id:e.preGeneratedLocalMessageId,upload_file_num:s.length,upload_file_size:a.join(","),is_upload_file:1,is_upload_mix_type:l?1:0,upload_file_type:n.join(","),collection_id:1===i.length?i[0]:(0,o.e)(i),upload_collection_way:0===s.length?void 0:1===s.length?"single":"multi",upload_from:null===(t=e.reportParams)||void 0===t?void 0:t.upload_from}}if((0,h.kk)(e)||(0,h.fr)(e)){var s;const t=(0,h.kk)(e)?e.compositeContent.files:e.compositeContent.images,i=t.map((e=>"blob"in e?(0,A.p)("name")(e.blob):"file_name"in e?e.file_name:void 0)).filter(b.q3)[0]||"",n=t.map((e=>{if("key"in e)return e.key})).filter(b.q3)[0]||"";return{is_upload_file:1,upload_id:e.preGeneratedLocalMessageId,upload_file_num:1,upload_file_size:0,is_upload_mix_type:0,upload_file_type:(0,r.ti)((0,r.GO)(i)),collection_id:n,upload_collection_way:"single",upload_from:null===(s=e.reportParams)||void 0===s?void 0:s.upload_from}}var i,n;return(0,h.JG)(e)?"image"in e&&e.image?{is_upload_file:1,upload_id:e.preGeneratedLocalMessageId,upload_file_num:1,upload_file_size:e.image.size,is_upload_mix_type:0,upload_file_type:(0,r.ti)((0,r.GO)((0,A.p)("name")(e.image))),collection_id:e.local_key,upload_collection_way:"single",upload_from:null===(i=e.reportParams)||void 0===i?void 0:i.upload_from}:"image_key"in e&&e.image_key?{is_upload_file:1,upload_id:e.preGeneratedLocalMessageId,upload_file_num:1,upload_file_size:0,is_upload_mix_type:0,upload_file_type:"Image",collection_id:e.image_key,upload_collection_way:"single",upload_from:null===(n=e.reportParams)||void 0===n?void 0:n.upload_from}:{is_upload_file:0}:{is_upload_file:0}}catch(a){return{}}},T=e=>{var t;const s=null===(t=e.extraExt)||void 0===t?void 0:t.reference_content;if(!s)return{is_quote:0};const i=(0,o.O)(s,[])[0];return{is_quote:1,quote_type:"attachment"===(null==i?void 0:i.type)?"file":"url"}},M={trackSendMessageStatusEvent:(e,t)=>{var s,n;const{sendMessageReport:a,reportParams:o}=t,{conversation_id:r,bot_id:l,message_id:c,section_id:u,is_ogf:h,enter_from:m,content_type:v}=a.getMeta(),b=y.gO.get("chatConfigService"),A=y.gO.get("chatBotService"),k=y.gO.get("chatTeaService");if(!b)return;const{loginSource:w}=b.chatReportParams,{botInfo:E}=(0,_.tY)(g.pU.getState(),r),R=(0,_.Rx)(g.pU.getState(),r),T=(0,p.D)(g.pU.getState(),"",r,E,R);null==k||k.trackEvent("send_message_status",(0,i.A)((0,i.A)((0,i.A)((0,i.A)({duration:null===(s=t.sendMessageReport.getDuration())||void 0===s?void 0:s.ack,success:t.success?1:0,result:t.success?void 0:"shark",conversation_id:r,conversation_type:R,chat_type:T,bot_id:l,message_id:c,section_id:u,scene:"seo_keyboard"===o.scene?"keyboard":o.scene,is_gpt4:h,message_type:(0,S.rJ)(e)},o),{},{use_skill:o.use_skill?1:0},w?{previous_page:w}:{}),v===d.cM.Text?{original_content_source:o.content_source||f.Z.Other}:{}),m&&"bot_discover"===m?{user_id:b.userId,req_id:l?null==A||null===(n=A.getBotIdToRequestIdMap())||void 0===n?void 0:n[l]:"",recommend_from:"bot_list_discover"}:{}))},logSendMessage:e=>{l.v.console.info({message:"send message",meta:{localMessage:e}})},trackSendMessageStartEvent:(e,t)=>{const s=y.gO.get("chatTeaService");null==s||s.trackEvent("message_send_start",{from:v.aU.Socket,type:e.message_type,send_id:e.message_id,section_id:e.section_id,local_message_id:e.local_message_id,conversation_id:e.conversation_id,skill_id:t.skill_id||"0"})},trackSendMessageEndEvent:(e,t)=>{var s,i,n;const{reportParams:a,sendMessageReport:o}=t,{retried:r}=o.getMeta(),l=y.gO.get("chatTeaService");null==l||l.trackEvent("message_send_end",{success:t.success?1:0,stream:0,duration:(null===(s=t.sendMessageReport)||void 0===s||null===(s=s.getDuration())||void 0===s?void 0:s.ack)||(null===(i=t.sendMessageReport)||void 0===i||null===(i=i.getDuration())||void 0===i?void 0:i.failed),from:null==e||null===(n=e.local_info)||void 0===n?void 0:n.from,type:e.message_type,section_id:e.section_id,local_message_id:e.local_message_id,conversation_id:e.conversation_id,retry:r,skill_id:a.skill_id||"0"})},trackSendMessageEvent:(e,t)=>{const{resolved:s,ctx:a,reportParams:r}=e,{enterFrom:l}=a,c=y.gO.get("chatConfigService"),h=y.gO.get("chatTeaService"),_=y.gO.get("chatBotService"),{loginSource:g}=(null==c?void 0:c.chatReportParams)||{};var p,m,b,S;s.isRegenerate||(null==h||h.trackEvent("send_message",(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({message_type:s.message_type,from:v.aU.Socket,conversation_id:a.conversationId,conversation_type:s.conversation_type,bot_id:s.bot_id,chat_type:s.chat_type},(0,n.A)(r,"from")),{},{scene:"seo_keyboard"===r.scene?"keyboard":r.scene,sec_scene:"resend"===r.scene?"resend":r.sec_scene,use_skill:r.use_skill?1:0,skill_id:r.skill_id,skill_name:r.skill_name,is_gpt4:(0,u.hy)(),is_quote:(Number(null===(p=(0,o.O)(null===(m=s.localCreateExt)||void 0===m?void 0:m.reference_content,{}))||void 0===p?void 0:p.length)||0)>0?1:0},s.content_type===d.cM.Text?{original_content_source:r.content_source||f.Z.Other}:{}),["keyboard_unlog","seo_keyboard"].includes(r.scene)&&g?{previous_page:g}:{}),l&&"bot_discover"===l?{user_id:null==c?void 0:c.userId,req_id:s.bot_id?null==_||null===(b=_.getBotIdToRequestIdMap())||void 0===b?void 0:b[s.bot_id]:"",recommend_from:"bot_list_discover"}:{}),null!==(S=t.ext)&&void 0!==S&&S.collection_id?{collection_id:t.ext.collection_id}:{})))},trackOnBoardingMessageSentEvent(){const e=y.gO.get("chatTeaService");null==e||e.trackEvent("auto_onboarding_message_sent",{type:"create_chat"})},trackUploadParseStatus(e,t){const{conversationId:s}=t.resolved,n=y.gO.get("chatTeaService");if((0,h.Bu)(t)){var a;const l=t.nestedItems.length,{botInfo:d}=(0,m.cL)(s),u=(0,o.O)(null===(a=t.resolved.localCreateExt)||void 0===a?void 0:a.input_skill,{});t.nestedItems.forEach((a=>{var o;const h={conversation_id:s,chat_type:(0,m.CB)("",s,d),skill_name:(u.skill_type||"").toString(),skill_id:u.skill_id||"",upload_id:t.resolved.localMessageId,upload_collection_way:l>1?"multi":"single",upload_type:"Image"===(0,r.ti)(a.fileName)?"pic":"pdf",upload_file_type:(0,r.GO)(a.fileName),upload_file_size:(null===(o=e.preprocessTaskMap[a.identifier])||void 0===o||null===(o=o.file)||void 0===o?void 0:o.size)||0};a.parseState===c.hI.ParseState_Failed?null==n||n.trackEvent("upload_parse_status",(0,i.A)({status:0,error_code:"parse_failed"},h)):null==n||n.trackEvent("upload_parse_status",(0,i.A)({status:1},h))}))}}};function z(e,t,s){var i;k.C.updateMeta(s.reportEvents,L(e,t)),k.C.addDuration(s.reportEvents,"has_err"),k.C.error(s.reportEvents,{reason:"has_err",meta:{has_err:null===(i=t.error_details)||void 0===i?void 0:i.error_code}}),C(t,{sendMessageReport:(0,a.A)(s.reportEvents,"send_message"),reportParams:s.reportParams,isRegenerate:s.isRegenerate,success:!1})}function C(e,t){t.sendMessageReport&&!t.isRegenerate&&(M.trackSendMessageStatusEvent(e,t),M.trackSendMessageEndEvent(e,t))}function x(e,t,s){k.C.updateMeta(s.reportEvents,L(e,t)),k.C.addDuration(s.reportEvents,"ack",!1),k.C.success(s.reportEvents),C(t,{sendMessageReport:(0,a.A)(s.reportEvents,"send_message"),reportParams:s.reportParams,isRegenerate:s.isRegenerate,success:!0})}function L(e,t){var s,i,n;const{local_message_id:a,conversation_id:o,local_conversation_id:r,bot_id:l,message_id:c}=t;return{local_message_id:a,conversation_id:o,local_conversation_id:r,from:null===(s=t.local_info)||void 0===s?void 0:s.from,bot_id:l||(0,_.Xc)(g.pU.getState(),o),message_id:c,reply_id:t.reply_id,retried:null===(i=t.local_info)||void 0===i?void 0:i.retried,log_id:null==t||null===(n=t.ext)||void 0===n?void 0:n.log_id,section_id:null==t?void 0:t.section_id,message_type:null==t?void 0:t.message_type}}},93270:(e,t,s)=>{s.d(t,{h:()=>n});var i=s(82854);const n=()=>(e=>{const{userOgf:t}=e;if(null!=t&&t.featureEnabled)return null!=t&&t.value?1:0})(i.ozw.getState())},21890:(e,t,s)=>{s.d(t,{B:()=>a});var i=s(56642),n=s(82854);const a=(e,t=i.x)=>{const s=(...s)=>(0,n.ozw)((t=>e(t,...s)),t);return s.raw=e,s}},34968:(e,t,s)=>{s.d(t,{v:()=>_});var i=s(44557),n=s(14065),a=s(49392),o=s(10129),r=s(27527),l=s(22358),c=s(37357),d=s(61276),u=s(49944);function h(){return(h=(0,n.A)((function*(e,t){var s;const{data:i}=yield r.j.apiService.message.GetMessageListByIndexList({conversation_id:e,message_index_list:[t]});if(null!=i&&null!==(s=i.message_list)&&void 0!==s&&s.length){const{message_list:e}=i;return e[0]}}))).apply(this,arguments)}const _={namespace:"cmd",pluginId:"MessageUpdate",cmdType:l.HK.MessageUpdate,LifeCycle:class{receiveCmdEnd(e){return(0,n.A)((function*(){const{conversation_id:t,message_id:s,index:n}=e;if(c.v.info({message:"Cmd: MessageUpdate",meta:{conversation_id:t,message_id:s,index:n}}),!t||!s||(0,a.A)(n))return;const r=yield function(e,t){return h.apply(this,arguments)}(t,n);if(!r)return;const l=(0,i.A)((0,i.A)({},(0,d.xr)(r,{finish_reply:!0,from:o.aU.AsyncFetch})),{},{message_id:s,conversation_id:t});(0,u.P)(l)}))()}}}},8382:(e,t,s)=>{s.d(t,{WZ:()=>a,ci:()=>l,rQ:()=>o,rU:()=>r});var i=s(20177),n=s(56422);s(64873);const a=(e,t)=>(0,i.A)(e||[],(e=>t(e))),o=(e=[],t)=>a(e,(e=>{var s;return!e.isLocalMessage&&!!e.messageId&&(null===(s=null==t?void 0:t(e))||void 0===s||s)})),r=({messageLinks:e=[],replyId:t,getMessage:s})=>(0,n.A)(e,(e=>{var i;return(null===(i=s(e))||void 0===i?void 0:i.reply_id)===t})),l=({messageLinks:e=[],replyId:t,getMessage:s})=>a(e,(e=>{var i;return(null===(i=s(e))||void 0===i?void 0:i.reply_id)===t}))},89638:(e,t,s)=>{s.d(t,{x:()=>o});var i=s(44557),n=s(81435),a=s(8382);const o=({prevMessageId:e,message:t,messageLinks:s,localMessageStatus:o,failedExpired:r,sendLoadingExpired:l,isRegenerate:c,localContent:d,enterFrom:u})=>{var h;return(0,i.A)((0,i.A)({},t),{},{message_type:n.Go.Message,create_time:Date.now(),status:t.status||n.q7.Available,local_content:d,local:{prevRemoteMessageId:e||(null===(h=(0,a.rQ)(s))||void 0===h?void 0:h.messageId)||"",status:o,failed:!1,isRetried:!1,failedExpired:r,sendLoadingExpired:l,isRegenerate:c,enterFrom:u}})}},67666:(e,t,s)=>{s.d(t,{C:()=>i});const i={addDuration(e,t,s=!0,i){Object.values(e||{}).forEach((e=>{null==e||e.addDurationPoint(t,s,i)}))},updateMeta(e,t){Object.values(e||{}).forEach((e=>{null==e||e.updateMeta(t)}))},reportDurationPoint(e,...t){Object.values(e||{}).forEach((e=>{null==e||e.reportDurationPoint(...t)}))},success(e,t){Object.values(e||{}).forEach((e=>{null==e||e.success(t)}))},error(e,t){Object.values(e||{}).forEach((e=>{null==e||e.error(t)}))}}},94063:(e,t,s)=>{function i(e){const t=Date.now();if(e%Math.pow(10,t.toString().length-1)===e){const s=1e3*e;return s<t?s:e}return e}s.d(t,{Q:()=>i})},25442:(e,t,s)=>{function i(e){const{conversation_id:t,local_conversation_id:s}=e;return!(!s||!t)}s.d(t,{o:()=>i})},10734:(e,t,s)=>{s.d(t,{G:()=>o});var i=s(10633);const n=Symbol("newer"),a=Symbol("older");class o{constructor(e,t){(0,i.A)(this,"size",void 0),(0,i.A)(this,"limit",void 0),(0,i.A)(this,"oldest",void 0),(0,i.A)(this,"newest",void 0),(0,i.A)(this,"_keyMap",void 0),this.size=0,this.limit=e,this.oldest=this.newest=void 0,this._keyMap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[n]&&(e===this.oldest&&(this.oldest=e[n]),e[n][a]=e[a]),e[a]&&(e[a][n]=e[n]),e[n]=void 0,e[a]=this.newest,this.newest&&(this.newest[n]=e),this.newest=e)}assign(e){let t,s=this.limit||Number.MAX_VALUE;this._keyMap.clear();const i=e[Symbol.iterator]();for(let o=i.next();!o.done;o=i.next()){const e=new r(o.value[0],o.value[1]);if(this._keyMap.set(e.key,e),t?(t[n]=e,e[a]=t):this.oldest=e,t=e,0==s--)throw new Error("overflow")}this.newest=t,this.size=this._keyMap.size}get(e){const t=this._keyMap.get(e);if(t)return this._markEntryAsUsed(t),t.value}set(e,t){let s=this._keyMap.get(e);return s?(s.value=t,this._markEntryAsUsed(s),this):(this._keyMap.set(e,s=new r(e,t)),this.newest?(this.newest[n]=s,s[a]=this.newest):this.oldest=s,this.newest=s,++this.size,this.size>this.limit&&this.shift(),this)}shift(){const e=this.oldest;var t;if(e)return null!==(t=this.oldest)&&void 0!==t&&t[n]?(this.oldest=this.oldest[n],this.oldest[a]=void 0):(this.oldest=void 0,this.newest=void 0),e[n]=e[a]=void 0,this._keyMap.delete(e.key),--this.size,[e.key,e.value]}find(e){const t=this._keyMap.get(e);return t?t.value:void 0}has(e){return this._keyMap.has(e)}delete(e){const t=this._keyMap.get(e);if(t)return this._keyMap.delete(t.key),t[n]&&t[a]?(t[a][n]=t[n],t[n][a]=t[a]):t[n]?(t[n][a]=void 0,this.oldest=t[n]):t[a]?(t[a][n]=void 0,this.newest=t[a]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=this.newest=void 0,this.size=0,this._keyMap.clear()}keys(){return new c(this.oldest)}values(){return new d(this.oldest)}entries(){return this}[Symbol.iterator](){return new l(this.oldest)}forEach(e,t){"object"!=typeof t&&(t=this);let s=this.oldest;for(;s;)e.call(t,s.value,s.key,this),s=s[n]}toJSON(){let e=new Array(this.size),t=0,s=this.oldest;for(;s;)e[t++]={key:s.key,value:s.value},s=s[n];return e}toString(){let e="",t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,t=t[n],t&&(e+=" < ");return e}}class r{constructor(e,t){(0,i.A)(this,n,void 0),(0,i.A)(this,a,void 0),this.key=e,this.value=t,this[n]=void 0,this[a]=void 0}}class l{constructor(e){(0,i.A)(this,"entry",void 0),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[n],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class c{constructor(e){(0,i.A)(this,"entry",void 0),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[n],{done:!1,value:e.key}):{done:!0,value:void 0}}}class d{constructor(e){(0,i.A)(this,"entry",void 0),this.entry=e}[Symbol.iterator](){return this}next(){const e=this.entry;return e?(this.entry=e[n],{done:!1,value:e.value}):{done:!0,value:void 0}}}},32102:(e,t,s)=>{s.d(t,{E:()=>n});var i=s(9012);const n=e=>({onboarding_content_source:(0,i.A)(e,["ext","onboarding_content_source"],"")})},80576:(e,t,s)=>{s.r(t),s.d(t,{HttpAdapter:()=>I,HttpChunkAdapter:()=>T,SamanthaChatCompletionAdapter:()=>Z,SocketAdapter:()=>P});var i=s(10633),n=s(44557),a=s(14065),o=s(40967),r=s(85886),l=s(37462),c=s(47686),d=s(49392),u=s(60163),h=s(60588),_=s(18590),g=s(16100),p=s(37357),m=s(96274),f=s(27737),v=s(30642),y=s(10129),b=s(46219),S=s(87233);const A="last-event-id",k="text/event-stream";class w extends h.A{constructor(e){super(),(0,i.A)(this,"_retryCounter",void 0),(0,i.A)(this,"_fetchInstance",void 0),(0,i.A)(this,"_reporter",void 0),(0,i.A)(this,"_logId",void 0),(0,i.A)(this,"_deprecatedFetchStream",void 0),(0,i.A)(this,"_newFetchStream",void 0),(0,i.A)(this,"_baseURL",void 0),(0,i.A)(this,"_chunkTask",void 0),(0,i.A)(this,"_getCommonHttpParams",void 0),(0,i.A)(this,"_getCommonHttpHeaders",void 0),(0,i.A)(this,"_emitEventThrottle",void 0),(0,i.A)(this,"id",void 0),(0,i.A)(this,"status",void 0),this._config=e;const{maxRetryAttempts:t,deprecatedFetchStream:s,newFetchStream:n,getCommonHttpParams:a,getCommonHttpHeaders:o,baseURL:l,chunkInterval:c=500}=this._config;this._retryCounter=new v.n0(t),this.id=Symbol("eventSourceWorker"),this.status=S.T.idle,this._handleEvent=this._handleEvent.bind(this),this._handleError=this._handleError.bind(this),this._handleFinish=this._handleFinish.bind(this),this._handleOpen=this._handleOpen.bind(this),this._handleEventSource=this._handleEventSource.bind(this),this._deprecatedFetchStream=s,this._newFetchStream=n,this._getCommonHttpParams=a,this._getCommonHttpHeaders=o,this._baseURL=l;const d=this.emit.bind(this);this._emitEventThrottle=(0,r.A)((e=>d("event",...e)),c)}_fetchStream(e){if(this._reporter=(0,g.XB)({eventName:"fetch_stream",logger:p.v,meta:{conversation_id:(null==e?void 0:e.conversationId)||"",reply_id:e.replyId,seq_st:(Number(e.chunkSeq)||0)+1,binary_type:this._config.binaryType}}),this._newFetchStream){var t,s,i;this._fetchInstance=null===(t=this._newFetchStream)||void 0===t?void 0:t.call(this,(0,v.ID)(`${this._baseURL||""}/alice/message/stream_reply`,null===(s=this._getCommonHttpParams)||void 0===s?void 0:s.call(this)),{method:"POST",headers:[["content-type","application/json"],...(0,u.A)((null===(i=this._getCommonHttpHeaders)||void 0===i?void 0:i.call(this))||{})],body:(0,_.e)({seq_st:(Number(e.chunkSeq)||0)+1,reply_id:e.replyId,binary_type:this._config.binaryType}),credentials:"same-origin",onError:this._handleError,onMessage:this._handleEventSource,openInterceptor:this._handleOpen})}else{var n;const t={cancel:l.A,CONNECTING:0,OPEN:1,CLOSED:2,readyState:0,lastEventId:0,isAborted:!1,on:l.A,off:l.A,start:l.A};this._fetchInstance=t,null===(n=this._deprecatedFetchStream)||void 0===n||n.call(this,{req:{url:`${this._baseURL||""}/alice/message/stream_reply`,body:{seq_st:(Number(e.chunkSeq)||0)+1,reply_id:e.replyId,binary_type:this._config.binaryType}},reportMeta:{conversation_id:(null==e?void 0:e.conversationId)||"",reply_id:e.replyId,seq_st:(Number(e.chunkSeq)||0)+1,binary_type:this._config.binaryType},onMessage:this._handleEvent,onError:(e,t)=>{this._logId=t,this._handleError(e)},onFinish:this._handleFinish,subscribeAbortTrigger:e=>{t.cancel=s=>{e(s),t.isAborted=!0}},getCommonHttpParams:this._getCommonHttpParams,getCommonHttpHeaders:this._getCommonHttpHeaders})}}_handleOpen(e){var t=this;return(0,a.A)((function*(){var s;const i=e.headers.get("content-type");if(null==i||!i.startsWith(k)){const t=yield e.json();throw new Error(JSON.stringify(t))}if(null==e||!e.ok||null==e||!e.body)throw new Error(JSON.stringify({msg:`Invalid Response, ResponseStatus: ${e.statusText}`,code:y.O4.ResponseIsInvalid}));null===(s=t._reporter)||void 0===s||s.addDurationPoint("fetch_stream_open"),t._logId=e.headers.get("x-tt-logid")||""}))()}_handleEventSource(e){var t,s,i;const{data:n="",event:a}=e;var o;(0,d.A)(null===(t=this._reporter)||void 0===t||null===(t=t.getDuration())||void 0===t?void 0:t.received_first_chunk_packet_by_sse)&&(null===(o=this._reporter)||void 0===o||o.addDurationPoint("received_first_chunk_packet_by_sse"));switch(a){case"pb":try{var r;const e=(0,v.Lf)(n);var l;if((0,d.A)(null===(r=this._reporter)||void 0===r||null===(r=r.getDuration())||void 0===r?void 0:r.decode_first_chunk_packet_by_sse))null===(l=this._reporter)||void 0===l||l.addDurationPoint("decode_first_chunk_packet_by_sse");this._handleEvent(e)}catch(c){throw c instanceof Error&&this._handleError(JSON.stringify({message:c.message,code:y.O4.StreamParseFailed})),c}return;case"json":return void this._handleEvent((0,_.O)(n,{}));case"done":return this._handleFinish(!0),null===(s=this._reporter)||void 0===s||s.addDurationPoint("success"),void(null===(i=this._reporter)||void 0===i||i.success());case"err":throw this._handleError(JSON.stringify({message:n,code:y.O4.ServerError})),new Error(n);default:return}}_handleEvent(e){var t;null!=this&&null!==(t=this._config)&&void 0!==t&&t.consoleIncrementMessagePacket&&p.v.console.info({namespace:"HttpChunk",message:"Increment Chunk Received",meta:{chunk:e}}),e.event_type===m.B.Message&&this._batchUpdateMessage(e)}_batchUpdateMessage(e){var t;const s=(0,d.A)(null===(t=this._reporter)||void 0===t||null===(t=t.getDuration())||void 0===t?void 0:t.merge_first_chunk_packet_by_sse);let i=!1;if(e.message_list){const t=[];for(const s of e.message_list){var a;const e=this._mergeMessage(s);var o;if((0,d.A)(null===(a=this._reporter)||void 0===a||null===(a=a.getDuration())||void 0===a?void 0:a.received_first_text_packet_by_sse)&&(0,v.pu)(e))null===(o=this._reporter)||void 0===o||o.addDurationPoint("received_first_text_packet_by_sse"),i=!0;t.push(e)}const l=(0,n.A)((0,n.A)({},e),{},{message_list:t});var r;if(s)null===(r=this._reporter)||void 0===r||r.addDurationPoint("merge_first_chunk_packet_by_sse");this._emitEventThrottle([l]);l.message_list.every((e=>{var t;return"1"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.is_finish)}))&&this._emitEventThrottle.flush()}if(e.message){var l,c;const{message:t}=e,a=this._mergeMessage(t),o=(0,n.A)((0,n.A)({},e),{},{message:a});var u;if(s)null===(u=this._reporter)||void 0===u||u.addDurationPoint("merge_first_chunk_packet_by_sse");var h;if((0,d.A)(null===(l=this._reporter)||void 0===l||null===(l=l.getDuration())||void 0===l?void 0:l.received_first_text_packet_by_sse)&&(0,v.pu)(a))null===(h=this._reporter)||void 0===h||h.addDurationPoint("received_first_text_packet_by_sse"),i=!0;this._emitEventThrottle([o]);("1"===(null===(c=o.message)||void 0===c||null===(c=c.ext)||void 0===c?void 0:c.is_finish)||i)&&this._emitEventThrottle.flush()}}_mergeMessage(e){var t,s;if(!this._chunkTask)return(0,v.xr)(e);const{completionMessageMap:i,replyId:a}=this._chunkTask,{message_id:o}=e||{};i[b.Ln]&&delete i[b.Ln];const r=o||b.Ln,l=null===(t=this._reporter)||void 0===t?void 0:t.getDurationTimestamp(),c=(0,v.xr)(e,(0,n.A)({from:y.aU.HttpChunk,log_id:this._logId||"",retried:!(null===(s=this._retryCounter)||void 0===s||!s.attempts)},l)),d=(0,v.Uy)(i[r],c)||(0,v.xr)(e);return i[r]=d,this.emit("update_task",a,d),d}_handleError(e){var t,s,i,n,a;let o={message:"",code:0};if(e instanceof Error?o={message:e.message,code:y.O4.FetchFailed}:"string"==typeof e&&(o=JSON.parse(e)),null===(t=this._reporter)||void 0===t||t.error({reason:null===(s=o)||void 0===s?void 0:s.message,meta:{error:o,log_id:this._logId},error:e}),null===(i=this._fetchInstance)||void 0===i||!i.isAborted)if(this._emitEventThrottle.flush(),null===(n=this._fetchInstance)||void 0===n||null===(a=n.cancel)||void 0===a||a.call(n,JSON.stringify({msg:"abort by error",code:y.O4.AbortFetch})),o.code===y.O4.ServerError){const e=(0,_.O)(o.message,{}),{code:t}=e;switch(t){case f.t.NETWORK_TIMEOUT:case f.t.MYSQL_ERROR:case f.t.REDIS_ERROR:case f.t.SYSTEM_ERROR2:return void this._reFetchStream({message:e.msg,code:e.code});default:this._batchEmitErrorMessage({message:e.msg,code:e.code})}}else{if(o.code===y.O4.AbortFetch)return;this._reFetchStream({message:o.message,code:v.ge})}}_reFetchStream(e){var t=this;return(0,a.A)((function*(){if(t._retryCounter.matchMaxRetryAttempts())return t._batchEmitErrorMessage(e),void t._handleFinish();t._retryCounter.add(),t._retryCounter.attempts>1&&(yield t._wait(t._retryCounter.attempts)),t._chunkTask&&t._fetchStream(t._chunkTask)}))()}_wait(e){return new Promise((t=>{setTimeout(t,this._getIntervalValue(e))}))}_getIntervalValue(e){const{minFetchInterval:t=500,maxFetchInterval:s=5e3,fetchIntervalGrowFactor:i=2}=this._config||{},n=t*Math.pow(i,e-1);return n>s?s:n}_handleFinish(e){e&&this._batchFinishMessage(),this._reset(),this.emit("finish",this.id)}_batchEmitErrorMessage(e){if(!this._chunkTask)return;const{completionMessageMap:t}=this._chunkTask;for(const s of(0,o.A)(t))this.emit("event",(0,v.C_)(s,e,this._logId||""))}_batchFinishMessage(){if(!this._chunkTask)return;const{completionMessageMap:e}=this._chunkTask;this._emitEventThrottle.flush();for(const t of(0,c.A)(e)){const s=(0,v.oQ)(e[t]),i=(0,n.A)((0,n.A)({},e[t]),{},{local_info:(0,n.A)((0,n.A)({},e[t].local_info||{}),{},{finish_reply:!s,from:y.aU.HttpChunk})});e[t]=i,this.emit("event",{event_type:m.B.Message,message:i})}}_reset(){var e;this.emit("clean",(null===(e=this._chunkTask)||void 0===e?void 0:e.replyId)||""),this._retryCounter.reset(),this._chunkTask=void 0,this.status=S.T.idle}_init(e){this.status=S.T.running,this._chunkTask=(0,v.NY)(e),this._retryCounter.reset()}get replyId(){var e;return null===(e=this._chunkTask)||void 0===e?void 0:e.replyId}startTask(e){this._init(e),this._fetchStream(e)}abort(){var e,t;this._emitEventThrottle.flush(),null===(e=this._fetchInstance)||void 0===e||null===(t=e.cancel)||void 0===t||t.call(e,JSON.stringify({msg:"breakdown",code:y.O4.AbortFetch})),this._reset()}}var E=s(13303),R=s(80210);class T extends E.a7{constructor(e){super(e),(0,i.A)(this,"_workerMap",new Map),(0,i.A)(this,"_poolSize",1),(0,i.A)(this,"_queue",[]),(0,i.A)(this,"_maxRetryAttempt",3),(0,i.A)(this,"_deprecatedFetchStream",void 0),(0,i.A)(this,"_newFetchStream",void 0),(0,i.A)(this,"_baseURL",void 0),(0,i.A)(this,"_binaryType","pb"),(0,i.A)(this,"_getCommonHttpParams",void 0),(0,i.A)(this,"_getCommonHttpHeaders",void 0),(0,i.A)(this,"_consoleIncrementMessagePacket",!1),(0,i.A)(this,"from",y.aU.HttpChunk),this._handleEvent=this._handleEvent.bind(this),this._handleFinish=this._handleFinish.bind(this),this._handleClean=this._handleClean.bind(this),this._handleUpdateTask=this._handleUpdateTask.bind(this),this._poolSize=e.poolSize||1,this._maxRetryAttempt=e.retryAttempt||3,this._getCommonHttpParams=e.getCommonHttpParams,this._getCommonHttpHeaders=e.getCommonHttpHeaders,this._deprecatedFetchStream=e.deprecatedClient,this._newFetchStream=e.newClient,this._baseURL=e.baseURL,this._binaryType=e.binaryType||"pb",this._consoleIncrementMessagePacket=e.consoleIncrementMessagePacket||!1}_initWorker(){const e=new w({maxRetryAttempts:this._maxRetryAttempt,deprecatedFetchStream:this._deprecatedFetchStream,newFetchStream:this._newFetchStream,getCommonHttpParams:this._getCommonHttpParams,getCommonHttpHeaders:this._getCommonHttpHeaders,baseURL:this._baseURL,binaryType:this._binaryType,consoleIncrementMessagePacket:this._consoleIncrementMessagePacket});return e.on("event",this._handleEvent),e.on("finish",this._handleFinish),e.on("clean",this._handleClean),e.on("update_task",this._handleUpdateTask),this._workerMap.set(e.id,e),e}_handleUpdateTask(e,t){var s;null===R.Rq||void 0===R.Rq||null===(s=R.Rq.getState())||void 0===s||s.updateChunkTask(e,t)}_handleClean(e){var t;null===R.Rq||void 0===R.Rq||null===(t=R.Rq.getState())||void 0===t||t.removeChunkTask(e)}_handleFinish(e){const t=this._workerMap.get(e);if((null==t?void 0:t.status)===S.T.idle){const e=this._queue.pop();e&&(null==t||t.startTask(e))}}_handleEvent(e){(0,E.Pt)(e,this)}_checkMessageInWorking(e){for(const t of this._workerMap.values())if(t.replyId===e)return!0;for(const t of this._queue)if(t.replyId===e)return!0;return!1}resumeTask(e){e.forEach((e=>{const{replyId:t}=e;t&&!this._checkMessageInWorking(t)&&this._pullMessage(e)}))}sendMessage(){}pullMessage(e){var t;const{reply_id:s}=e;if(!s||this._checkMessageInWorking(s))return;const i=null===R.Rq||void 0===R.Rq||null===(t=R.Rq.getState())||void 0===t?void 0:t.createChunkTask(s,e);i&&this._pullMessage(i)}_pullMessage(e){for(const t of this._workerMap.values())if(t.status===S.T.idle)return void t.startTask(e);if(this._workerMap.size<this._poolSize){this._initWorker().startTask(e)}else this._queue.push(e)}abortMessage(e){const t=this._queue.findIndex((t=>t.replyId===e));if(~t)return this._queue.splice(t,1),void this._handleClean(e);for(const s of this._workerMap.values())s.replyId===e&&s.abort()}drop(){this._queue=[];for(const e of this._workerMap.values())e.abort()}}var M=s(76398),z=s(13655),C=s(27527),x=s(81435),L=s(1800),U=s(80483),B=s(47725);class I extends E.a7{constructor(e){super(e),(0,i.A)(this,"from",y.aU.HttpLongPolling),(0,i.A)(this,"_config",void 0),(0,i.A)(this,"_pullMessageTasks",{}),this._handleEvent=this._handleEvent.bind(this),this._config=e}_handleEvent(e,t){const s=(0,n.A)({},e);if(e.event_type===m.B.Message&&e.message){const i=(0,B.xr)(e.message,{from:this.from,retried:!0,log_id:t});s.message=i}if(e.event_type===m.B.Message&&e.message_list){const i=e.message_list.map(((e,s,i)=>(0,B.xr)(e,{from:this.from,retried:!0,log_id:t,message_list_count:i.length,in_message_list_pos:s})));s.message_list=i}(0,E.Pt)(s,this)}sendMessage(e){var t;C.j.apiService.message.MessageReplay({payload:L.K.enc((new TextEncoder).encode((0,_.e)(e)))},{overrideParams:{aid:null===(t=this._config)||void 0===t?void 0:t.ws_app_id},overrideConfig:{timeout:b.Sf}}).then((e=>{if(!e.payload)throw new Error("Invalid ack message");const t=L.K.dec(e.payload);this._handleEvent((0,_.O)(z.A.read(t,0,t.byteLength),{}),(0,U.n)(e))})).catch((e=>{p.v.console.info(`get ack message failed: ${e.message}`)}))}_fetchMessage(e){C.j.apiService.message.GetMessageReply({message_id:e.reply_id||e.message_id,conversation_id:e.conversation_id},{overrideConfig:{timeout:b.EB}}).then((t=>{var s;if(this._pullMessage(e,b.MV),null===(s=t.data)||void 0===s||null===(s=s.message_list)||void 0===s||!s.length)throw new Error("message_list is empty");const i=t.data.message_list.filter((e=>!(0,v.yU)(e)));i.sort(((e,t)=>(Number(e.index)||0)-(Number(t.index)||0))),i.forEach((e=>{var s,i;(this._handleEvent({message:e,event_type:m.B.Message},(0,U.n)(t)),null!=e&&null!==(s=e.ext)&&void 0!==s&&s.sp)&&this._handleEvent({message:(0,n.A)((0,n.A)({},(0,M.A)(e,["conversation_id","section_id","message_id","reply_id","message_type"])),{},{content_type:x.cM.Suggest,content:(0,_.e)({suggest:(0,_.O)(null==e||null===(i=e.ext)||void 0===i?void 0:i.sp,{})||""}),ext:{},meta_infos:[]}),event_type:m.B.Message},(0,U.n)(t))}))})).catch((t=>{this._pullMessage(e,b.MV),p.v.console.info(`get message reply failed: ${t.message}`)}))}_pullMessage(e,t){var s;const{reply_id:i}=e;if(!i||"0"===i)return void p.v.console.info("reply_id is empty, skip pull message");if(!this._pullMessageTasks[i])return void p.v.console.info("task is empty, skip pull message");if(Date.now()-this._pullMessageTasks[i].expired>0)return;null===(s=this._pullMessageTasks[i])||void 0===s||s.clear();const n=setTimeout((()=>{this._fetchMessage(e)}),t),a=()=>{clearTimeout(n)};this._pullMessageTasks[i].clear=a,this._pullMessageTasks[i].finish=()=>{a(),delete this._pullMessageTasks[i]}}pullMessage(e,t){const{reply_id:s}=e,{delay:i}=t;s&&"0"!==s&&(this._pullMessageTasks[s]?this._pullMessageTasks[s].clear():this._pullMessageTasks[s]={reply_id:s,finish:l.A,clear:l.A,expired:Date.now()+b.dc},this._pullMessage(e,i))}abortMessage(e){var t;null===(t=this._pullMessageTasks[e])||void 0===t||t.finish()}drop(){Object.values(this._pullMessageTasks).forEach((e=>e.finish())),this._pullMessageTasks={}}}function O(e){return e.message_type===x.Go.Ack&&(e.ext?e.ext.is_finish="1":e.ext={is_finish:"1"}),e}class P extends E.a7{constructor(e){if(super(e),(0,i.A)(this,"client",void 0),(0,i.A)(this,"from",y.aU.Socket),this._handleEvent=this._handleEvent.bind(this),!e)throw new Error("Invalid socket config, socket config is required");const{socketClient:t,launchConfig:s,getSocketParams:n,consoleSocketPacket:a,socketClientLazy:o,refreshSocketConfig:r=()=>Promise.resolve(void 0)}=e;t?(this.client=t,this.client.init({onSocketStatusChange:this._onSocketChange.bind(this),config:s,onMessage:this._handleEvent,refreshSocketConfig:r,getSocketParams:n,consoleSocketPacket:a||!1})):o&&o.then((e=>{this.client=new e,this.client.init({onSocketStatusChange:this._onSocketChange.bind(this),config:s,onMessage:this._handleEvent,refreshSocketConfig:r,getSocketParams:n,consoleSocketPacket:a||!1})}))}_handleEvent({event:e,traceId:t}){const s=e;if(e.event_type===m.B.Message&&e.message){O(e.message);const i=(0,v.xr)(e.message,{from:this.from,trace_id:t});s.message=i}if(e.event_type===m.B.Message&&e.message_list){const i=e.message_list.map(((e,s,i)=>{O(e);return(0,v.xr)(e,{from:this.from,trace_id:t,message_list_count:i.length,in_message_list_pos:s})}));s.message_list=i}(0,E.Pt)(s,this)}_onSocketChange(e){this.emit("socket_change",e)}reconnect(e){var t,s;null===(t=this.client)||void 0===t||null===(s=t.reconnect)||void 0===s||s.call(t,e)}pullMessage(){}abortMessage(){}sendMessage(e){var t,s;null===(t=this.client)||void 0===t||t.send((0,_.e)(e)),p.v.persist.log({eventName:"missing_tea_uuid_when_socket_send_message",meta:{tea_uuid:(null===(s=this.client)||void 0===s||null===(s=s.options)||void 0===s||null===(s=s.customParams)||void 0===s?void 0:s.tea_uuid)||"unknown"}})}drop(){var e;null===(e=this.client)||void 0===e||e.drop(),this.client=void 0}}var q=s(56422),G=s(95589),D=s(5099),N=s(91689),j=0,F=1,V=2;const H={decode:e=>e?z.A.read(e,0,e.byteLength):""};class K{constructor(e,t=H){(0,i.A)(this,"_buffer",new Uint8Array),(0,i.A)(this,"_pos",void 0),(0,i.A)(this,"_fieldLen",void 0),(0,i.A)(this,"_line",void 0),(0,i.A)(this,"_message",void 0),this._onMessage=e,this._decoder=t,this._message=this._new(),this._line={start:0,end:-1},this._fieldLen=-1,this._pos=0,this.feed=this.feed.bind(this)}feed(e){this._append(e),this._readLineLoop()}_new(){return{data:void 0,event:void 0,id:void 0,retry:void 0}}_readLineLoop(){const e=this._buffer.length;if(e)for(-1!==this._line.end&&(this._line.start=0);this._pos<e&&(this._line.end=-1,this._readLine(),-1!==this._line.end);)this._readField(this._buffer.subarray(this._line.start,this._line.end)),this._line.start=this._pos,this._fieldLen=-1,0!==this._line.start&&(this._buffer=this._buffer.subarray(this._line.start),this._pos-=this._line.start,this._line.start=this._pos)}_readLine(){const e=this._buffer.length;for(;this._pos<e&&-1===this._line.end;){switch(this._buffer[this._pos]){case 58:-1===this._fieldLen&&(this._fieldLen=this._pos-this._line.start);break;case 13:this._line.end=this._pos,this._skipTrailingNewLine();break;case 10:this._line.end=this._pos}this._pos+=1}}_skipTrailingNewLine(){10===this._buffer[this._pos+1]&&this._pos++}_readField(e){if(0===e.length&&(this._onMessage(this._message),this._message=this._new()),-1!==this._fieldLen)if(this._fieldLen!==e.length-1)if(this._fieldLen){const t=this._decoder.decode(e.subarray(0,this._fieldLen));let s=this._fieldLen+1;32===e[this._fieldLen+1]&&(s+=1);const i=this._decoder.decode(e.subarray(s));this._writeField(t,i)}else;else{const t=this._decoder.decode(e.subarray(0,this._fieldLen)),s="";this._writeField(t,s)}else{const t=this._decoder.decode(e),s="";this._writeField(t,s)}}_writeField(e,t){switch(e){case"data":void 0!==this._message.data?this._message.data=`${this._message.data}\n${t}`:this._message.data=t;break;case"event":this._message.event=t;break;case"id":this._message.id=t;break;case"retry":this._message.retry=function(e){const t=Number(e);if(!Number.isNaN(t))return t}(t)}}_append(e){const t=this._buffer.length,s=e.length,i=new Uint8Array(t+s);i.set(this._buffer),i.set(e,t),this._buffer=i}}function W(){return(W=(0,a.A)((function*(e,t){const s=e.getReader(),i=new K(t);let n;for(;n=yield s.read(),!n.done;)i.feed(n.value)}))).apply(this,arguments)}class J{constructor(e,t){(0,i.A)(this,"CONNECTING",j),(0,i.A)(this,"OPEN",F),(0,i.A)(this,"CLOSED",V),(0,i.A)(this,"_emitter",void 0),(0,i.A)(this,"_readyState",V),(0,i.A)(this,"_lastEventId",void 0),(0,i.A)(this,"_fetchInstance",void 0),(0,i.A)(this,"_abortController",void 0),this._input=e,this._requestOptions=t,this._emitter=new h.A,this._startFetch()}_startFetch(){var e=this;return(0,a.A)((function*(){try{var t,s;e._readyState=j;const i=new AbortController;let{headers:a}=e._requestOptions;a instanceof Headers&&e._lastEventId?a.set(A,String(e._lastEventId)):a=(0,N.A)(a)?[...a,[A,String(e._lastEventId)]]:(0,n.A)((0,n.A)({},a),{},{[A]:String(e._lastEventId)}),e._fetchInstance=fetch(e._input,(0,n.A)((0,n.A)({},(0,D.A)(e._requestOptions,"openInterceptor")),{},{headers:a,signal:i.signal})),e._abortController=i;const o=yield e._fetchInstance;yield null===(t=(s=e._requestOptions).openInterceptor)||void 0===t?void 0:t.call(s,o),e._readyState=F,yield e._onOpen(o)}catch(i){e._onError(i)}}))()}_onOpen(e){var t=this;return(0,a.A)((function*(){const s=e.headers.get("content-type");if(null==s||!s.startsWith(k))throw new Error("Invalid Content-Type");if(null==e||!e.ok||null==e||!e.body)throw new Error("Invalid Response");t._emitter.emit("open",e),yield function(e,t){return W.apply(this,arguments)}(e.body,t._onMessage.bind(t)),t._emitter.emit("close","done")}))()}_onError(e){this._fetchInstance=void 0,this._readyState=V,this._emitter.emit("error",e)}_onMessage(e){this._lastEventId=Number(e.id),this._emitter.emit("message",e)}get lastEventId(){return this._lastEventId}get isAborted(){var e;return!(null===(e=this._abortController)||void 0===e||!e.signal.aborted)}get readyState(){return this._readyState}start(){this._fetchInstance||this._startFetch()}on(e,t,s){this._emitter.on(e,t,s)}off(e,t,s,i){this._emitter.off(e,t,s,i)}cancel(e){var t;null===(t=this._abortController)||void 0===t||t.abort(e),this._fetchInstance=void 0}}const Q=(e,t)=>{const s=new J(e,(0,D.A)(t,["onClose","onOpen","onError","onMessage"]));return t.onOpen&&s.on("open",t.onOpen),t.onClose&&s.on("close",t.onClose),t.onMessage&&s.on("message",t.onMessage),t.onError&&s.on("error",t.onError),s};var Y=s(68355);class X{constructor(e){(0,i.A)(this,"_completionMessage",void 0),(0,i.A)(this,"_mockMessageId",""),this._completionMessage=e}write(e){this._completionMessage=(0,v.dV)(this._completionMessage,e)}writeGatewayError({reason:e,sentEvent:t,logId:s}){const i=e.code===y.O4.FetchFailed;let a=this._completionMessage;!a&&t&&(a={local_message_id:t.local_message_id,local_conversation_id:String(t.local_conversation_id),conversation_id:String(t.conversation_id)});const o=(0,n.A)((0,n.A)({},a),{},{error_details:{has_error:!0,error_message:e.message,error_code:i?Y.O4.Ok:e.code,locale:""},local_info:{from:y.aU.SamanthaChatCompletion,log_id:s}});this._completionMessage=o}writeError({errorEvent:e,sentEvent:t,logId:s}){var i,a,o;let r=this._completionMessage;!r&&t&&(r={local_message_id:t.local_message_id,local_conversation_id:String(t.local_conversation_id),conversation_id:String(t.conversation_id)});const l=(0,n.A)((0,n.A)({},r),{},{error_details:{has_error:!0,error_message:(null===(i=e.error_detail)||void 0===i?void 0:i.message)||"",error_code:(null===(a=e.error_detail)||void 0===a?void 0:a.code)||Y.O4.Ok,locale:(null===(o=e.error_detail)||void 0===o?void 0:o.locale)||""},local_info:{from:y.aU.SamanthaChatCompletion,log_id:s}});this._completionMessage=l}writeFin(){const e=(0,n.A)((0,n.A)({},this._completionMessage),{},{is_finish:!0});this._completionMessage=e}writeFinishReply({logId:e}){var t;const s=(0,n.A)((0,n.A)({},this._completionMessage),{},{local_info:(0,n.A)((0,n.A)({},null===(t=this._completionMessage)||void 0===t?void 0:t.local_info),{},{finish_reply:!0,log_id:e,from:y.aU.SamanthaChatCompletion})});this._completionMessage=s}read(){return this._completionMessage}clear(){this._completionMessage=void 0,this._mockMessageId=""}}class Z extends E.a7{constructor(e){super(e),(0,i.A)(this,"from",y.aU.SamanthaChatCompletion),(0,i.A)(this,"_baseURL",void 0),(0,i.A)(this,"_fetchEntriesMap",{}),(0,i.A)(this,"_createFetchStream",void 0),(0,i.A)(this,"_getCommonHttpParams",void 0),(0,i.A)(this,"_getCommonHttpHeaders",void 0),this._baseURL=e.baseURL||"",this._createFetchStream=e.createFetchStream||Q,this._getCommonHttpParams=e.getCommonHttpParams,this._getCommonHttpHeaders=e.getCommonHttpHeaders}_generateHandlers(e,t){return{onError:s=>{const{retryCounter:i,instance:n,sentEvent:a,lastEventId:o}=this._fetchEntriesMap[t]||{};if(null!=n&&n.isAborted||null!=i&&i.matchMaxRetryAttempts())return;const r=e.read();this._sendMessage({sentEvent:a,lastEventId:o,message:r,retryCounter:i}),null==i||i.add()},onOpen:e=>{const s=this._fetchEntriesMap[t],i=e.headers.get("content-type");if(null==i||!i.startsWith(k))throw new Error(`Invalid Response, Unexpected ContentType: ${i}`);if(null==e||!e.ok||null==e||!e.body)throw new Error(`Invalid Response, ResponseStatus: ${e.statusText}`);s&&(s.logId=e.headers.get("x-tt-logid")||"")},onMessage:s=>{const i=this._fetchEntriesMap[t];if(!i)return;const{logId:n,sentEvent:a}=i,{data:o="",event:r}=s;if("gateway-error"!==r){const{event_data:s="",event_type:r,event_id:l}=(0,_.O)(o,{});switch(l&&(i.lastEventId=l,R.Rq.getState().updateSamanthaChatCompletionTask(a.local_message_id,e.read(),l)),r){case G.Bx.ACK:{const e=(0,_.O)(s,{}),t=(0,v.MH)(e,a,{log_id:n,from:this.from});return void(t&&this.emit("message",t))}case G.Bx.CMPL:{const t=(0,_.O)(s,{});e.write((0,v.OS)(t,{log_id:n,from:this.from}));const i=e.read();return void(i&&this.emit("message",i))}case G.Bx.FIN:{e.writeFinishReply({logId:n});const s=e.read();return s&&this.emit("message",s),void this._handleFinish(t)}case G.Bx.ERR:{const i=(0,_.O)(s,{});e.writeError({errorEvent:i,sentEvent:a,logId:n});const o=e.read();return o&&this.emit("message",o),void this._handleFinish(t)}case G.Bx.CMD:default:return}}else{const t=(0,_.O)(o,{});e.writeGatewayError({reason:{message:t.message,code:t.code},sentEvent:a,logId:n});const s=e.read();s&&this.emit("message",s)}}}}_handleFinish(e){delete this._fetchEntriesMap[e],R.Rq.getState().removeSamanthaChatCompletionTask(e)}_sendMessage(e){var t,s,i;const{sentEvent:a,message:o,lastEventId:r="0",retryCounter:l=new v.n0(5)}=e;if(!a)return;const c=new X(o),d=this._generateHandlers(c,a.local_message_id),h=null===(t=this._createFetchStream)||void 0===t?void 0:t.call(this,(0,v.ID)(`${this._baseURL||""}/samantha/chat/completion`,null===(s=this._getCommonHttpParams)||void 0===s?void 0:s.call(this)),{method:"POST",headers:[["content-type","application/json"],["Agw-Js-Conv","str"],...(0,u.A)((null===(i=this._getCommonHttpHeaders)||void 0===i?void 0:i.call(this))||{})],body:(0,_.e)((0,n.A)((0,n.A)({},a),{},{completion_option:(0,n.A)((0,n.A)({},a.completion_option),{},{event_id:r})})),credentials:"same-origin",onError:d.onError,onMessage:d.onMessage,openInterceptor:d.onOpen});h&&(this._fetchEntriesMap[a.local_message_id]={instance:h,logId:"",sentEvent:a,lastEventId:r,retryCounter:l})}sendMessage(e){R.Rq.getState().createSamanthaChatCompletionTask(e.local_message_id,e),this._sendMessage({sentEvent:e})}abortMessage(e){var t;null===(t=this._fetchEntriesMap[e])||void 0===t||null===(t=t.instance)||void 0===t||t.cancel("cancel request"),delete this._fetchEntriesMap[e]}resumeTask(e){e.forEach((e=>{const{localMessageId:t}=e;t&&!this._fetchEntriesMap[t]&&this._sendMessage({lastEventId:e.lastEventId,sentEvent:e.sentEvent,message:e.message})}))}drop(){(0,q.A)((0,o.A)(this._fetchEntriesMap),(e=>!!e)).forEach((e=>{var t;null==e||e.instance.cancel("drop adapter");const s=null==e||null===(t=e.sentEvent)||void 0===t?void 0:t.local_message_id;s&&R.Rq.getState().removeSamanthaChatCompletionTask(s)})),this._fetchEntriesMap={}}}},13303:(e,t,s)=>{s.d(t,{Pt:()=>r,Pv:()=>l,a7:()=>c});var i=s(10633),n=s(96274),a=s(10129),o=s(60588);const r=(e,t)=>{const{event_type:s,message:i,cmd:a,message_list:o}=e;s===n.B.Message&&o&&o.forEach((e=>t.emit("message",e))),s===n.B.Message&&i&&t.emit("message",i),s===n.B.Cmd&&a&&t.emit("cmd",a)},l={adapters:{},register(e){this.adapters[e.from]=e},unregister(e){this.adapters[e.from]=void 0},get(e){return this.adapters[e]},getAll(){return Object.values(this.adapters)}};class c extends o.A{constructor(e){super(),(0,i.A)(this,"from",a.aU.Unknown)}sendMessage(e){}pullMessage(e,t){}abortMessage(e){}drop(){}}},87233:(e,t,s)=>{s.d(t,{T:()=>i});let i=function(e){return e[e.running=1]="running",e[e.idle=2]="idle",e}({})},91027:(e,t,s)=>{s.d(t,{Hg:()=>u});var i=s(10633),n=s(33531),a=s(87729);class o extends n.Q{constructor(e){super(),(0,i.A)(this,"type",0),(0,i.A)(this,"info",void 0),a.C.util.initPartial(e,this)}static fromBinary(e,t){return(new o).fromBinary(e,t)}static fromJson(e,t){return(new o).fromJson(e,t)}static fromJsonString(e,t){return(new o).fromJsonString(e,t)}static equals(e,t){return a.C.util.equals(o,e,t)}}(0,i.A)(o,"runtime",a.C),(0,i.A)(o,"typeName","msg_pb.MetaInfo"),(0,i.A)(o,"fields",a.C.util.newFieldList((()=>[{no:1,name:"type",kind:"scalar",T:5},{no:2,name:"info",kind:"scalar",T:9,opt:!0}])));class r extends n.Q{constructor(e){super(),(0,i.A)(this,"conversationId",void 0),(0,i.A)(this,"sectionId",void 0),(0,i.A)(this,"messageId",void 0),(0,i.A)(this,"localMessageId",void 0),(0,i.A)(this,"index",void 0),(0,i.A)(this,"secSender",void 0),(0,i.A)(this,"replyId",void 0),(0,i.A)(this,"status",void 0),(0,i.A)(this,"createTime",void 0),(0,i.A)(this,"messageType",void 0),(0,i.A)(this,"contentType",void 0),(0,i.A)(this,"content",void 0),(0,i.A)(this,"ttsContent",void 0),(0,i.A)(this,"ext",{}),(0,i.A)(this,"nextConnectionType",void 0),(0,i.A)(this,"chunkSeq",void 0),(0,i.A)(this,"isDelta",void 0),(0,i.A)(this,"metaInfos",[]),(0,i.A)(this,"localConversationId",void 0),(0,i.A)(this,"botId",void 0),(0,i.A)(this,"appletPayload",{}),(0,i.A)(this,"modelType",void 0),(0,i.A)(this,"updateTime",void 0),(0,i.A)(this,"threadId",void 0),a.C.util.initPartial(e,this)}static fromBinary(e,t){return(new r).fromBinary(e,t)}static fromJson(e,t){return(new r).fromJson(e,t)}static fromJsonString(e,t){return(new r).fromJsonString(e,t)}static equals(e,t){return a.C.util.equals(r,e,t)}}(0,i.A)(r,"runtime",a.C),(0,i.A)(r,"typeName","msg_pb.PushMessage"),(0,i.A)(r,"fields",a.C.util.newFieldList((()=>[{no:1,name:"conversation_id",kind:"scalar",T:9,opt:!0},{no:2,name:"section_id",kind:"scalar",T:9,opt:!0},{no:3,name:"message_id",kind:"scalar",T:9,opt:!0},{no:4,name:"local_message_id",kind:"scalar",T:9,opt:!0},{no:5,name:"index",kind:"scalar",T:3,opt:!0},{no:6,name:"sec_sender",kind:"scalar",T:9,opt:!0},{no:7,name:"reply_id",kind:"scalar",T:9,opt:!0},{no:8,name:"status",kind:"scalar",T:5,opt:!0},{no:9,name:"create_time",kind:"scalar",T:3,opt:!0},{no:10,name:"message_type",kind:"scalar",T:5,opt:!0},{no:11,name:"content_type",kind:"scalar",T:5,opt:!0},{no:12,name:"content",kind:"scalar",T:9,opt:!0},{no:13,name:"tts_content",kind:"scalar",T:9,opt:!0},{no:14,name:"ext",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:15,name:"next_connection_type",kind:"scalar",T:5,opt:!0},{no:16,name:"chunk_seq",kind:"scalar",T:3,opt:!0},{no:17,name:"is_delta",kind:"scalar",T:8,opt:!0},{no:18,name:"meta_infos",kind:"message",T:o,repeated:!0},{no:19,name:"local_conversation_id",kind:"scalar",T:9,opt:!0},{no:20,name:"bot_id",kind:"scalar",T:9,opt:!0},{no:21,name:"applet_payload",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:22,name:"model_type",kind:"scalar",T:5,opt:!0},{no:23,name:"update_time",kind:"scalar",T:3,opt:!0},{no:24,name:"thread_id",kind:"scalar",T:3,opt:!0}])));class l extends n.Q{constructor(e){super(),(0,i.A)(this,"cmdType",void 0),(0,i.A)(this,"index",void 0),(0,i.A)(this,"conversationId",void 0),(0,i.A)(this,"messageId",void 0),(0,i.A)(this,"ext",{}),(0,i.A)(this,"upCmdType",void 0),(0,i.A)(this,"localMessageId",void 0),a.C.util.initPartial(e,this)}static fromBinary(e,t){return(new l).fromBinary(e,t)}static fromJson(e,t){return(new l).fromJson(e,t)}static fromJsonString(e,t){return(new l).fromJsonString(e,t)}static equals(e,t){return a.C.util.equals(l,e,t)}}(0,i.A)(l,"runtime",a.C),(0,i.A)(l,"typeName","msg_pb.PushCmd"),(0,i.A)(l,"fields",a.C.util.newFieldList((()=>[{no:1,name:"cmd_type",kind:"scalar",T:5,opt:!0},{no:2,name:"index",kind:"scalar",T:3,opt:!0},{no:3,name:"conversation_id",kind:"scalar",T:9,opt:!0},{no:4,name:"message_id",kind:"scalar",T:9,opt:!0},{no:5,name:"ext",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:6,name:"up_cmd_type",kind:"scalar",T:5,opt:!0},{no:7,name:"local_message_id",kind:"scalar",T:9,opt:!0}])));class c extends n.Q{constructor(e){super(),(0,i.A)(this,"longitude",void 0),(0,i.A)(this,"latitude",void 0),(0,i.A)(this,"countryName",void 0),(0,i.A)(this,"provinceName",void 0),(0,i.A)(this,"cityName",void 0),(0,i.A)(this,"districtName",void 0),(0,i.A)(this,"townName",void 0),(0,i.A)(this,"countryCode",void 0),a.C.util.initPartial(e,this)}static fromBinary(e,t){return(new c).fromBinary(e,t)}static fromJson(e,t){return(new c).fromJson(e,t)}static fromJsonString(e,t){return(new c).fromJsonString(e,t)}static equals(e,t){return a.C.util.equals(c,e,t)}}(0,i.A)(c,"runtime",a.C),(0,i.A)(c,"typeName","msg_pb.GeoInfo"),(0,i.A)(c,"fields",a.C.util.newFieldList((()=>[{no:1,name:"longitude",kind:"scalar",T:9,opt:!0},{no:2,name:"latitude",kind:"scalar",T:9,opt:!0},{no:3,name:"country_name",kind:"scalar",T:9,opt:!0},{no:4,name:"province_name",kind:"scalar",T:9,opt:!0},{no:5,name:"city_name",kind:"scalar",T:9,opt:!0},{no:6,name:"district_name",kind:"scalar",T:9,opt:!0},{no:7,name:"town_name",kind:"scalar",T:9,opt:!0},{no:8,name:"country_code",kind:"scalar",T:9,opt:!0}])));class d extends n.Q{constructor(e){super(),(0,i.A)(this,"messageId",void 0),(0,i.A)(this,"localMessageId",void 0),(0,i.A)(this,"replyId",void 0),(0,i.A)(this,"questionId",void 0),(0,i.A)(this,"createTime",void 0),(0,i.A)(this,"content",void 0),(0,i.A)(this,"ext",{}),(0,i.A)(this,"messageType",void 0),a.C.util.initPartial(e,this)}static fromBinary(e,t){return(new d).fromBinary(e,t)}static fromJson(e,t){return(new d).fromJson(e,t)}static fromJsonString(e,t){return(new d).fromJsonString(e,t)}static equals(e,t){return a.C.util.equals(d,e,t)}}(0,i.A)(d,"runtime",a.C),(0,i.A)(d,"typeName","msg_pb.AppAction"),(0,i.A)(d,"fields",a.C.util.newFieldList((()=>[{no:1,name:"message_id",kind:"scalar",T:3,opt:!0},{no:2,name:"local_message_id",kind:"scalar",T:9,opt:!0},{no:3,name:"reply_id",kind:"scalar",T:3,opt:!0},{no:4,name:"question_id",kind:"scalar",T:3,opt:!0},{no:5,name:"create_time",kind:"scalar",T:3,opt:!0},{no:6,name:"content",kind:"scalar",T:9,opt:!0},{no:7,name:"ext",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:8,name:"message_type",kind:"scalar",T:5,opt:!0}])));class u extends n.Q{constructor(e){super(),(0,i.A)(this,"eventType",0),(0,i.A)(this,"message",void 0),(0,i.A)(this,"cmd",void 0),(0,i.A)(this,"geo",void 0),(0,i.A)(this,"appAction",void 0),(0,i.A)(this,"version",void 0),(0,i.A)(this,"messageList",[]),a.C.util.initPartial(e,this)}static fromBinary(e,t){return(new u).fromBinary(e,t)}static fromJson(e,t){return(new u).fromJson(e,t)}static fromJsonString(e,t){return(new u).fromJsonString(e,t)}static equals(e,t){return a.C.util.equals(u,e,t)}}(0,i.A)(u,"runtime",a.C),(0,i.A)(u,"typeName","msg_pb.PushEvent"),(0,i.A)(u,"fields",a.C.util.newFieldList((()=>[{no:1,name:"event_type",kind:"scalar",T:5},{no:2,name:"message",kind:"message",T:r,opt:!0},{no:3,name:"cmd",kind:"message",T:l,opt:!0},{no:4,name:"geo",kind:"message",T:c,opt:!0},{no:5,name:"app_action",kind:"message",T:d,opt:!0},{no:6,name:"version",kind:"scalar",T:5,opt:!0},{no:7,name:"message_list",kind:"message",T:r,repeated:!0}])))},170:(e,t,s)=>{s.d(t,{P9:()=>d,VX:()=>c,nc:()=>l});var i=s(63379),n=s(81435),a=s(36572),o=s(65320),r=s(59257);const l={pluginId:"Nested_Common_Chat_Protocol",matchContentType:e=>e===n.cM.Nested,Plugin:class{normalizeSamanthaMessage(e){return e}normalizePushMessage(e){var t;const s=(0,o.zG)(e)?(0,r.r8)(null===(t=e.content_obj)||void 0===t?void 0:t.entities):void 0;return null!=s&&s.length&&(0,i.A)(e,{attachments:s}),e}}};const c={pluginId:"Text_Common_Chat_Protocol",matchContentType:e=>e===n.cM.Text||e===a.cM.SamanthaText,Plugin:class{normalizeSamanthaMessage(e){return e}normalizePushMessage(e,t){const s=(0,r.KS)(t.ext);return null!=s&&s.length&&(0,i.A)(e,{references:s}),e}}};const d={pluginId:"Composite_Common_Chat_Protocol",matchContentType:e=>e===n.cM.Composite,Plugin:class{normalizeSamanthaMessage(e){return e}normalizePushMessage(e){var t,s,n;const a=[];return null!==(t=e.content_obj)&&void 0!==t&&t.file_model&&a.push(...(0,r.TU)(e.content_obj.file_model)),null!==(s=e.content_obj)&&void 0!==s&&s.link_model&&a.push((0,r.kv)(e.content_obj.link_model)),null!==(n=e.content_obj)&&void 0!==n&&n.image_model&&a.push(...(0,r.KF)(e.content_obj.image_model)),null!=a&&a.length&&(0,i.A)(e,{attachments:a}),e}}}},25856:(e,t,s)=>{s(30642)},59257:(e,t,s)=>{s.d(t,{KF:()=>h,KS:()=>d,TU:()=>p,cz:()=>_,kv:()=>g,r8:()=>u});var i=s(9012),n=s(10129),a=s(72041),o=s(22358),r=s(13734),l=s(18590);const c={0:n.RM.Unknown,1:n.RM.File,2:n.RM.Image,text:n.RM.Text,attachment:n.RM.File,link:n.RM.Link,image:n.RM.Image},d=e=>{var t;const s=(null===(t=(0,l.O)((0,i.A)(e,["samantha_context"]),{}))||void 0===t||null===(t=t.query_context)||void 0===t?void 0:t.ref_images)||[],a=(0,l.O)((0,i.A)(e,["reference_content"]),[]);return[...s.map((e=>({type:n.RM.Image,key:e.image_token,url:e.url,extra:{refer_types:e.refer_types}}))),...a.map((e=>({type:c[e.type],name:null==e?void 0:e.fileName,key:null==e?void 0:e.fileKey,url:null==e?void 0:e.link,content:null==e?void 0:e.text})))]},u=e=>(null==e?void 0:e.map((e=>{var t,s,i,n,l,d,u,h,_;if(e.entity_type===a.WR.Image){var g,p,m,f,v;const t=(0,r.GO)((null===(g=e.entity_content)||void 0===g||null===(g=g.image)||void 0===g?void 0:g.key)||"");return{type:c.image,identifier:e.identifier,name:`image.${t}`,key:null===(p=e.entity_content)||void 0===p||null===(p=p.image)||void 0===p?void 0:p.key,url:null===(m=e.entity_content)||void 0===m||null===(m=m.image)||void 0===m||null===(m=m.image_ori)||void 0===m?void 0:m.url,file_review_state:null!==(f=e.file_name_state)&&void 0!==f?f:o.Cp.ReviewState_Processing,file_parse_state:null!==(v=e.file_parse_state)&&void 0!==v?v:o.hI.ParseState_Processing}}return{type:c[(null===(t=e.entity_content)||void 0===t||null===(t=t.file)||void 0===t?void 0:t.file_type)||"attachment"],identifier:e.identifier,name:null===(s=e.entity_content)||void 0===s||null===(s=s.file)||void 0===s?void 0:s.file_name,key:null===(i=e.entity_content)||void 0===i||null===(i=i.file)||void 0===i?void 0:i.key,md5:null===(n=e.entity_content)||void 0===n||null===(n=n.file)||void 0===n?void 0:n.md5,url:(null===(l=e.entity_content)||void 0===l||null===(l=l.file)||void 0===l?void 0:l.url)||(null===(d=e.entity_content)||void 0===d||null===(d=d.file)||void 0===d||null===(d=d.image)||void 0===d||null===(d=d.image_ori)||void 0===d?void 0:d.url),size:Number(null===(u=e.entity_content)||void 0===u||null===(u=u.file)||void 0===u?void 0:u.size),file_review_state:null!==(h=e.file_name_state)&&void 0!==h?h:o.Cp.ReviewState_Processing,file_parse_state:null!==(_=e.file_parse_state)&&void 0!==_?_:o.hI.ParseState_Processing}})))||[],h=e=>{var t;return null===(t=e.image_list)||void 0===t?void 0:t.map((e=>{var t;return{key:e.key,type:c.image,name:e.file_name,url:null===(t=e.image_ori)||void 0===t?void 0:t.url}}))},_=e=>({type:c.link,key:e,url:e}),g=e=>({type:c.link,key:e.url,url:e.url}),p=e=>{var t;return null===(t=e.file_list)||void 0===t?void 0:t.map((e=>({key:e.key,name:e.file_name,type:c.attachment,url:e.key})))}},639:(e,t,s)=>{s.d(t,{G:()=>a});var i=s(13655),n=s(13925);const a=e=>new n.V5(e,{decode:e=>e?i.A.read(e,0,e.byteLength):""})},84433:(e,t,s)=>{s.d(t,{n:()=>n});var i=s(10633);class n{constructor(e=0){(0,i.A)(this,"_attempts",0),this._maxRetryAttempts=e}add(){this._attempts++}reset(){this._attempts=0}get attempts(){return this._attempts}matchMaxRetryAttempts(){return this._attempts>=this._maxRetryAttempts}}},70942:(e,t,s)=>{s.d(t,{C_:()=>h,NY:()=>u,ge:()=>d});var i=s(44557),n=s(92431),a=s(60163),o=s(5099),r=s(96274),l=s(68355),c=s(10129);const d=111111111;function u(e){const t=(0,n.A)(e),{completionMessageMap:s}=t;for(const[i,n]of(0,a.A)(s))s[i]=(0,o.A)(n,["local","local_message_id"]);return t}function h(e,t,s){const n=t.code===d,a=(0,i.A)((0,i.A)({},null!=e?e:{}),{},{error_details:{has_error:!0,error_code:n?l.O4.Ok:t.code,error_message:t.message,locale:""},local_info:{from:c.aU.HttpChunk,log_id:s}});return{event_type:r.B.Message,message:a}}},83664:(e,t,s)=>{s.d(t,{B:()=>i});const i=new(s(60588).b)},8607:(e,t,s)=>{function i(){const e={service:null};return{get(t,s){var i;const n=null===(i=e.service)||void 0===i||null===(i=i.ctx)||void 0===i?void 0:i[t];if(!n&&!s)throw new Error(`target service [${t}] not found`);return n},get service(){return e.service},set service(t){e.service=t}}}s.d(t,{p:()=>i})},72975:(e,t,s)=>{s.d(t,{Z:()=>i});let i=function(e){return e.Original="original",e.UseTemplate="use_template",e.ChangeTemplate="change_template",e.Paste="paste",e.Other="other",e.NotMessage="notMessage",e}({})},10129:(e,t,s)=>{s.d(t,{FQ:()=>i,O4:()=>o,QV:()=>a,RM:()=>r,aU:()=>n});let i=function(e){return e.Preprocessing="preprocessing",e.PreprocessFailed="preprocessFailed",e.Sending="sending",e.WaitingAck="waitingAck",e.ReceivingFirstPackage="receivingFirstPackage",e.ReceivingStream="receivingStream",e.SendingRegenerate="sendingRegenerate",e.Timeout="timeout",e.StreamingTimeout="streamingTimeout",e.SentInLocalConversation="SentInLocalConversation",e.SentAndCreateConversationFailedInLocalConversation="SentAndCreateConversationFailedInLocalConversation",e.SafetyError="SafetyError",e}({});var n={Api:"Api",Socket:"Socket",HttpChunk:"HttpChunk",HttpLongPolling:"HttpLongPolling",SamanthaChatCompletion:"SamanthaChatCompletion",Unknown:"Unknown",AsyncFetch:"AsyncFetch"},a={open:"open",close:"close",error:"error",message:"message"};let o=function(e){return e[e.FetchFailed=1001]="FetchFailed",e[e.ResponseIsInvalid=1002]="ResponseIsInvalid",e[e.StreamParseFailed=1003]="StreamParseFailed",e[e.ServerError=1004]="ServerError",e[e.AbortFetch=1005]="AbortFetch",e}({}),r=function(e){return e.Unknown="unknown",e.File="file",e.Image="image",e.Text="text",e.Link="link",e}({})},10484:(e,t,s)=>{s.d(t,{H:()=>i});let i=function(e){return e[e.Conversation=0]="Conversation",e[e.Bot=1]="Bot",e[e.ThreadLocalConversation=2]="ThreadLocalConversation",e[e.ProfileBot=3]="ProfileBot",e[e.NewThread=4]="NewThread",e[e.CollectionLocalConversation=6]="CollectionLocalConversation",e[e.AIVideoLocalConversation=7]="AIVideoLocalConversation",e[e.SharedThreadContinueChat=8]="SharedThreadContinueChat",e}({})},47997:(e,t,s)=>{s.d(t,{Cr:()=>i});let i=function(e){return e[e.Coco=1]="Coco",e[e.Bot=2]="Bot",e[e.CocoSub=3]="CocoSub",e[e.CocoWeb=4]="CocoWeb",e[e.CocoWebSub=5]="CocoWebSub",e}({})},12648:(e,t,s)=>{s.d(t,{Cr:()=>i});let i=function(e){return e[e.Coco=1]="Coco",e[e.Bot=2]="Bot",e[e.CocoSub=3]="CocoSub",e[e.CocoWeb=4]="CocoWeb",e[e.CocoWebSub=5]="CocoWebSub",e}({})},96274:(e,t,s)=>{s.d(t,{B:()=>i});var i={Message:1,Cmd:2,AppAction:3}},27527:(e,t,s)=>{s.d(t,{j:()=>c});var i=s(44557),n=s(33451),a=s(10633);var o=s(37357);const r=["httpClient","ignoreCommonParams","ignoreCommonHeaders"],l=["params","headers"];class c{static _handleError({eventName:e,message:t,throwError:s}){const i=new Error(`[FlowApi] ${t}`);if(o.v.persist.error({eventName:e,error:i}),s)throw i}static init(e){if(this._apiService)return;const{isDebugging:t,baseURL:s,httpClient:a,getCommonParams:o,getCommonHeaders:c}=e;this.isDebugging=t;const d={baseURL:s,request:(e,t={})=>{let{httpClient:s,ignoreCommonParams:d,ignoreCommonHeaders:u}=t,h=(0,n.A)(t,r),{params:_,headers:g}=e,p=(0,n.A)(e,l);return(null!=s?s:a)((0,i.A)({params:(0,i.A)((0,i.A)({},d||null==o?void 0:o()),_),headers:(0,i.A)((0,i.A)((0,i.A)({},u||null==c?void 0:c()),g),null==h?void 0:h.overrideHeaders)},p),h)}},u={rawRequest:(e,t)=>a(e,(0,i.A)((0,i.A)({},t),{},{overrideConfig:(0,i.A)({ignoreResponseInterceptors:!0},null==t?void 0:t.overrideConfig)})),normalRequest:(e,t)=>d.request(e,t),requestWithPath:e=>(t,s)=>{var n;const a="string"!=typeof d.baseURL?(null===(n=d.baseURL)||void 0===n?void 0:n.call(d,e))||e:`${d.baseURL}${e}`;return d.request((0,i.A)((0,i.A)({},t),{},{url:t.url||a}),s)}};this._apiService=new Proxy({},{get:(e,t)=>{var s;const i=t;if(i in u)return u[i];if(this.instanceMap[i])return this.instanceMap[i];const n=this.classMap[i]||this.defaultClassMap[i];n||this._handleError({eventName:"flow_api_init_error",message:`namespace ${i} is not registered`,throwError:!0});const a=null!==(s=this.classConstructorOptionsMap[i])&&void 0!==s?s:d;return a.request||(a.request=d.request),this.instanceMap[i]=new n(a),this.instanceMap[i]}})}static register(e,t,s){if(this.classMap[e]){if(this.classMap[e]===t&&(!s&&!this.classConstructorOptionsMap[e]||this.classConstructorOptionsMap[e]===s))return;this._handleError({eventName:"flow_api_register_error",message:`${e} is already registered`,throwError:this.isDebugging})}else this.instanceMap[e]?this._handleError({eventName:"flow_api_register_error",message:`${e} has been instantiated and cannot be registered`,throwError:this.isDebugging}):(!this.defaultClassMap[e]||t.prototype instanceof this.defaultClassMap[e]||this._handleError({eventName:"flow_api_default_constructor_invalid",message:`${t.name} needs to inherit from ${this.defaultClassMap[e].name}`,throwError:this.isDebugging}),this.classMap[e]=t,s&&(this.classConstructorOptionsMap[e]=s))}static get apiService(){return this._apiService||this._handleError({eventName:"flow_api_read_error",message:"Please call FlowApi.init first",throwError:!0}),this._apiService}}(0,a.A)(c,"isDebugging",!1),(0,a.A)(c,"_apiService",void 0),(0,a.A)(c,"defaultClassMap",{alice:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("AliceApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}CheckUpdate(e,t){const s=this.genBaseURL("/alice/update/check"),i={package_type:(e||{}).package_type};return this.request({url:s,method:"POST",data:i},t)}GetQuery(e,t){const s=this.genBaseURL("/alice/query"),i=e||{},n={query_text:i.query_text,source:i.source};return this.request({url:s,method:"POST",data:n},t)}LoadVideoTT(e,t){const s=this.genBaseURL("/alice/media/source/2"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}LoadVideoDY(e,t){const s=this.genBaseURL("/alice/media/source/3"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}DebugPromptDetail(e,t){const s=this.genBaseURL("/alice/debug/prompt_detail"),i=e||{},n={message_id:i.message_id,type_list:i.type_list};return this.request({url:s,method:"POST",data:n},t)}MCheckMusic(e,t){const s=this.genBaseURL("/alice/media/mcheck/music"),i=e||{},n={check_list:i.check_list,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}Report(e,t){const s=this.genBaseURL("/alice/report/create"),i=e||{},n={report_type:i.report_type,entity_id:i.entity_id,reason_ids:i.reason_ids,reason_detail:i.reason_detail};return this.request({url:s,method:"POST",data:n},t)}TemplateRecommendRelated(e,t){const s=this.genBaseURL("/alice/template/recommend_related"),i=e||{},n={template_type:i.template_type,template_id:i.template_id,offset:i.offset,size:i.size,enter_time:i.enter_time};return this.request({url:s,method:"POST",data:n},t)}TemplateRecommendList(e,t){const s=this.genBaseURL("/alice/template/recommend_list"),i=e||{},n={template_type:i.template_type,offset:i.offset,size:i.size,token:i.token};return this.request({url:s,method:"POST",data:n},t)}LoadMusicQS(e,t){const s=this.genBaseURL("/alice/media/source/4"),i={vid_list:(e||{}).vid_list};return this.request({url:s,method:"POST",data:i},t)}GetMsgTemplates(e,t){const s=this.genBaseURL("/alice/msg_template/get"),i=e||{},n={cursor:i.cursor,size:i.size,template_lang:i.template_lang,cold_start:i.cold_start};return this.request({url:s,method:"POST",data:n},t)}SearchCards(e,t){const s=this.genBaseURL("/alice/media/card_search"),i=e||{},n={query_params:i.query_params,query_type:i.query_type};return this.request({url:s,method:"POST",data:n},t)}ListRootSpans(e,t){const s=this.genBaseURL("/alice/debug/list_root_span"),i=e||{},n={filter_tags:i.filter_tags,start_at:i.start_at,end_at:i.end_at,limit:i.limit,desc_by_start_time:i.desc_by_start_time,offset:i.offset};return this.request({url:s,method:"POST",data:n},t)}GetTraceSDK(e,t){const s=this.genBaseURL("/alice/debug/get_trace_sdk"),i=e||{},n={trace_id:i.trace_id,log_id:i.log_id,scene:i.scene,start_at:i.start_at,end_at:i.end_at,message_id:i.message_id,tenant:i.tenant};return this.request({url:s,method:"POST",data:n},t)}},bot:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("AliceBotApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GenBotIcon(e,t){const s=this.genBaseURL("/alice/bot/gen_icon"),i=e||{},n={name:i.name,description:i.description,bot_lang:i.bot_lang};return this.request({url:s,method:"POST",data:n},t)}GenBotIconByPrompt(e,t){const s=this.genBaseURL("/alice/bot/gen_icon_by_prompt"),i=e||{},n={prompt:i.prompt,num:i.num,image_req:i.image_req};return this.request({url:s,method:"POST",data:n},t)}GetBotList(e,t){const s=this.genBaseURL("/alice/bot/get_bot_list"),i=e||{},n={bot_ids:i.bot_ids,bot_list_type:i.bot_list_type,pageIndex:i.pageIndex,pageSize:i.pageSize};return this.request({url:s,method:"POST",data:n},t)}UploadFile(e,t){const s=this.genBaseURL("/alice/bot/upload_file"),i=e||{},n={file_head:i.file_head,data:i.data};return this.request({url:s,method:"POST",data:n},t)}RecommendBots(e,t){const s=this.genBaseURL("/alice/bot/recommend"),i=e||{},n={recommend_type:i.recommend_type,page_index:i.page_index,page_size:i.page_size,bot_ids:i.bot_ids,tag_id:i.tag_id,msg_list:i.msg_list,cold_start:i.cold_start,old_bot_id:i.old_bot_id};return this.request({url:s,method:"POST",data:n},t)}LanguageList(e,t){const s=this.genBaseURL("/alice/bot/language_list"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}CreateBot(e,t){const s=this.genBaseURL("/alice/bot/create"),i=e||{},n={name:i.name,description_for_human:i.description_for_human,icon_uri:i.icon_uri,private_status:i.private_status,voice_type:i.voice_type,ugc_voice:i.ugc_voice,bot_lang:i.bot_lang,muted:i.muted,use_bot_enrich:i.use_bot_enrich,enable_web_search:i.enable_web_search,enable_pic_gen:i.enable_pic_gen,first_met:i.first_met,use_bot_enrich_edit:i.use_bot_enrich_edit,create_channel:i.create_channel,bg_img_uri:i.bg_img_uri,bg_img_info:i.bg_img_info,user_bot_gender_starling_key:i.user_bot_gender_starling_key,user_bot_type_starling_key:i.user_bot_type_starling_key,bio:i.bio,original_user_img_uri:i.original_user_img_uri};return this.request({url:s,method:"POST",data:n},t)}EnrichBot(e,t){const s=this.genBaseURL("/alice/bot/enrich"),i=e||{},n={name:i.name,bot_lang:i.bot_lang,need_desc:i.need_desc,need_voice_type:i.need_voice_type,user_bot_gender_starling_key:i.user_bot_gender_starling_key,user_bot_type_starling_key:i.user_bot_type_starling_key,bg_img_prompt:i.bg_img_prompt,data:i.data};return this.request({url:s,method:"POST",data:n},t)}UpdateBot(e,t){const s=this.genBaseURL("/alice/bot/update_bot"),i=e||{},n={bot_id:i.bot_id,name:i.name,description_for_human:i.description_for_human,icon_uri:i.icon_uri,model_type:i.model_type,voice_type:i.voice_type,delete:i.delete,bot_lang:i.bot_lang,muted:i.muted,private_status:i.private_status,ugc_voice:i.ugc_voice,message_push:i.message_push,enable_web_search:i.enable_web_search,enable_pic_gen:i.enable_pic_gen,first_met:i.first_met,bg_img_uri:i.bg_img_uri,bg_img_info:i.bg_img_info,dynamic_img_uri:i.dynamic_img_uri,bot_icon_mapped_app_icon:i.bot_icon_mapped_app_icon,bot_memory_switch_status:i.bot_memory_switch_status,reset_bot_memory_hint_status:i.reset_bot_memory_hint_status,bio:i.bio,original_user_img_uri:i.original_user_img_uri};return this.request({url:s,method:"POST",data:n},t)}VoiceTypeList(e,t){const s=this.genBaseURL("/alice/bot/voice_type_list"),i=e||{},n={bot_id:i.bot_id,bot_language_code:i.bot_language_code};return this.request({url:s,method:"POST",data:n},t)}BotInfo(e,t){const s=this.genBaseURL("/alice/bot/info"),i=e||{},n={token:i.token,botId:i.botId};return this.request({url:s,method:"POST",data:n},t)}GetBotSubject(e,t){const s=this.genBaseURL("/alice/bot/get_bot_subject"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}UpdateCallerName(e,t){const s=this.genBaseURL("/alice/bot/update_caller_name"),i=e||{},n={bot_id:i.bot_id,caller_name:i.caller_name};return this.request({url:s,method:"POST",data:n},t)}GetBotPreset(e,t){const s=this.genBaseURL("/alice/bot/get_bot_preset"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}GetFirstMet(e,t){const s=this.genBaseURL("/alice/bot/first_met"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}GetBot(e,t){const s=this.genBaseURL("/alice/bot/get_bot"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}GetBotListV2(e,t){const s=this.genBaseURL("/alice/bot/get_bot_list_v2"),i=e||{},n={bot_id_list:i.bot_id_list,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}ActionBarList(e,t){const s=this.genBaseURL("/alice/bot/action_bar_list"),i=e||{},n={language_code:i.language_code,bot_id:i.bot_id};return this.request({url:s,method:"POST",data:n},t)}ActionBarOperationReport(e,t){const s=this.genBaseURL("/alice/bot/action_bar_report"),i=e||{},n={language_code:i.language_code,bot_id:i.bot_id,action_bar_key:i.action_bar_key,passthrough_field:i.passthrough_field,switch_report:i.switch_report,instruction_report:i.instruction_report};return this.request({url:s,method:"POST",data:n},t)}ActionCards(e,t){const s=this.genBaseURL("/alice/bot/action_cards"),i=e||{},n={bot_id:i.bot_id,card_scene:i.card_scene};return this.request({url:s,method:"POST",data:n},t)}ReviewBotInfo(e,t){const s=this.genBaseURL("/alice/bot/review_bot_info"),i={bot_info:(e||{}).bot_info};return this.request({url:s,method:"POST",data:i},t)}GetAvatarHeadLocation(e,t){const s=this.genBaseURL("/alice/bot/avatar_head_location"),i={image_uri_list:(e||{}).image_uri_list};return this.request({url:s,method:"POST",data:i},t)}GetImgAvgHue(e,t){const s=this.genBaseURL("/alice/bot/get_img_avg_hue"),i={image_uri:(e||{}).image_uri};return this.request({url:s,method:"POST",data:i},t)}CheckBotAuth(e,t){const s=this.genBaseURL("/alice/bot/check_bot_auth"),i=e||{},n={client_key:i.client_key,scope:i.scope,state:i.state};return this.request({url:s,method:"POST",data:n},t)}PluginAuth(e,t){const s=this.genBaseURL("/alice/bot/plugin_auth"),i=e||{},n={bot_id:i.bot_id,plugin_ids:i.plugin_ids,op_type:i.op_type};return this.request({url:s,method:"POST",data:n},t)}PluginDetail(e,t){const s=this.genBaseURL("/alice/bot/plugin_detail"),i={plugin_id:(e||{}).plugin_id};return this.request({url:s,method:"POST",data:i},t)}PluginList(e,t){const s=this.genBaseURL("/alice/bot/plugin_list"),i=e||{},n={bot_id:i.bot_id,page_no:i.page_no,page_size:i.page_size};return this.request({url:s,method:"POST",data:n},t)}GetBotCreateQuota(e,t){const s=this.genBaseURL("/alice/bot/get_bot_create_quota");return this.request({url:s,method:"POST"},t)}Mock(e,t){const s=this.genBaseURL("/alice/bot/mock"),i=e||{},n={delete_current_week:i.delete_current_week,AddTime:i.AddTime,Uid:i.Uid};return this.request({url:s,method:"POST",data:n},t)}EnrichBotCheck(e,t){const s=this.genBaseURL("/alice/bot/enrich_check"),i={enrich_bot_content:(e||{}).enrich_bot_content};return this.request({url:s,method:"POST",data:i},t)}BatchDeleteBotMemory(e,t){const s=this.genBaseURL("/alice/bot/batch_delete_memory"),i=e||{},n={bot_id:i.bot_id,memory_ids:i.memory_ids};return this.request({url:s,method:"POST",data:n},t)}ListBotMemory(e,t){const s=this.genBaseURL("/alice/bot/list_memory"),i=e||{},n={bot_id:i.bot_id,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}ClearBotMemory(e,t){const s=this.genBaseURL("/alice/bot/clear_memory"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}InsertBotMemory(e,t){const s=this.genBaseURL("/alice/bot/insert_memory"),i=e||{},n={bot_id:i.bot_id,memory_content:i.memory_content};return this.request({url:s,method:"POST",data:n},t)}SkillCards(e,t){const s=this.genBaseURL("/alice/bot/skill_cards");return this.request({url:s,method:"POST"},t)}ResetBotSubject(e,t){const s=this.genBaseURL("/alice/bot/reset_subject"),i={bot_id:(e||{}).bot_id};return this.request({url:s,method:"POST",data:i},t)}UpdateMusicGenTemplateCount(e,t){const s=this.genBaseURL("/alice/bot/update_music_gen_template_count"),i={template_id:(e||{}).template_id};return this.request({url:s,method:"POST",data:i},t)}ListMusicGenTemplate(e,t){const s=this.genBaseURL("/alice/bot/list_music_gen_template"),i=e||{},n={random_seed:i.random_seed,offset:i.offset,limit:i.limit,need_more_template_cover:i.need_more_template_cover};return this.request({url:s,method:"POST",data:n},t)}},conversation:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("AliceConversationApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}CreateSubConversation(e,t){const s=this.genBaseURL("/alice/conversation/create_sub_conversation"),i=e||{},n={conversation_id:i.conversation_id,message_id:i.message_id,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}ConversationPin(e,t){const s=this.genBaseURL("/alice/conversation/pin"),i=e||{},n={conversation_id:i.conversation_id,bot_id:i.bot_id,local_conversation_id:i.local_conversation_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}ConversationUpdate(e,t){const s=this.genBaseURL("/alice/conversation/update"),i=e||{},n={conversation_id:i.conversation_id,name:i.name,local_conversation_id:i.local_conversation_id,bot_id:i.bot_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}ConversationInfo(e,t){const s=this.genBaseURL("/alice/conversation/info"),i=e||{},n={conversation_id:i.conversation_id,bot_id:i.bot_id,local_conversation_id:i.local_conversation_id,ext:i.ext,init_messages:i.init_messages,bot_source:i.bot_source,scene:i.scene,evaluate_ab_params:i.evaluate_ab_params};return this.request({url:s,method:"POST",data:n},t)}ConversationUnpin(e,t){const s=this.genBaseURL("/alice/conversation/unpin"),i={conversation_id:(e||{}).conversation_id};return this.request({url:s,method:"POST",data:i},t)}CreateSection(e,t){const s=this.genBaseURL("/alice/conversation/create_section"),i=e||{},n={conversation_id:i.conversation_id,local_conversation_id:i.local_conversation_id,bot_id:i.bot_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}MarkConversationRead(e,t){const s=this.genBaseURL("/alice/conversation/mark_conversation_read"),i=e||{},n={conversation_id:i.conversation_id,latest_read_idx:i.latest_read_idx};return this.request({url:s,method:"POST",data:n},t)}ConversationArchive(e,t){const s=this.genBaseURL("/alice/conversation/archive"),i=e||{},n={conversation_id:i.conversation_id,bot_id:i.bot_id,local_conversation_id:i.local_conversation_id};return this.request({url:s,method:"POST",data:n},t)}ConversationInfoAddBot(e,t){const s=this.genBaseURL("/alice/conversation/add_bot"),i={token:(e||{}).token};return this.request({url:s,method:"POST",data:i},t)}ConversationClear(e,t){const s=this.genBaseURL("/alice/conversation/clear"),i=e||{},n={conversation_id:i.conversation_id,local_conversation_id:i.local_conversation_id,bot_id:i.bot_id,ext:i.ext};return this.request({url:s,method:"POST",data:n},t)}ConversationList(e,t){const s=this.genBaseURL("/alice/conversation/list"),i=e||{},n={index:i.index,batch_size:i.batch_size,conversation_types:i.conversation_types};return this.request({url:s,method:"POST",data:n},t)}ConversationReport(e,t){const s=this.genBaseURL("/alice/conversation/report"),i=e||{},n={conversation_id:i.conversation_id,conversation_type:i.conversation_type,bot_conversation_type:i.bot_conversation_type};return this.request({url:s,method:"POST",data:n},t)}},message:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("MessageApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}StreamCallBot(e,t){const s=this.genBaseURL("/alice/message/stream_call_bot"),i={payload:(e||{}).payload};return this.request({url:s,method:"POST",data:i},t)}LoadMusicQS(e,t){const s=this.genBaseURL("/alice/media/source/4"),i=e||{},n={vid_list:i.vid_list,source_id_list:i.source_id_list};return this.request({url:s,method:"POST",data:n},t)}MessageReplay(e,t){const s=this.genBaseURL("/alice/message/replay"),i=e||{},n={payload:i.payload,evaluate_ab_params:i.evaluate_ab_params};return this.request({url:s,method:"POST",data:n},t)}MessageList(e,t){const s=this.genBaseURL("/alice/message/list"),i=e||{},n={conversation_id:i.conversation_id,cursor:i.cursor,batch_size:i.batch_size,bot_id:i.bot_id};return this.request({url:s,method:"POST",data:n},t)}LoadVideoDY(e,t){const s=this.genBaseURL("/alice/media/source/3"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}SearchCards(e,t){const s=this.genBaseURL("/alice/media/card_search"),i=e||{},n={query_params:i.query_params,query_type:i.query_type};return this.request({url:s,method:"POST",data:n},t)}MessageStream(e,t){const s=this.genBaseURL("/alice/message/stream_reply"),i=e||{},n={seq_st:i.seq_st,seq_ed:i.seq_ed,reply_id:i.reply_id,binary_type:i.binary_type,token:i.token};return this.request({url:s,method:"POST",data:n},t)}MessageReport(e,t){const s=this.genBaseURL("/alice/message/report"),i=e||{},n={message_id:i.message_id,reply_id:i.reply_id,action:i.action,position:i.position,feedbackDetail:i.feedbackDetail,conversation_id:i.conversation_id,feedbackSource:i.feedbackSource};return this.request({url:s,method:"POST",data:n},t)}GetMessageReply(e,t){const s=this.genBaseURL("/alice/message/get_reply"),i=e||{},n={message_id:i.message_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}LoadVideoTT(e,t){const s=this.genBaseURL("/alice/media/source/2"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}UpdateMsgContent(e,t){const s=this.genBaseURL("/alice/message/update_content"),i=e||{},n={msg_id:i.msg_id,display_content:i.display_content,content:i.content,need_social_adapter:i.need_social_adapter};return this.request({url:s,method:"POST",data:n},t)}LatestMessageList(e,t){const s=this.genBaseURL("/alice/conversation/latest_messagelist"),i={request_list:(e||{}).request_list};return this.request({url:s,method:"POST",data:i},t)}MCheckMusic(e,t){const s=this.genBaseURL("/alice/media/mcheck/music"),i=e||{},n={check_list:i.check_list,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}GetMsgContent(e,t){const s=this.genBaseURL("/alice/message/content"),i={msg_id:(e||{}).msg_id};return this.request({url:s,method:"POST",data:i},t)}GetAnswerActionContent(e,t){const s=this.genBaseURL("/alice/message/answer_action_content"),i=e||{},n={action_key:i.action_key,msg_id:i.msg_id,bot_id:i.bot_id,conversation_id:i.conversation_id,section_id:i.section_id};return this.request({url:s,method:"POST",data:n},t)}CheckMessageSendRateLimit(e,t){const s=this.genBaseURL("/alice/message/rate_limit");return this.request({url:s,method:"POST"},t)}PutChatRecord(e,t){const s=this.genBaseURL("/alice/message/put_chat_record"),i=e||{},n={conversation_id:i.conversation_id,tool_message_id:i.tool_message_id,switch_message_id:i.switch_message_id};return this.request({url:s,method:"POST",data:n},t)}CmdList(e,t){const s=this.genBaseURL("/alice/message/cmd_list"),i=e||{},n={last_cmd_index:i.last_cmd_index,batch_size:i.batch_size};return this.request({url:s,method:"POST",data:n},t)}MessagePreHandle(e,t){const s=this.genBaseURL("/alice/message/pre_handle"),i=e||{},n={content_type:i.content_type,content:i.content};return this.request({url:s,method:"POST",data:n},t)}MessageListV2(e,t){const s=this.genBaseURL("/alice/message/list/v2"),i=e||{},n={conversation_id:i.conversation_id,start_index:i.start_index,batch_size:i.batch_size,is_reverse:i.is_reverse,end_index:i.end_index};return this.request({url:s,method:"POST",data:n},t)}MessageStreamV2(e,t){const s=this.genBaseURL("/alice/message/stream"),i=e||{},n={seq_st:i.seq_st,seq_ed:i.seq_ed,reply_id:i.reply_id,binary_type:i.binary_type,token:i.token};return this.request({url:s,method:"POST",data:n},t)}SaveBotReply(e,t){const s=this.genBaseURL("/alice/message/save_bot_reply"),i=e||{},n={user_id:i.user_id,conversation_id:i.conversation_id,bot_id:i.bot_id,question_id:i.question_id,contents:i.contents,suggests:i.suggests,source_type:i.source_type,for_historical_question:i.for_historical_question,suggests_v2:i.suggests_v2,biz_id:i.biz_id,tenant_id:i.tenant_id};return this.request({url:s,method:"POST",data:n},t)}SaveMessageShareInfo(e,t){const s=this.genBaseURL("/alice/message/share/save"),i=e||{},n={conv_id:i.conv_id,message_id_list:i.message_id_list,enable_generate_title:i.enable_generate_title,is_allow_seo:i.is_allow_seo,share_total_conversation:i.share_total_conversation};return this.request({url:s,method:"POST",data:n},t)}GetMessageShareInfo(e,t){const s=this.genBaseURL("/alice/message/share/get"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"POST",data:i},t)}MessageAfterAuthorization(e,t){const s=this.genBaseURL("/alice/message/after_authorization"),i={scene:(e||{}).scene};return this.request({url:s,method:"POST",data:i},t)}MultiMessagePreHandle(e,t){const s=this.genBaseURL("/alice/message/pre_handle_v2"),i=e||{},n={uplink_entity:i.uplink_entity,conversation_id:i.conversation_id,bot_id:i.bot_id,section_id:i.section_id,local_message_id:i.local_message_id};return this.request({url:s,method:"POST",data:n},t)}MessageEntityState(e,t){const s=this.genBaseURL("/alice/message/entity_state"),i=e||{},n={state_type:i.state_type,entity_info:i.entity_info};return this.request({url:s,method:"POST",data:n},t)}GetBigMusicLyrics(e,t){const s=this.genBaseURL("/alice/media/bigmusic/lyrics"),i=e||{},n={prompt:i.prompt,instruction_options:i.instruction_options};return this.request({url:s,method:"POST",data:n},t)}UpdateBigMusicMsg(e,t){const s=this.genBaseURL("/alice/media/bigmusic/update_message"),i=e||{},n={message_id:i.message_id,title:i.title,cover_uri:i.cover_uri,task_id:i.task_id};return this.request({url:s,method:"POST",data:n},t)}GetBigMusicVideoInfo(e,t){const s=this.genBaseURL("/alice/media/bigmusic/get_video"),i=e||{},n={video_id:i.video_id,share_id:i.share_id,download_params:i.download_params,template_id:i.template_id,creation_id:i.creation_id};return this.request({url:s,method:"POST",data:n},t)}MultiMessagePreHandleWithoutConv(e,t){const s=this.genBaseURL("/alice/message/pre_handle_v2_without_conv"),i=e||{},n={uplink_entity:i.uplink_entity,bot_id:i.bot_id,local_message_id:i.local_message_id,pre_generate_id:i.pre_generate_id};return this.request({url:s,method:"POST",data:n},t)}SaveBigMusicShareInfo(e,t){const s=this.genBaseURL("/alice/media/bigmusic/share_save"),i=e||{},n={message_id:i.message_id,task_id:i.task_id};return this.request({url:s,method:"POST",data:n},t)}GetBigMusicLyricsWeb(e,t){const s=this.genBaseURL("/alice/media/bigmusic/lyrics_web"),i=e||{},n={prompt:i.prompt,genre:i.genre,mood:i.mood};return this.request({url:s,method:"POST",data:n},t)}MessageListDouyinPlayback(e,t){const s=this.genBaseURL("/alice/message/douyin_playback"),i=e||{},n={encryption_message_id_list:i.encryption_message_id_list,date:i.date,with_push_message:i.with_push_message};return this.request({url:s,method:"POST",data:n},t)}UpdateBigMusicMsgWeb(e,t){const s=this.genBaseURL("/alice/media/bigmusic/update_message_web"),i=e||{},n={message_id:i.message_id,title:i.title,cover_uri:i.cover_uri,task_id:i.task_id};return this.request({url:s,method:"POST",data:n},t)}GetMessageListByIndexList(e,t){const s=this.genBaseURL("/alice/message/index_list"),i=e||{},n={conversation_id:i.conversation_id,message_index_list:i.message_index_list,is_reverse:i.is_reverse};return this.request({url:s,method:"POST",data:n},t)}UploadEventLog(e,t){const s=this.genBaseURL("/alice/message/event_log"),i=e||{},n={question_id:i.question_id,timestamp:i.timestamp,section_id:i.section_id,conversation_id:i.conversation_id,event_type:i.event_type,key:i.key,value:i.value};return this.request({url:s,method:"POST",data:n},t)}LoadVideoModel(e,t){const s=this.genBaseURL("/alice/media/video_model"),i=e||{},n={query:i.query,search_id:i.search_id,item_ids:i.item_ids,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}QueryMatchInfo(e,t){const s=this.genBaseURL("/alice/message/match_info"),i=e||{},n={type:i.type,data:i.data,league_id:i.league_id};return this.request({url:s,method:"POST",data:n},t)}EvaluateSessionPlayback(e,t){const s=this.genBaseURL("/alice/message/session_playback"),i=e||{},n={encryption_message_id_list:i.encryption_message_id_list,from_date:i.from_date,to_date:i.to_date,with_push_message:i.with_push_message,source:i.source};return this.request({url:s,method:"POST",data:n},t)}UpdateRecordMsg(e,t){const s=this.genBaseURL("/alice/message/update_record"),i=e||{},n={msg_id:i.msg_id,status:i.status,need_social_adapter:i.need_social_adapter,duration:i.duration,meeting_id:i.meeting_id};return this.request({url:s,method:"POST",data:n},t)}},dataReport:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("DataReportService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}FetchMsgList(e,t){const s=this.genBaseURL("/alice_op/msg/fetch_message_ids"),i=e||{},n={start_time:i.start_time,end_time:i.end_time,content:i.content,user_id:i.user_id,message_id:i.message_id,device_id:i.device_id,page_index:i.page_index,page_size:i.page_size};return this.request({url:s,method:"POST",data:n},t)}FetchChainEventList(e,t){const s=this.genBaseURL("/alice_op/msg/fetch_chain_events"),i=e||{},n={start_time:i.start_time,end_time:i.end_time,message_id:i.message_id,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}FetchAliceChainEventList(e,t){const s=this.genBaseURL("/alice/msg/fetch_chain_events"),i=e||{},n={start_time:i.start_time,end_time:i.end_time,message_id:i.message_id,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}FetchAliceEventList(e,t){const s=this.genBaseURL("/alice/msg/fetch_events"),i=e||{},n={start_time:i.start_time,end_time:i.end_time,message_id:i.message_id,offset:i.offset,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}},samantha:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SamanthaApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetFeed(e,t){const s=this.genBaseURL("/samantha/feed");return this.request({url:s,method:"GET"},t)}ThreadList(e,t){const s=this.genBaseURL("/samantha/thread/list"),i=e||{},n={index:i.index,batch_size:i.batch_size};return this.request({url:s,method:"POST",data:n},t)}ThreadDelete(e,t){const s=this.genBaseURL("/samantha/thread/delete"),i=e||{},n={thread_id:i.thread_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}ThreadUpdate(e,t){const s=this.genBaseURL("/samantha/thread/update"),i=e||{},n={thread_id:i.thread_id,conversation_id:i.conversation_id,name:i.name};return this.request({url:s,method:"POST",data:n},t)}ThreadCreate(e,t){const s=this.genBaseURL("/samantha/thread/create"),i=e||{},n={conversation_id:i.conversation_id,message_id:i.message_id,bot_id:i.bot_id,samantha_onboarding:i.samantha_onboarding};return this.request({url:s,method:"POST",data:n},t)}GetSkillGuidance(e,t){const s=this.genBaseURL("/samantha/skill/guidance"),i=e||{},n={config_key:i.config_key,option_indexes:i.option_indexes};return this.request({url:s,method:"POST",data:n},t)}GetRecommendSkills(e,t){const s=this.genBaseURL("/samantha/skill/recommend");return this.request({url:s,method:"POST"},t)}CreateOrGetMainThread(e,t){const s=this.genBaseURL("/samantha/thread/main/create_or_get");return this.request({url:s,method:"POST"},t)}GetSamanthaWebHitStatus(e,t){const s=this.genBaseURL("/samantha/user/web_hit_status/get");return this.request({url:s,method:"GET"},t)}UpdateSamanthaWebHitStatus(e,t){const s=this.genBaseURL("/samantha/user/web_hit_status/update"),i=e||{},n={status:i.status,hit_source:i.hit_source,remind_time:i.remind_time};return this.request({url:s,method:"POST",data:n},t)}DetectLang(e,t){const s=this.genBaseURL("/samantha/plugin/detect_lang"),i={raw_text:(e||{}).raw_text};return this.request({url:s,method:"POST",data:i},t)}GetThreadShareInfo(e,t){const s=this.genBaseURL("/samantha/thread/share/info"),i=e||{},n={thread_id:i.thread_id,conversation_id:i.conversation_id};return this.request({url:s,method:"POST",data:n},t)}GetThreadShareSnapshot(e,t){const s=this.genBaseURL("/samantha/thread/share/snapshot/get"),i=e||{},n={share_id:i.share_id,need_bot:i.need_bot};return this.request({url:s,method:"POST",data:n},t)}SaveThreadShareInfo(e,t){const s=this.genBaseURL("/samantha/thread/share/save"),i=e||{},n={thread_id:i.thread_id,message_index_end:i.message_index_end,is_allow_seo:i.is_allow_seo,message_index_list:i.message_index_list,save_type:i.save_type,conversation_id:i.conversation_id,share_type:i.share_type};return this.request({url:s,method:"POST",data:n},t)}DeleteShareThreadInfo(e,t){const s=this.genBaseURL("/samantha/thread/share/delete"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"POST",data:i},t)}GetTouristFeed(e,t){const s=this.genBaseURL("/samantha/feed/tourist_get");return this.request({url:s,method:"GET"},t)}GetYouTubeShare(e,t){const s=this.genBaseURL("/samantha/plugin/get_youtube_share"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"GET",params:i},t)}CreateYouTubeShare(e,t){const s=this.genBaseURL("/samantha/plugin/youtube_share"),i={content:(e||{}).content};return this.request({url:s,method:"POST",data:i},t)}GetUtmInfo(e,t){const s=this.genBaseURL("/samantha/desktop/get_utm"),i={id:(e||{}).id};return this.request({url:s,method:"GET",params:i},t)}SaveUtmInfo(e,t){const s=this.genBaseURL("/samantha/desktop/save_utm"),i={info:(e||{}).info};return this.request({url:s,method:"POST",data:i},t)}GetLatestCRXInfo(e,t){const s=this.genBaseURL("/samantha/plugin/latest_crx_info");return this.request({url:s,method:"GET"},t)}Txt2Img(e,t){const s=this.genBaseURL("/samantha/cozeplugin/txt2img"),i=e||{},n={ratio:i.ratio,prompt:i.prompt,style:i.style};return this.request({url:s,method:"POST",data:n},t)}Translate(e,t){const s=this.genBaseURL("/samantha/plugin/translate"),i=e||{},n={raw_text:i.raw_text,source_lang:i.source_lang,target_lang:i.target_lang,translate_service:i.translate_service,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}PluginDeletePromptSkill(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/delete"),i=e||{},n={item_id:i.item_id,user_setting:i.user_setting,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}PluginAddPromptSkill(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/add"),i=e||{},n={items:i.items,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}PluginListDiscoverSkills(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/list_discover_skills"),i=e||{},n={page_size:i.page_size,start_index:i.start_index,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}ListCustomPSByUser(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/list_by_user"),i={frontend_source:(e||{}).frontend_source};return this.request({url:s,method:"POST",data:i},t)}PluginSavePSSetting(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/save_setting"),i=e||{},n={user_setting:i.user_setting,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}PluginUpdatePromptSkill(e,t){const s=this.genBaseURL("/samantha/plugin/prompt_skill/update"),i=e||{},n={item:i.item,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}GetSetting(e,t){const s=this.genBaseURL("/samantha/user/setting/get"),i={ab_param:(e||{}).ab_param};return this.request({url:s,method:"POST",data:i},t)}UpdateSetting(e,t){const s=this.genBaseURL("/samantha/user/setting/update"),i={ogf_enable:(e||{}).ogf_enable};return this.request({url:s,method:"POST",data:i},t)}Revise(e,t){const s=this.genBaseURL("/samantha/plugin/revise"),i={items:(e||{}).items};return this.request({url:s,method:"POST",data:i},t)}GetPluginChangeLog(e,t){const s=this.genBaseURL("/samantha/plugin/change_log"),i=e||{},n={version:i.version,language:i.language};return this.request({url:s,method:"GET",params:n},t)}GetPDFOcr(e,t){const s=this.genBaseURL("/samantha/pdf/ocr"),i=e||{},n={file_key:i.file_key,url:i.url,start_page:i.start_page,end_page:i.end_page};return this.request({url:s,method:"POST",data:n},t)}CollectionTagList(e,t){const s=this.genBaseURL("/samantha/collection/tag/list"),i=e||{},n={next_key:i.next_key,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}CollectionList(e,t){const s=this.genBaseURL("/samantha/collection/list"),i=e||{},n={keyword:i.keyword,tags:i.tags,types:i.types,next_key:i.next_key,limit:i.limit,onboarding:i.onboarding};return this.request({url:s,method:"POST",data:n},t)}CreateCollection(e,t){const s=this.genBaseURL("/samantha/collection/create"),i={collection:(e||{}).collection};return this.request({url:s,method:"POST",data:i},t)}GetCollection(e,t){const s=this.genBaseURL(`/samantha/collection/get/${e.id}`),i={scenario:(e||{}).scenario};return this.request({url:s,method:"GET",params:i},t)}AcademicSearch(e,t){const s=this.genBaseURL("/samantha/cozeplugin/academic_search"),i=e||{},n={query:i.query,offset:i.offset,limit:i.limit};return this.request({url:s,method:"GET",params:n},t)}ThreadCreateOrGet(e,t){const s=this.genBaseURL("/samantha/thread/create_or_get"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"POST",data:i},t)}DeleteCollection(e,t){const s=this.genBaseURL("/samantha/collection/delete"),i=e||{},n={id:i.id,delete_children:i.delete_children};return this.request({url:s,method:"POST",data:n},t)}CreateCollectionShare(e,t){const s=this.genBaseURL("/samantha/collection/share/create"),i=e||{},n={collection_id:i.collection_id,enable_seo:i.enable_seo};return this.request({url:s,method:"POST",data:n},t)}GetCollectionShare(e,t){const s=this.genBaseURL(`/samantha/collection/share/${e.share_id}`);return this.request({url:s,method:"GET"},t)}StreamCallBotInToutiao(e,t){const s=this.genBaseURL("/samantha/toutiao/stream_call_bot"),i={payload:(e||{}).payload};return this.request({url:s,method:"POST",data:i},t)}StreamArticleTranslate(e,t){const s=this.genBaseURL("/samantha/plugin/stream_article_translate"),i=e||{},n={raw_text:i.raw_text,target_lang:i.target_lang,translate_service:i.translate_service,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}UpdatePagesOutline(e,t){const s=this.genBaseURL("/samantha/pages/update_outline"),i=e||{},n={id:i.id,content:i.content,meta:i.meta};return this.request({url:s,method:"POST",data:n},t)}GetPodcastTranscript(e,t){const s=this.genBaseURL("/samantha/plugin/podcast/transcript"),i=e||{},n={url:i.url,type:i.type,resource_url:i.resource_url};return this.request({url:s,method:"POST",data:n},t)}PodcastResourceShouldUpload(e,t){const s=this.genBaseURL("/samantha/plugin/podcast/should_upload"),i=e||{},n={url:i.url,type:i.type};return this.request({url:s,method:"POST",data:n},t)}GetCollectionByFingerprint(e,t){const s=this.genBaseURL(`/samantha/collection/fingerprint/get/${e.fingerprint}`);return this.request({url:s,method:"GET"},t)}SniffUrl(e,t){const s=this.genBaseURL("/samantha/pdf/sniff"),i={urls:(e||{}).urls};return this.request({url:s,method:"POST",data:i},t)}AudioASR(e,t){const s=this.genBaseURL("/samantha/audio/asr"),i=e||{},n={format:i.format,codec:i.codec,rate:i.rate,bits:i.bits,channel:i.channel,language:i.language};return this.request({url:s,method:"GET",params:n},t)}AudioTTS(e,t){const s=this.genBaseURL("/samantha/audio/tts"),i=e||{},n={speaker:i.speaker,format:i.format};return this.request({url:s,method:"GET",params:n},t)}GetThread(e,t){const s=this.genBaseURL("/samantha/thread/get"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"GET",params:i},t)}GetCollectionOnboardingMessage(e,t){const s=this.genBaseURL("/samantha/collection/onboarding_message"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"GET",params:i},t)}GetWordContentFromDict(e,t){const s=this.genBaseURL("/samantha/plugin/dict/word"),i=e||{},n={content:i.content,language_target:i.language_target,language_source:i.language_source,use_dict:i.use_dict,frontend_source:i.frontend_source,related_text:i.related_text};return this.request({url:s,method:"POST",data:n},t)}UpdatePages(e,t){const s=this.genBaseURL("/samantha/pages/update"),i=e||{},n={pages_id:i.pages_id,content:i.content,version:i.version,title:i.title};return this.request({url:s,method:"POST",data:n},t)}GetPages(e,t){const s=this.genBaseURL("/samantha/pages/get"),i={pages_id:(e||{}).pages_id};return this.request({url:s,method:"GET",params:i},t)}GetThreadCollectionShareMessages(e,t){const s=this.genBaseURL("/samantha/collection/thread/share"),i=e||{},n={share_id:i.share_id,need_bot:i.need_bot};return this.request({url:s,method:"GET",params:n},t)}GetThreadCollectionMessages(e,t){const s=this.genBaseURL("/samantha/collection/thread/messages"),i={collection_id:(e||{}).collection_id};return this.request({url:s,method:"GET",params:i},t)}GetLatestReadingList(e,t){const s=this.genBaseURL("/samantha/skill/latest_reading_list"),i=e||{},n={cursor:i.cursor,count:i.count};return this.request({url:s,method:"POST",data:n},t)}GetTranslationLanguageList(e,t){const s=this.genBaseURL("/samantha/plugin/translation/language_list");return this.request({url:s,method:"GET"},t)}GetSearchCardRecommend(e,t){const s=this.genBaseURL("/samantha/plugin/search/card_recommend"),i=e||{},n={expect_cards:i.expect_cards,exposed_card_ids:i.exposed_card_ids};return this.request({url:s,method:"POST",data:n},t)}UpdateCollectionMemo(e,t){const s=this.genBaseURL("/samantha/collection/memo/update"),i=e||{},n={id:i.id,upsert:i.upsert,remove:i.remove};return this.request({url:s,method:"POST",data:n},t)}SearchPagesImages(e,t){const s=this.genBaseURL("/samantha/pages/search_image"),i=e||{},n={query:i.query,offset:i.offset,limit:i.limit,title:i.title,need_rewrite_query:i.need_rewrite_query};return this.request({url:s,method:"POST",data:n},t)}UploadPagesImage(e,t){const s=this.genBaseURL("/samantha/pages/upload_image"),i=e||{},n={file_type:i.file_type,data:i.data};return this.request({url:s,method:"POST",data:n},t)}PluginWebMetaUpload(e,t){const s=this.genBaseURL("/samantha/plugin/web_meta_upload"),i=e||{},n={source_url:i.source_url,web_meta:i.web_meta};return this.request({url:s,method:"POST",data:n},t)}GetLarkUserInfo(e,t){const s=this.genBaseURL("/samantha/user/lark_user_info/get"),i={code:(e||{}).code};return this.request({url:s,method:"POST",data:i},t)}ImageOCR(e,t){const s=this.genBaseURL("/samantha/image/ocr"),i=e||{},n={uri:i.uri,scene:i.scene};return this.request({url:s,method:"POST",data:n},t)}OlympicHomepage(e,t){const s=this.genBaseURL("/samantha/olympic/homepage"),i=e||{},n={match_type_list:i.match_type_list,date:i.date};return this.request({url:s,method:"GET",params:n},t)}OlympicSubscribeDailyReport(e,t){const s=this.genBaseURL("/samantha/olympic/subscribe_daily_report"),i={subscribe:(e||{}).subscribe};return this.request({url:s,method:"POST",data:i},t)}GetSearchHighlight(e,t){const s=this.genBaseURL("/samantha/search/highlight"),i=e||{},n={summary:i.summary,content:i.content};return this.request({url:s,method:"POST",data:n},t)}GetOlympicMatchSummary(e,t){const s=this.genBaseURL(`/samantha/olympic/summary/${e.match_id}`);return this.request({url:s,method:"GET"},t)}GetSearchReferencePaper(e,t){const s=this.genBaseURL("/samantha/search/paper_reference"),i={title:(e||{}).title};return this.request({url:s,method:"GET",params:i},t)}OlympicDailyReportSubscribeStatus(e,t){const s=this.genBaseURL("/samantha/olympic/subscribe_status");return this.request({url:s,method:"POST"},t)}UpdateOutlineMeta(e,t){const s=this.genBaseURL("/samantha/pages/update_outline_meta"),i=e||{},n={user_id:i.user_id,outline_id:i.outline_id,content:i.content,markdown_content:i.markdown_content};return this.request({url:s,method:"POST",data:n},t)}SearchOutlineReference(e,t){const s=this.genBaseURL("/samantha/pages/search_outline_reference"),i={query:(e||{}).query};return this.request({url:s,method:"POST",data:i},t)}SearchReferenceByParagraph(e,t){const s=this.genBaseURL("/samantha/pages/search_reference_by_paragraph"),i=e||{},n={paragraph_content:i.paragraph_content,user_prompt:i.user_prompt};return this.request({url:s,method:"POST",data:n},t)}DeleteWordNote(e,t){const s=this.genBaseURL("/samantha/word_notes/delete"),i=e||{},n={word:i.word,source_lang:i.source_lang,target_lang:i.target_lang,delete_operation:i.delete_operation};return this.request({url:s,method:"POST",data:n},t)}GetWordNotes(e,t){const s=this.genBaseURL("/samantha/word_notes/get"),i=e||{},n={source_lang:i.source_lang,target_lang:i.target_lang,status:i.status};return this.request({url:s,method:"GET",params:n},t)}GetOutlineMeta(e,t){const s=this.genBaseURL("/samantha/pages/get_outline_meta"),i=e||{},n={user_id:i.user_id,outline_id:i.outline_id};return this.request({url:s,method:"POST",data:n},t)}SaveWordNote(e,t){const s=this.genBaseURL("/samantha/word_notes/save"),i=e||{},n={source_lang:i.source_lang,target_lang:i.target_lang,word:i.word};return this.request({url:s,method:"POST",data:n},t)}GetPluginChangeLogV2(e,t){const s=this.genBaseURL("/samantha/plugin/change_log_v2"),i=e||{},n={version:i.version,language:i.language,browser_name:i.browser_name};return this.request({url:s,method:"GET",params:n},t)}GetDocumentInfo(e,t){const s=this.genBaseURL("/samantha/aireader/document_info/get"),i={uris:(e||{}).uris};return this.request({url:s,method:"POST",data:i},t)}GetJWT(e,t){const s=this.genBaseURL("/samantha/plugin/jwt"),i={scope:(e||{}).scope};return this.request({url:s,method:"GET",params:i},t)}StreamCallBot(e,t){const s=this.genBaseURL("/samantha/plugin/stream_call_bot"),i={payload:(e||{}).payload};return this.request({url:s,method:"POST",data:i},t)}GetLatestStableVersion(e,t){const s=this.genBaseURL("/samantha/desktop/get_stable_version"),i=e||{},n={current_version:i.current_version,block_version:i.block_version,channel:i.channel,last_running_version:i.last_running_version};return this.request({url:s,method:"GET",params:n},t)}UpdateCollection(e,t){const s=this.genBaseURL("/samantha/collection/update"),i=e||{},n={id:i.id,data:i.data};return this.request({url:s,method:"POST",data:n},t)}GetDesktopHomepage(e,t){const s=this.genBaseURL("/samantha/desktop/homepage");return this.request({url:s,method:"GET"},t)}JWTValidate(e,t){const s=this.genBaseURL("/samantha/plugin/validate_jwt");return this.request({url:s,method:"GET"},t)}SaveUserSystemSettings(e,t){const s=this.genBaseURL("/samantha/plugin/user_settings/save"),i=e||{},n={settings:i.settings,frontend_source:i.frontend_source};return this.request({url:s,method:"POST",data:n},t)}GetUserSystemSettings(e,t){const s=this.genBaseURL("/samantha/plugin/user_settings/get"),i={frontend_source:(e||{}).frontend_source};return this.request({url:s,method:"GET",params:i},t)}GetUnreadNoticeInfo(e,t){const s=this.genBaseURL("/samantha/notice/info");return this.request({url:s,method:"GET"},t)}GetNoticeRecordList(e,t){const s=this.genBaseURL("/samantha/notice/get_list"),i=e||{},n={page:i.page,size:i.size};return this.request({url:s,method:"GET",params:n},t)}MarkNoticeInfoRead(e,t){const s=this.genBaseURL("/samantha/notice/mark_read");return this.request({url:s,method:"GET"},t)}EvaluateGetABParams(e,t){const s=this.genBaseURL("/samantha/evaluate/get_ab_params");return this.request({url:s,method:"POST"},t)}ReportShare(e,t){const s=this.genBaseURL("/samantha/thread/share/report"),i=e||{},n={share_id:i.share_id,reason_ids:i.reason_ids,reason_detail:i.reason_detail};return this.request({url:s,method:"POST",data:n},t)}CheckUltraLongTextQuota(e,t){const s=this.genBaseURL("/samantha/aireader/ultra_long_text/check_quota");return this.request({url:s,method:"POST"},t)}MarkUltraLongTextRead(e,t){const s=this.genBaseURL("/samantha/notice/ultra_long_text/mark_read");return this.request({url:s,method:"POST"},t)}SearchArtifact(e,t){const s=this.genBaseURL("/samantha/artifact/search"),i=e||{},n={conversation_id:i.conversation_id,artifact_id:i.artifact_id,version:i.version,include_content:i.include_content};return this.request({url:s,method:"POST",data:n},t)}PDFPreview(e,t){const s=this.genBaseURL("/samantha/pdf/preview"),i={uris:(e||{}).uris};return this.request({url:s,method:"POST",data:i},t)}TerminalGenPages(e,t){const s=this.genBaseURL("/samantha/pages/terminal_gen_pages"),i={pages_id:(e||{}).pages_id};return this.request({url:s,method:"POST",data:i},t)}ExportWordNotes(e,t){const s=this.genBaseURL("/samantha/word_notes/export"),i=e||{},n={source_lang:i.source_lang,target_lang:i.target_lang};return this.request({url:s,method:"GET",params:n},t)}CreateSelectedCollection(e,t){const s=this.genBaseURL("/samantha/collection/selected_create"),i={selected_ids:(e||{}).selected_ids};return this.request({url:s,method:"POST",data:i},t)}ResourceContentExists(e,t){const s=this.genBaseURL("/samantha/aireader/resource_content/exists"),i=e||{},n={type:i.type,fingerprint:i.fingerprint};return this.request({url:s,method:"GET",params:n},t)}CreateResourceContent(e,t){const s=this.genBaseURL("/samantha/aireader/resource_content/create"),i={resource_content:(e||{}).resource_content};return this.request({url:s,method:"POST",data:i},t)}AddReference(e,t){const s=this.genBaseURL("/samantha/pages/add_reference"),i=e||{},n={uri:i.uri,link:i.link,uuid:i.uuid,file_type:i.file_type};return this.request({url:s,method:"POST",data:n},t)}MarkStrongReminderRead(e,t){const s=this.genBaseURL("/samantha/notice/strong_notice_mark_read");return this.request({url:s,method:"GET"},t)}GetAudioConf(e,t){const s=this.genBaseURL("/samantha/audio/conf");return this.request({url:s,method:"GET"},t)}DoCookieSync(e,t){const s=this.genBaseURL("/samantha/plugin/cookie_sync/do");return this.request({url:s,method:"POST"},t)}QueryReferenceContent(e,t){const s=this.genBaseURL("/samantha/pages/query_reference_content"),i={uuid:(e||{}).uuid};return this.request({url:s,method:"POST",data:i},t)}ChildCollectionList(e,t){const s=this.genBaseURL("/samantha/collection/child_collections"),i=e||{},n={parent_id:i.parent_id,next_key:i.next_key,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}UpdateSkillsOrder(e,t){const s=this.genBaseURL("/samantha/skill/update_order"),i={input_skill:(e||{}).input_skill};return this.request({url:s,method:"POST",data:i},t)}GetSkillList(e,t){const s=this.genBaseURL("/samantha/skill/list");return this.request({url:s,method:"POST"},t)}},notify:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("NotifyApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetNoticeGroupUnreadCount(e,t){const s=this.genBaseURL("/alice/notice/get_unread_count"),i={groups:(e||{}).groups};return this.request({url:s,method:"POST",data:i},t)}GetNoticeList(e,t){const s=this.genBaseURL("/alice/notice/list"),i=e||{},n={min_cursor:i.min_cursor,max_cursor:i.max_cursor,count:i.count,need_read_time:i.need_read_time};return this.request({url:s,method:"POST",data:n},t)}MarkReadNotice(e,t){const s=this.genBaseURL("/alice/notice/mark_read"),i=e||{},n={group:i.group,last_read_time:i.last_read_time,mark_count:i.mark_count,groups:i.groups,notice_id:i.notice_id};return this.request({url:s,method:"POST",data:n},t)}GetPushContent(e,t){const s=this.genBaseURL("/alice/notice/push_content"),i=e||{},n={group_id:i.group_id,user_id:i.user_id};return this.request({url:s,method:"POST",data:n},t)}ReportOCPCEvent(e,t){const s=this.genBaseURL("/alice/notice/report_ocpc"),i=e||{},n={landing_page_url:i.landing_page_url,app_id:i.app_id,event_ts:i.event_ts,event_name:i.event_name,event_params:i.event_params};return this.request({url:s,method:"POST",data:n},t)}GetNoticeBanner(e,t){const s=this.genBaseURL("/alice/notice/banner"),i={page_type:(e||{}).page_type};return this.request({url:s,method:"POST",data:i},t)}UpdateRedDot(e,t){const s=this.genBaseURL("/alice/notice/update_red_dot"),i=e||{},n={user_id:i.user_id,all_red_dot:i.all_red_dot,red_dot:i.red_dot};return this.request({url:s,method:"POST",data:n},t)}GetAggregationList(e,t){const s=this.genBaseURL("/alice/notice/agg_list"),i=e||{},n={notice_id:i.notice_id,notice_group:i.notice_group,min_cursor:i.min_cursor,max_cursor:i.max_cursor,count:i.count,bot_id:i.bot_id};return this.request({url:s,method:"POST",data:n},t)}DeleteNotices(e,t){const s=this.genBaseURL("/alice/notice/delete"),i={notice_id_list:(e||{}).notice_id_list};return this.request({url:s,method:"POST",data:i},t)}},safety:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SafetyApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}AgeGateCheck(e,t){const s=this.genBaseURL("/alice/age_gate/check"),i={scene:(e||{}).scene};return this.request({url:s,method:"POST",data:i},t)}BanAppeal(e,t){const s=this.genBaseURL("/alice/user/ban_appeal"),i={user_id:(e||{}).user_id};return this.request({url:s,method:"POST",data:i},t)}AgeGateReport(e,t){const s=this.genBaseURL("/alice/age_gate/report"),i=e||{},n={birthday:i.birthday,scene:i.scene,pass:i.pass};return this.request({url:s,method:"POST",data:n},t)}GetUserBlocklist(e,t){const s=this.genBaseURL("/alice/user/blocklist/list"),i=e||{},n={index:i.index,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}DeleteBlocklistUser(e,t){const s=this.genBaseURL("/alice/user/blocklist/delete"),i={blocklist_user_id:(e||{}).blocklist_user_id};return this.request({url:s,method:"POST",data:i},t)}CreateBlocklistUser(e,t){const s=this.genBaseURL("/alice/user/blocklist/create"),i={blocklist_user_id:(e||{}).blocklist_user_id};return this.request({url:s,method:"POST",data:i},t)}AgeGateDelete(e,t){const s=this.genBaseURL("/alice/age_gate/delete"),i={uid:(e||{}).uid};return this.request({url:s,method:"POST",data:i},t)}RedirectByRegion(e,t){const s=this.genBaseURL("/alice/safety/redirect_by_region"),i={key:(e||{}).key};return this.request({url:s,method:"GET",params:i},t)}GetReportReasons(e,t){const s=this.genBaseURL("/alice/safety/report/reasons"),i={report_type:(e||{}).report_type};return this.request({url:s,method:"GET",params:i},t)}ConversationReport(e,t){const s=this.genBaseURL("/alice/safety/report/create/conversation"),i=e||{},n={report_type:i.report_type,conversation_ID:i.conversation_ID,reason_ID:i.reason_ID,reason_detail:i.reason_detail,report_message:i.report_message,report_source:i.report_source,reporter_user_ID:i.reporter_user_ID};return this.request({url:s,method:"POST",data:n},t)}ConversationAppeal(e,t){const s=this.genBaseURL("/alice/safety/conversation/appeal"),i={conversation_id:(e||{}).conversation_id};return this.request({url:s,method:"POST",data:i},t)}UserReport(e,t){const s=this.genBaseURL("/alice/safety/report/create/user"),i=e||{},n={report_type:i.report_type,reporter_user_id:i.reporter_user_id,reported_user_id:i.reported_user_id,reason_id:i.reason_id,reason_detail:i.reason_detail,report_messages:i.report_messages,report_source:i.report_source};return this.request({url:s,method:"POST",data:n},t)}GetReviewReport(e,t){const s=this.genBaseURL("/alice/safety/get_review_report"),i={suppression_notify_id:(e||{}).suppression_notify_id};return this.request({url:s,method:"GET",params:i},t)}SuppressAppeal(e,t){const s=this.genBaseURL("/alice/safety/appeal"),i={suppression_notify_id:(e||{}).suppression_notify_id};return this.request({url:s,method:"POST",data:i},t)}},profile:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("ProfileApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}ProfileBotList(e,t){const s=this.genBaseURL("/alice/profile/bot_list"),i=e||{},n={visit_id:i.visit_id,index:i.index,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}ProfileInfo(e,t){const s=this.genBaseURL("/alice/profile/self"),i={visit_id:(e||{}).visit_id};return this.request({url:s,method:"POST",data:i},t)}CheckProfileInfoDefault(e,t){const s=this.genBaseURL("/alice/profile/info_default"),i={entity_id:(e||{}).entity_id};return this.request({url:s,method:"POST",data:i},t)}UserHitProfileRegister(e,t){const s=this.genBaseURL("/alice/profile/hit_register");return this.request({url:s,method:"POST"},t)}PullUserConfig(e,t){const s=this.genBaseURL("/alice/user/config/pull"),i=e||{},n={objects:i.objects,reason:i.reason};return this.request({url:s,method:"POST",data:n},t)}UpdateProfile(e,t){const s=this.genBaseURL("/alice/profile/update_profile"),i=e||{},n={entity_id:i.entity_id,nickname:i.nickname,user_name:i.user_name,avatar_url:i.avatar_url,is_register:i.is_register,user_language_code:i.user_language_code};return this.request({url:s,method:"POST",data:n},t)}CheckUserNameUnique(e,t){const s=this.genBaseURL("/alice/profile/user_name_unique"),i=e||{},n={user_name:i.user_name,entity_id:i.entity_id};return this.request({url:s,method:"POST",data:n},t)}ProfileOverview(e,t){const s=this.genBaseURL("/alice/profile/overview"),i={visit_id:(e||{}).visit_id};return this.request({url:s,method:"POST",data:i},t)}SyncUserConfig(e,t){const s=this.genBaseURL("/alice/user/config/sync"),i={configs:(e||{}).configs};return this.request({url:s,method:"POST",data:i},t)}ProfileBrief(e,t){const s=this.genBaseURL("/alice/profile/self_brief");return this.request({url:s,method:"POST"},t)}ReportAwemeOpenID(e,t){const s=this.genBaseURL("/alice/profile/report_aweme_open_id"),i=e||{},n={client_key:i.client_key,open_id:i.open_id};return this.request({url:s,method:"POST",data:n},t)}OperateUserVoice(e,t){const s=this.genBaseURL("/alice/profile/update_user_voice"),i=e||{},n={uid:i.uid,voice_id:i.voice_id,operate:i.operate};return this.request({url:s,method:"POST",data:n},t)}GetUserVoice(e,t){const s=this.genBaseURL("/alice/profile/get_user_voice"),i={uid:(e||{}).uid};return this.request({url:s,method:"POST",data:i},t)}UserCreationList(e,t){const s=this.genBaseURL("/alice/profile/creation/list"),i=e||{},n={cursor:i.cursor,page_size:i.page_size,visit_id:i.visit_id,private_status:i.private_status};return this.request({url:s,method:"POST",data:n},t)}CreateCreation(e,t){const s=this.genBaseURL("/alice/profile/creation/create"),i=e||{},n={source:i.source,content:i.content,private_status:i.private_status};return this.request({url:s,method:"POST",data:n},t)}UpdateCreation(e,t){const s=this.genBaseURL("/alice/profile/creation/update"),i=e||{},n={creation_id:i.creation_id,content:i.content,private_status:i.private_status,status:i.status};return this.request({url:s,method:"POST",data:n},t)}ReportCounter(e,t){const s=this.genBaseURL("/alice/profile/creation/report_counter"),i=e||{},n={name_space:i.name_space,operator:i.operator,entity_id:i.entity_id};return this.request({url:s,method:"POST",data:n},t)}},search:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SearchApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}Search(e,t){const s=this.genBaseURL("/alice/comprehensive/search"),i=e||{},n={keyword:i.keyword,index_type:i.index_type,offset:i.offset,size:i.size};return this.request({url:s,method:"POST",data:n},t)}},social:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SocialApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetSharePage(e,t){const s=this.genBaseURL("/social/conversation/get_share_page/"),i={share_token:(e||{}).share_token};return this.request({url:s,method:"POST",data:i},t)}},suggestwords:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SuggestwordsApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetVideoSuggest(e,t){const s=this.genBaseURL("/alice/suggestwords/get_video_suggest"),i=e||{},n={item_id:i.item_id,item_id_good:i.item_id_good,video_suggest_type:i.video_suggest_type};return this.request({url:s,method:"POST",data:n},t)}GetSuggestWords(e,t){const s=this.genBaseURL("/alice/suggestwords"),i=e||{},n={query_text:i.query_text,source:i.source};return this.request({url:s,method:"POST",data:n},t)}GetTrendsTopic(e,t){const s=this.genBaseURL("/alice/suggestwords/trends_topic");return this.request({url:s,method:"POST"},t)}GetFlowSuggest(e,t){const s=this.genBaseURL("/alice/suggestwords/get_flow_suggest"),i=e||{},n={prompt_content:i.prompt_content,response_content:i.response_content,language:i.language};return this.request({url:s,method:"POST",data:n},t)}GetSuggestWordsComposite(e,t){const s=this.genBaseURL("/alice/suggestwords/composite"),i=e||{},n={query_text:i.query_text,source:i.source};return this.request({url:s,method:"POST",data:n},t)}},resource:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("ResourceApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetFileURL(e,t){const s=this.genBaseURL("/alice/message/get_file_url"),i=e||{},n={uris:i.uris,type:i.type,format:i.format,expire_second:i.expire_second};return this.request({url:s,method:"POST",data:n},t)}UploadImage(e,t){const s=this.genBaseURL("/alice/upload/image"),i=e||{},n={file_type:i.file_type,biz_type:i.biz_type,data:i.data};return this.request({url:s,method:"POST",data:n},t)}FileUpload(e,t){const s=this.genBaseURL("/alice/upload/file"),i=e||{},n={file_type:i.file_type,biz_type:i.biz_type,data:i.data};return this.request({url:s,method:"POST",data:n},t)}GetUploadAuthToken(e,t){const s=this.genBaseURL("/alice/upload/auth_token"),i=e||{},n={scene:i.scene,data_type:i.data_type};return this.request({url:s,method:"POST",data:n},t)}RefreshFileURL(e,t){const s=this.genBaseURL("/alice/upload/refresh_file_url"),i={url:(e||{}).url};return this.request({url:s,method:"POST",data:i},t)}},setting:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SettingApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}Launch(e,t){const s=this.genBaseURL("/alice/user/launch"),i=e||{},n={ug_landing_tag:i.ug_landing_tag,select:i.select};return this.request({url:s,method:"POST",data:n},t)}GetFeedbackList(e,t){const s=this.genBaseURL("/alice/user/feedback_list"),i=e||{},n={iid:i.iid,appkey:i.appkey,min_id:i.min_id,max_id:i.max_id,count:i.count};return this.request({url:s,method:"POST",data:n},t)}GetTabbarConfig(e,t){const s=this.genBaseURL("/alice/user/tabbar/config");return this.request({url:s,method:"POST"},t)}OpAdvanceSwitch(e,t){const s=this.genBaseURL("/alice/user/op_advance"),i={op_type:(e||{}).op_type};return this.request({url:s,method:"POST",data:i},t)}GetVoiceConfig(e,t){const s=this.genBaseURL("/alice/user/voice_config");return this.request({url:s,method:"POST"},t)}GetDowngradeConfig(e,t){const s=this.genBaseURL("/alice/user/downgrade_config");return this.request({url:s,method:"POST"},t)}},seo:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SeoApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetDemo(e,t){const s=this.genBaseURL("/seo_api/demo"),i={pageId:(e||{}).pageId};return this.request({url:s,method:"GET",params:i},t)}GetItem(e,t){const s=this.genBaseURL("/seo_api/item/get"),i={id:(e||{}).id};return this.request({url:s,method:"GET",params:i},t)}GetList(e,t){const s=this.genBaseURL("/seo_api/item/list"),i=e||{},n={page_size:i.page_size,page_num:i.page_num,type:i.type};return this.request({url:s,method:"GET",params:n},t)}GetRecommendList(e,t){const s=this.genBaseURL("/seo_api/item/recommend"),i=e||{},n={page_size:i.page_size,page_num:i.page_num,recommend_type:i.recommend_type,type:i.type};return this.request({url:s,method:"GET",params:n},t)}GetUgcTalkSeoInfo(e,t){const s=this.genBaseURL("/seo_api/ugc/talk"),i={share_id:(e||{}).share_id};return this.request({url:s,method:"GET",params:i},t)}GetArticleFeed(e,t){const s=this.genBaseURL("/seo_api/article/feed"),i=e||{},n={id:i.id,count:i.count};return this.request({url:s,method:"GET",params:n},t)}SetBlockRecord(e,t){const s=this.genBaseURL("/seo_api/req/block/add"),i=e||{},n={tea_uid:i.tea_uid,tea_uuid:i.tea_uuid,current_url:i.current_url,block_url:i.block_url};return this.request({url:s,method:"GET",params:n},t)}},samanthaChat:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("SamanthaChatApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}Completion(e,t){const s=this.genBaseURL("/samantha/chat/completion"),i=e||{},n={messages:i.messages,completion_option:i.completion_option,conversation_id:i.conversation_id,local_message_id:i.local_message_id,local_conversation_id:i.local_conversation_id,reply_id:i.reply_id};return this.request({url:s,method:"POST",data:n},t)}},account:class{constructor(e){(0,a.A)(this,"request",(()=>{throw new Error("AccountApiService.request is undefined")})),(0,a.A)(this,"baseURL",""),this.request=(null==e?void 0:e.request)||this.request,this.baseURL=(null==e?void 0:e.baseURL)||""}genBaseURL(e){return"string"==typeof this.baseURL?this.baseURL+e:this.baseURL(e)}GetTabbarConfig(e,t){const s=this.genBaseURL("/alice/user/tabbar/config");return this.request({url:s,method:"POST"},t)}InnerSSOTokenVerify(e,t){const s=this.genBaseURL("/alice/user/inner_sso_token_verify");return this.request({url:s,method:"POST"},t)}DeleteBlocklistUser(e,t){const s=this.genBaseURL("/alice/user/blocklist/delete"),i={blocklist_user_id:(e||{}).blocklist_user_id};return this.request({url:s,method:"POST",data:i},t)}ActHeartbeat(e,t){const s=this.genBaseURL("/alice/user/act_heartbeat");return this.request({url:s,method:"POST"},t)}Dynamic(e,t){const s=this.genBaseURL("/alice/user/dynamic"),i={key_list:(e||{}).key_list};return this.request({url:s,method:"POST",data:i},t)}GetWebAnonID(e,t){const s=this.genBaseURL("/alice/user/get_web_anon_id");return this.request({url:s,method:"POST"},t)}CreateBlocklistUser(e,t){const s=this.genBaseURL("/alice/user/blocklist/create"),i={blocklist_user_id:(e||{}).blocklist_user_id};return this.request({url:s,method:"POST",data:i},t)}GetFeedbackList(e,t){const s=this.genBaseURL("/alice/user/feedback_list"),i=e||{},n={iid:i.iid,appkey:i.appkey,min_id:i.min_id,max_id:i.max_id,count:i.count};return this.request({url:s,method:"POST",data:n},t)}SyncUserConfig(e,t){const s=this.genBaseURL("/alice/user/config/sync"),i={configs:(e||{}).configs};return this.request({url:s,method:"POST",data:i},t)}AuthSuccessReport(e,t){const s=this.genBaseURL("/alice/user/auth_success_report"),i=e||{},n={push_open:i.push_open,scene:i.scene,no_disappear:i.no_disappear,suggest_items:i.suggest_items};return this.request({url:s,method:"POST",data:n},t)}GetAccountInfo(e,t){const s=this.genBaseURL("/alice/user/get_account_info");return this.request({url:s,method:"POST"},t)}PullUserConfig(e,t){const s=this.genBaseURL("/alice/user/config/pull"),i=e||{},n={objects:i.objects,reason:i.reason};return this.request({url:s,method:"POST",data:n},t)}GetUserOgfQuota(e,t){const s=this.genBaseURL("/alice/user/get_user_ogf_quota");return this.request({url:s,method:"POST"},t)}InnerSSOToken(e,t){const s=this.genBaseURL("/alice/user/inner_sso_token");return this.request({url:s,method:"ANY"},t)}Launch(e,t){const s=this.genBaseURL("/alice/user/launch"),i=e||{},n={ug_landing_tag:i.ug_landing_tag,select:i.select};return this.request({url:s,method:"POST",data:n},t)}BanAppeal(e,t){const s=this.genBaseURL("/alice/user/ban_appeal"),i={user_id:(e||{}).user_id};return this.request({url:s,method:"POST",data:i},t)}GetUserBlocklist(e,t){const s=this.genBaseURL("/alice/user/blocklist/list"),i=e||{},n={index:i.index,limit:i.limit};return this.request({url:s,method:"POST",data:n},t)}OpAdvanceSwitch(e,t){const s=this.genBaseURL("/alice/user/op_advance"),i={op_type:(e||{}).op_type};return this.request({url:s,method:"POST",data:i},t)}SilentAuth(e,t){const s=this.genBaseURL("/alice/user/aweme_silent_auth"),i=e||{},n={code:i.code,old_access_token:i.old_access_token,old_open_id:i.old_open_id};return this.request({url:s,method:"POST",data:n},t)}}}),(0,a.A)(c,"classMap",{}),(0,a.A)(c,"classConstructorOptionsMap",{}),(0,a.A)(c,"instanceMap",{})},82506:(e,t,s)=>{s.d(t,{P:()=>o,g:()=>r});var i=s(10633),n=s(60588);class a{constructor(){(0,i.A)(this,"eventEmitter",new n.A),(0,i.A)(this,"started",!0),(0,i.A)(this,"buffer",[])}emit(e,...t){this.started?this.eventEmitter.emit(e,...t):this.buffer.push({event:e,args:t})}on(e,t){this.eventEmitter.on(e,t)}off(e,t){this.eventEmitter.off(e,t)}start(){if(!this.started){this.started=!0;for(const{event:e,args:t}of this.buffer)this.emit(e,...t)}}stop(){this.started=!1}clear(){this.buffer=[]}}var o={UNAUTHORIZED:"unauthorized",NOACCESS:"noAccess",SHARK_BLOCK:"sharkBlocked",COUNTRY_RESTRICTED:"countryRestricted",CONVERSATION_INVALID:"conversationInvalid",NEED_TO_WAIT:"needToWait",USER_BANNED:"userBanned",USER_BANNED_OTHER:"userBannedOther",USER_BAN_RELEASE:"userBanRelease",NETWORK_ERROR:"networkError"};const r=new a},32727:(e,t,s)=>{s.d(t,{r:()=>m});var i=s(44557),n=s(14065),a=s(33451),o=s(28159),r=s(41967),l=s(11855),c=s(29019),d=s.n(c),u=s(63159);const h=e=>(0,u.jsxs)("svg",(0,i.A)((0,i.A)({xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",viewBox:"0 0 17 17"},e),{},{children:[(0,u.jsx)("g",{clipPath:"url(#white-loading_svg__a)",children:(0,u.jsx)("path",{stroke:"url(#white-loading_svg__b)",strokeLinecap:"round",strokeWidth:1.778,d:"M15.61 8.5A7.111 7.111 0 0 0 2.097 5.405"})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"white-loading_svg__b",x1:2.096,x2:15.611,y1:8.5,y2:8.5,gradientUnits:"userSpaceOnUse",children:[(0,u.jsx)("stop",{stopColor:"#fff",stopOpacity:0}),(0,u.jsx)("stop",{offset:.399,stopColor:"#fff",stopOpacity:.5}),(0,u.jsx)("stop",{offset:1,stopColor:"#fff"})]}),(0,u.jsx)("clipPath",{id:"white-loading_svg__a",children:(0,u.jsx)("path",{fill:"#fff",d:"M.5.5h16v16H.5z"})})]})]})),_=e=>(0,u.jsxs)("svg",(0,i.A)((0,i.A)({xmlns:"http://www.w3.org/2000/svg",width:17,height:17,fill:"none",viewBox:"0 0 17 17"},e),{},{children:[(0,u.jsx)("g",{clipPath:"url(#black-loading_svg__a)",children:(0,u.jsx)("path",{stroke:"url(#black-loading_svg__b)",strokeLinecap:"round",strokeWidth:1.778,d:"M15.61 8.5A7.111 7.111 0 0 0 2.097 5.405"})}),(0,u.jsxs)("defs",{children:[(0,u.jsxs)("linearGradient",{id:"black-loading_svg__b",x1:2.096,x2:15.611,y1:8.5,y2:8.5,gradientUnits:"userSpaceOnUse",children:[(0,u.jsx)("stop",{stopOpacity:0}),(0,u.jsx)("stop",{offset:.399,stopOpacity:.5}),(0,u.jsx)("stop",{offset:1})]}),(0,u.jsx)("clipPath",{id:"black-loading_svg__a",children:(0,u.jsx)("path",{fill:"#000",d:"M.5.5h16v16H.5z"})})]})]})),g={button:"button-YIMk8y",clickable:"clickable-LJsrmr","type-primary":"type-primary-qG4wRn",typePrimary:"type-primary-qG4wRn","type-dashed":"type-dashed-HdUCt6",typeDashed:"type-dashed-HdUCt6","type-danger":"type-danger-ffMO7U",typeDanger:"type-danger-ffMO7U",disabled:"disabled-j3ucAu","width-fit":"width-fit-V3Wkl4",widthFit:"width-fit-V3Wkl4","width-full":"width-full-DHUGO3",widthFull:"width-full-DHUGO3",loading:"loading-kzj8pB",rotate:"rotate-epwdFQ",rotation:"rotation-uKQGyL"},p=["disabled","loading","width","type","onClick","onDisableClick","onLoadingClick","icon","className","style","children"],m=e=>{let{disabled:t=!1,loading:s=!1,width:c="full",type:m="primary",onClick:f,onDisableClick:v,onLoadingClick:y,icon:b,className:S,style:A,children:k}=e,w=(0,a.A)(e,p);const[E,R]=(0,l.useState)(!1),[T,M]=(0,l.useState)(!1),z=E||s,C=T||t,x={setDisabled:M,setLoading:R},L=function(){var e=(0,n.A)((function*(){if(z)return void(null==y||y(x));if(C)return void(null==v||v(x));const e=null==f?void 0:f(x);if(e){R(!0);try{yield e}finally{R(!1)}}}));return function(){return e.apply(this,arguments)}}();return(0,u.jsxs)("div",(0,i.A)((0,i.A)({className:d()(g.button,S,g[`type-${m}`],(0,o.A)(c)?g[`width-${c}`]:void 0,{[g.disabled]:C,[g.clickable]:Boolean(f)&&(Boolean(y)||!s)&&!t}),style:(0,i.A)((0,i.A)({},A),{},{width:(0,r.A)(c)?c:void 0}),onClick:L,"data-disabled":t},w),{},{children:[z?"dashed"===m?(0,u.jsx)(_,{className:d()(g.loading,g.rotate)}):(0,u.jsx)(h,{className:d()(g.loading,g.rotate)}):b,k]}))}},32393:(e,t,s)=>{s.d(t,{Qo:()=>n});var i=s(11855);const n=()=>!1;(0,i.createContext)(null).Provider},52071:(e,t,s)=>{s.d(t,{a:()=>l});var i=s(11855),n=s(32985),a=s(16479),o=s(63159);window.ResizeObserver||(window.ResizeObserver=n.tb);const r={offsetHeight:0,offsetWidth:0,height:0,width:0},l=({children:e,onResize:t})=>{const s=(0,i.useRef)(null),l=(0,i.useRef)(null),c=(0,a.A)(t),d=(0,i.useRef)();return(0,i.useLayoutEffect)((()=>{const e=new n.tb((e=>{var t;const i=e.find((e=>e.target===s.current));if(!i)return;const{offsetWidth:n,offsetHeight:a}=i.target,{contentRect:{width:o,height:r},target:u}=i,h={width:o,height:r,offsetWidth:n,offsetHeight:a};null===(t=c.current)||void 0===t||t.call(c,{current:h,previous:d.current,target:u,targetStandBy:l.current}),d.current=h}));return s.current&&e.observe(s.current),()=>{var t;s.current&&(null===(t=c.current)||void 0===t||t.call(c,{current:r,previous:d.current,target:s.current,targetStandBy:l.current}));e.disconnect()}}),[]),(0,o.jsx)(o.Fragment,{children:e(s,l)})}},25227:(e,t,s)=>{s.d(t,{B:()=>z});var i=s(96770),n=s(6693),a=s(11855),o=s(29019),r=s.n(o);let l=function(e){return e.Top="top",e.Bottom="bottom",e.Inner="inner",e}({});var c=s(14065),d=s(44557),u=s(39415);const h="scroll-view-VuVgIp",_="before-ZSZMHg",g="after-nYhsA1",p="content-NfeEi5",m="scrollable-xAHiOl",f="reverse-fWD12d",v="disable-scroll-DBbH6v",y="show-scrollbar-H13q3P",b="auto-show-scrollbar-yUgdkB",S="children-wrapper-tALoJZ",A=(()=>{const e=(0,u.Z5)();if(!e)return!0;const{major:t}=e;return t>=83})(),k=({reverse:e,scrollStatusRef:t,onBeforeScroll:s,onAfterScroll:i})=>{const n=(0,a.useRef)(null),o=(0,a.useRef)(!1),r=()=>{const{current:e}=n;if(!e)throw Error("Not found ScrollView ref instance");return e},h=()=>{const t=r();return e&&!A?t.scrollTop-(t.scrollHeight-t.offsetHeight):t.scrollTop},_=(t,n)=>{const a=r(),o=(t=>{const s=r(),i=t;if((0,u.F_)()){if(e){const e=s.offsetHeight-s.scrollHeight+1;return Math.max(i,e)}{const e=s.scrollHeight-s.offsetHeight-1;return Math.min(i,e)}}return i})(e&&!A?t+(a.scrollHeight-a.offsetHeight):t);null==s||s(),n?a.scrollTo((0,d.A)({top:o},n)):a.scrollTop=o,null==i||i()},g=(t,s)=>{if(!o.current)return _((t=>{const s=r();return e?t-(s.scrollHeight-s.offsetHeight):t})(t),s),new Promise((e=>{requestAnimationFrame((()=>{e()}))}))},p=function(){var e=(0,c.A)((function*(){yield g(0)}));return function(){return e.apply(this,arguments)}}(),m=function(){var t=(0,c.A)((function*(t={}){const{smooth:s=!1}=t,{scrollHeight:i,offsetHeight:n}=r();yield g((t=>{const s=r();return e?s.scrollHeight-s.offsetHeight+t:t})(i-n),{behavior:s?"smooth":void 0})}));return function(){return t.apply(this,arguments)}}(),f=()=>{const{current:t}=n;if(!t)return 0;const{scrollHeight:s,offsetHeight:i}=t,a=h();return e?s-(i+-a):a},y=()=>{const{current:e}=n;return e?e.scrollHeight-f()-e.offsetHeight:0};return(0,a.useEffect)((()=>{var e,t;null===(e=n.current)||void 0===e||e.addEventListener("touchstart",(()=>{o.current=!0})),null===(t=n.current)||void 0===t||t.addEventListener("touchend",(()=>{o.current=!1}))}),[]),{ref:n,controller:{scrollTo:g,scrollToTop:p,scrollToBottom:m,getScrollTop:f,getScrollBottom:y,refreshAnchor:()=>{(null==t?void 0:t.current)===l.Top?p():(null==t?void 0:t.current)===l.Bottom&&m()},disableScroll:e=>{var t;o.current=!0,null===(t=n.current)||void 0===t||t.classList.add(e||v),_(h()-1)},enableScroll:e=>{var t;o.current=!1,null===(t=n.current)||void 0===t||t.classList.remove(e||v)},isNearBottom:e=>y()<=e}}};var w=s(34774),E=s(80385),R=s(73460),T=s(52071),M=s(63159);const z=(0,a.forwardRef)((function({style:e,className:t,children:s,scrollableClassName:o,childrenWrapperClassName:c,before:d,after:u,innerBefore:v,reverse:A=!1,reachTopThreshold:z,onReachTop:C,onLeaveTop:x,reachBottomThreshold:L,onReachBottom:U,onLeaveBottom:B,showScrollbar:I,autoShowScrollbar:O,onScroll:P,bottomAttaching:q=!1},G){const D=A?l.Bottom:l.Top,N=(0,a.useRef)(D),j=(0,a.useRef)(!1),{ref:F,controller:V}=k({reverse:A,scrollStatusRef:N,onBeforeScroll:()=>{j.current=!0}}),{getScrollTop:H,getScrollBottom:K}=V,W=(0,a.useRef)(!1),J=(0,a.useRef)(!1),{onScroll:Q}=(0,E.o)({onVisibleChange:e=>{F.current&&(e?F.current.classList.add(w.A["show-scrollbar-thumb"]):F.current.classList.remove(w.A["show-scrollbar-thumb"]))}});(0,a.useImperativeHandle)(G,(()=>V),[V]);const Y=(0,a.useMemo)((()=>(0,n.A)((e=>{N.current=e}),100)),[]),{handleResize:X}=(({enable:e=!0,controller:t})=>({handleResize:({current:{offsetHeight:s},previous:i})=>{if(!e)return;const n=t.getScrollBottom(),{offsetHeight:a}=null!=i?i:{};a&&(n>=s-a+10||t.scrollToBottom())}}))({controller:V,enable:!A&&q});return(0,M.jsx)(R.a,{containerRef:F,controller:V,children:(0,M.jsxs)("div",{className:r()(h,t),style:e,children:[d&&(0,M.jsx)("div",{className:r()(_),children:(0,i.A)(d)?null==d?void 0:d(V):d}),(0,M.jsx)("div",{className:r()(p),children:(0,M.jsxs)("div",{ref:F,className:r()(m,o,{[f]:A,[y]:I,[b]:O}),onScroll:e=>{const t=j.current;if(j.current=!1,!e.currentTarget)return;null==P||P(e);const{offsetHeight:s}=e.currentTarget,i=null!=z?z:s,n=null!=L?L:s;H()<i?W.current||(W.current=!0,null==C||C()):W.current&&(W.current=!1,null==x||x()),K()<n?J.current||(J.current=!0,null==U||U()):J.current&&(J.current=!1,null==B||B()),N.current=l.Inner,H()<=0&&K()<=0?Y(D):H()<=0?Y(l.Top):K()<=0?Y(l.Bottom):Y(l.Inner),t||Q()},children:[(()=>{const e=(0,i.A)(s)?s(V):s;return A?e:(0,M.jsx)(T.a,{onResize:X,children:t=>(0,M.jsx)("div",{ref:t,className:r()(S,"children-wrapper",c),children:e})})})(),v&&(0,M.jsx)("div",{className:r()(_),children:(0,i.A)(v)?null==v?void 0:v(V):v})]})}),u&&(0,M.jsx)("div",{className:r()(g),children:(0,i.A)(u)?null==u?void 0:u(V):u})]})})}))},73460:(e,t,s)=>{s.d(t,{a:()=>l});var i=s(44557),n=s(11855),a=s(41354),o=s(63159);const r=(0,n.createContext)(null),l=({containerRef:e,controller:t,children:s})=>{const{width:n,height:l}=(0,a.w)({ref:e});return(0,o.jsx)(r.Provider,{value:(0,i.A)({ref:e,width:n,height:l},t),children:s})}},77835:(e,t,s)=>{s.d(t,{p:()=>g});var i=s(44557),n=s(33451),a=s(11855),o=s(29019),r=s.n(o),l=s(34944),c=s(32393),d=s(77809);const u={container:"container-AilALM","hide-scrollbar":"hide-scrollbar-r3YpM5",hideScrollbar:"hide-scrollbar-r3YpM5","custom-scrollbar":"custom-scrollbar-xZDNG1",customScrollbar:"custom-scrollbar-xZDNG1",flow:"flow-xs54Ev"};var h=s(63159);const _=["theme","customScrollbar","hideScrollBar"],g=(0,a.forwardRef)((function(e,t){var s;let{theme:o="flow",customScrollbar:g=!0,hideScrollBar:p=!1}=e,m=(0,n.A)(e,_);const{defaultValue:f,value:v,onChange:y,className:b,"data-testid":S,readOnly:A}=m,k=(0,c.Qo)(),[w,E]=(0,a.useState)(""),R=(0,d.r$)(null!==(s=null!=v?v:w)&&void 0!==s?s:f,!0);return(0,h.jsx)(l.fs,(0,i.A)((0,i.A)((0,i.A)({ref:t,dir:k?R:"ltr"},m),A?{readonly:!0,disabled:void 0}:{disabled:m.disabled}),{},{className:r()(u.container,u[o],b,{[u["custom-scrollbar"]]:g,[u["hide-scrollbar"]]:p}),onChange:(e,t)=>{E(e),null==y||y(e,t)},"data-testid":S}))}));(0,l.ZH)(g,{maintainCursor:!0})},38523:(e,t,s)=>{s.d(t,{e:()=>i});let i=function(e){return e.VideoSummary="VideoSummary",e.SearchResult="SearchResult",e.TextFragment="TextFragment",e.TranslateResult="TranslateResult",e.ExplainResult="ExplainResult",e.Image="Image",e.Web="Web",e.Pdf="pdf",e.SocialWebCard="SocialWebCard",e.PodcastSummary="PodcastSummary",e.Pages="Pages",e.Thread="Thread",e.SelectedCollections="SelectedCollections",e.CustomSkillResult="CustomSkillResult",e}({})},77809:(e,t,s)=>{s.d(t,{r$:()=>l});var i=s(14065),n=s(11855),a=(s(22933),s(15957));const o=["ae","aeb","ajt","apc","apd","ar","ara","arb","arc","arq","ars","ary","arz","ave","avl","bal","bcc","bej","bft","bgn","bqi","brh","cja","ckb","cld","dcc","dgl","div","drw","dv","fa","fas","fia","fub","gbz","gjk","gju","glk","grc","gwc","gwt","haz","he","heb","hnd","hno","iw","ji","kas","kby","khw","ks","kvx","kxp","kzh","lad","lah","lki","lrc","luz","mde","mfa","mki","mvy","myz","mzn","nqo","oru","ota","otk","oui","pal","pbu","per","pes","phl","phn","pnb","pra","prd","prs","ps","pus","rhg","rmt","scl","sd","sdh","shu","skr","smp","snd","sog","swb","syr","tnf","trw","ug","uig","ur","urd","wni","xco","xld","xmn","xmr","xna","xpr","xsa","ydd","yi","yid","zdj"],r=function(){var e=(0,i.A)((function*(e,t=!1){try{const n=e.trim();if(!n)return t;const{franc:r}=yield(0,a.ts)((()=>Promise.resolve().then(s.bind(s,6683)))),l=r(n,{minLength:20});return"und"===l?(i=n.charAt(0),new RegExp("^[^A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02b8\u0300-\u0590\u0800-\u1fff\u2c00-\ufb1c\ufdfe-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]").test(i)):o.includes(l)}catch(n){return t}var i}));return function(t){return e.apply(this,arguments)}}(),l=(e,t=!1)=>{const[s,a]=(0,n.useState)("ltr");return(0,n.useEffect)((()=>{(0,i.A)((function*(){const s=yield r(e,t);a(s?"rtl":"ltr")}))()}),[e,t]),s}},16100:(e,t,s)=>{s.d(t,{XB:()=>c});var i=s(33451),n=s(44557),a=s(54096),o=s(37357);const r=["logger"],l=({eventName:e,logger:t=o.v,meta:s,once:i=!1})=>{const r=t,l=[];let c=0,d=!1;const u=()=>{c=Date.now(),r.persist.info({eventName:`${e}_start`,meta:(0,n.A)({},h())})},h=()=>(0,n.A)((0,n.A)({},s),d?{event_has_finished:!0}:{}),_=()=>{if(0!==l.length)return l.reduce(((e,t,s)=>{const{pointName:i}=t;return e[i]=t.time-c,(0,a.A)(e,["interval",i],0===s?e[i]:t.time-l[s-1].time),e}),{})},g=({meta:t}={})=>{i&&d||(r.persist.success({eventName:e,meta:(0,n.A)((0,n.A)({},h()),{},{success:1,duration:_()},t)}),d=!0)};let p;const m=({reason:t,error:s,meta:a})=>{i&&d||(r.persist.error({eventName:e,error:s||new Error(t),meta:(0,n.A)((0,n.A)({},h()),{},{success:0,reason:t,duration:_()},a)}),d=!0)};return u(),{name:"ReportEvent",start:u,cancel:()=>{clearTimeout(p),d=!0},success:g,successIfIdle:(e,t,s)=>{clearTimeout(p),p=setTimeout((()=>d?void 0:(g(t),null==s?void 0:s())),e)},error:m,errorIfIdle:(e,t,s)=>{clearTimeout(p),p=setTimeout((()=>d?void 0:(m(t),null==s?void 0:s())),e)},addDurationPoint:(e,t=!0,s)=>{const i=l.find((t=>t.pointName===e));i?(t&&(i.time=Date.now()),s&&(i.time=s)):l.push({pointName:e,time:s||Date.now()}),l.sort(((e,t)=>e.time-t.time))},getDuration:_,getDurationTimestamp:()=>{if(0!==l.length)return l.reduce(((e,t)=>{const{pointName:s}=t;return e[s]=t.time,e}),{})},reportDurationPoint:(t,s=!0)=>{const i=l.find((e=>e.pointName===t));s&&null!=i&&i.reported||(r.persist.info({eventName:`${e}_duration_${t}`,meta:(0,n.A)({},h())}),i&&(i.reported=!0))},getMeta:h,updateMeta:e=>{s=(0,n.A)((0,n.A)({},s),e)},getFinishStatus:()=>d,setStartTime:e=>{c=e}}},c=e=>{let{logger:t=o.v}=e,s=(0,i.A)(e,r);return l((0,n.A)({logger:t},s))}},97946:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M12 15.64q-.39 0-.71-.312L5.343 9.242a.9.9 0 0 1-.203-.281 1 1 0 0 1-.063-.352q0-.257.117-.468a.9.9 0 0 1 .328-.328.86.86 0 0 1 .461-.125.9.9 0 0 1 .657.28l5.742 5.884h-.758l5.734-5.883a.9.9 0 0 1 .657-.282q.258 0 .46.125a.84.84 0 0 1 .32.329q.126.21.126.468a.86.86 0 0 1-.266.633l-5.945 6.086a.95.95 0 0 1-.71.313"})})),r=(0,i.a)((0,a.jsx)(o,{}))},27658:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M17.008 11.996q0 .203-.078.375t-.235.328l-6.086 5.953a.86.86 0 0 1-.64.266.9.9 0 0 1-.461-.125.9.9 0 0 1-.336-.328.925.925 0 0 1 .164-1.117l5.484-5.352-5.484-5.351a.92.92 0 0 1-.281-.657q0-.258.117-.46a.9.9 0 0 1 .336-.321.9.9 0 0 1 .46-.125.87.87 0 0 1 .641.258l6.086 5.953q.156.157.235.328.078.173.078.375"})})),r=(0,i.a)((0,a.jsx)(o,{}))},20309:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"m5.344 14.508 5.945-6.086a.95.95 0 0 1 .711-.32 1 1 0 0 1 .383.093q.18.078.328.227l5.945 6.086a.86.86 0 0 1 .266.64.86.86 0 0 1-.125.461.9.9 0 0 1-.32.329.86.86 0 0 1-.461.124.87.87 0 0 1-.657-.28l-5.734-5.876h.758L6.64 15.781a.85.85 0 0 1-.657.281.86.86 0 0 1-.46-.125 1 1 0 0 1-.329-.328.9.9 0 0 1-.117-.46q0-.189.063-.352a.9.9 0 0 1 .203-.29"})})),r=(0,i.a)((0,a.jsx)(o,{}))},26457:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M11.145 15.626c.46.499 1.25.499 1.71 0l4.294-4.648a.582.582 0 0 0-.428-.978H7.28a.582.582 0 0 0-.428.978z"})})),r=(0,i.a)((0,a.jsx)(o,{}))},59980:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M11.996 20.5a8.2 8.2 0 0 1-3.282-.666A8.6 8.6 0 0 1 6 17.999a8.8 8.8 0 0 1-1.834-2.716A8.2 8.2 0 0 1 3.5 12q0-1.744.666-3.283a8.711 8.711 0 0 1 4.54-4.55 8.2 8.2 0 0 1 3.282-.667q1.752 0 3.29.667A8.7 8.7 0 0 1 17.99 6.01a8.6 8.6 0 0 1 1.843 2.707A8.2 8.2 0 0 1 20.5 12a8.2 8.2 0 0 1-.666 3.283 8.7 8.7 0 0 1-4.556 4.55 8.2 8.2 0 0 1-3.282.667m-2.698-5.02a.81.81 0 0 0 .576-.222l2.13-2.147 2.139 2.147a.76.76 0 0 0 .559.223q.33 0 .55-.223a.75.75 0 0 0 .231-.55.72.72 0 0 0-.23-.552l-2.147-2.148 2.155-2.147a.77.77 0 0 0 .23-.552.73.73 0 0 0-.23-.543.73.73 0 0 0-.543-.23.75.75 0 0 0-.55.23l-2.164 2.148L9.85 8.766a.78.78 0 0 0-.55-.214.77.77 0 0 0-.552.222.73.73 0 0 0-.222.552q0 .305.23.543l2.147 2.14-2.147 2.155a.73.73 0 0 0-.23.543q0 .321.222.551a.77.77 0 0 0 .551.223"})})),r=(0,i.a)((0,a.jsx)(o,{}))},86012:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M10.663 18.777q-.562 0-.961-.5l-4.047-5.062a1.4 1.4 0 0 1-.219-.352 1 1 0 0 1-.062-.351.9.9 0 0 1 .265-.672.95.95 0 0 1 .688-.266q.477 0 .805.43l3.5 4.492 6.78-10.773q.18-.274.368-.383a.9.9 0 0 1 .484-.117q.407 0 .665.257.257.25.257.657 0 .164-.054.336-.055.163-.172.351L11.616 18.27a1.09 1.09 0 0 1-.953.507"})})),r=(0,i.a)((0,a.jsx)(o,{}))},43684:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M5 12q0-.386.276-.66a.89.89 0 0 1 .66-.285h5.127V5.937q0-.385.276-.661A.9.9 0 0 1 12 5q.393 0 .67.276a.9.9 0 0 1 .275.66v5.119h5.118q.385 0 .661.284A.9.9 0 0 1 19 12a.91.91 0 0 1-.276.67.92.92 0 0 1-.66.267h-5.119v5.135q0 .376-.276.652A.9.9 0 0 1 12 19a.9.9 0 0 1-.66-.276.9.9 0 0 1-.277-.652v-5.135H5.937a.92.92 0 0 1-.661-.268A.9.9 0 0 1 5 12"})})),r=(0,i.a)((0,a.jsx)(o,{}))},32138:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 20 20"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",fillRule:"evenodd",d:"M13.193 8.217q.09.08.207.08a.3.3 0 0 0 .21-.08.33.33 0 0 0 .108-.204 9 9 0 0 1 .152-.804q.081-.325.207-.535a1 1 0 0 1 .33-.334q.208-.125.523-.195.315-.075.773-.127A.317.317 0 0 0 16 5.696q0-.12-.083-.21a.35.35 0 0 0-.21-.11 9 9 0 0 1-.77-.14 1.8 1.8 0 0 1-.51-.198 1 1 0 0 1-.328-.328 2 2 0 0 1-.214-.525 11 11 0 0 1-.167-.8.33.33 0 0 0-.11-.205.3.3 0 0 0-.208-.08q-.12 0-.21.08a.33.33 0 0 0-.105.204 9 9 0 0 1-.152.804 1.9 1.9 0 0 1-.21.535q-.127.207-.331.334-.204.123-.52.195-.315.07-.775.123a.33.33 0 0 0-.21.108.3.3 0 0 0-.084.214q0 .123.08.213.084.09.21.108.461.069.77.143.313.074.514.197a1 1 0 0 1 .324.328q.128.204.213.526.087.324.17.8.022.124.109.205M11.74 7.008q.088.054.166.117l-1.65 2.357.34.485 1.302 1.86a2.452 2.452 0 1 1-.939.632l-1.29-1.843-.104-.147-.105.15-1.29 1.842a2.452 2.452 0 1 1-.939-.632l1.303-1.86.34-.487-3.043-4.346a.566.566 0 0 1 .927-.65l2.807 4.01 1.28-1.826.046.011q.517.122.85.327m-.28 6.886a1.32 1.32 0 1 1 2.6.458 1.32 1.32 0 0 1-2.6-.458m-3.791.002a1.32 1.32 0 1 0-2.6.458 1.32 1.32 0 0 0 2.6-.458",clipRule:"evenodd"})})),r=(0,i.a)((0,a.jsx)(o,{}))},68692:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M11.21 20.836q-.483 0-.843-.273a1.27 1.27 0 0 1-.46-.743l-.321-1.383-.211-.07-1.195.735q-.407.256-.86.195a1.32 1.32 0 0 1-.789-.399l-1.093-1.085a1.34 1.34 0 0 1-.407-.797q-.054-.446.203-.852l.75-1.195-.07-.196-1.383-.32a1.29 1.29 0 0 1-1.015-1.305V11.61a1.31 1.31 0 0 1 1.015-1.304l1.367-.328.079-.211-.75-1.196a1.24 1.24 0 0 1-.204-.843 1.34 1.34 0 0 1 .407-.797l1.093-1.094q.345-.344.79-.399.444-.062.851.188l1.203.742.219-.086.32-1.383a1.27 1.27 0 0 1 .461-.734q.36-.28.844-.281h1.586a1.3 1.3 0 0 1 1.297 1.015l.32 1.383.219.086 1.203-.742q.406-.251.851-.187.454.054.79.398L18.57 6.93q.344.351.399.797.062.445-.196.843l-.75 1.196.086.21 1.36.329q.46.11.734.468.282.36.281.836v1.54a1.32 1.32 0 0 1-1.015 1.304l-1.375.32-.078.196.75 1.195q.258.406.195.852-.056.445-.398.797l-1.094 1.085a1.33 1.33 0 0 1-.797.399 1.23 1.23 0 0 1-.852-.195l-1.203-.735-.203.07-.32 1.383q-.11.47-.461.742a1.32 1.32 0 0 1-.836.274zm.196-1.414h1.196q.188 0 .21-.18l.47-1.922q.39-.086.726-.226.336-.15.625-.328l1.68 1.03q.148.103.289-.03l.828-.836q.124-.11.023-.282l-1.031-1.671q.164-.282.305-.625.149-.345.234-.711l1.93-.461q.18-.031.18-.22v-1.17q0-.18-.18-.22l-1.922-.46a4.3 4.3 0 0 0-.25-.743 6 6 0 0 0-.29-.601l1.032-1.68q.11-.164-.023-.297l-.829-.812q-.132-.126-.297-.04l-1.68 1.024A6 6 0 0 0 14 7.656a4.3 4.3 0 0 0-.719-.242l-.469-1.937q-.023-.18-.21-.18h-1.196q-.196 0-.226.18l-.453 1.921q-.375.094-.743.25-.36.15-.625.305L7.68 6.937a.23.23 0 0 0-.288.032l-.836.82q-.125.133-.024.297l1.032 1.68a10 10 0 0 0-.29.601 4 4 0 0 0-.242.742l-1.922.461q-.18.04-.18.22v1.17q0 .189.18.22l1.922.453q.094.375.242.719.15.335.305.625l-1.039 1.68q-.094.163.024.28l.835.829q.141.132.282.039l1.687-1.04q.29.18.633.329.351.14.719.226l.46 1.922q.032.18.227.18M12 15.328q-.813 0-1.492-.398a3.14 3.14 0 0 1-1.078-1.078 2.87 2.87 0 0 1-.399-1.493q0-.812.399-1.484.406-.672 1.078-1.07.68-.399 1.492-.399a2.87 2.87 0 0 1 1.492.399 3 3 0 0 1 1.07 1.07q.399.672.399 1.484 0 .813-.399 1.493a3 3 0 0 1-1.07 1.078 2.87 2.87 0 0 1-1.492.398m0-1.344q.438 0 .805-.218a1.66 1.66 0 0 0 .578-.594q.219-.367.219-.813t-.22-.804a1.6 1.6 0 0 0-2.194-.586 1.66 1.66 0 0 0-.586.586q-.22.36-.22.804 0 .454.22.82.217.367.585.587.367.219.813.218"})})),r=(0,i.a)((0,a.jsx)(o,{}))},30020:(e,t,s)=>{s.d(t,{A:()=>r});s(11855);var i=s(18935),n=s(44557),a=s(63159);const o=e=>(0,a.jsx)("svg",(0,n.A)((0,n.A)({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24"},e),{},{children:(0,a.jsx)("path",{fill:"currentColor",d:"M13.7 20.331a.87.87 0 0 1-.596-.231 1 1 0 0 1-.311-.587q-.24-1.369-.49-2.303-.249-.924-.613-1.511a2.8 2.8 0 0 0-.933-.943q-.579-.355-1.476-.569a26 26 0 0 0-2.214-.409 1 1 0 0 1-.605-.31.9.9 0 0 1-.231-.614.87.87 0 0 1 .24-.614.94.94 0 0 1 .605-.31q1.325-.152 2.231-.357.907-.204 1.494-.56a2.9 2.9 0 0 0 .951-.96q.374-.605.605-1.538.231-.942.436-2.312a.94.94 0 0 1 .302-.586.88.88 0 0 1 .604-.232q.348 0 .596.232a.96.96 0 0 1 .32.586q.24 1.369.48 2.303.248.925.614 1.511.364.588.942.943.579.356 1.467.569.898.213 2.214.4.373.063.605.32.24.258.24.605a.91.91 0 0 1-.854.924q-1.315.152-2.223.365-.906.204-1.502.56a2.8 2.8 0 0 0-.951.96q-.366.605-.596 1.538-.232.944-.436 2.312a.95.95 0 0 1-.311.587.86.86 0 0 1-.605.231M7.12 9.684q-.444 0-.497-.462a16 16 0 0 0-.214-1.343q-.107-.489-.356-.738-.248-.259-.746-.382a14 14 0 0 0-1.387-.25q-.49-.07-.49-.497t.436-.498a20 20 0 0 0 1.423-.293q.516-.135.765-.374.248-.249.355-.72.106-.48.214-1.325.053-.471.497-.471.436 0 .498.453.107.89.214 1.387.115.498.364.747.249.24.756.356t1.405.24q.195.018.32.16a.5.5 0 0 1 .124.338q0 .418-.427.498-.915.15-1.43.293-.508.135-.757.383-.249.24-.355.72-.107.48-.214 1.333a.5.5 0 0 1-.498.445"})})),r=(0,i.a)((0,a.jsx)(o,{}))},92474:(e,t,s)=>{s.d(t,{c:()=>h});var i=s(44557),n=s(33451),a=s(11855),o=s(29019),r=s.n(o),l=s(34944);const c={"samantha-button":"samantha-button-pNbiYm",samanthaButton:"samantha-button-pNbiYm",primary:"primary-R41N0Q",secondary:"secondary-SZcW61",tertiary:"tertiary-i0ofUw",quartary:"quartary-oxqDvJ","ai-primary":"ai-primary-tZmdm_",aiPrimary:"ai-primary-tZmdm_","rotate-anim":"rotate-anim-kwxT3E",rotateAnim:"rotate-anim-kwxT3E","ai-secondary":"ai-secondary-Ia111P",aiSecondary:"ai-secondary-Ia111P","image-primary":"image-primary-IpwCvR",imagePrimary:"image-primary-IpwCvR","image-secondary":"image-secondary-Nv7jUE",imageSecondary:"image-secondary-Nv7jUE","image-tertiary":"image-tertiary-AJDpvJ",imageTertiary:"image-tertiary-AJDpvJ","image-quartary":"image-quartary-KjjOxJ",imageQuartary:"image-quartary-KjjOxJ",large:"large-K8zSnA","icon-only":"icon-only-OVkvZT",iconOnly:"icon-only-OVkvZT",icon:"icon-yU_9dw","icon-right":"icon-right-sFOZGh",iconRight:"icon-right-sFOZGh",medium:"medium-kAPPpg",small:"small-RwsXHR",logo:"logo-jfpKg9"};var d=s(63159);const u=["type","size","logo"],h=a.forwardRef((function(e,t){const{type:s="primary",size:a="medium",logo:o=!1}=e,h=(0,n.A)(e,u),{icon:_,iconPosition:g}=h,p=_||e.loading,m=_&&o;return(0,d.jsx)(l.$n,(0,i.A)((0,i.A)({ref:t},h),{},{theme:"solid",type:"primary",size:"default",className:r()(c["samantha-button"],c[s],c[a],{[c.icon]:p,[c["icon-right"]]:p&&"right"===g,[c["icon-only"]]:p&&!e.children,[c.logo]:m},h.className),children:e.children}))}))},13094:(e,t,s)=>{s.d(t,{y:()=>o});var i=s(34944),n=s(39415);const a="samantha-toast-container";if(n.M){if(!document.getElementById(a)){const e=document.createElement("div");e.id=a,document.body.appendChild(e)}}const o=i.EY.create({getPopupContainer:()=>n.M?document.getElementById(a):null})},3365:(e,t,s)=>{s.d(t,{cV:()=>n,sh:()=>i});let i=function(e){return e.IMAGE="image",e.OBJECT="object",e}({}),n=function(e){return e.FEEDBACK="feedback",e.BOT_CHAT="bot_chat",e}({})},82831:(e,t,s)=>{s.d(t,{A:()=>n});var i=s(11855);const n=function(e){const t=(0,i.useRef)();return t.current=(0,i.useMemo)((()=>e),[e]),(0,i.useCallback)(((...e)=>{const s=t.current;return null==s?void 0:s(...e)}),[t])}},41354:(e,t,s)=>{s.d(t,{w:()=>l});var i=s(49392),n=s(9388),a=s(11855),o=s(37517),r=s(32985);"undefined"==typeof window||window.ResizeObserver||(window.ResizeObserver=r.tb);const l=(e={})=>{const{ref:t,onlyBothNilIsFirstScreen:s=!0,onResize:r}=e,l=(0,a.useRef)(null),c=null!=t?t:l,[d,u]=(0,a.useState)(),[h,_]=(0,a.useState)();(0,a.useLayoutEffect)((()=>{g()}),[]),(0,a.useLayoutEffect)((()=>{(0,i.A)(d)||(0,i.A)(h)||null==r||r({width:d,height:h})}),[d,h]);const g=()=>{if(c.current){const{width:e,height:t}=c.current.getBoundingClientRect();u(e),_(t)}else u(void 0),_(void 0)},{width:p,height:m}=(0,o.A)({ref:c,onResize:e=>{null==r||r(e);const{width:t,height:s}=e;(0,n.flushSync)((()=>{u(null!=t?t:0),_(null!=s?s:0)}))}});(0,a.useLayoutEffect)((()=>{u(void 0)}),[p]),(0,a.useLayoutEffect)((()=>{_(void 0)}),[m]);const f=s&&(0,i.A)(p)&&(0,i.A)(m);return{ref:c,width:null!=d?d:f?void 0:null!=p?p:0,height:null!=h?h:f?void 0:null!=m?m:0,refresh:g}}},18590:(e,t,s)=>{s.d(t,{O:()=>n,e:()=>i});const i=e=>{try{return JSON.stringify(e)}catch(t){return""}},n=(e,t)=>{try{return e?JSON.parse(e):t}catch(s){return t}}},69902:(e,t,s)=>{s.d(t,{p:()=>a});var i=s(28159),n=s(9012);const a=e=>t=>{const s=(0,n.A)(t,e);return(0,i.A)(s)?s:""}},39791:(e,t,s)=>{s.d(t,{BK:()=>n});var i=s(49392);function n(e,t,s){return new Promise(((n,a)=>{setTimeout((()=>{s?a(new Error("Mock to reject.")):(0,i.A)(t)?n(void 0):n(t)}),e)}))}},13655:(e,t,s)=>{s.d(t,{A:()=>a});var i=s(21511),n=s(92431);const a={length(e){let t=0,s=0;for(let i=0;i<e.length;++i)s=e.charCodeAt(i),s<128?t+=1:s<2048?t+=2:55296==(64512&s)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},read(e,t,s){if(s-t<1)return"";let i="";for(let n=t;n<s;){const t=e[n++];if(t<=127)i+=String.fromCharCode(t);else if(t>=192&&t<224)i+=String.fromCharCode((31&t)<<6|63&e[n++]);else if(t>=224&&t<240)i+=String.fromCharCode((15&t)<<12|(63&e[n++])<<6|63&e[n++]);else if(t>=240){const s=((7&t)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;i+=String.fromCharCode(55296+(s>>10)),i+=String.fromCharCode(56320+(1023&s))}}return i},write(e,t,s){const i=s;let n,a;for(let o=0;o<e.length;++o)n=e.charCodeAt(o),n<128?t[s++]=n:n<2048?(t[s++]=n>>6|192,t[s++]=63&n|128):55296==(64512&n)&&56320==(64512&(a=e.charCodeAt(o+1)))?(n=65536+((1023&n)<<10)+(1023&a),++o,t[s++]=n>>18|240,t[s++]=n>>12&63|128,t[s++]=n>>6&63|128,t[s++]=63&n|128):(t[s++]=n>>12|224,t[s++]=n>>6&63|128,t[s++]=63&n|128);return s-i},posCalcRange(e,t){let s=0;const a={};let o=(0,n.A)(t);o=(0,i.A)(o.sort(((e,t)=>e-t)));for(let i=0;i<e.length&&(s===o[0]&&(a[o[0]]=i,o.shift()),55296==(64512&e[i].charCodeAt(0))&&56320==(64512&e[i+1].charCodeAt(0))?(s+=this.length(`${e[i]}${e[i+1]}`),i++):s+=this.length(e[i]),o.length);i++);return a},posCalc(e,t){let s="",i=0;for(let n=0;n<e.length;n++)if(s+=e[n],this.length(s)===t)return i=n+1,i;return i}}},16464:(e,t,s)=>{s.d(t,{A:()=>i});const i={area:"area-AdxVTy",info:"info-zicQ8s",link:"link-URSKaa",dropdown:"dropdown-fl_iip"}},68355:(e,t,s)=>{s.d(t,{O4:()=>i});const i=s(87729).C.makeEnum("event.ErrorCode",[{no:0,name:"Ok"},{no:710022008,name:"HighRiskPrompt"}])},95589:(e,t,s)=>{s.d(t,{Bx:()=>a});var i=s(87729),n=s(88300);const a=i.C.makeEnum("event.EventType",[{no:0,name:"Unknown"},{no:2001,name:"CMPL"},{no:2002,name:"ACK"},{no:2003,name:"FIN"},{no:2004,name:"CMD"},{no:2005,name:"ERR"}]),o=i.C.makeEnum("event.IMBoxChannel",[{no:0,name:"SSE"},{no:1,name:"IM"}]),r=i.C.makeMessageType("event.Option",(()=>[{no:1,name:"event_type",kind:"enum",T:i.C.getEnumType(a)},{no:2,name:"im_box_channel",kind:"enum",T:i.C.getEnumType(o)}]));i.C.makeExtension("event.doubao_event",n.ex,(()=>({no:50001,kind:"message",T:r})))},36572:(e,t,s)=>{s.d(t,{cM:()=>a});var i=s(87729),n=s(88300);const a=i.C.makeEnum("expr.ContentType",[{no:0,name:"Unknown"},{no:2001,name:"SamanthaText"},{no:2002,name:"SamanthaSuggest"},{no:2003,name:"SamanthaLoading"},{no:2004,name:"SamanthaMusic"},{no:2005,name:"SamanthaMusicGenInput"},{no:2006,name:"SamanthaMusicGenOutput"},{no:2007,name:"SamanthaSearchCard"},{no:2008,name:"SamanthaSearchText"},{no:2009,name:"SamanthaImageInput"},{no:2010,name:"SamanthaImageOutput"},{no:2011,name:"SamanthaTranslate"},{no:2012,name:"SamanthaReadInput"},{no:2013,name:"SamanthaWebpageInput"},{no:2014,name:"SamanthaSearchInput"}]),o=i.C.makeEnum("expr.AliceContentType",[{no:0,name:"AliceUnknown"},{no:1,name:"AliceText"},{no:2,name:"AliceSuggest"},{no:3,name:"AliceMusic"},{no:4,name:"AliceWebView"},{no:5,name:"AliceVideo"},{no:6,name:"AliceImage"},{no:7,name:"AliceFile"},{no:8,name:"AlicePluginSearchResult"},{no:9,name:"AliceAwemeVideoList"},{no:10,name:"AliceComposite"},{no:11,name:"AliceBiz"},{no:20,name:"AliceNested"},{no:50,name:"AliceCard"},{no:51,name:"AliceBotCard"},{no:53,name:"AliceFormMsg"},{no:60,name:"AliceCopilotCard"},{no:70,name:"AliceLyricsToSongMusic"},{no:71,name:"AliceLyricsToSongLyric"},{no:72,name:"AliceLyricsToSongsMusic"},{no:80,name:"AlicePagesCard"},{no:81,name:"AliceOutline"},{no:100,name:"AliceWidget"},{no:1e3,name:"AliceUnsupported"}]),r=i.C.makeEnum("expr.SkillType",[{no:0,name:"SkillFreeChat"},{no:2,name:"SkillWrite"},{no:3,name:"SkillImageGen"},{no:4,name:"SkillSearch"},{no:5,name:"SkillTranslate"},{no:6,name:"SkillRead"},{no:7,name:"SkillWebpage"},{no:8,name:"SkillDeepSearch"},{no:9,name:"SkillMusicGen"}]),l=i.C.makeMessageType("expr.Option",(()=>[{no:1,name:"content_type",kind:"enum",T:i.C.getEnumType(a)},{no:2,name:"need_store",kind:"scalar",T:8},{no:3,name:"alice_content_type",kind:"enum",T:i.C.getEnumType(o)},{no:4,name:"skill_type",kind:"enum",T:i.C.getEnumType(r)}]));i.C.makeExtension("expr.doubao_content",n.ex,(()=>({no:5e4,kind:"message",T:l})))}}]);