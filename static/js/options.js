var e,t={77191:(e,t,n)=>{n.d(t,{J2:()=>p,M$:()=>m,Pt:()=>d,UJ:()=>_,jI:()=>r});var i=n(44557),s=n(14065),o=n(9144),a=n(70405),l=n(67685);function r(e){return c.apply(this,arguments)}function c(){return(c=(0,s.A)((function*(e){return(0,a.S6)({method:"POST",url:`${l.kD}/plugin/detect_lang`,params:(0,o.wH)(),data:{raw_text:e}})}))).apply(this,arguments)}function d(e,t){return u.apply(this,arguments)}function u(){return(u=(0,s.A)((function*(e,t,n=0){return(0,a.S6)({method:"POST",url:`${l.kD}/plugin/translate`,params:(0,o.wH)(),data:{raw_text:e,target_lang:t,source_lang:n},preventDefaultAuthAction:!0})}))).apply(this,arguments)}function m(e){return h.apply(this,arguments)}function h(){return(h=(0,s.A)((function*(e){let t=(0,o.wH)();return e&&(t=(0,i.A)((0,i.A)({},t),{},{language:e})),(0,a.S6)({method:"POST",url:`${l.kD}/skill/recommend`,params:t})}))).apply(this,arguments)}function p(e){return g.apply(this,arguments)}function g(){return(g=(0,s.A)((function*(e){const t=(0,o.wH)();return(0,a.S6)({method:"POST",url:`${l.Jk}/user_voice/recommend`,params:t,data:e})}))).apply(this,arguments)}function _(){return v.apply(this,arguments)}function v(){return(v=(0,s.A)((function*(){return yield(0,a.S6)({method:"POST",url:`${l.kD}/user/setting/get`,data:{ab_param:{ab_request:{extension_collection_entry:{parmas:["collection_ability","show_entry"],is_login:!0}}}}})}))).apply(this,arguments)}},70405:(e,t,n)=>{n.d(t,{S6:()=>r,ew:()=>c});var i=n(14065),s=n(16409),o=n(2573),a=n(44969);const l=new Set([a.Be,a.BW]),r=function(){var e=(0,i.A)((function*(e,t){try{const{data:n,success:i,error:a}=yield(0,s.cs)({name:"http-request",body:{config:e,options:t}});if(l.has(`${null==n?void 0:n.code}`)&&o.A.emit("api-request-proxy-unAuthorized",{params:e,data:n}),!i)throw a;const{code:r,msg:c,data:d}=n;if(void 0!==r&&0!==r)throw new Error(JSON.stringify({message:`code invalid error: ${r}, ${c}`,code:r}));return d}catch(n){return n}}));return function(t,n){return e.apply(this,arguments)}}(),c=function(){var e=(0,i.A)((function*(e,t){try{const{data:n,success:i,error:o}=yield(0,s.cs)({name:"http-request",body:{config:e,options:t}});if(!i)throw o;const{code:a,msg:l}=n;if(void 0!==a&&0!==a)throw new Error(`code invalid error: ${a}, ${l}`);return n}catch(n){return n}}));return function(t,n){return e.apply(this,arguments)}}()},9144:(e,t,n)=>{n.d(t,{IP:()=>l,Ql:()=>c,wH:()=>r});var i=n(77591),s=n(44969),o=n(67976),a=n(67685);const l=()=>{const{ttWid:e,webId:t=""}=(0,i.bU)();return e?t:"0"},r=()=>{var e;const{country:t,teaWebId:n,teaUuid:r}=(0,i.bU)();return{version:s.rE,version_code:s.br,language:(0,o.XQ)(),browser_language:navigator.language,device_platform:a.lx,aid:a.sZ,pkg_type:a.eG,device_id:l(),web_id:null!==(e=null!=n?n:r)&&void 0!==e?e:"0",is_new_user:"0",region:t,sys_region:t,"use-olympus-account":1,samantha_web:"1",real_aid:a.sZ||""}},c=()=>{const e={},{isEnableDebug:t,extEnv:n}=(0,i.MI)();return t&&n&&(e["x-tt-env"]=n,e["production"===a.nD?"x-use-ppe":"x-use-boe"]="1"),e}},22074:(e,t,n)=>{n.d(t,{O:()=>o,fv:()=>a,gm:()=>s,nr:()=>i});n(55322),n(77591);const i=()=>/^((?!chrome|android).)*safari/i.test(navigator.userAgent),s=()=>{var e;return null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Samantha")},o=()=>{var e;return(null===(e=Intl)||void 0===e||null===(e=e.DateTimeFormat())||void 0===e||null===(e=e.resolvedOptions())||void 0===e?void 0:e.timeZone)||""},a=()=>{try{return Boolean(getComputedStyle(document.documentElement||document.body).getPropertyValue("--arc-palette-title"))}catch(e){return!1}}},13464:(e,t,n)=>{n.d(t,{NS:()=>v,dp:()=>_,hj:()=>f});var i=n(14065),s=n(18797);const o=new Map,a=["META","STYLE","SCRIPT","NOSCRIPT"];var l=n(24337),r=n(44969),c=n(98767),d=n(13162),u=n(67805);const m=e=>{let t=e;return e.startsWith("webkit")&&(t=`-${t}`),t.replace(/([A-Z])/g,(function(e){return`-${e.toLowerCase()}`}))},h=(e,t,n,i,s,c=[])=>{try{var d;const{tagName:l}=e;if(a.includes(l))return;const u=e.getAttribute("class");if(null!=u&&u.includes(r.AC))return;if(c.find((e=>t.matches(e))))return;Object.keys(e.dataset||{}).forEach((t=>{e.removeAttribute(`data-${m(t)}`)}));const p=window.getComputedStyle(t);if("none"===p.display)return void i.push(e);if(Object.entries(p).forEach((t=>{const[n,i]=t;if(!i||!isNaN(Number(n)))return;const s=(e=>{const t=o.get(e);if(t)return t;const n=document.createElement("div"),i=n.attachShadow({mode:"open"}),s=document.createElement(e);s.style.cssText="color: initial;",i.appendChild(s),"A"===e&&s.setAttribute("href","https://www.ciciai.com/browser-extension/landing"),document.body.insertBefore(n,document.body.firstElementChild);const a=new Map,l=window.getComputedStyle(s);return Object.entries(l).forEach((e=>{const[t,n]=e;n&&isNaN(Number(t))&&!t.includes("font")&&a.set(t,n)})),o.set(e,a),n.remove(),a})(l).get(n);s!==i&&(e.style[m(n)]=i)})),null!==(d=e.style.backgroundImage)&&void 0!==d&&d.includes("url")){const t=e.style.backgroundImage.substring(5,e.style.backgroundImage.length-2),n=s.get(t);n?n.push(e):s.set(t,[e])}if("IMG"===l){const{src:t}=e,n=s.get(t);n?n.push(e):s.set(t,[e])}else if("A"===l&&"A"===t.tagName)e.setAttribute("href",null==t?void 0:t.href),e.setAttribute("target","_blank");else{if("SVG"===l)return;if("VIDEO"===l){const t=e.getAttribute("poster");if(t){const n=s.get(t);n?n.push(e):s.set(t,[e])}}}for(let o=0;o<t.children.length&&o<e.children.length;o++)n.pushTask((()=>h(e.children[o],t.children[o],n,i,s,c)))}catch(u){(0,l.z3)("[collection] cloneDom error: ",u)}},p=function(){var e=(0,i.A)((function*(e,t){if(e)try{const n=yield(0,c.n_)(e);if(null!=n&&n.blob){const e=yield(0,d.r)(n.blob);t.forEach((t=>t.setAttribute(u.$_,e)))}}catch(n){return void(0,l.z3)("[collection] uploadImage error",n,e)}}));return function(t,n){return e.apply(this,arguments)}}(),g=function(){var e=(0,i.A)((function*(e,t=!0,n=[]){const i=new Map,o=[],c=[];try{(0,l.Rm)("[collection] start clone dom"),yield new Promise((a=>{const l=new s.E(a);e.forEach((e=>{const s=e.cloneNode(!0);if(t){const e=document.createElement("div");e.appendChild(s),c.push(e)}else c.push(s);l.pushTask((()=>h(s,e,l,o,i,n)))})),l.loop()})),(0,l.Rm)("[collection] start upload img"),yield Promise.race([Promise.all([...i].map((e=>p(e[0],e[1])))),new Promise((e=>{setTimeout((()=>{e(),(0,l.Rm)("[collection] uploadImage timeout")}),6e4)}))]),(0,l.Rm)("[collection] start remove useless tag"),o.forEach((e=>e.remove())),c.forEach((e=>{e.querySelectorAll(`[class*=${r.AC}]`).forEach((e=>e.remove())),a.forEach((t=>e.querySelectorAll(t.toLocaleLowerCase()).forEach((e=>e.remove())))),n.forEach((t=>e.querySelectorAll(t).forEach((e=>e.remove()))))}))}catch(d){(0,l.z3)("[collection] clone dom error: ",d)}return(0,l.Rm)("[collection] clone done"),c}));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=(0,i.A)((function*(e,t=!0,n=[]){const i=yield g([e],t,n);return i.length?i[0]:e.cloneNode(!0)}));return function(t){return e.apply(this,arguments)}}(),v=(e,t,n)=>{const i=document.createElement("div");i.innerHTML='<iframe\n  scrolling="no"\n  frameBorder="no"\n  allowFullScreen="true"\n  sandbox="allow-popups allow-same-origin"></iframe>';const s=i.querySelector("iframe");return s?(s.style.width="100%",s.style.height=`${t}px`,s.style.width=`${n}px`,s.srcdoc=`<html>\n        <head>\n          <style>\n            * {\n              cursor: unset !important;\n            }\n            body {\n              padding: 0;\n              margin: 0;\n            }\n            a {\n              cursor: pointer !important;\n            }\n          </style>\n        </head>\n        <body>\n          ${e}\n        </body>\n      </html>`,i.innerHTML):e},f=e=>{const t=document.createElement("div");return t.style.overflow="hidden",t.style.display="flex",t.style.alignItems="center",t.style.flexWrap="nowrap",t.style.flexDirection="column",t.style.width=`${e}px`,t}},44969:(e,t,n)=>{n.d(t,{AC:()=>_,BW:()=>f,Be:()=>v,Cp:()=>c,EP:()=>d,JE:()=>u,LN:()=>A,QN:()=>a,R3:()=>g,Vn:()=>b,Yq:()=>p,Zn:()=>x,br:()=>r,j0:()=>h,o$:()=>o,o2:()=>m,rE:()=>l});var i=n(77793);function s(){return(0,i.A)().replaceAll("-","")}const o="cici_host_style",a="static/css/content_list.json",l="1.12.0",r=20650,c="/browser-extension",d=`${c}/login`,u=`${c}/welcome`,m=`${c}/landing`,h=`${c}/uninstall`,p=`${s()}`,g="doubao",_=`${g}-ai-collection-assistant`,v="710022013",f="710012001",b=634880,x="en-GB",A="en"},80459:(e,t,n)=>{n.d(t,{JL:()=>u,NR:()=>r,ST:()=>d,V6:()=>c,qB:()=>h,yL:()=>m});var i=n(14065),s=n(9012),o=(n(11855),n(75541),n(77591),n(24337)),a=n(44969);n(22074),n(76813),n(75943),n(77259);let l;const r=function(){var e=(0,i.A)((function*(e,t){try{if(!l){const e=yield fetch(chrome.runtime.getURL(t)),n=(yield e.json()).content_css,i=yield Promise.all(n.map((e=>fetch(chrome.runtime.getURL(e)))));l=Promise.all(i.map((e=>e.text()))).then((e=>e.join("\n")))}const n=document.createElement("style");n.className=a.o$,n.textContent=yield l,e.prepend(n)}catch(n){o.z3(`Error applying styles: ${n.message}`,n)}}));return function(t,n){return e.apply(this,arguments)}}();function c(e,t){let n=null,i=null;const o=(0,s.A)(t,"maxWait",1e3);function a(){n&&(clearInterval(n),n=null)}return new Promise((l=>{const r=()=>{const n=(0,s.A)(t,"wrapper",document).querySelector(e);n&&(a(),i&&(clearTimeout(i),i=null),l(n))};n=window.setInterval(r,100),i=window.setTimeout((()=>{a(),l(null)}),o),r()}))}const d=e=>e instanceof Element&&"STYLE"===e.tagName.toUpperCase(),u=e=>e instanceof Element&&"LINK"===e.tagName.toUpperCase(),m=e=>e instanceof Element&&"SCRIPT"===e.tagName.toUpperCase(),h=e=>8===e.nodeType},76360:(e,t,n)=>{n.d(t,{Gj:()=>l,HF:()=>m,L2:()=>r,Nf:()=>c,Yh:()=>d,od:()=>h});var i,s,o=n(14065);const a=null===(i=globalThis.chrome)||void 0===i?void 0:i.runtime,l=()=>{if(!a)throw new Error("Extension runtime is not available");return a},r=(null===(s=globalThis.chrome)||void 0===s||s.tabs,()=>"\u8c46\u5305");const c=()=>chrome.runtime.getURL("assets/icon.png"),d=e=>chrome.runtime.getURL(`options.html${null!=e?e:""}`);let u="";const m=()=>(u||(u=chrome.runtime.getManifest().version),u),h=function(){var e=(0,o.A)((function*(e){return yield chrome.i18n.detectLanguage(e)}));return function(t){return e.apply(this,arguments)}}()},12365:(e,t,n)=>{n.d(t,{B:()=>v});var i=n(10633),s=n(60588),o=n(36080),a=n(2573),l=n(44969),r=n(67976),c=n(24337);const d=new Set([l.Be,l.BW]),u=e=>`on-open-${e}`,m=e=>`on-update-${e}`,h=e=>`on-done-${e}`,p=e=>`on-error-${e}`,g=e=>`on-abort-${e}`,_=e=>`on-close-${e}`;const v=new class{constructor(){(0,i.A)(this,"eventEmitter",new s.b),(0,i.A)(this,"messageCommunication",void 0),(0,i.A)(this,"abort",((e,t,n=!1)=>{var i;(0,c.Rm)("[zoei] FetchStreamProxy.abort",e,t),null===(i=this.messageCommunication)||void 0===i||i.postMessage({body:{id:e,type:"abort",reason:t}}),n||this.removeListeners(e)})),(0,i.A)(this,"handleMessage",(e=>{var t;const n=(null===(t=this.messageCommunication)||void 0===t?void 0:t.formatMessage(e))||{},{id:i,event:s}=n;switch(s){case"open":return void this.eventEmitter.emit(u(i),n);case"data":return void this.eventEmitter.emit(m(i),n);case"done":return this.eventEmitter.emit(h(i),n),void this.removeListeners(i);case"error":return this.eventEmitter.emit(p(i),n),void this.removeListeners(i);case"abort":return this.eventEmitter.emit(g(i),n),void this.removeListeners(i);case"close":return this.eventEmitter.emit(_(i),n),void this.removeListeners(i)}})),this.messageCommunication=(0,o.A)("fetch-stream"),this.messageCommunication.onMessage.addListener(this.handleMessage)}fetch(e,t){var n;const{id:i=(0,r.AP)(),onOpen:s,onUpdate:o,onDone:l,onError:v,onAbort:f,onClose:b}=t;return(0,c.Rm)("[zoei] FetchStreamProxy.fetch",{id:i,payload:e}),null===(n=this.messageCommunication)||void 0===n||n.postMessage({body:{id:i,type:"fetch",payload:e}}),s&&this.eventEmitter.addListener(u(i),s),o&&this.eventEmitter.addListener(m(i),o),l&&this.eventEmitter.addListener(h(i),l),f&&this.eventEmitter.addListener(g(i),f),b&&this.eventEmitter.addListener(_(i),b),this.eventEmitter.addListener(p(i),(t=>{var n;d.has(`${null==t||null===(n=t.jsonData)||void 0===n?void 0:n.code}`)&&a.A.emit("fetch-stream-proxy-unAuthorized",{params:e,_message:t}),null==v||v(t)})),i}removeListeners(e){this.eventEmitter.removeAllListeners(u(e)),this.eventEmitter.removeAllListeners(m(e)),this.eventEmitter.removeAllListeners(h(e)),this.eventEmitter.removeAllListeners(p(e)),this.eventEmitter.removeAllListeners(g(e))}}},91376:(e,t,n)=>{n.d(t,{I$:()=>a,eW:()=>c,gp:()=>d,kr:()=>l,ku:()=>o,mz:()=>r});var i=n(77591),s=n(22074);const o=()=>{var e;return null===(e=(0,i.TK)("collectionConfig"))||void 0===e?void 0:e.showEntry},a=()=>(0,i.tl)("search_addons").feed_card_show,l=()=>{var e;return null===(e=(0,i.tl)("input_translate_assistant"))||void 0===e?void 0:e.enable},r=()=>{var e;return null===(e=(0,i.tl)("hover_translate_assistant"))||void 0===e?void 0:e.enable},c=()=>{var e;return!(0,s.gm)()&&(null===(e=(0,i.tl)("capture_assistant"))||void 0===e?void 0:e.enable)},d=()=>{var e;return null===(e=(0,i.tl)("tts"))||void 0===e?void 0:e.ttsReadPageEnabled}},21559:(e,t,n)=>{n.d(t,{c6:()=>d,vF:()=>r});var i=n(37357),s=n(66873),o=n(27925),a=n(20825);const l=new(n(79776).h);(0,i.b)({clients:[l],disableConsole:!a.Cu});const r=i.v,c=new s.B(o.A),d=i.v.createLoggerWith({clients:[c],ctx:{meta:{}}})},81057:(e,t,n)=>{n.d(t,{J:()=>c,K:()=>r});var i=n(58311),s=n(35625),o=n(5081),a=n(16029);let l=null;const r=e=>(l||(e===a.xb.CN&&(l=o.Ay),e===a.xb.MALIVA&&(l=s.Ay),e===a.xb.SG&&(l=i.Ay)),l),c=()=>a.xb.CN},96638:(e,t,n)=>{n.d(t,{AA:()=>u,EU:()=>i,HO:()=>s,Hh:()=>c,I8:()=>h,Tz:()=>l,WN:()=>d,Xt:()=>m,YN:()=>g,_8:()=>v,aX:()=>a,em:()=>_,fS:()=>p,y3:()=>o});var i={search:"search",read:"read",pronounce:"pronounce",explain:"explain",translate:"translate",summarize:"summarize",grammar:"grammar",rewrite:"rewrite",ask:"browser_ask",browser_explain:"browser_explain",youtube:"youtube",mail:"browser_mail",copy:"copy",browser_plugin_info:"browser_plugin_info",input_skill:"input_skill",collect:"collect",adjust_skill:"adjust_skill"};[{cnName:"\u200b\u4e2d\u6587\u200b",enName:"Chinese\u200b",name:"\u4e2d\u6587",lang:"zh"},{cnName:"\u82f1\u6587\u200b",enName:"English\u200b",name:"English",lang:"en"},{cnName:"\u65e5\u8bed\u200b",enName:"Japanese\u200b",name:"\u65e5\u672c\u8a9e",lang:"ja"},{cnName:"\u97e9\u8bed\u200b",enName:"Korean\u200b",name:"\ud55c\uad6d\uc5b4",lang:"ko"},{cnName:"\u6cd5\u8bed\u200b",enName:"French\u200b",name:"Fran\xe7ais",lang:"fr"},{cnName:"\u5fb7\u8bed\u200b",enName:"German\u200b",name:"Deutsch",lang:"de"},{cnName:"\u897f\u73ed\u7259\u8bed\u200b",enName:"Spanish\u200b",name:"Espa\xf1ol",lang:"es"},{cnName:"\u4fc4\u8bed\u200b",enName:"Russian\u200b",name:"\u0420\u0443\u0441\u0441\u043a\u0438\u0439",lang:"ru"},{cnName:"\u610f\u5927\u5229\u8bed\u200b",enName:"Italian\u200b",name:"Italiano",lang:"it"},{cnName:"\u8461\u8404\u7259\u8bed\u200b",enName:"Portuguese\u200b",name:"Portugu\xeas",lang:"pt"},{cnName:"\u8377\u5170\u8bed\u200b",enName:"Dutch\u200b",name:"Nederlands",lang:"nl"},{cnName:"\u745e\u5178\u8bed\u200b",enName:"Swedish\u200b",name:"Svenska",lang:"sv"},{cnName:"\u4e39\u9ea6\u8bed\u200b",enName:"Danish\u200b",name:"Dansk",lang:"da"},{cnName:"\u632a\u5a01\u8bed\u200b",enName:"Norwegian\u200b",name:"Norsk",lang:"no"},{cnName:"\u6ce2\u5170\u8bed\u200b",enName:"Polish\u200b",name:"Polski",lang:"pl"},{cnName:"\u5e0c\u814a\u8bed\u200b",enName:"Greek\u200b",name:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",lang:"el"},{cnName:"\u571f\u8033\u5176\u8bed\u200b",enName:"Turkish\u200b",name:"T\xfcrk\xe7e",lang:"tr"},{cnName:"\u8d8a\u5357\u8bed\u200b",enName:"Vietlangse\u200b",name:"Ti\u1ebfng Vi\u1ec7t",lang:"vi"},{cnName:"\u6cf0\u8bed\u200b",enName:"Thai\u200b",name:"\u0e44\u0e17\u0e22",lang:"th"},{cnName:"\u5370\u5730\u8bed\u200b",enName:"Hindi\u200b",name:"\u0939\u093f\u0928\u094d\u0926\u0940\u200b",lang:"hi"}].reduce(((e,t)=>(e[t.lang]=t.name,e)),{});const s=[{id:i.ask,prompt:"",name:"flow_web_ext_action_ask",icon:"searchAI"},{id:i.explain,prompt:"\u89e3\u91ca\u8fd9\u6bb5\u6587\u672c: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_explain",icon:"explain"},{id:i.translate,prompt:"\u628a\u4e0b\u9762\u8fd9\u6bb5\u6587\u672c\u7ffb\u8bd1\u6210\u76ee\u6807\u8bed\u8a00: $[lang]\u3002\u9700\u8981\u7ffb\u8bd1\u7684\u5185\u5bb9\u662f: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_translate",icon:"IconTranslateOutline"},{id:i.pronounce,prompt:"",name:"\u6717\u8bfb",icon:"IconPlayAudio"},{id:i.summarize,prompt:"\u603b\u7ed3\u4ee5\u4e0b\u5185\u5bb9: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_summarize",icon:"summarize"},{id:i.grammar,prompt:"\u6821\u5bf9\u5e76\u7ea0\u6b63\u8fd9\u6bb5\u6587\u5b57: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"flow_web_ext_action_grammar",icon:"check"},{id:i.adjust_skill,prompt:"\u91cd\u65b0\u8868\u8ff0\u8fd9\u6bb5\u6587\u5b57, \u4f7f\u8fd9\u6bb5\u6587\u5b57\u8868\u8ff0\u7684\u66f4\u52a0\u5408\u7406: \n\u201d\u201d\u201d\n$[text]\n\u201d\u201d\u201d",name:"modify_change_tone",icon:"adjust_skill"},{id:i.copy,prompt:"",name:"message_long_press_copy",icon:"copy"},{id:i.collect,prompt:"",name:"flow_web_ext_action_bookmarks",icon:"collect",options:{brand:"\u8c46\u5305"}}],o=(i.ask,i.grammar,i.rewrite,i.adjust_skill,i.grammar,i.rewrite,i.explain,i.translate,i.copy,i.adjust_skill,new Set([i.ask])),a=[i.explain,i.translate,i.pronounce,i.collect],l=[i.copy],r=new Set([i.summarize]),c=(e=[])=>s.filter((t=>a.includes(t.id)&&!r.has(t.id)&&!e.includes(t.id))),d=(e=[])=>s.filter((t=>l.includes(t.id)&&!r.has(t.id)&&!e.includes(t.id))),u=[i.grammar,i.rewrite,i.collect,i.pronounce,i.adjust_skill],m=[i.explain,i.translate,i.copy],h=(e=[])=>s.filter((t=>u.includes(t.id)&&!r.has(t.id)&&!e.includes(t.id))),p=(e=[])=>s.filter((t=>m.includes(t.id)&&!r.has(t.id)&&!e.includes(t.id))),g=s.reduce(((e,t)=>(e[t.id]=t,e)),{});const _=e=>!g[e],v=e=>{const t=g[e];return Boolean(t)}},15965:(e,t,n)=>{n.d(t,{B9:()=>c,Tp:()=>r});var i=n(89586);const s=10485760,o=new RegExp("^https?:\\/\\/www\\.zhihu\\.com\\/question\\/\\d+");function a(){o.test(location.href)&&(i.Readability.prototype.REGEXPS.negative=/-ad-|^kfecollection-viprecommendcard$|hidden|^hid$| hid$| hid |^hid |banner|combx|comment|com-|contact|foot|footer|footnote|gdpr|masthead|media|meta|outbrain|promo|related|scroll|share|shoutbox|sidebar|skyscraper|sponsor|shopping|tags|tool|widget/i)}const l={charThreshold:500,keepClasses:!1};function r(e,t=s){const n=(e=e||document).cloneNode(!0);a();const o=new i.Readability(n,l).parse();return o&&o.content.length>t&&o.content.slice(0,t),o}function c(e){return new Promise((e=>{if("complete"===document.readyState||"interactive"===document.readyState)e();else{const t=()=>{document.removeEventListener("DOMContentLoaded",t),e()};document.addEventListener("DOMContentLoaded",t)}})).then((()=>r(document,e)))}},64123:(e,t,n)=>{n.d(t,{AI:()=>g,Lj:()=>m,Ue:()=>a,Z8:()=>r,ZH:()=>l,ZV:()=>c,jv:()=>h,o:()=>u,vK:()=>d});var i=n(7685),s=n.n(i),o=n(4252);const a=(()=>{let e=null;return()=>(null===e&&(e="macos"===s().getParser(navigator.userAgent).getOSName(!0)),e)})(),l=()=>a()?d.Command:d.Ctrl,r=()=>a()?d.Option:d.Alt;function c(e){const t=a();switch(e){case o.e.OpenSide:return t?`${d.Command}+K`:`${d.Ctrl}+K`;case o.e.TranslatePage:return t?`${d.Option}+1`:`${d.Alt}+1`;case o.e.ReadPage:return t?`${d.Option}+2`:`${d.Alt}+2`;case o.e.HoverTextTranslate:return t?`${d.Command}`:`${d.Ctrl}`;case o.e.ScreenCapture:return t?`${d.Option}+3`:`${d.Alt}+3`;case o.e.CollectPage:return t?`${d.Option}+4`:`${d.Alt}+4`;case o.e.TTSReadPage:return t?`${d.Option}+5`:`${d.Alt}+5`;case o.e.VoiceInput:return"B";case o.e.BilingualSubtitles:return"H";default:return""}}let d=function(e){return e.Command="Command",e.Windows="Windows",e.Ctrl="Ctrl",e.Alt="Alt",e.Option="Option",e.Shift="Shift",e}({});function u(e){return e.split("+").map((e=>{switch(e){case d.Command:return"Cmd";case d.Windows:return"Win";case d.Option:return"Opt";default:return e}})).join(" + ")}function m(e){let t="";const n=e.match(/^Key(\w)$/),i=e.match(/^Digit(\d)$/);return(n||i)&&(n&&(t+=n[1]),i&&(t+=i[1])),t}let h=function(e){return e.Command="Command",e.Option="Option",e}({});const p={[h.Command]:{macKey:d.Command,winKey:d.Ctrl},[h.Option]:{macKey:d.Option,winKey:d.Alt}},g=e=>{const t=p[e];return a()?t.macKey:t.winKey}},77591:(e,t,n)=>{n.d(t,{Fc:()=>L,MI:()=>D,TK:()=>E,bU:()=>B,gv:()=>P,lv:()=>I,tl:()=>M,ue:()=>R,vE:()=>N});var i,s=n(14065),o=n(44557),a=n(22234),l=n(97724),r=n(39415),c=n(88090),d=n(87648),u=n(31826),m=n(59186),h=n(53262),p=n(98801),g=n(10242),_=n(96638),v=n(44969),f=n(41753),b=n(29988),x=n(58980),A=n(12710);const y=(0,h.c)();let w=(0,c.wz)(y);w===v.Zn&&(w=v.LN);let S=y;S===v.Zn&&(S=v.LN);const j={vocabruaryDisableAll:!0,vocabruaryDisableHosts:[],vocabruaryHighlightColor:A.Bx[4][0],vocabruaryOnboarding:!0,videoSubtitleDisableAll:!1,videoSubtitleDisableHosts:[],videoImmersionDisableAll:!1,videoImmersionDisableHosts:[],videoSummaryDisableAll:!1,videoMemoDisableAll:!1,videoMemoDisableHosts:[],videoSummaryDisableHosts:[],podcastSummaryDisableAll:!1,podcastSummaryDisableHosts:[],chatFloatCardDisableAll:!1,chatFloatCardDisableHosts:[],sidebarButtonDisabledAll:!1,sidebarButtonDisabledHosts:[],searchDisabledAll:!1,searchDisabledHosts:[],disableSearchAddonsGlobal:!0,disableSearchAddonsHosts:[],autoTranslatePageHosts:[],disableGlobalGrammar:!(0,r.UP)(),disableGrammarHosts:[],InputAssistantDisabledAll:!1,InputAssistantDisabledHosts:[],replyAssistantDisabledAll:!1,replyAssistantDisabledHosts:[],sidebarButtonTop:.5,sidebarButtonPosition:"right",inputAssistantLang:"zh",quickDisabledAll:!1,quickDisabledHosts:[],translateLanguage:w,autoTranslateSubtitles:!0,subtitleTranslateLang:"system",selectBarOnlyIcon:!1,pageTranslateService:x.c$.MICROSOFT,selectTranslateService:x.c$.DOUBAO,pageTranslateShowUnderline:!1,linkPreviewDisabledAll:!1,linkPreviewDisabledHosts:[],hoverTranslateSetting:x.X0.NO_TRANSLATE,inputTranslateInfo:{isFirstUse:!0,language:"en",showInputInnerTips:!0,translateService:x.c$.HUOSHAN,hotKeyCode:x.WR.Space,disableAll:!0},readingPopupActions:{actionList:(0,_.Hh)(),moreActionList:(0,_.WN)()},editingPopupActions:{actionList:(0,_.I8)(),moreActionList:(0,_.fS)()},transPreferConfig:{tipShown:!1,langMap:{}},collectImageDisabledAll:!1,collectImageDisabledHosts:[],socialWebcollectDisabledAll:!1,mediaCardTranslateLanguage:S,readWebPageCtxConfig:{enabled:!0,hasWebPageContextDialogShow:!0,hasUserSwitched:!1}},k=(Object.keys(j),(0,o.A)((0,o.A)({},j),{},{uuid:"",installReason:"",synced:!1,authInfo:{isAuthenticated:!1},launchInfo:{},launchConfig:{},abTestValue:{},chatInfo:{},debugInfo:{isEnableDebug:!1,webEnv:"",extEnv:""},requestCommonParams:{},shortcutsConfig:g.A,actions:_.HO,themeMode:x.lG.AUTO,uiLanguage:y,voiceSpeaker:m.F,sidePanelEnabled:!0,hostId:"",PopupListMaxCount:4,onboardingActionRecord:(0,u.wG)(),isSelectbarMoreMenuClicked:!1,needOpenSideBar:!1,featureInfo:null,collectionConfig:(0,f.i)(),tabConversationMap:{},isHistoryChatsClicked:!1,appSettings:p.K,overseaAccessibility:{},doubaoNoticeKey:"",searchUsageTimesInfo:{},voiceSettingTipShown:!1,isArc:!1,dismissUpdateKey:"",navigatorLanguage:(null===(i=navigator)||void 0===i?void 0:i.language)||"",voiceInputShortcutTipShown:!1}));let C=()=>{};const I=function(){var e=(0,s.A)((function*(){C=yield(0,d.X)(k),k.synced=!0}));return function(){return e.apply(this,arguments)}}(),T=(e,t,n=!1)=>{const i=k[e];return k[e]=n?(0,l.A)(i,t):t,b.A.set(e,k[e])},N=T;function E(e){return k[e]}const M=e=>{const t=E("appSettings")[e];return(0,a.A)(t,p.K[e])},P=()=>k.shortcutsConfig;function L(){return k.authInfo}function D(){return k.debugInfo}function R(){return k.launchInfo}function B(){return k.requestCommonParams}},5842:(e,t,n)=>{n.d(t,{IK:()=>l});var i=n(10484),s=n(77591),o=(n(21559),n(47730),n(82770)),a=n(52833);function l(){var e;const t=(0,s.TK)("authInfo"),{mainConversation:n}=(0,s.TK)("chatInfo"),l=(0,o.Mz)(o.FM.enableNewChat,!1),r=null==n?void 0:n.bot_id;if(!t.isAuthenticated||!l)return{convId:null==n?void 0:n.conversation_id,convType:i.H.Conversation,mainBotId:r};const{tabId:c}=a.on.getState().tabInfo;if(!c){return{convId:null==n?void 0:n.conversation_id,convType:i.H.Conversation,mainBotId:r}}const d=(0,s.TK)("tabConversationMap"),u=void 0===d[c]?i.H.NewThread:d[c].conversationType;return{convId:null===(e=d[c])||void 0===e?void 0:e.conversationId,convType:u,mainBotId:r}}},36897:(e,t,n)=>{n.d(t,{jB:()=>s});n(11855),n(77591);window.location.href;const i={youtube:/^https:\/\/www.youtube.com\/watch\?/,bilibili:/^https:\/\/www\.bilibili\.com\/video\/\w+/},s=e=>!!e&&i[e].test(location.href)},21811:(e,t,n)=>{n.d(t,{DT:()=>d,l_:()=>u});var i=n(44557),s=n(76813),o=n(67685),a=n(24228),l=n(16409),r=(n(24337),n(44969)),c=n(22074);const d=e=>{if(!location.href.includes(`${o.FI}${r.EP}`))if((0,c.nr)()){const{trackMeta:t}=e||{};window.open(function(e){const t={from:"ext"};return e&&(t.extra=btoa(JSON.stringify(e))),(0,s.ID)(`https://${o.FI}/browser-extension/login`,t)}({trackMeta:t}),"_blank")}else(0,l.cs)({name:"open-login-window",body:(0,i.A)((0,i.A)((0,i.A)({},(0,a.c)()),e),{},{clearWindow:(0,c.fv)()})})},u=()=>{var e,t,n;return{imageUrl:(null===(e=document.querySelector('meta[property="og:image"]'))||void 0===e?void 0:e.getAttribute("content"))||"",desc:(null===(t=document.querySelector('meta[property="og:description"]'))||void 0===t?void 0:t.getAttribute("content"))||(null===(n=document.querySelector('meta[name="description"]'))||void 0===n?void 0:n.getAttribute("content"))||""}}},66351:(e,t,n)=>{n.d(t,{E:()=>Wt,I:()=>Jt,Io:()=>lt,Ll:()=>Qt,PW:()=>Ot,Pg:()=>Yt,Pl:()=>dt,RH:()=>at,Tf:()=>Gt,bz:()=>yt,de:()=>mt,fz:()=>Rt,gz:()=>It,jk:()=>ut,rZ:()=>rt,vo:()=>Bt,wO:()=>$t,wv:()=>ot,xV:()=>ct});var i=n(44557),s=(n(11855),n(54528)),o=n(47351),a=n(45041),l=n(59107),r=n(27398),c=n(70798),d=n(51405),u=n(79613),m=n(76360),h=n(89130),p=n(12508),g=n(34919),_=n(31442),v=n(93708),f=n(86617),b=n(70221),x=n(5960),A=n(67368),y=n(37730),w=n(21010),S=n(16593),j=n(3341),k=n(55615),C=n(98335),I=n(63751),T=n(90952),N=n(64390),E=n(4045),M=n(59799),P=n(34658),L=n(67455),D=n(27040),R=n(14089),B=n(24890),O=n(30961),U=n(21500),F=n(56317),q=n(52621),H=n(77355),V=n(27350),K=n(15440),z=n(23396),G=n(95633),$=n(15238),W=n(40643),Y=n(10360),Q=n(31870),Z=n(67310),X=n(61533),J=n(74772),ee=n(70279),te=n(36011),ne=n(15652),ie=n(56502),se=n(1519),oe=n(48231),ae=n(81621),le=n(6862),re=n(63904),ce=n(48158),de=n(5169),ue=n(52669),me=n(3040),he=n(50077),pe=n(26517),ge=n(55941),_e=n(63544),ve=n(67397),fe=n(96062),be=n(32574),xe=n(96452),Ae=n(4501),ye=n(13217),we=n(3225),Se=n(5654),je=n(89488),ke=n(47792),Ce=n(75862),Ie=n(82787),Te=n(93442),Ne=n(26025),Ee=n(67434),Me=n(78802),Pe=n(98554),Le=n(22392),De=n(66408),Re=n(8237),Be=n(16367),Oe=n(39007),Ue=n(70873),Fe=n(11007),qe=n(25568),He=n(9335),Ve=n(53012),Ke=n(47494),ze=n(40549),Ge=n(92852),$e=n(57810),We=n(2668),Ye=n(91985),Qe=n(47251),Ze=n(27834),Xe=n(28742),Je=n(93313),et=n(83112),tt=n(63610),nt=n(95960),it=n(28434),st=n(63159);const ot=(0,d.a)((0,st.jsx)(ke.h,{})),at=((0,d.a)((0,st.jsx)(Se.h,{})),(0,d.a)((0,st.jsx)(Le.h,{})),(0,d.a)((0,st.jsx)(be.h,{})),(0,d.a)((0,st.jsx)(Fe.h,{}))),lt=(0,d.a)((0,st.jsx)(qe.h,{})),rt=(0,d.a)((0,st.jsx)(Ue.h,{})),ct=(0,d.a)((0,st.jsx)(He.h,{})),dt=(0,d.a)((0,st.jsx)(re.h,{})),ut=((0,d.a)((0,st.jsx)(tt.h,{})),(0,d.a)((0,st.jsx)($e.h,{})),(0,d.a)((0,st.jsx)(ie.h,{}))),mt=((0,d.a)((0,st.jsx)(de.h,{})),(0,d.a)((0,st.jsx)(le.h,{}))),ht=(0,d.a)((0,st.jsx)(ee.h,{})),pt=(0,d.a)((0,st.jsx)(W.h,{})),gt=(0,d.a)((0,st.jsx)(H.h,{})),_t=(0,d.a)((0,st.jsx)(k.h,{})),vt=(0,d.a)((0,st.jsx)(S.h,{})),ft=(0,d.a)((0,st.jsx)(y.h,{})),bt=(0,d.a)((0,st.jsx)(x.h,{})),xt=(0,d.a)((0,st.jsx)(h.h,{})),At=(0,d.a)((0,st.jsx)(Y.h,{})),yt=(0,d.a)((0,st.jsx)(Z.h,{})),wt=((0,d.a)((0,st.jsx)(X.h,{})),(0,d.a)((0,st.jsx)(w.h,{}))),St=(0,d.a)((0,st.jsx)(J.h,{})),jt=(0,d.a)((0,st.jsx)(B.h,{})),kt=((0,d.a)((0,st.jsx)(N.h,{})),(0,d.a)((0,st.jsx)(I.h,{}))),Ct=((0,d.a)((0,st.jsx)(T.h,{})),(0,d.a)((0,st.jsx)(G.h,{}))),It=(0,d.a)((0,st.jsx)(te.h,{})),Tt=((0,d.a)((0,st.jsx)(z.h,{})),(0,d.a)((0,st.jsx)(oe.h,{}))),Nt=(0,d.a)((0,st.jsx)(L.h,{})),Et=((0,d.a)((0,st.jsx)(D.h,{})),(0,d.a)((0,st.jsx)(U.h,{}))),Mt=(0,d.a)((0,st.jsx)(j.h,{})),Pt=(0,d.a)((0,st.jsx)(E.h,{})),Lt=(0,d.a)((0,st.jsx)(M.h,{})),Dt=((0,d.a)((0,st.jsx)(Q.h,{})),(0,d.a)((0,st.jsx)(ue.h,{})),(0,d.a)((0,st.jsx)(f.h,{})),(0,d.a)((0,st.jsx)(b.h,{})),(0,d.a)((0,st.jsx)(v.h,{})),(0,d.a)((0,st.jsx)(K.h,{}))),Rt=(0,d.a)((0,st.jsx)(A.h,{})),Bt=(0,d.a)((0,st.jsx)($.h,{})),Ot=(0,d.a)((0,st.jsx)(P.h,{})),Ut=(0,d.a)((0,st.jsx)(p.h,{})),Ft=(0,d.a)((0,st.jsx)(q.h,{})),qt=(0,d.a)((0,st.jsx)(g.h,{})),Ht=((0,d.a)((0,st.jsx)(Ze.h,{})),(0,d.a)((0,st.jsx)(et.h,{})),(0,d.a)((0,st.jsx)(ge.h,{})),(0,d.a)((0,st.jsx)(Be.h,{})),(0,d.a)((0,st.jsx)(Oe.h,{})),(0,d.a)((0,st.jsx)(xe.h,{}))),Vt=((0,d.a)((0,st.jsx)(V.h,{})),(0,d.a)((0,st.jsx)(ye.h,{}))),Kt=((0,d.a)((0,st.jsx)(Ke.h,{})),(0,d.a)((0,st.jsx)(ze.h,{})),(0,d.a)((0,st.jsx)(Ae.h,{}))),zt=((0,d.a)((0,st.jsx)(C.h,{})),(0,d.a)((0,st.jsx)(F.h,{}))),Gt=((0,d.a)((0,st.jsx)(_.h,{})),(0,d.a)((0,st.jsx)(se.h,{})),(0,d.a)((0,st.jsx)(ne.h,{}))),$t=((0,d.a)((0,st.jsx)(O.h,{})),(0,d.a)((0,st.jsx)(R.h,{})),(0,d.a)((0,st.jsx)(ce.h,{})),(0,d.a)((0,st.jsx)(Ve.h,{})),(0,d.a)((0,st.jsx)(Re.h,{})),(0,d.a)((0,st.jsx)(he.h,{})),(0,d.a)((0,st.jsx)(_e.h,{}))),Wt=((0,d.a)((0,st.jsx)(Ee.h,{})),(0,d.a)((0,st.jsx)(De.h,{})),(0,d.a)((0,st.jsx)(fe.h,{})),(0,d.a)((0,st.jsx)(me.h,{})),(0,d.a)((0,st.jsx)(Qe.h,{})),(0,d.a)((0,st.jsx)(Je.h,{})),(0,d.a)((0,st.jsx)(Ne.h,{})),(0,d.a)((0,st.jsx)(We.h,{})),(0,d.a)((0,st.jsx)(pe.h,{}))),Yt=(0,d.a)((0,st.jsx)(Ge.h,{})),Qt=(0,d.a)((0,st.jsx)(ve.h,{})),Zt=((0,d.a)((0,st.jsx)(Me.h,{})),(0,d.a)((0,st.jsx)(Pe.h,{})),(0,d.a)((0,st.jsx)(Xe.h,{})),(0,d.a)((0,st.jsx)(Ye.h,{})),(0,d.a)((0,st.jsx)(we.h,{})),(0,d.N)((0,m.Nf)())),Xt=((0,d.a)((0,st.jsx)(ae.h,{})),(0,d.a)((0,st.jsx)(Ie.h,{})),(0,d.a)((0,st.jsx)(je.h,{})),(0,d.a)((0,st.jsx)(Te.h,{})),(0,d.a)((0,st.jsx)(Ce.h,{})),(0,d.a)((0,st.jsx)(nt.h,{})),(0,d.a)((0,st.jsx)(it.h,{})),(0,i.A)((0,i.A)({},u.M),{},{arrow:dt,avatar:mt,check:s.A,contact:ht,drag:pt,explain:o.A,instruct:gt,rewrite:_t,adjust_skill:a.A,search:vt,sider:ft,summarize:bt,translate:xt,del:At,copy:l.A,conversation:St,settings:wt,more:jt,regenerate:kt,expand:Ct,close:It,cancel:Tt,ok:Nt,messageFailed:Et,right:Mt,IconRead:Pt,IconReadPage:Lt,global:Dt,expandDownFilled:Bt,IconTranslateOutline:Ut,IconLangSettings:Ft,IconTranslateOutlineActive:qt,IconLink:zt,cici:Zt,searchToggleSize:Ht,searchMore:Vt,searchSource:Kt,collect:r.A,searchAI:c.A,IconPlayAudio:ot})),Jt=(e,t)=>{const n=Xt[e];return n?(0,st.jsx)(n,(0,i.A)({},t)):(e=>{try{return new URL(e),!0}catch(t){return!1}})(e)?(0,st.jsx)("img",(0,i.A)({src:e},t)):(0,st.jsx)(zt,(0,i.A)({},t))}},69456:(e,t,n)=>{n.d(t,{F4:()=>o,lE:()=>a});var i=n(14065),s=n(13464);const o=function(){var e=(0,i.A)((function*(e){if("xiaoyuzhou"===e){const e=document.querySelector("main");if(!e)return"";const t=e.getBoundingClientRect(),{width:n}=t;let{height:i}=t;const o=n-36,a=(0,s.hj)(n-36);a.style.position="relative";const l=document.createElement("div");l.style.position="absolute",l.style.left="0",l.style.top="0",l.style.height="96px",l.style.width="100%",l.style.backgroundImage="linear-gradient(#f8f8f8 0%, #f8f8f8 40%, #fff 40.1%, #fff 100%)",l.style.backgroundRepeat="repeat-y",l.style.backgroundSize="100% 5px",a.appendChild(l);const r=['button[data-testid="podcast-assistant-single-summary-btn"]','div[id*="doubao-ai-podcast-assistant"]',"main > aside"],c=e.querySelector("main > section");c&&!c.querySelector(".comment")&&(r.push("main > section"),i-=c.getBoundingClientRect().height);const d=e.querySelector("main > div.placeholder");d&&0===d.children.length&&(r.push("main > div.placeholder"),i-=d.getBoundingClientRect().height);const u=yield(0,s.dp)(e,!1,r);a.appendChild(u);return(0,s.NS)(a.outerHTML,i,o)}return""}));return function(t){return e.apply(this,arguments)}}(),a=e=>{if("xiaoyuzhou"===e){const e=document.querySelector("header .podcast-title .name");return e?window.getComputedStyle(e).color:""}return""}},54422:(e,t,n)=>{n.d(t,{Cm:()=>o,dE:()=>c,dZ:()=>a,lO:()=>l,ri:()=>r,sp:()=>i,ut:()=>s});const i="start_request_tts_stream",s="request_stop_tts_stream",o="request_tts_stream_with_text",a="finish_request_tts_stream",l="stop_all_audios",r="register_tts_audio",c="request_tts_audio"},84943:(e,t,n)=>{},24693:(e,t,n)=>{n.d(t,{DC:()=>s,UU:()=>a,mp:()=>o});n(84943);var i=n(80459);const s=e=>[i.ST,i.JL,i.yL,i.qB].some((t=>t(e)));const o=e=>{const t=/^[\s\n]*$/,n=e=>{if(e.nodeType===Node.TEXT_NODE){const n=e.textContent||"";if(!t.test(n))return!0}else if(e.nodeType===Node.ELEMENT_NODE&&e instanceof Element&&!s(e))for(const t of Array.from(e.childNodes))if(n(t))return!0;return!1};return n(e)};function a(e){return e.replaceAll(/[\n]\s*/g,"")}},97466:(e,t,n)=>{var i=n(14065),s=n(11855),o=n(75541),a=n(29019),l=n.n(a),r=n(57214),c=n(27527),d=n(34944),u=n(96638),m=n(44557),h=n(41354),p=n(39415),g=n(10633),_=n(35065),v=n(70593),f=n(62881),b=n(21559),x=n(77191),A=n(77591),y=n(47730);var w;const S=e=>{let t=e;return"zh-CN"===e&&(t="zh"),"es-ES"===e&&(t="es"),t};let j=0;class k{constructor(){var e=this;(0,g.A)(this,"isTranslating",!1),(0,g.A)(this,"id",0),(0,g.A)(this,"texts",[]),(0,g.A)(this,"translatePromise",void 0),(0,g.A)(this,"resolveTranslate",void 0),(0,g.A)(this,"translateFinished",!1),(0,g.A)(this,"startTime",void 0),(0,g.A)(this,"endTime",void 0),(0,g.A)(this,"addText",((e,t,n)=>{(void 0===this.startTime||this.startTime>t)&&(this.startTime=t);const i=t+n;(void 0===this.endTime||this.endTime<i)&&(this.endTime=i),this.texts.push(e);const s=40===this.texts.length?new k:this,o=this.texts.length-1,a=this.translatePromise.then((t=>[e,t[o]]));return this.triggerTranslate(),{nextThread:s,translateResult:a}})),(0,g.A)(this,"detectLang",(e=>e?new Promise((t=>{chrome.i18n.detectLanguage(e,(e=>{var n;const i=null==e||null===(n=e.languages[0])||void 0===n?void 0:n.language;t(S(i))}))})).catch((e=>"en")):"en")),(0,g.A)(this,"handleTranslateFinished",void 0),(0,g.A)(this,"onReady",(e=>{this.handleTranslateFinished=e})),(0,g.A)(this,"translate",(0,i.A)((function*(){const t="system"===k.translateTargetLang?S(chrome.i18n.getUILanguage()):k.translateTargetLang;if(0===e.texts.length)return yield(n=300,new Promise((e=>{setTimeout((()=>{e(!0)}),n)}))),e.translate();var n;const i=e.texts[0]+(e.texts[1]||"")+(e.texts[2]||"")+(e.texts[3]||"");var s,o;return(yield e.detectLang(i))===t?(null===(s=e.resolveTranslate)||void 0===s||s.call(e,e.texts),e.translateFinished=!0,void(null===(o=e.handleTranslateFinished)||void 0===o||o.call(e,e.id))):C(e.texts,t).then((t=>{var n,i;null===(n=e.resolveTranslate)||void 0===n||n.call(e,t),e.translateFinished=!0,null===(i=e.handleTranslateFinished)||void 0===i||i.call(e,e.id)})).catch((e=>{b.vF.persist.error({error:e})}))}))),(0,g.A)(this,"triggerTranslate",(()=>{this.isTranslating||(this.isTranslating=!0,k.doTheTranslate(this))})),this.id=j,j+=1,k.translateThreads.push(this),this.translatePromise=new Promise((e=>{this.resolveTranslate=e}))}}w=k,(0,g.A)(k,"translateTargetLang","system"),(0,g.A)(k,"onThreadReady",((e,t)=>{const n=w.translateThreads.find((t=>t.id===e));n&&n.onReady(t)})),(0,g.A)(k,"setTranslateTargetLang",(e=>{w.translateTargetLang=e})),(0,g.A)(k,"translateTasks",[]),(0,g.A)(k,"resetTranslateTasks",(()=>{w.translateTasks=[]})),(0,g.A)(k,"sortTranslateThreads",(e=>{const t=(0,v.A)(w.translateTasks,(t=>Boolean(t.startTime&&t.endTime&&t.startTime<=e&&e<=t.endTime)));if(t<=0)return;const n=w.translateTasks.splice(t);w.translateTasks=[...n,...w.translateTasks]})),(0,g.A)(k,"doTheTranslate",(e=>{w.translateTasks.push(e),w.loopTasks()})),(0,g.A)(k,"isLooping",!1),(0,g.A)(k,"loopTasks",(0,i.A)((function*(){if(!w.isLooping){for(;w.translateTasks.length>0;){w.isLooping=!0;const e=w.translateTasks.shift();e&&(yield e.translate())}w.isLooping=!1}}))),(0,g.A)(k,"translateThreads",[]),(0,g.A)(k,"findTranslateReady",(e=>{if(void 0===e||e<0)return!1;const{translateFinished:t}=w.translateThreads.find((t=>t.id===e))||{};return!!t}));const C=function(){var e=(0,i.A)((function*(e,t="zh"){const n=(0,f.xp)(t);if(void 0===n)return e;return(yield(0,x.Pt)(e,n)).items.map((e=>e.res))}));return function(t){return e.apply(this,arguments)}}();var I=n(29988),T=n(6601),N=n(71679),E=n(55388);const M=(e,t=3)=>e().catch((n=>{if(0===t)throw n;return M(e,t-1)}));const P=new class{constructor(){var e=this;(0,g.A)(this,"youtubeVideoManager",new T.q),(0,g.A)(this,"uiStore",void 0),(0,g.A)(this,"cursorOverVideo",!1),(0,g.A)(this,"currentSubtitle",void 0),(0,g.A)(this,"lastLang",void 0),(0,g.A)(this,"currentVideoId",""),(0,g.A)(this,"fetchingVideoId",""),(0,g.A)(this,"subtitleButtonContainer",null),(0,g.A)(this,"getVideoIdFromUrl",(()=>new URL(window.location.href).searchParams.get("v")||"")),(0,g.A)(this,"urlChangeHandler",(e=>{var t;const n=null==e||null===(t=e.detail)||void 0===t||null===(t=t.response)||void 0===t||null===(t=t.playerResponse)||void 0===t?void 0:t.videoDetails;if(this.currentVideoId=(null==n?void 0:n.videoId)||"",this.currentVideoId||(this.currentVideoId=this.getVideoIdFromUrl()),this.watchSettingLang(),this.currentVideoId){this.preloadSubtitles();try{I.A.get("autoTranslateSubtitles").then((e=>{e&&this.openBilingualSubtitle()}))}catch(i){}}})),(0,g.A)(this,"measureRightControls",(()=>{const e=document.querySelector(".ytp-right-controls");return e?e.getBoundingClientRect().height:0})),(0,g.A)(this,"computeButtonHeight",(()=>{var e,t;const{height:n}=(null===(e=this.subtitleButtonContainer)||void 0===e?void 0:e.getBoundingClientRect())||{height:0};null===(t=this.uiStore)||void 0===t||t.setButtonHeight(n)})),(0,g.A)(this,"pauseVideo",(()=>{this.youtubeVideoManager.pause()})),(0,g.A)(this,"computePopoverPosition",(()=>{var e,t;const{left:n}=(null===(e=this.subtitleButtonContainer)||void 0===e?void 0:e.getBoundingClientRect())||{left:0},{left:i}=this.youtubeVideoManager.getBoundingClientRect(),s=n-i+20,o=this.measureRightControls()+16-72;null===(t=this.uiStore)||void 0===t||t.setPopoverPosition({left:s,bottom:o})})),(0,g.A)(this,"preloadSubtitles",(()=>{this.fetchSubtitles()})),(0,g.A)(this,"fetchSubtitles",(0,i.A)((function*(){e.currentVideoId=e.currentVideoId||e.getVideoIdFromUrl();const t=e.getSubtitleLang();if(!e.currentVideoId)return;if(e.fetchingVideoId===e.currentVideoId&&e.lastLang===t)return;e.lastLang=t,e.fetchingVideoId=e.currentVideoId;const n=yield M((()=>(0,E.S)({videoID:e.currentVideoId,useUILang:!t,lang:t})),10),i=null==n?void 0:n.subtitles;var s;(i&&(e.currentSubtitle=i),e.currentVideoId===e.fetchingVideoId)&&(null===(s=e.uiStore)||void 0===s||s.setSubtitleReady(!0));return i}))),(0,g.A)(this,"restart",(()=>{this.reset(),this.fetchSubtitles()})),(0,g.A)(this,"reset",(()=>{var e,t;null===(e=this.uiStore)||void 0===e||e.setSubtitleReady(!1),this.stopWatchingSubtitles(),null===(t=this.uiStore)||void 0===t||t.setResetVideoUI((new Date).getTime()),k.resetTranslateTasks()})),(0,g.A)(this,"getCurrentSubtitles",(()=>this.currentSubtitle)),(0,g.A)(this,"setSubtitleButtonContainer",(e=>{this.subtitleButtonContainer=e})),(0,g.A)(this,"watchButtonPosition",(()=>{this.youtubeVideoManager.onVideoResizeHandler((()=>{this.computePopoverPosition(),this.computeButtonHeight()}))})),(0,g.A)(this,"watchCursorOverVideo",(()=>this.youtubeVideoManager.onCursorOverVideo((e=>{this.cursorOverVideo=e})))),(0,g.A)(this,"bindVideoOnclickHandler",this.youtubeVideoManager.bindVideoOnclickHandler),(0,g.A)(this,"onBottomVisibilityToggle",this.youtubeVideoManager.onBottomVisibilityToggle),(0,g.A)(this,"closeBilingualSubtitle",(()=>{(0,N.W)()})),(0,g.A)(this,"openBilingualSubtitle",(0,i.A)((function*(){(yield I.A.get("autoTranslateSubtitles"))&&((0,N.l)(),yield e.fetchSubtitles())}))),(0,g.A)(this,"reopenTranslate",(e=>{k.setTranslateTargetLang(e),this.openBilingualSubtitle()})),(0,g.A)(this,"stopWatchingSubtitles",(()=>{this.youtubeVideoManager.onTimeUpdated(null),this.youtubeVideoManager.onTimeJump(null)})),(0,g.A)(this,"watchCurrentSubtitle",((e,t)=>{if(null==e||!e.length||0===e.length)return;const n=this.currentVideoId;let i=e[0],s=e[1];this.youtubeVideoManager.onTimeUpdated((o=>{if(n!==this.currentVideoId)return;if(o>i.offset&&o<i.offset+i.duration)return;if(s&&o>=s.offset&&o<s.offset+s.duration)return t(s.text),i=s,void(s=e[e.indexOf(i)+1]);k.sortTranslateThreads(o);const a=e.find((e=>e.offset<=o&&o<e.offset+e.duration));a?(i=a,t(a.text)):t({threadId:-1,originalText:"",getTranslate:()=>Promise.resolve(["",""])})})),setTimeout((()=>{this.youtubeVideoManager.fireTimeUpdateEvent()}))})),(0,g.A)(this,"getSubtitleLang",(()=>{let e="en";const t=localStorage.getItem("yt-player-caption-sticky-language");if(t){const n=JSON.parse(t);e=(null==n?void 0:n.data)||""}return e})),(0,g.A)(this,"updateSubtitlesIfLangChange",(()=>{this.getSubtitleLang()!==this.lastLang&&this.restart()})),(0,g.A)(this,"watchSettingLang",(()=>{this.youtubeVideoManager.watchSettingChange(this.updateSubtitlesIfLangChange)})),(0,g.A)(this,"onVideoToggleFullscreen",this.youtubeVideoManager.onYoutubeToggleFullscreen),(0,g.A)(this,"makeSureOriginalSubtitleHide",(()=>{(0,N.l)()})),(0,g.A)(this,"onTimeJump",this.youtubeVideoManager.onTimeJump),(0,g.A)(this,"getCurrentVideoId",(()=>this.currentVideoId)),(0,g.A)(this,"toggleBilingualSubtitle",(0,i.A)((function*(){if(!e.cursorOverVideo)return;(0,A.TK)("autoTranslateSubtitles")?(e.closeBilingualSubtitle(),(0,A.vE)("autoTranslateSubtitles",!1)):(yield e.openBilingualSubtitle(),(0,A.vE)("autoTranslateSubtitles",!0))}))),(0,g.A)(this,"getIsCurrentSubtitle",(()=>this.cursorOverVideo)),this.urlChangeHandler(),"navigation"in window?window.navigation.addEventListener("navigate",(()=>{this.reset(),this.urlChangeHandler()})):window.addEventListener("yt-navigate-start",this.reset),window.addEventListener("yt-navigate-finish",this.urlChangeHandler),window.addEventListener("yt-navigate-cache",this.reset),this.uiStore=_.wT.getState()}};var L=n(79309),D=n(86855),R=n(66714),B=n(79724),O=n(66351);const U={"cici-ext-container":"cici-ext-container-ZXIrSN",ciciExtContainer:"cici-ext-container-ZXIrSN","inactivelink-hover-animation":"inactivelink-hover-animation-rw7qIp",inactivelinkHoverAnimation:"inactivelink-hover-animation-rw7qIp","notactivelink-hover-animation":"notactivelink-hover-animation-ybLE6S",notactivelinkHoverAnimation:"notactivelink-hover-animation-ybLE6S","light-click-animation":"light-click-animation-pnkngZ",lightClickAnimation:"light-click-animation-pnkngZ","click-animation":"click-animation-biWpBI",clickAnimation:"click-animation-biWpBI","semi-animation-rotate":"semi-animation-rotate-mQlH3b",semiAnimationRotate:"semi-animation-rotate-mQlH3b","inactive-btn-hover-animation":"inactive-btn-hover-animation-ryMlR1",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-ryMlR1","cici-ext-always-dark":"cici-ext-always-dark-Ms9LjO",ciciExtAlwaysDark:"cici-ext-always-dark-Ms9LjO","cici-ext-always-light":"cici-ext-always-light-RjPqkd",ciciExtAlwaysLight:"cici-ext-always-light-RjPqkd",ellipsis:"ellipsis-oS6yYX",container_mac:"container_mac-Zkbzgm",containerMac:"container_mac-Zkbzgm",container:"container-XWDV0F","action-container":"action-container-IZGz9g",actionContainer:"action-container-IZGz9g",actions:"actions-CriGMt",btnArea:"btnArea-SqnOyh",dropdownRight:"dropdownRight-kAsuSU",btnActive:"btnActive-bdZkh2",askBtn:"askBtn-LyFDUw",dropDown:"dropDown-coUCnI",dropItem:"dropItem-COx823",icon:"icon-edhNJn",name:"name-VSTPWY",divider:"divider-Og5Pde",extra:"extra-nu7DvO",closeBtnContainer:"closeBtnContainer-DOn6ux",closeBtn:"closeBtn-yuxJN3",closeBtnVisible:"closeBtnVisible-YjzwHn",closeBtnActive:"closeBtnActive-Lc6OPB",changeTone:"changeTone-lO7I5p","activelink-hover-animation":"activelink-hover-animation-UNXOi0",activelinkHoverAnimation:"activelink-hover-animation-UNXOi0"},F={"cici-ext-container":"cici-ext-container-rHktgd",ciciExtContainer:"cici-ext-container-rHktgd","inactivelink-hover-animation":"inactivelink-hover-animation-bsDtJw",inactivelinkHoverAnimation:"inactivelink-hover-animation-bsDtJw","notactivelink-hover-animation":"notactivelink-hover-animation-mWP6z9",notactivelinkHoverAnimation:"notactivelink-hover-animation-mWP6z9","light-click-animation":"light-click-animation-GPX_a3",lightClickAnimation:"light-click-animation-GPX_a3","click-animation":"click-animation-h3Ddrd",clickAnimation:"click-animation-h3Ddrd","semi-animation-rotate":"semi-animation-rotate-f09XQ1",semiAnimationRotate:"semi-animation-rotate-f09XQ1","inactive-btn-hover-animation":"inactive-btn-hover-animation-N6PjHc",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-N6PjHc","cici-ext-always-dark":"cici-ext-always-dark-_ihuvp",ciciExtAlwaysDark:"cici-ext-always-dark-_ihuvp","cici-ext-always-light":"cici-ext-always-light-jaQijK",ciciExtAlwaysLight:"cici-ext-always-light-jaQijK",ellipsis:"ellipsis-E3jYqE",configBtnContainer:"configBtnContainer-PyLLM0",isOpen:"isOpen-nUJVGv",configBtn:"configBtn-PHODxg",moreIconContainer:"moreIconContainer-O4DZxj",name:"name-rkPj8K",dropdownContainer:"dropdownContainer-sjKguw",dropdownItem:"dropdownItem-hFsOSP",moreArrow:"moreArrow-drLkaI","activelink-hover-animation":"activelink-hover-animation-PQUMN2",activelinkHoverAnimation:"activelink-hover-animation-PQUMN2"};var q=n(63159);const H=e=>{const t=e.size;return(0,q.jsx)(O.wv,{style:{fontSize:t}})},V=(0,p.jc)(),K=e=>{const t=(0,r.B)(),{selectBarOnlyIcon:n,getPopupContainer:i}=e,{inputText:s}=(0,D.t_)(),{audioStatus:o,togglePlay:a}=(0,L.$)(s),c=o.loading?R.L:o.playing?B.d:H;let m;const h=t("flow_web_ext_tts_start","\u5f00\u59cb\u6717\u8bfb"),p=t("flow_web_ext_tts_stop","\u505c\u6b62\u6717\u8bfb");m=n?o.loading||o.playing?p:h:o.loading||o.playing?p:void 0,V&&(m=void 0);const g=(0,q.jsx)(d.$n,{className:l()(U.btnArea,{[U.btn_area_mac]:V}),onPointerUp:a,icon:(0,q.jsx)(c,{size:16}),"data-testid":`select-bar-${u.EU.pronounce}-action`,children:!n&&(0,q.jsx)("span",{className:l()(U.name,{[U.isCustomkill]:!0}),children:"\u6717\u8bfb"})});return(0,q.jsx)("div",{children:m?(0,q.jsx)(d.m_,{content:m,spacing:16,getPopupContainer:i,children:g}):g},u.EU.pronounce)},z=()=>{const{inputText:e}=(0,D.t_)(),{audioStatus:t,togglePlay:n}=(0,L.$)(e),i=t.loading?R.L:t.playing?B.d:H;return(0,q.jsxs)(d.ms.Item,{onClick:e=>{e.preventDefault(),e.stopPropagation(),n()},"data-testid":`select-bar-more-${u.EU.pronounce}-action`,className:F.dropdownItem,children:[(0,q.jsx)("div",{className:l()(F.moreIconContainer,"menu-item-icon"),children:(0,q.jsx)(i,{size:16})}),(0,q.jsx)("span",{className:l()(F.name,"menu-item-name"),children:"\u6717\u8bfb"})]},u.EU.pronounce)};var G=n(45041),$=n(20309),W=n(97946);const Y={};function Q(){const e="zh",[t,n]=(0,s.useState)();return(0,s.useEffect)((()=>{Y[e]||(Y[e]=(0,x.M$)(e)),Y[e].then((e=>{var t;return n(null==e||null===(t=e.input_config)||void 0===t?void 0:t.write_assistant)})).catch((()=>{delete Y[e]}))}),[e]),t}function Z(e,t,n){const i=n=>{var i;const s=null===(i=n.composedPath)||void 0===i?void 0:i.call(n);s&&!t.some((e=>!!e.current&&s.includes(e.current)))&&e()};return(0,s.useEffect)((()=>(document.addEventListener("pointerdown",i),()=>{document.removeEventListener("pointerdown",i)})),[...t,...n||[]]),t}function X(e){var t;const{getPopupContainer:n,onItemClick:i}=e,o=(0,r.B)(),a=Q(),c=(null==a||null===(t=a.compose)||void 0===t?void 0:t.tone)||[],[u,m]=(0,s.useState)(!1),h=(0,s.useRef)(null),p=(0,s.useRef)(null);return Z((()=>{m(!1)}),[h,p]),(0,q.jsx)("div",{className:U.changeTone,children:(0,q.jsx)(d.ms,{className:F.dropdownContainer,spacing:2,trigger:"custom",visible:u,getPopupContainer:n,render:(0,q.jsx)("div",{ref:h,children:(0,q.jsx)(d.ms.Menu,{children:c.map(((e,t)=>(0,q.jsx)(d.ms.Item,{className:F.dropdownItem,"data-testid":`writing-change-tone-${t}`,onClick:t=>{e.value&&i(e,t)},children:e.show_name},e.value)))})}),children:(0,q.jsx)("div",{ref:p,children:(0,q.jsxs)(d.$n,{"data-testid":e["data-testid"],onClick:()=>{m(!u)},className:l()(U.btnArea,{[U.btnActive]:u}),icon:(0,q.jsx)(G.A,{}),children:[(0,q.jsx)("span",{children:o("modify_change_tone")}),(0,q.jsx)("span",{className:U.dropdownRight,children:u?(0,q.jsx)($.A,{}):(0,q.jsx)(W.A,{})})]})})})})}var J=n(4252),ee=n(64123),te=n(10242);const ne=e=>{const[t,n]=(0,y.Y)("shortcutsConfig"),i=t[e]||te.A[e];return{shortcutKey:i.key,setShortcutKey:s=>{n(Object.assign(t,{[e]:(0,m.A)((0,m.A)({},i),{},{key:s})}))}}},ie=(0,p.jc)();function se(e){const{item:t,selectBarOnlyIcon:n,onClick:i,getPopupContainer:s}=e,o=(0,r.B)(),a=(0,u.em)(t.id),c=t.id===u.EU.ask,{shortcutKey:m}=ne(J.e.OpenSide);if(t.id===u.EU.pronounce)return(0,q.jsx)(K,{selectBarOnlyIcon:n,getPopupContainer:s});if(t.id===u.EU.adjust_skill)return(0,q.jsx)(X,{"data-testid":`select-bar-${t.id}-action`,onItemClick:(e,n)=>{D.t_.getState().setTone(e),i(t,n)},getPopupContainer:s});const h=(0,q.jsx)(d.$n,{className:l()(U.btnArea,{[U.btn_area_mac]:ie}),onPointerUp:e=>i(t,e),icon:(0,O.I)(t.icon),"data-testid":`select-bar-${t.id}-action`,children:!n&&(0,q.jsx)("span",{className:l()(U.name,{[U.isCustomSkill]:a}),children:o(t.name,t.options)})}),p=(n||c)&&!ie,g=p?(e=>{let t="";return n?(t=o(e),c&&m&&(t+=` (${(0,ee.o)(m)})`),t):(c&&m&&(t=(0,ee.o)(m)),t)})(t.name):"";return(0,q.jsx)("div",{children:p&&g?(0,q.jsx)(d.m_,{content:g,spacing:16,getPopupContainer:s,children:h}):h},t.id)}var oe=n(30020),ae=n(14411),le=n(68692),re=n(27658),ce=n(12038),de=n(56397);const ue=({button_name:e,show_from:t,isSubtitle:n})=>{(0,ce.z8)(de.Ur.showSelectAssistantBtn,{button_name:e,show_from:t,is_subtitle:n?1:0})},me=({button_name:e,click_from:t=de.Z5.selectAssistantMenu,isSubtitle:n})=>{(0,ce.z8)(de.Ur.clickSelectAssistantMenuBtn,{button_name:e,click_from:t,is_subtitle:n?1:0})};var he=n(36700),pe=n(64353),ge=n(48485),_e=n(59585),ve=n.n(_e),fe=n(58447),be=n(10484),xe=n(45577),Ae=n(5842),ye=n(15965),we=n(44969);n(80160);const Se=(e,t="",n=512)=>{var i;const s=null!==(i=e.split(",")[1])&&void 0!==i?i:e,o=atob(s),a=[];for(let l=0;l<o.length;l+=n){const e=o.slice(l,l+n),t=new Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);const i=new Uint8Array(t);a.push(i)}return new Blob(a,{type:t})},je=e=>e.startsWith("video/");var ke=n(38523),Ce=n(23362);window.location.href,window.location.href;const Ie=e=>/^https:\/\/www\.xiaoyuzhoufm\.com\/episode\/\w+/.test(e),Te=()=>{const e=document.querySelector("embed");return"EMBED"===(null==e?void 0:e.nodeName)&&"application/pdf"===(null==e?void 0:e.type)},Ne=e=>(e=>/^https:\/\/arxiv\.org\/abs\/\d+\.\d+/.test(e))(e)?{name:"arxiv",prevNodeQuery:"a.download-pdf"}:Te()?{name:"pdf"}:null;var Ee=n(2573),Me=n(13464),Pe=n(89124),Le=n(64802),De=n(98767),Re=n(13162),Be=n(67976),Oe=n(67685),Ue=n(3310),Fe=n(23835),qe=n(60296),He=n(5099),Ve=n(88090),Ke=n(98847),ze=n(98830),Ge=n(77259),$e=n(16409),We=n(70405);const Ye=new Map;function Qe(e){var t;return{id:-1,tags:[],language:null!==(t=(0,Ve.wz)((0,A.TK)("uiLanguage")))&&void 0!==t?t:navigator.language,collection_type:e,source_url:location.href}}function Ze(e){return Xe.apply(this,arguments)}function Xe(){return(Xe=(0,i.A)((function*(e){const t=yield(0,We.S6)({method:"POST",url:`${Oe.kD}/collection/create`,data:e});if(t instanceof Error)throw t;return t}))).apply(this,arguments)}function Je(e,t){return et.apply(this,arguments)}function et(){return(et=(0,i.A)((function*(e,t){const n=t?`${t}`:void 0,i={collection:(0,m.A)((0,m.A)({},Qe(ke.e.TextFragment)),{},{parent_collection_id:n,text_fragment:{ctx_text:e.contextText,selection_text:e.selectionText,anchor_offset:e.anchorOffset,selection_context:e.selectionContext}})};return yield Ze(i)}))).apply(this,arguments)}function tt(){return(tt=(0,i.A)((function*(e,t,n){const i=n?`${n}`:void 0,s={collection:(0,m.A)((0,m.A)({},Qe(ke.e.TranslateResult)),{},{summary:t.translatedText,summary_msg_id_str:e,parent_collection_id:i,translate_result:{selection_text:t.selectionText,translate_language:t.translate_lang,translate_service:t.translate_service,dict:t.dict,selection_context:t.selectionContext}})};return yield Ze(s)}))).apply(this,arguments)}function nt(){return(nt=(0,i.A)((function*(e,t,n){const i=n?`${n}`:void 0,s={collection:(0,m.A)((0,m.A)({},Qe(ke.e.ExplainResult)),{},{summary:t.explainedText,summary_msg_id_str:e,parent_collection_id:i,explain_result:{selection_text:t.selectionText,selection_context:t.selectionContext}})};return yield Ze(s)}))).apply(this,arguments)}function it(){return(it=(0,i.A)((function*(e,t,n){const i=n?`${n}`:void 0,s={collection:(0,m.A)((0,m.A)({},Qe(ke.e.CustomSkillResult)),{},{parent_collection_id:i,summary:t.result_text,summary_msg_id_str:e,custom_skill_result:t})};return yield Ze(s)}))).apply(this,arguments)}function st(){return(st=(0,i.A)((function*(e,t){const n={collection:(0,m.A)((0,m.A)({},Qe(ke.e.SearchResult)),{},{summary:t.generatedText,summary_msg_id_str:e,search_result:{search_text:t.searchText}})};return yield Ze(n)}))).apply(this,arguments)}function ot(){return ot=(0,i.A)((function*(e,t,n){const i={collection:(0,m.A)((0,m.A)({},Qe(ke.e.Web)),{},{fingerprint:t,web:(0,m.A)({},e)})};if(n&&(i.collection.source_url=n),!t)return yield Ze(i);const s=Ye.get(t);if(s)return s;const o=new Promise(((e,t)=>Ze(i).then(e).catch(t))).finally((()=>Ye.delete(t)));return Ye.set(t,o),o})),ot.apply(this,arguments)}function at(){return at=(0,i.A)((function*(e){const t={collection:(0,m.A)((0,m.A)({},Qe(ke.e.Pdf)),{},{fingerprint:yield(0,ze.K)(ke.e.Pdf),pdf:e})};return yield Ze(t)})),at.apply(this,arguments)}function lt(){return(lt=(0,i.A)((function*(e,t){const n={collection:(0,m.A)((0,m.A)({},Qe(ke.e.SocialWebCard)),{},{social_web_card:e})};return t&&(n.collection.source_url=t),yield Ze(n)}))).apply(this,arguments)}function rt(){return rt=(0,i.A)((function*(e,t,n,i){const s=yield(0,ze.K)(ke.e.VideoSummary),o=n.transcript?yield(0,Ke.xj)():void 0,a={collection:(0,m.A)((0,m.A)({},Qe(ke.e.VideoSummary)),{},{fingerprint:s,summary:e,memos:i,summary_msg_id_str:t||void 0,video_summary:(0,m.A)((0,m.A)({},n),{},{video_shots:o})})},l=Ye.get(s);if(l)return l;const r=new Promise(((e,t)=>Ze(a).then(e).catch(t))).finally((()=>Ye.delete(s)));return Ye.set(s,r),r})),rt.apply(this,arguments)}function ct(e){return dt.apply(this,arguments)}function dt(){return(dt=(0,i.A)((function*(e){if(!(0,A.TK)("authInfo").isAuthenticated)return;const t=yield(0,We.S6)({method:"GET",url:`${Oe.kD}/collection/fingerprint/get/${e}`,preventDefaultAuthAction:!0});return t instanceof Error||null==t?void 0:t.id}))).apply(this,arguments)}function ut(){return(ut=(0,i.A)((function*(e){const t={id:`${e.id}`,data:{summary:e.summary,summary_msg_id:e.summary_msg_id,video_summary:{timeline:e.timeline}}},n=yield(0,We.S6)({method:"POST",url:`${Oe.kD}/collection/update`,data:t});if(n instanceof Error)throw n;return{id:`${e.id}`}}))).apply(this,arguments)}function mt(){return(mt=(0,i.A)((function*(e){const t={id:`${e.id}`,data:{summary:e.summary,summary_msg_id:e.summary_msg_id,podcast_summary:{timeline:e.timeline}}},n=yield(0,We.S6)({method:"POST",url:`${Oe.kD}/collection/update`,data:t});if(n instanceof Error)throw n;return{id:`${e.id}`}}))).apply(this,arguments)}function ht(){return ht=(0,i.A)((function*(e){const t=yield(0,ze.K)(ke.e.PodcastSummary);e.podcastParams.cover_file_token||(e.podcastParams.cover_file_token="");const n=yield e.getHtmlContent(),i={collection:(0,m.A)((0,m.A)({},Qe(ke.e.PodcastSummary)),{},{fingerprint:t,summary:e.summary,summary_msg_id_str:e.summary_msg_id||void 0,memos:e.memos,podcast_summary:(0,m.A)((0,m.A)({},e.podcastParams),{},{html_content:n})})},s=Ye.get(t);if(s)return s;const o=new Promise(((e,t)=>Ze(i).then(e).catch(t))).finally((()=>Ye.delete(t)));return Ye.set(t,o),o})),ht.apply(this,arguments)}function pt(){return pt=(0,i.A)((function*(e){var t;const n=yield(0,ze.K)(ke.e.Image,e.url);let i="";const s=yield(0,De.n_)(e.url);if(null!=s&&s.blob){i=yield(0,Re.r)(s.blob)}const o={collection:(0,m.A)((0,m.A)({},Qe(ke.e.Image)),{},{fingerprint:n,image:(0,m.A)((0,m.A)({},null!==(t=e.url)&&void 0!==t&&t.startsWith("data")?(0,He.A)(e,["url"]):e),{},{file_token:i})})},a=Ye.get(n);if(a)return a;const l=new Promise(((e,t)=>Ze(o).then(e).catch(t))).finally((()=>Ye.delete(n)));return Ye.set(n,l),l})),pt.apply(this,arguments)}var gt=n(52833);let _t=function(e){return e.recommendVideo="recommendvideo_list_click",e.playNext="next_button",e.recommendVideoEnding="recommendvideo_ending_click",e}({});const vt=new class{constructor(){(0,g.A)(this,"_isImmersionMode",!1),(0,g.A)(this,"_lastEntryFullScreenFrom",void 0),(0,g.A)(this,"_shouldSummaryVideoDefault",!1),(0,g.A)(this,"_lastRelayBtnType",_t.playNext),(0,g.A)(this,"_lastRelayBtnTime",Date.now()),(0,g.A)(this,"_currentTranscript",void 0),(0,g.A)(this,"_videoSummaryMsgBlock",{}),(0,g.A)(this,"_moduleClickFrom",void 0)}isImmersionMode(){return this._isImmersionMode}setImmersionMode(e){this._isImmersionMode=e}getLastEntryFullScreenFrom(){return this._lastEntryFullScreenFrom}updateEntryFullScreenFrom(e){this._lastEntryFullScreenFrom=e}updateTranscriptData(e){if(this._currentTranscript=e,null!=e&&e.length){const t=(0,Be.qf)(e||[]);setTimeout((()=>{gt.on.getState().updateWebContext({type:gt.e6.videoTranscript,content:t})}),1e3)}else gt.on.getState().updateWebContext({type:gt.e6.default,content:""})}getTranscriptData(){return this._currentTranscript}hasTranscript(){var e;return Boolean(null===(e=this._currentTranscript)||void 0===e?void 0:e.length)}shouldSummaryVideoDefault(){return this._shouldSummaryVideoDefault}updateShouldSummaryVideoDefault(e){this._shouldSummaryVideoDefault=e}getLastClickRelayBtnType(){return this._lastRelayBtnType}recordClickRelayBtnType(e){this._lastRelayBtnType=e,this._lastRelayBtnTime=Date.now()}resetClickRelayBtnType(e){if(e)return this._lastRelayBtnType=_t.playNext,void(this._lastRelayBtnTime=Date.now());Date.now()-this._lastRelayBtnTime>1e4&&(this._lastRelayBtnType=_t.playNext,this._lastRelayBtnTime=Date.now())}updateVideoSummaryId(e){this._videoSummaryMsgBlock.videoSummaryId=e}getVideoSummaryMsgBlock(){return this._videoSummaryMsgBlock}updateModuleClickFrom(e){this._moduleClickFrom||(this._moduleClickFrom=e)}getModuleClickFrom(){return this._moduleClickFrom}resetVideoSummaryStatus(){this._moduleClickFrom=void 0,this.updateTranscriptData(),this.updateVideoSummaryId()}};var ft=n(9216),bt=n(48869),xt=n(51402),At=n(41967),yt=n(2633),wt=n(19730),St=(n(36897),n(6918));const jt=e=>{if("string"==typeof e)try{const t=JSON.parse(e);return!("object"!=typeof t||!t)}catch(t){return!1}return!1},kt=e=>{var t;if(!jt(e))return"";const n=JSON.parse(e);return null==n||null===(t=n.filter((e=>Ct(null==e?void 0:e.timestamp)&&e.chapter)))||void 0===t?void 0:t.map((e=>{var t;const n=e.chapter,i=e.timestamp/1e3;if(e.bullet_points&&(null===(t=e.bullet_points)||void 0===t?void 0:t.length)>0){const t=e.bullet_points.filter((e=>Ct(null==e?void 0:e.timestamp)&&e.point)),s=(0,xt.A)(t,(e=>(0,m.A)((0,m.A)({},e),{},{timestamp:e.timestamp/1e3}))),o=(0,bt.A)(s,"timestamp",["asc"]);return(0,m.A)((0,m.A)({},e),{},{section:n,timestamp:i,bullet_points:o})}return(0,m.A)((0,m.A)({},e),{},{section:n,timestamp:i})}))},Ct=e=>Number(e)>=0;function It(){return/youtube/.test(location.hostname)?"youtube":/bilibili/.test(location.hostname)?"bilibili":"youtube"}function Tt(e){return Nt.apply(this,arguments)}function Nt(){return(Nt=(0,i.A)((function*(e){const t=It();let n=window.location.href;return"bilibili"===t&&(n=yield(0,ft.Z)(e)),n}))).apply(this,arguments)}function Et(e){return"bilibili"===It()?(()=>{const e=document.querySelector("#wxwork-share-pic");if(!e)return"";const t=e.getAttribute("src");if(!t)return"";const n=t.lastIndexOf("@");return n<=0?"":`https:${t.slice(0,n)}`})():(e=>`https://img.youtube.com/vi/${e}/maxresdefault.jpg`)(e)}const Mt=e=>{let t=[];return(0,wt.A)(e,(e=>{if(-5===e.type){const n=(0,St.O)(e.info,{}).final;(0,yt.A)(n.section)||(t=n.section);const i=n.timeline;(0,wt.A)(i,(e=>{(0,At.A)(null==e?void 0:e.section_index)&&!t[e.section_index].bullet_points&&(t[e.section_index].bullet_points=e.bullet_points,t[e.section_index].tags=e.tags)}))}})),JSON.stringify(t)};function Pt(){const e=document.querySelector("#danmukuBox .fake-danmaku");return Boolean(e)}var Lt=n(69456);const Dt=new Map;new Set;function Rt(){return Rt=(0,i.A)((function*(e,t,n){const i=Dt.get(e);if(i)return i;const s=yield(0,We.S6)({method:"POST",url:`${Oe.C1}/samantha/plugin/podcast/transcript`,data:{url:e,type:t,resource_url:n}});return"success"===(null==s?void 0:s.status)&&Dt.set(e,s),s})),Rt.apply(this,arguments)}var Bt=n(23427),Ot=n(42101),Ut=n(21811),Ft=n(75943),qt=n(17411),Ht=n(80459),Vt=n(10895);const Kt=d.EY.create();function zt(){return`popup-${Ft.m.getInstance().getHostId()}`}function Gt(e){const t=zt(),n=document.getElementById(t);n&&e.prepend(n)}const $t=e=>{const t=zt();let n=document.getElementById(t);if(n)return null==e||e(),()=>{var e;return(null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body"))||document.body};n=document.createElement("div"),n.style.width="0",n.style.height="0",n.style.position="absolute",n.id=t,n.style.zIndex="200000";const i=n.attachShadow({mode:"open"}),s=document.createElement("body");s.classList.add("cici-ext-container"),i.appendChild(s),document.body.prepend(n),Kt.config({getPopupContainer:()=>{var e;const n=null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body");return setTimeout((()=>{const e=null==n?void 0:n.querySelector('div.semi-toast-wrapper[id^="toast"]');e&&(e.id=`_${e.id}`)})),n||document.body}});const o=()=>{document.fullscreenElement?Gt(document.fullscreenElement):Gt(document.body)};return document.addEventListener("fullscreenchange",o),(0,Ht.NR)(i,we.QN).finally((()=>null==e?void 0:e())),(0,Ft.A)((()=>{var e;document.removeEventListener("fullscreenchange",o),null===(e=document.getElementById(t))||void 0===e||e.remove()})),()=>{var e;return(null===(e=document.getElementById(t))||void 0===e||null===(e=e.shadowRoot)||void 0===e?void 0:e.querySelector("body"))||document.body}},Wt=e=>{const t=(0,qt.Uk)(),n=(0,s.useCallback)((()=>{window.open(e.infoUrl)}),[e]);return(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)("div",{className:l()(Vt.A.toastContainer),"data-testid":"collect-toast-success",children:[(0,q.jsx)("div",{className:l()(Vt.A.text),children:t("flow_web_ext_bookmarks_saved")}),(0,q.jsx)("div",{className:l()(Vt.A.linkToInfo),onClick:n,children:t("flow_web_ext_bookmarks_saved_view")})]})})},Yt=()=>{const e=(0,qt.Uk)();return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)("div",{className:l()(Vt.A.toastContainer),"data-testid":"collect-toast-loading",children:(0,q.jsx)("div",{className:l()(Vt.A.loadingText),children:e("flow_web_ext_bookmarks_saving")})})})},Qt=()=>{const e=(0,qt.Uk)();return(0,q.jsx)(q.Fragment,{children:(0,q.jsx)("div",{className:l()(Vt.A.toastContainer),children:(0,q.jsx)("div",{className:l()(Vt.A.errorText),children:e("flow_web_ext_bookmarks_failed")})})})};function Zt(){const e={content:(0,q.jsx)(Yt,{}),duration:0,showClose:!1,className:l()(Vt.A.toastLoadingCard),stack:!1,icon:(0,q.jsx)(d.tK,{}),id:"1",zIndex:99999};Kt.close("1"),$t((()=>Kt.info(e)))}function Xt(e,t){return Zt(),e().then((e=>(function(e){const t={content:(0,q.jsx)(Wt,{infoUrl:e.infoUrl}),duration:3,showClose:!1,className:l()(Vt.A.toastCard),stack:!1,id:"2",zIndex:99999};Kt.close("1"),$t((()=>Kt.success(t)))}({infoUrl:t(e)}),e))).catch((e=>(b.vF.persist.error({eventName:"\u6536\u85cf\u5185\u5bb9\u5931\u8d25\uff01",error:e}),function(){const e={content:(0,q.jsx)(Qt,{}),duration:3,showClose:!1,className:l()(Vt.A.toastErrorCard),stack:!1,id:"3",zIndex:99999};Kt.close("1"),$t((()=>Kt.error(e)))}(),e)))}function Jt(e){if((0,A.TK)("authInfo").isAuthenticated)switch(e.collectionType){case Ue.X.TranslateResult:case Ue.X.ExplainResult:case Ue.X.TextFragment:case Ue.X.CustomSkillResult:!function(e){en.apply(this,arguments)}(e);break;case Ue.X.SearchResult:!function(e){const t=e.messageId;if(void 0===t||void 0===e.localMessageId)return;(0,he.o2)(e.collectFrom,he.p6.searchresult);const n=qe.P.getState().messages[e.localMessageId],{text:i=""}=n||{},s={searchText:e.userInput||"",generatedText:i};Xt((()=>function(e,t){return st.apply(this,arguments)}(t,s)),(e=>`${Oe.Vl}/${e.id}`)).then((t=>{var n;Ee.A.emit("onWebpageSaved",t.id),null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.searchresult,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.searchresult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e);break;case Ue.X.Web:on(e);break;case Ue.X.Pdf:an(e);break;case Ue.X.VideoSummary:cn(e);break;case Ue.X.SocialWebCard:!function(e){const{getSocialWebCardContent:t}=e;if(!t)return;(0,he.o2)(e.collectFrom,he.p6.web),Xt((0,i.A)((function*(){const e=yield t();if(!e)throw new Error("\u83b7\u53d6\u793e\u4ea4\u5361\u7247\u6536\u85cf\u4fe1\u606f\u51fa\u9519");const{text_content:n,html_content:i,cover_image_url:s="",source_url:o,content_height:a,content_width:l,body_content:r,content_img_key:c=""}=e,d=yield function(e,t){return lt.apply(this,arguments)}({text_content:n,html_content:(0,Me.NS)(i,a,l),cover_image_url:s,body_content:r.substr(0,500),content_img_key:c},o);return d})),(e=>dn(e.id.toString()))).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.web,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.web)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e);break;case Ue.X.PodcastSummary:un(e);break;case Ue.X.Image:!function(e){const{image_result:t,collectType:n,collectFrom:s}=e;if(!t)return;(0,he.o2)(s,n||he.p6.Image),Xt((0,i.A)((function*(){return yield function(e){return pt.apply(this,arguments)}(t)})),(e=>dn(e.id.toString()))).then((t=>{var i;t.id&&(null===(i=e.onSuccess)||void 0===i||i.call(e,t.id)),(0,he.mL)(s,void 0!==t.id,n||he.p6.Image,`${t.id}`)})).catch((()=>{(0,he.mL)(s,!1,n||he.p6.Image)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e)}else(0,Ut.DT)({trackMeta:{previous_page:"web",login_entrance:"web"}})}function en(){return en=(0,i.A)((function*(e){const t=(D.t_.getState().simpleSelectionBaseInfo||{}).selectContext,{actionMessages:n,currentAction:s,messageCursor:o,boxVisible:a}=D.t_.getState();if(e.ocr_result)return function(e){const{ocr_result:t}=e;if(!t)return;(0,he.o2)(e.collectFrom,he.p6.ExtractText),Xt((()=>Je({contextText:"",selectionText:t.text,anchorOffset:0})),(e=>`${Oe.Vl}/${e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.ExtractText,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.ExtractText)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e);const l=yield ct(yield(0,ze.K)(ke.e.Web));if(a){var r,c,d;const{messages:a}=qe.P.getState(),m=null!==(c=(null!==(r=n[s])&&void 0!==r?r:[])[o])&&void 0!==c?c:"",{text:h="",body:p,originParam:g}=a[m]||{};if(void 0===(null==p||null===(d=p.message)||void 0===d?void 0:d.message_id))return;s===u.EU.explain?((0,he.o2)(e.collectFrom,he.p6.ExplainResult),Xt((0,i.A)((function*(){return function(e,t,n){return nt.apply(this,arguments)}(p.message.message_id,{selectionText:(null==g?void 0:g.text)||"",explainedText:(0,Le.q4)(h),selectionContext:t},l)})),(e=>`${Oe.Vl}/${l?`${l}?mark_child=${e.id}`:e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.ExplainResult,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.ExplainResult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))):s===u.EU.translate?((0,he.o2)(e.collectFrom,he.p6.TranslateResult),Xt((0,i.A)((function*(){var n,i,s;return function(e,t,n){return tt.apply(this,arguments)}(p.message.message_id,{selectionText:(null==g?void 0:g.text)||"",translate_lang:(null==p||null===(n=p.message)||void 0===n||null===(n=n.ext)||void 0===n?void 0:n.translate)||(0,Be.XQ)(),translatedText:(0,Le.q4)(h),translate_service:null===(i=e.translate_result)||void 0===i?void 0:i.translate_service,dict:null===(s=e.translate_result)||void 0===s?void 0:s.dict,selectionContext:t},l)})),(e=>`${Oe.Vl}/${l?`${l}?mark_child=${e.id}`:e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.TranslateResult,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.TranslateResult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))):function(e,t){var n,s,o;const{actionMessages:a,currentAction:l,messageCursor:r,simpleSelectionBaseInfo:{selectContext:c}}=D.t_.getState(),{messages:d}=qe.P.getState(),m=null!==(n=a[l])&&void 0!==n?n:[],h=null!==(s=m[r])&&void 0!==s?s:"",{text:p="",body:g,originParam:_}=d[h]||{};if(void 0===(null==g||null===(o=g.message)||void 0===o?void 0:o.message_id))return;(0,he.o2)(he.vP.highlight_result_card_custom_skill,he.p6.CustomSkillResult);const v=tn(l);if(!v)return;const f=Boolean(v.confId);Xt((0,i.A)((function*(){return function(e,t,n){return it.apply(this,arguments)}(g.message.message_id,{selection_text:(null==_?void 0:_.text)||"",result_text:(0,Le.q4)(p),skill_name:v.name,icon_key:f?"":v.icon,icon_url:f?v.icon:"",is_discover_skill:(0,u._8)(v.id)||f,selection_context:c},t)})),(e=>dn(`${t?`${t}?mark_child=${e.id}`:e.id}`))).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(he.vP.highlight_result_card_custom_skill,void 0!==t.id,he.p6.CustomSkillResult,`${t.id}`)})).catch((()=>{(0,he.mL)(he.vP.highlight_result_card_custom_skill,!1,he.p6.CustomSkillResult)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e,l)}else!function(e,t){const n=D.t_.getState().simpleSelectionBaseInfo;if(void 0===n.anchorOffset)return;const i=n.selectContext,s={contextText:n.contextText,selectionText:n.text,anchorOffset:n.anchorOffset,selectionContext:i};Xt((()=>Je(s,t)),(e=>`${Oe.Vl}/${t?`${t}?mark_child=${e.id}`:e.id}`)).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.textfragment,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.textfragment)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}(e,l)})),en.apply(this,arguments)}const tn=e=>{const t=(0,A.TK)("readingPopupActions"),n=(0,A.TK)("editingPopupActions");return t.actionList.find((t=>t.id===e))||t.moreActionList.find((t=>t.id===e))||n.actionList.find((t=>t.id===e))||n.moreActionList.find((t=>t.id===e))};const nn=function(){var e=(0,i.A)((function*(){try{if(Ie(location.href)){var e,t;const n=Bt.x.getStatus(),{summaryId:i,podcastType:s,coverUrl:o,audioUrl:a,title:l,duration:r,summaryStatus:c}=n;if("xiaoyuzhou"!==s||!a||c===Ot.t.exceedSizeFailed||c===Ot.t.commonFailed)return;let{transcript:d}=n;if(!d){const e=yield function(e,t,n){return Rt.apply(this,arguments)}(location.href,s);if("success"!==e.status||!e.transcript)return!1;d=e.transcript,Bt.x.setVideoSummaryStatus({transcript:e.transcript})}Zt();const{messages:u}=qe.P.getState();let m="",h="";const{isDone:p,text:g=""}=u[i||""]||{},_=(null===(e=u[i||""])||void 0===e||null===(e=e.body)||void 0===e||null===(e=e.message)||void 0===e?void 0:e.meta_infos)||[],v=Mt(_);m=g,h=kt(v);const f=i&&p&&(null===(t=u[i])||void 0===t||null===(t=t.body)||void 0===t||null===(t=t.message)||void 0===t?void 0:t.message_id)||"";return un({collectFrom:he.vP.podcast_collect,collectionType:ke.e.PodcastSummary,podcastSummaryResult:{summary:m,summary_msg_id:f||"",podcastParams:{podcast_type:s,audio_url:a,title:l||"",timeline:h||[],cover_url:o||"",transcript:d?JSON.stringify(d):"",podcast_duration:r||"",theme_color:(0,Lt.lE)(s)},getHtmlContent:Bt.x.getHtmlContentFunc()}}),!0}}catch(n){return!1}return!1}));return function(){return e.apply(this,arguments)}}(),sn=e=>{if(/youtube/.test(location.hostname)?location.pathname.startsWith("/watch"):/bilibili/.test(location.hostname)&&location.pathname.startsWith("/video/"))return rn(e),!0;if(/bilibili/.test(location.hostname)&&location.pathname.startsWith("/festival/")){const t=new URL(location.href),{setVideoId:n,setVideoTitle:i}=Fe.e.getState(),s=t.searchParams.get("bvid");return n(s||""),i(document.title),vt.updateVideoSummaryId(""),s?(0,ft.S)({videoId:s}).then((e=>vt.updateTranscriptData.bind(vt)(e.subtitles))).finally((()=>rn(e))):rn(e),!0}return!1},on=function(){var e=(0,i.A)((function*(e){(0,he.o2)(e.collectFrom,he.p6.web);if((yield nn())||sn(e))return;if((()=>{const e=(0,Ce.Ay)(location.href);return e&&(Zt(),Ee.A.emit("trigger-search-assistant-summary"),setTimeout((()=>Ee.A.emit("trigger-search-assistant-collection")),500)),Boolean(e)})())return;const t={text_content:"",html_content:"",title:"",dir:"",description:"",cover_image_url:"",cover_file_token:""};let n;if(e.getWebContent||(n=yield(0,Pe.q)(document),n))Xt((0,i.A)((function*(){let i,s;if(e.getWebContent){const n=yield e.getWebContent();if(!n)throw new Error("\u83b7\u53d6\u7f51\u7ad9\u6536\u85cf\u4fe1\u606f\u51fa\u9519");t.text_content=n.text_content,t.html_content=(0,Me.NS)(n.html_content,n.content_height,n.content_width),t.title=n.title,t.dir=n.dir,t.cover_image_url=n.cover_image_url,t.description=n.description,i=n.source_url}else if(n){const{imageUrl:e,desc:i}=(0,Ut.l_)();t.text_content=n.textContent,t.html_content=n.content,t.title=n.title,t.dir=n.dir,t.cover_image_url=e,t.description=i}if(t.cover_image_url)try{const e=(yield(0,De.n_)(t.cover_image_url)).blob;t.cover_file_token=yield(0,Re.r)(e)}catch(l){t.cover_image_url="",b.vF.persist.error({eventName:"\u83b7\u53d6\u5c01\u9762\u5931\u8d25\uff01",error:l})}s=yield(0,ze.K)(ke.e.Web,t.text_content);const o=Se(yield function(e=!0){return new Promise(((t,n)=>{const i=Ge.j.getAssistantContainer(),{display:s}=(null==i?void 0:i.style)||{};let o;e&&i&&(i.style.display="none",o=setTimeout((()=>{i.style.display=s,o=void 0}),2e3)),setTimeout((()=>{(0,$e.cs)("capture-visible-tab").then((n=>{t(n.data),e&&i&&(i.style.display=s),void 0!==o&&clearTimeout(o)})).catch((e=>{void 0!==o&&clearTimeout(o),n(e)}))}),100)}))}(),"image/jpeg"),a=yield(0,Re.r)(o);return t.snapshot_img_key=a,yield function(e,t,n){return ot.apply(this,arguments)}(t,s,i)})),(e=>`${Oe.Vl}/${e.id}`)).then((t=>{var n;Ee.A.emit("onWebpageSaved",t.id),null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.web,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.web)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}));else{Ne(location.href)&&Te()&&!window.location.protocol.startsWith("file:")&&an(e)}}));return function(t){return e.apply(this,arguments)}}();function an(e){(0,he.o2)(e.collectFrom,he.p6.pdf),Xt((0,i.A)((function*(){const e=window.location.pathname.split("/").pop(),t=yield function(e){return at.apply(this,arguments)}({url:window.location.href,filename:e||"pdf"});return t})),(e=>dn(e.id.toString()))).then((t=>{var n;null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),Ee.A.emit("onWebpageSaved",t.id),(0,he.mL)(e.collectFrom,void 0!==t.id,he.p6.pdf,`${t.id}`)})).catch((()=>{(0,he.mL)(e.collectFrom,!1,he.p6.pdf)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}const ln=function(){var e=(0,i.A)((function*(e,t,n){var i,s;const{transcript:o,videoId:a,title:l,videoSummaryId:r}=e,{messages:c}=qe.P.getState();let d="",u="";const{isDone:m,text:h=""}=c[r||""]||{},p=(null===(i=c[r||""])||void 0===i||null===(i=i.body)||void 0===i||null===(i=i.message)||void 0===i?void 0:i.meta_infos)||[];d=h,u=Mt(p);const g={summary:d,summary_msg_id:r&&m&&(null===(s=c[r])||void 0===s||null===(s=s.body)||void 0===s||null===(s=s.message)||void 0===s?void 0:s.message_id)||""||"",videoParams:{video_type:It(),video_url:yield Tt(a),title:l,timeline:kt(u)||[],cover_url:Et(a),cover_file_token:"",transcript:o&&o.length?JSON.stringify(o):"",video_duration:"bilibili"===It()?(null===(v=document.querySelector(".bpx-player-ctrl-time-duration"))||void 0===v?void 0:v.innerText)||"":(null===(_=document.querySelector(".ytp-time-duration"))||void 0===_?void 0:_.innerText)||""}};var _,v;n({collectFrom:t,collectionType:Ue.X.VideoSummary,videoSummaryResult:g})}));return function(t,n,i){return e.apply(this,arguments)}}();function rn(e){Zt(),ln(function(){const e=vt.getVideoSummaryMsgBlock(),t=vt.getTranscriptData()||[],{videoSummaryId:n="",videoHighlightsId:i=""}=e,{videoId:s,title:o}=Fe.e.getState();return{transcript:t,videoId:s,title:o,videoSummaryId:n,videoHighlightsId:i}}(),e.collectFrom,cn)}function cn(e){if(!e.videoSummaryResult)return;const t=e.videoSummaryResult;(0,he.o2)(he.vP.video_page_summarize,he.p6.videosummary),Xt((0,i.A)((function*(){var e;const n=yield(0,ze.K)(ke.e.VideoSummary);let i;try{t.summary_msg_id&&(i=yield ct(n))}catch(o){}if(i)return yield function(e){return ut.apply(this,arguments)}({id:`${i}`,summary:t.summary,summary_msg_id:t.summary_msg_id,timeline:t.videoParams.timeline});const s=null==t||null===(e=t.videoParams)||void 0===e?void 0:e.cover_url;if(null!=s&&s.startsWith("http"))try{let e;try{const{blob:t}=yield(0,De.n_)(s);e=t}catch(o){const t=document.querySelector("video");t&&(e=(yield(0,De.CU)(t))||void 0)}if(e){const n=yield(0,Re.r)(e);t.videoParams.cover_file_token=n}}catch(o){}return Pt()&&(t.videoParams.transcript=""),yield function(e,t,n,i){return rt.apply(this,arguments)}(t.summary,t.summary_msg_id,t.videoParams)})),(e=>dn(e.id.toString()))).then((t=>{var n;Ee.A.emit("onWebpageSaved",t.id),null===(n=e.onSuccess)||void 0===n||n.call(e,t.id),(0,he.mL)(he.vP.video_page_summarize,void 0!==t.id,he.p6.videosummary,`${t.id}`)})).catch((()=>{(0,he.mL)(he.vP.video_page_summarize,!1,he.p6.videosummary)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)}))}const dn=e=>`${Oe.Vl}/${e}`;function un(e){const{podcastSummaryResult:t}=e;t&&((0,he.o2)(he.vP.podcast_collect,he.p6.Podcast),Xt((0,i.A)((function*(){const e=yield(0,ze.K)(ke.e.PodcastSummary);let n;try{t.summary_msg_id&&(n=yield ct(e))}catch(s){}if(n)return yield function(e){return mt.apply(this,arguments)}({id:`${n}`,summary:t.summary,summary_msg_id:t.summary_msg_id,timeline:t.podcastParams.timeline});const i=yield(0,De.n_)(t.podcastParams.cover_url);if(null!=i&&i.blob){const e=yield(0,Re.r)(i.blob);t.podcastParams.cover_file_token=e}return yield function(e){return ht.apply(this,arguments)}(t)})),(e=>dn(e.id.toString()))).then((t=>{var n;t.id&&(null===(n=e.onSuccess)||void 0===n||n.call(e,t.id)),(0,he.mL)(he.vP.podcast_collect,void 0!==t.id,he.p6.Podcast,`${t.id}`)})).catch((()=>{(0,he.mL)(he.vP.podcast_collect,!1,he.p6.Podcast)})).finally((()=>{var t;null===(t=e.onFinally)||void 0===t||t.call(e)})))}var mn=n(97311),hn=n(58980),pn=n(34870),gn=n(45498);const _n="onboardingActionRecord",vn=(e,t="web")=>{switch(e){case u.EU.ask:return`${t}_ask`;case u.EU.mail:return`${t}_gmail`;default:return`${t}_${e}`}},fn=e=>{const{action:t,triggerLogin:n=!0,loginParams:i}=e,{isActionLimited:s,actionRecordUseOnce:o}=xn.getState();return s(t||"")?(n&&(0,Ut.DT)(i),!0):(t&&o(t),!1)},bn={actionRecordUpperLimit:new Map,limitedActionRecord:new Set,limitedBrowserPluginSkill:new Set},xn=(0,gn.vt)()((0,pn.eh)(((e,t)=>(0,m.A)((0,m.A)({},bn),{},{setLocalActionRecordUpperLimit:(n,i)=>e((()=>({actionRecordUpperLimit:t().actionRecordUpperLimit.set(n,i)}))),actionRecordUseOnce:e=>{var n;if(!t().actionRecordUpperLimit.has(e))return;const{count:i=0}=(null===(n=(0,A.TK)(_n))||void 0===n?void 0:n[e])||{};(0,A.vE)(_n,{[e]:{count:i+1}},!0)},addLimitedActionRecord:n=>e((()=>({limitedActionRecord:t().limitedActionRecord.add(n)}))),addLimitedBrowserPluginSkill:n=>e((()=>({limitedBrowserPluginSkill:t().limitedBrowserPluginSkill.add(n)}))),isActionLimited:e=>{var n;const{isAuthenticated:i}=(0,A.TK)("authInfo");if(i)return!1;if(t().limitedActionRecord.has(e))return!0;const{count:s=0}=(null===(n=(0,A.TK)(_n))||void 0===n?void 0:n[e])||{},o=t().actionRecordUpperLimit.get(e);return void 0!==o&&s>o},isBrowserPluginSkillLimited:e=>{const{isAuthenticated:n}=(0,A.TK)("authInfo");return!n&&t().limitedBrowserPluginSkill.has(e)}}))));new Map([["explain","web_explain"],["search","web_search"],["youtube","web_video_summary"]]);var An=n(93476),yn=n(25218),wn=n(12648),Sn=(n(77526),n(42265)),jn=n(44963),kn=n(20825);function Cn(e,t){return In.apply(this,arguments)}function In(){return(In=(0,i.A)((function*(e,t){An.l.getState().isSidePanelMode&&!kn._K.isInSidePanel?yield(0,jn.c)({name:"send-message-to-chat",body:{msg:t,chatType:e}}):(0,Sn.C)(t,{chatType:e,botType:"Main"})}))).apply(this,arguments)}function Tn(e,t,n){const i=e===be.H.NewThread;return{botId:n,conversationId:i?void 0:t,localConversationId:i?t:void 0,conversationType:i?wn.Cr.CocoWebSub:void 0}}var Nn=n(37424);const En=(0,p.jc)(),Mn=function(){var e=(0,i.A)((function*(e,t){var n;An.l.getState().setIsShowSidebar(!0,(null==t?void 0:t.enterMethod)||de.cz.selectAssistantMenu);let i="";const s=fe.K9.Search;try{var o;const[e]=yield Promise.all([(0,xe.Rf)((0,x.M$)(),1500,(()=>{b.vF.persist.error({eventName:"[SELECT_BAR] - SEARCH",error:new Error("get skill res timeout")})})),(0,Nn.Z)()]);if(i=(null===(o=(0,ge.A)(e.latest_skills,(e=>(null==e?void 0:e.skill_type)===s)))||void 0===o?void 0:o.skill_id)||"",""===i)throw new Error("search skill id is empty")}catch(u){b.vF.persist.error({message:"get skill failed",error:u})}let a={textContent:""};try{a=yield(0,ye.B9)()}catch(u){b.vF.persist.error({message:"get doc failed when search",error:u})}const{convId:l,convType:r,mainBotId:c}=(0,Ae.IK)(),d={text:e||D.t_.getState().inputText,extraExt:{input_skill:JSON.stringify({skill_id:i,skill_type:s,variables:{}}),earlier_search_result:"1",send_from_skill_guidance_or_suggestion:(0,A.TK)("authInfo").isAuthenticated?"0":"1",samantha_context:JSON.stringify((0,yn.k)({query_context:{web_content:(null===(n=a)||void 0===n?void 0:n.textContent)||""}})),need_create_thread:r===be.H.NewThread?"1":"0"},reportParams:{scene:(null==t?void 0:t.scene)||mn.sJ.highlight_search_result_tool,sec_scene:(null==t?void 0:t.secScene)||mn._o.highlight_search_result_ask,use_skill:!0,skill_name:i},ctx:Tn(r,l,c)};yield Cn(r,[d])}));return function(t,n){return e.apply(this,arguments)}}(),Pn=function(){var e=(0,i.A)((function*(e,t,n=!1){me({button_name:Rn(e),click_from:t,isSubtitle:P.getIsCurrentSubtitle()});const{setCurrentAction:i,setBarVisible:s,setBarFakeHide:o,setBoxVisible:a,inputText:l,setSceneId:r}=D.t_.getState();if(!l)return;gt.on.getState().setFloatingCardVisible(!1),gt.on.getState().setSummaryActionVisible(!1);const c=fn({action:vn(e),triggerLogin:e===u.EU.ask,loginParams:{}});if(s(!1),e===u.EU.ask){if(c)return;const e=D.t_.getState().inputText;return En?(o(!0),void Mn(e)):void Mn(t===de.Z5.shortcut?e:void 0)}if(i(e),e!==u.EU.copy)if(e!==u.EU.collect){if(e===u.EU.explain){const e=yield(0,gt.nx)(we.Vn);null!=e&&e.textContent&&D.t_.setState({contextText:e.textContent})}r(e===u.EU.translate?hn.Fc.ChooseWordsTranslate:void 0),n?Ln(e,l):a(!0)}else Jt({collectFrom:he.vP.highlight_function_bar,collectionType:Ue.X.TextFragment});else ve()(l)}));return function(t,n){return e.apply(this,arguments)}}(),Ln=function(){var e=(0,i.A)((function*(e,t){if(fn({action:vn(e,"web"),loginParams:{trackMeta:{login_entrance:"sidebar_float"}}}))return;D.t_.getState().clearMessages(),An.l.getState().setIsShowSidebar(!0,de.cz.other);try{yield(0,Nn.Z)()}catch(r){b.vF.persist.error({message:"page load failed",error:r})}const{convId:n,convType:i,mainBotId:s}=(0,Ae.IK)(),o={text:t,reportParams:{scene:mn.sJ.highlight_in_siderbar_chat},ctx:Tn(i,n,s)},a=(0,A.TK)("uiLanguage"),l=(0,A.TK)("translateLanguage");if([u.EU.translate,u.EU.explain].includes(e)){const t={[e]:"{}",browser_language:a,flag_browser_plugin:"1"};e===u.EU.translate&&(t[e]=l||"{}"),o.extraExt=t,o.reportParams.sec_scene=e===u.EU.translate?"highlight_in_siderbar_chat_translate":"highlight_in_siderbar_chat_explain"}else{const t=Dn(e);o.extraExt={flag_browser_plugin:"1",browser_plugin_info:JSON.stringify({frontend_source:"plugin",custom_prompt_skill_id:e,lang:l||a,custom_ref_show_variable:{title:(null==t?void 0:t.name)||"",icon:(null==t?void 0:t.icon)||""}}),need_create_thread:i===be.H.NewThread?"1":"0"}}yield Cn(i,[o])}));return function(t,n){return e.apply(this,arguments)}}(),Dn=e=>{const t=(0,A.TK)("readingPopupActions"),n=(0,A.TK)("editingPopupActions");return t.actionList.find((t=>t.id===e))||t.moreActionList.find((t=>t.id===e))||n.actionList.find((t=>t.id===e))||n.moreActionList.find((t=>t.id===e))},Rn=e=>{var t;return(0,u.em)(e)?(null===(t=Dn(e))||void 0===t?void 0:t.name)||"customized_button":e};var Bn=n(27609);const On=({className:e,customMenus:t,onHideMenu:n})=>{const i=(0,r.B)(),o=(0,s.useCallback)(((e,t={})=>{me({button_name:e,click_from:de.Z5.selectAssistantMoreMenu,isSubtitle:P.getIsCurrentSubtitle()}),(0,pe.I)((0,m.A)((0,m.A)({},t),{},{enter_method:de.cz.selectAssistantMenu,settting_key:"toolbar-configuration"}))}),[]),a=(0,s.useMemo)((()=>[{title:i("flow_web_ext_setting_toolbar_discover"),icon:(0,q.jsx)(oe.A,{}),btnName:de.Yd.discoverSkill,handleClick:()=>o(de.Yd.discoverSkill,{discover_skill:"true"})},{title:i("flow_web_ext_setting_toolbar_addskill"),icon:(0,q.jsx)(ae.A,{}),btnName:de.Yd.addASkill,handleClick:()=>o(de.Yd.addASkill,{add_prompt:"true"})},{title:i("flow_web_ext_action_settings"),icon:(0,q.jsx)(le.A,{}),btnName:de.Yd.setting,handleClick:()=>o(de.Yd.setting)}]),[i]);return(0,s.useEffect)((()=>{a.forEach((e=>{ue({button_name:e.btnName,show_from:de.Z5.selectAssistantMoreMenu,isSubtitle:P.getIsCurrentSubtitle()})}))}),[]),(0,q.jsxs)(d.ms.Menu,{style:{padding:0},className:e,children:[a.map((e=>(0,q.jsxs)(d.ms.Item,{onClick:()=>{null==n||n(),e.handleClick()},"data-testid":`select-bar-more-setting-${e.btnName}-action`,className:F.dropdownItem,children:[(0,q.jsx)("div",{className:l()(F.moreIconContainer,"menu-item-icon"),children:e.icon}),(0,q.jsx)("span",{className:l()(F.name,"menu-item-name"),children:e.title})]},e.title))),t]})},Un=({actions:e,onClickItem:t,getPopupContainer:n,menuClassName:i,subDropdownClassName:o,subDropdownSpacing:a})=>{var c;const m=Q(),h=(null==m||null===(c=m.compose)||void 0===c?void 0:c.tone)||[],p=(0,r.B)();(0,s.useEffect)((()=>{e.forEach((e=>{ue({button_name:Rn(e.id),show_from:de.Z5.selectAssistantMoreMenu,isSubtitle:P.getIsCurrentSubtitle()})}));e.find((e=>e.id===u.EU.collect))&&(0,he.ae)(he.vP.highlight_function_bar,he.p6.textfragment)}),[e]);return(0,q.jsx)(d.ms.Menu,{style:{padding:0},className:i,children:e.map((e=>(e=>{const s=e.id===u.EU.adjust_skill,r=e.id===u.EU.pronounce,c=(0,q.jsxs)(d.ms.Item,{onClick:s||r?void 0:n=>t(e,n),"data-testid":`select-bar-more-${e.id}-action`,className:F.dropdownItem,children:[(0,q.jsx)("div",{className:l()(F.moreIconContainer,"menu-item-icon"),children:(0,O.I)(e.icon)}),(0,q.jsx)("span",{className:l()(F.name,"menu-item-name"),children:p(e.name,e.options)}),s&&(0,q.jsx)("span",{className:l()(F.moreArrow,"menu-item-right-arrow"),children:(0,q.jsx)(re.A,{})})]},e.id);return r?(0,q.jsx)(z,{}):s?(0,q.jsx)(d.ms,{className:l()(F.dropdownContainer,o),getPopupContainer:n,trigger:"hover",position:"rightTop",spacing:a,render:(0,q.jsx)("div",{onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},children:(0,q.jsx)(d.ms.Menu,{className:i,children:h.map((n=>(0,q.jsx)(d.ms.Item,{className:F.dropdownItem,onClick:i=>{D.t_.getState().setTone(n),t(e,i)},children:n.show_name},n.value)))})}),children:c},e.id):c})(e)))})},Fn=e=>{var t;const{setMoreBtnVisible:n,handleClickBtn:i,setDisableMenuVisible:o,disableMenuVisible:a,moreActionList:r=[],isDemo:c=!1}=e,[u,m]=(0,s.useState)(!1),h=null===(t=(0,Bn.A)())||void 0===t?void 0:t.getPopupContainer,[p]=(0,y.Y)("isSelectbarMoreMenuClicked"),g=(0,s.useRef)(null),_=(0,s.useRef)(null);Z((()=>{m(!1)}),[g,_]);const v=(0,s.useCallback)((()=>{m(!u),o(!1),(0,A.vE)("isSelectbarMoreMenuClicked",!0)}),[u]);return(0,s.useEffect)((()=>{a&&m(!1)}),[a]),(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(d.ms,{visible:u,trigger:"custom",getPopupContainer:h,spacing:6,position:"bottomRight",onClickOutSide:()=>m(!1),className:F.dropdownContainer,render:(0,q.jsxs)("div",{ref:g,onMouseEnter:()=>{n(!1)},onPointerUp:()=>{n(!1)},children:[r.length>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Un,{actions:r,onClickItem:(...e)=>{i(...e),m(!1)},getPopupContainer:h}),(0,q.jsx)("div",{style:{paddingLeft:10,paddingRight:10},children:(0,q.jsx)(d.cG,{margin:5})})]}),(0,q.jsx)(On,{onHideMenu:()=>{m(!1)}})]}),children:(0,q.jsx)("div",{ref:_,className:l()(F.configBtnContainer,{[F.isOpen]:u}),children:(0,q.jsx)("button",{type:"button",className:F.configBtn,onPointerUp:v,"data-testid":"select-bar-more-action",children:c||u||p?(0,q.jsx)(W.A,{}):(0,q.jsx)(d.Ex,{dot:!0,type:"danger",children:(0,q.jsx)(W.A,{})})})})})})};var qn=n(86785),Hn=n(78503),Vn=n(91376);const Kn=(0,p.jc)();function zn(e){var t;const{selectBarOnlyIcon:n,availableActionList:i,moreActionList:o=[],isDemo:a}=e,[r,c]=(0,s.useState)(!1),[m,h]=(0,s.useState)(!1),p=null===(t=(0,Bn.A)())||void 0===t?void 0:t.getPopupContainer,g=(0,D.t_)((e=>e.setBarVisible)),_=(0,An.l)((e=>e.setIsShowQuick)),v=null==i?void 0:i.map((e=>e.id)).join("");(0,s.useEffect)((()=>{i.forEach((e=>{ue({button_name:Rn(e.id),show_from:de.Z5.selectAssistantMenu,isSubtitle:P.getIsCurrentSubtitle()})}))}),[v]);const f=(0,Be.kW)(),b=()=>{_(!1),g(!1)},x=(e,t,n=!1)=>{e.id===u.EU.ask&&(t.preventDefault(),t.stopPropagation()),Pn(e.id,n?de.Z5.selectAssistantMoreMenu:de.Z5.selectAssistantMenu,"sidebar"===e.displayMode)},A=e=>{e.preventDefault(),e.stopPropagation()},y=r||f||Kn,w=(0,s.useCallback)(((e,t)=>x(e,t,!0)),[]);(0,s.useEffect)((()=>{i.find((e=>e.id===u.EU.collect))&&(0,Vn.ku)()&&(0,he.ae)(he.vP.highlight_function_bar,he.p6.textfragment)}),[]);return(0,q.jsx)("div",{className:Kn?U.container_mac:U.container,"data-testid":"select-bar-container",children:(0,q.jsxs)("div",{onMouseDown:A,className:U["action-container"],children:[(0,q.jsx)("div",{className:U.actions,children:i.map((e=>(0,q.jsx)(se,{item:e,selectBarOnlyIcon:n,getPopupContainer:p,onClick:x},e.id)))}),(0,q.jsx)(d.cG,{margin:2,layout:"vertical",style:{height:12}}),(0,q.jsxs)("div",{className:U.extra,onMouseEnter:()=>{c(!0)},onMouseLeave:()=>{m||c(!1)},children:[(0,q.jsx)(Fn,{setMoreBtnVisible:c,handleClickBtn:w,disableMenuVisible:m,setDisableMenuVisible:h,moreActionList:o,isDemo:a}),(0,q.jsx)(qn.A,{cssStyle:{position:"relative",height:"100%"},optionPageSection:"toolbar-configuration",position:"bottomRight",spacing:0,onDisableOnceClick:b,disableKey:Hn.lf.selectAssistant,show:m,setShow:h,renderChildren:({onTriggerClick:e})=>(0,q.jsx)("div",{className:U.closeBtnContainer,children:(0,q.jsx)(O.gz,{className:l()(U.closeBtn,{[U.closeBtnVisible]:y,[U.closeBtnActive]:m}),onClick:t=>{m?h(!m):e(t)}})})})]})]})})}var Gn=n(93804);const $n="rootContainer-W2lELf",Wn="contentContainer-Iw2rQe",Yn=e=>{const{selectBarOnlyIcon:t,availableActionList:n,moreActionList:i,isDemo:o,setRePosKeyInner:a}=e,r=(0,s.useRef)(null),{height:c}=(0,h.w)({ref:r});return(0,s.useEffect)((()=>{setTimeout((()=>{if(!r.current)return;const{clientWidth:e,clientHeight:t}=r.current,{parentElement:n}=r.current;n&&(n.style.height=`${Math.round(t)}px`,n.style.width=`${Math.round(e)+Math.round(e)%2}px`),a(Date.now())}),0)}),[n,r.current,c]),(0,q.jsx)("div",{className:$n,children:(0,q.jsx)("div",{className:l()(Wn),ref:r,children:(0,q.jsx)(zn,{selectBarOnlyIcon:t,availableActionList:n,moreActionList:i,isDemo:o})})})},Qn=e=>{var t;const n=null===(t=(0,s.useContext)(Gn.A))||void 0===t?void 0:t.getPopupContainer,{children:i,visible:o,rePosKey:a,autoAdjustOverflow:l,style:r={},selectBarOnlyIcon:c,availableActionList:u,moreActionList:h=[],position:p="top",getPopupContainer:g=n,isDemo:_}=e,[v,f]=(0,s.useState)(a);return(0,s.useEffect)((()=>{f(a)}),[a]),(0,q.jsx)(d.AM,{position:p,showArrow:!1,content:(0,q.jsx)(Yn,{selectBarOnlyIcon:c,availableActionList:u,moreActionList:h,isDemo:_,setRePosKeyInner:f}),trigger:"custom",visible:o,getPopupContainer:g,style:(0,m.A)((0,m.A)({},{boxShadow:"none",padding:"0",backgroundColor:"transparent"}),r),rePosKey:v,autoAdjustOverflow:l,children:i})},Zn="demoContainer-YdcS71",Xn="demoText-T31NIk",Jn=e=>{const{selectBarOnlyIcon:t,availableActionList:n,style:i,visible:o=!0}=e,a=(0,s.useRef)(null);return(0,q.jsxs)("div",{className:Zn,ref:a,style:i,children:[(0,q.jsx)(Qn,{style:{top:"-5px"},visible:o,availableActionList:n,selectBarOnlyIcon:t,autoAdjustOverflow:!1,getPopupContainer:()=>a.current,isDemo:!0,children:(0,q.jsx)("div",{className:Xn,children:"Hello"})}),(0,q.jsx)(O.Pg,{style:{verticalAlign:"middle",marginLeft:"5px"}})]})},ei="optionsPage-n5vMJj",ti="main-KdNeno",ni="sider-CTyuPd",ii="area-ouuKPc",si="logo-yuFm_Z",oi="logoIcon-UgQH_H",ai="name-e1FMWB",li="nav-i78ass",ri="content-WGU_pZ",ci="section-Cq3gzL",di="sectionTitle-KdZ6ag",ui="sectionSecondTitle-xXTUbB",mi="sectionThirdTitle-h7FxCn",hi="demo-siV4sv",pi="sites-yUoo6d",gi="container-Aby_mV",_i="radioItem-_MWgg3",vi="radioArea-ra4fDR",fi="radioContainer-FqJxK4",bi="radio-Yy2RHO",xi="radioSelected-nmceUM",Ai="radioLable-z_eih2",yi=()=>{const e=(0,s.useRef)(null),t=(0,r.B)(),[n]=(0,y.Y)("selectBarOnlyIcon"),i=[{value:!1,lable:t("flow_web_ext_setting_toolbar_appearance_intuit")},{value:!0,lable:t("flow_web_ext_setting_toolbar_appearance_mini")}];return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:ui,style:{paddingLeft:"0px"},children:t("flow_web_ext_setting_toolbar_appearance")}),(0,q.jsx)("div",{ref:e,className:gi,children:i.map(((e,t)=>{const i=e.value===n;return(0,q.jsxs)("div",{className:_i,children:[(0,q.jsx)(Jn,{selectBarOnlyIcon:e.value,availableActionList:[u.EU.ask,u.EU.translate].map((e=>u.YN[e])),style:{height:"146px",paddingTop:"10px"}}),(0,q.jsx)("div",{className:vi,children:(0,q.jsxs)("button",{className:fi,onPointerUp:()=>(0,A.vE)("selectBarOnlyIcon",e.value),children:[(0,q.jsx)("div",{className:l()(bi,{[xi]:i}),children:i&&(0,q.jsx)(O.jk,{})}),(0,q.jsx)("div",{className:Ai,children:e.lable})]})})]},t)}))})]})},wi={"cici-ext-container":"cici-ext-container-qlE156",ciciExtContainer:"cici-ext-container-qlE156","inactivelink-hover-animation":"inactivelink-hover-animation-pf9d3t",inactivelinkHoverAnimation:"inactivelink-hover-animation-pf9d3t","notactivelink-hover-animation":"notactivelink-hover-animation-l0ClId",notactivelinkHoverAnimation:"notactivelink-hover-animation-l0ClId","light-click-animation":"light-click-animation-esI_sK",lightClickAnimation:"light-click-animation-esI_sK","click-animation":"click-animation-TvCSUG",clickAnimation:"click-animation-TvCSUG","semi-animation-rotate":"semi-animation-rotate-i0tp3u",semiAnimationRotate:"semi-animation-rotate-i0tp3u","inactive-btn-hover-animation":"inactive-btn-hover-animation-dwAqqb",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-dwAqqb","cici-ext-always-dark":"cici-ext-always-dark-FhjQ0S",ciciExtAlwaysDark:"cici-ext-always-dark-FhjQ0S","cici-ext-always-light":"cici-ext-always-light-SdxZ1D",ciciExtAlwaysLight:"cici-ext-always-light-SdxZ1D",ellipsis:"ellipsis-MiSZf2",tabContent:"tabContent-kOmNIf",tabHeaderCard:"tabHeaderCard-yGKEuX",menuSorterContainer:"menuSorterContainer-MTzmBH",menuSorterContentContainer:"menuSorterContentContainer-B2WAZD",icon:"icon-HUseZo",label:"label-rbVDdN",control:"control-G8swCh",menuSorterContentContainerEmpty:"menuSorterContentContainerEmpty-qQU6HM",content:"content-TldbpR",menuSorterItemContainer:"menuSorterItemContainer-AauqWv",name:"name-Zzb6DD",menuSorterItem:"menuSorterItem-XtbPlk",menuSorterTitle:"menuSorterTitle-njiJlZ",skillHeader:"skillHeader-ZgwbQn","activelink-hover-animation":"activelink-hover-animation-pQ3FQY",activelinkHoverAnimation:"activelink-hover-animation-pQ3FQY"},Si=e=>{const{isActive:t,tabType:n}=e,[i]=(0,y.Y)("selectBarOnlyIcon"),[o]=(0,y.Y)("editingPopupActions"),[a]=(0,y.Y)("readingPopupActions"),l=(0,s.useMemo)((()=>[...[...u.y3].map((e=>u.YN[e])),..."while_editing_texts"===n?o.actionList:a.actionList]),[n,o,a]);return(0,q.jsx)("div",{className:wi.tabHeaderCard,children:(0,q.jsx)(Jn,{style:{border:"none"},visible:t,selectBarOnlyIcon:i,availableActionList:l})})};var ji=n(17401);const ki=(e,t)=>{(0,ce.z8)(e,t)},Ci=e=>{const{setPromptEditorInfo:t,id:n,setDeleteId:i}=e,[o,a]=(0,s.useState)(!1),l=(0,s.useMemo)((()=>[{icon:O.xV,onPointerUp:()=>{(0,ce.z8)(de.Ur.skillEditDelete,{}),i(n)},key:"delete"},{icon:O.rZ,onPointerUp:()=>{(0,ce.z8)(de.Ur.skillEditClick,{}),t({visible:!0,editId:n})},key:"update"}]),[]);return(0,q.jsxs)("div",{className:wi.menuSorterContentContainer,onMouseEnter:()=>a(!0),onMouseLeave:()=>a(!1),children:[(0,q.jsxs)("div",{className:wi.label,children:[(0,q.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,q.jsx)(O.Ll,{style:e.isPinned?{visibility:"hidden"}:{}})}),(0,q.jsxs)("div",{className:wi.menuSorterItemContainer,children:[(0,O.I)(e.icon,{className:wi.icon}),(0,q.jsx)("div",{className:wi.name,style:{maxWidth:o?160:220},"data-testid":`menu-sorter-item-${e.name}`,children:e.name})]})]}),o&&!u.YN[e.id]&&(0,q.jsx)("div",{className:wi.control,children:l.map(((t,n)=>(0,q.jsx)("button",{className:wi.menuSorterItemControlBtn,onPointerUp:t.onPointerUp,"data-testid":`menu-sorter-${e.name}-${t.key}`,children:(0,q.jsx)(t.icon,{})},n)))})]})},Ii=()=>{const e=(0,r.B)();return(0,q.jsx)("div",{className:wi.menuSorterContentContainerEmpty,children:(0,q.jsx)("div",{className:wi.content,children:e("flow_web_ext_setting_toolbar_hidden_empty")})})};var Ti=n(24337),Ni=n(27737),Ei=n(15704),Mi=n(76813),Pi=n(86767),Li=n(79267),Di=n(88608),Ri=n(37890),Bi=n(46241),Oi=n(29659),Ui=n(817),Fi=n(81057),qi=n(16029),Hi=n(5008),Vi=n(75882),Ki=n(76360);const zi=new class{constructor(e){var t,n,i,s,o,a,l,r,c,d;(0,g.A)(this,"jsMonitor",void 0),(0,g.A)(this,"promiseMonitor",void 0),(0,g.A)(this,"fetchMonitor",void 0),(0,g.A)(this,"crashMonitor",void 0),(0,g.A)(this,"bid",void 0),(0,g.A)(this,"crashLog",void 0),(0,g.A)(this,"region",void 0),(0,g.A)(this,"_options",void 0),(0,g.A)(this,"client",void 0),(0,g.A)(this,"prepared",!1),(0,g.A)(this,"start",((e={})=>{if(self){const t=(0,Oi.m)(),n=(0,Ki.HF)();this.client.init((0,m.A)({env:"public",release:n,version:n,bid:this.bid,transport:{get:t.get,post:t.post}},e)),this.client.start(),this.runBgMonitors(),this.addMessageListeners(),(0,Hi.sN)(this),this.prepared=!0}})),(0,g.A)(this,"config",(e=>{this.client.config(e)})),(0,g.A)(this,"runBgMonitors",(()=>{var e;(this.jsMonitor&&new Di.A(this.region),this.promiseMonitor&&new Li.A(this.region),this.fetchMonitor)&&new Ri.A({region:this.region,rule:null===(e=this._options.plugins)||void 0===e?void 0:e.fetchInterceptRule});this.crashMonitor&&new Bi.A(this.region,this.crashLog)})),(0,g.A)(this,"addMessageListeners",(()=>{const e=this,t={name:"slardar-message",handle:t=>{const{type:n,data:i}=t||{};switch(n){case qi.O4.CONTENT_EVENT:e.sendEvent(i);break;case qi.O4.CONTENT_LOG:case qi.O4.CONTENT_PERF_EVENT:e.sendLog(i)}}};(0,Vi.c)(t)})),(0,g.A)(this,"sendEvent",(e=>{var t,n;this.prepared&&(null===(t=(n=this.client).sendEvent)||void 0===t||t.call(n,e),(0,Ei.v)({type:"slardar",payload:e,action:"event"}))})),(0,g.A)(this,"sendLog",(e=>{var t,n;this.prepared&&(null===(t=(n=this.client).sendLog)||void 0===t||t.call(n,e),(0,Ei.v)({type:"slardar",payload:e,action:"log"}))})),this.jsMonitor=null===(t=null==e||null===(n=e.plugins)||void 0===n?void 0:n.jsMonitor)||void 0===t||t,this.promiseMonitor=null===(i=null==e||null===(s=e.plugins)||void 0===s?void 0:s.promiseMonitor)||void 0===i||i,this.fetchMonitor=null===(o=null==e||null===(a=e.plugins)||void 0===a?void 0:a.fetchMonitor)||void 0===o||o,this.crashMonitor=null===(l=null==e||null===(r=e.plugins)||void 0===r?void 0:r.crashMonitor)||void 0===l||l,this.bid=e.bid,this.crashLog=null!==(c=null==e||null===(d=e.log)||void 0===d?void 0:d.crashLog)&&void 0!==c&&c,this.region=(0,Fi.J)(),this._options=e,this.client=(0,Fi.K)(this.region)}configExtraInfo(e){Ui.A.recordExtraInfo(e)}}({bid:"flow_web_ext",plugins:{promiseMonitor:!1,crashMonitor:!1}});var Gi=n(9144);class $i extends Error{constructor(e,t){super(`ServerError, code: ${e}, msg:${t}`),this.code=e}}Error;const Wi=function(){var e=(0,i.A)((function*(e,t){var n,i;const{url:s,method:o,data:a,params:l,headers:r}=e,c=yield fetch((0,Mi.ID)(s,(0,m.A)((0,m.A)({},(0,Gi.wH)()),l)),{method:o,body:JSON.stringify(a),headers:(0,m.A)((0,m.A)({},(0,Gi.Ql)()),{},{"Content-Type":"application/json"},r)}),d=null===(n=c.headers)||void 0===n||null===(i=n.get)||void 0===i?void 0:i.call(n,"x-tt-logid");if(!c.ok)throw(0,Ei.v)({type:"http-request",payload:{config:e,response:{statusText:c.statusText},logId:d}}),new Error(c.statusText);const u=yield c.json();(0,Ei.v)({type:"http-request",payload:{config:e,response:u,logId:d}});const{code:h,msg:p}=u;var g;if(void 0!==h&&0!==h)throw zi.sendEvent((0,m.A)({name:"response_server_code_invalid"},(0,Pi.i)({url:null==e?void 0:e.url,msg:p,code:`${h}`,statusCode:200,isSse:!1,"x-tt-env":null==e||null===(g=e.headers)||void 0===g?void 0:g["x-tt-env"],logId:d}))),new $i(h,p);return[Ni.t.NOACCESS,Ni.t.NOT_LOGIN].includes(Number(h))&&Ee.A.emit("auth-info-request-updated"),(0,m.A)((0,m.A)({},u),{},{logId:d})}));return function(t,n){return e.apply(this,arguments)}}(),Yi=function(){var e=(0,i.A)((function*(...e){const{data:t}=yield Wi(...e);return t}));return function(){return e.apply(this,arguments)}}();function Qi(){return(Qi=(0,i.A)((function*(e){const t=(0,A.TK)("authInfo");return e?yield Yi({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/list_by_user`,data:{user_id:t.userId,frontend_source:1}}):yield(0,We.S6)({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/list_by_user`,data:{user_id:t.userId,frontend_source:1}})}))).apply(this,arguments)}function Zi(e){return Xi.apply(this,arguments)}function Xi(){return(Xi=(0,i.A)((function*(e){const t=(0,A.TK)("authInfo"),n=e.map((e=>{const n={icon:e.icon,use_in:e.useIn,displayMode:e.displayMode};e.conf_id&&(n.conf_id=e.conf_id);const i=JSON.stringify(n);return{title:e.title,prompt_template:e.prompt,user_id:t.userId,extra:i,item_type:e.item_type||1,conf_id:e.conf_id||"",skill_bot_id:e.skill_bot_id||"",skill_agent_id:e.skill_agent_id||""}}));return yield(0,We.S6)({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/add`,data:{items:n,frontend_source:1}})}))).apply(this,arguments)}function Ji(e){return es.apply(this,arguments)}function es(){return es=(0,i.A)((function*(e){const t=(0,A.TK)("authInfo"),n=(0,A.TK)("readingPopupActions"),i=(0,A.TK)("editingPopupActions"),s=JSON.stringify({readingPopupActions:{selectbar:n.actionList.filter((t=>t.id!==e)).map((e=>e.id)),dropdown:n.moreActionList.filter((t=>t.id!==e)).map((e=>e.id))},editingPopupActions:{selectbar:i.actionList.filter((t=>t.id!==e)).map((e=>e.id)),dropdown:i.moreActionList.filter((t=>t.id!==e)).map((e=>e.id))}});return yield(0,We.S6)({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/delete`,data:{item_id:e,user_setting:{user_id:t.userId,settings:s},frontend_source:1}})})),es.apply(this,arguments)}function ts(){return(ts=(0,i.A)((function*(e){const t={icon:e.icon,use_in:e.useIn,displayMode:e.displayMode};e.conf_id&&(t.conf_id=e.conf_id);const n=JSON.stringify(t),i=(0,A.TK)("authInfo");return yield(0,We.S6)({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/update`,data:{item:{id:e.id,title:e.title,prompt_template:e.prompt,user_id:i.userId,extra:n,item_type:e.item_type||1},frontend_source:1}})}))).apply(this,arguments)}function ns(){return is.apply(this,arguments)}function is(){return is=(0,i.A)((function*(){const e=(0,A.TK)("authInfo"),t=(0,A.TK)("readingPopupActions"),n=(0,A.TK)("editingPopupActions"),i=JSON.stringify({readingPopupActions:{selectbar:t.actionList.map((e=>e.id)),dropdown:t.moreActionList.map((e=>e.id))},editingPopupActions:{selectbar:n.actionList.map((e=>e.id)),dropdown:n.moreActionList.map((e=>e.id))}});return yield(0,We.S6)({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/save_setting`,data:{user_setting:{user_id:e.userId,settings:i},frontend_source:1}})})),is.apply(this,arguments)}const ss=()=>{const e=[],{selectBarPronounceEnabled:t}=(0,A.tl)("tts");return t||e.push(u.EU.pronounce),(0,Vn.ku)()||e.push(u.EU.collect),e},os=(e,t,n)=>{const i={actionList:[],moreActionList:[]},s=new Set,o=ss();return e&&(e.selectbar.forEach((e=>{if(o.includes(e))return;const n=t.get(e);n&&(i.actionList.push(n),s.add(e))})),e.dropdown.forEach((e=>{if(o.includes(e))return;const n=t.get(e);n&&(i.moreActionList.push(n),s.add(e))}))),t.forEach(((e,t)=>{if(!s.has(t)&&!o.includes(t)){(n?u.aX.includes(t):u.AA.includes(t))?i.actionList.push(e):i.moreActionList.push(e)}})),i},as={readingPopupActions:{selectbar:u.aX,dropdown:u.Tz},editingPopupActions:{selectbar:u.AA,dropdown:u.Xt}},ls=()=>{const e=ss();(0,A.vE)("readingPopupActions",{actionList:(0,u.Hh)(e),moreActionList:(0,u.WN)(e)}),(0,A.vE)("editingPopupActions",{actionList:(0,u.I8)(e),moreActionList:(0,u.fS)(e)})};function rs(){return cs.apply(this,arguments)}function cs(){return cs=(0,i.A)((function*(e=!1){try{const t=(0,A.TK)("authInfo");if(!t.isAuthenticated||!t.userId)return void ls();const n=yield function(e){return Qi.apply(this,arguments)}(e);if(!n)return;const{user_setting:i,items:s}=n;if(!i||!s)return;const o=new Map([...(0,u.Hh)(),...(0,u.WN)()].map((e=>[e.id,e]))),a=new Map([...(0,u.I8)(),...(0,u.fS)()].map((e=>[e.id,e])));null==s||s.forEach((e=>{const{id:t,extra:n,title:i,prompt_template:s}=e,l=JSON.parse(n),{use_in:r="",icon:c="",displayMode:d,conf_id:u}=l||{},m={id:t,icon:c,name:i,prompt:s,displayMode:d,confId:u};"editing"===r?a.set(t,m):o.set(t,m)}));const{settings:l=""}=i,r=l?JSON.parse(l):as,c=os(r.readingPopupActions,o,!0),d=os(r.editingPopupActions,a,!1);c.actionList.length+c.moreActionList.length&&(0,A.vE)("readingPopupActions",c),d.actionList.length+d.moreActionList.length&&(0,A.vE)("editingPopupActions",d)}catch(t){(0,Ti.z3)("initSelectBarSkillList err",t),b.vF.persist.info({eventName:"getSelectBarSkillList",meta:(0,m.A)({},t)})}})),cs.apply(this,arguments)}const ds="leftDroppable",us="rightDroppable",ms=e=>{const t=(0,r.B)(),n=(0,A.TK)("PopupListMaxCount"),o="while_reading_websites"===e.tabType?"readingPopupActions":"editingPopupActions",[a]=(0,y.Y)(o),l=(0,A.TK)(o),[c,d]=(0,s.useState)([...l.actionList]),[h,p]=(0,s.useState)([...l.moreActionList]),[g,_]=(0,s.useState)(!1),[v,f]=(0,s.useState)(!1),b=(0,s.useCallback)((()=>{g&&(c.push(h[0]),h.splice(0,1),d(c),p(h),_(!1))}),[c,h,g,d,p,_]),x=(0,s.useCallback)(function(){var e=(0,i.A)((function*(e){if(f(!1),!e.destination)return b(),void _(!1);if(e.source.droppableId===us){let{index:t}=e.source;g&&t++;const n=h.splice(t,1)[0];e.destination.droppableId===us?h.splice(e.destination.index,0,n):e.destination.droppableId===ds&&c.splice(e.destination.index,0,n)}else if(e.source.droppableId===ds){const t=c.splice(e.source.index,1)[0];e.destination.droppableId===ds?c.splice(e.destination.index,0,t):e.destination.droppableId===us&&h.splice(e.destination.index,0,t),_(!1)}(0,A.vE)(o,{actionList:c,moreActionList:h}),yield ns()}));return function(t){return e.apply(this,arguments)}}(),[b,_,c,d,h,p,o]),w=(0,s.useCallback)(((e,t)=>{var i,s;(null===(i=e.source)||void 0===i?void 0:i.droppableId)===us&&((null===(s=e.destination)||void 0===s?void 0:s.droppableId)===ds?c.length>=n&&(h.splice(0,0,c.pop()),p(h),d(c),_(!0)):b())}),[c,h,n,b,_,d,p]),S=(0,s.useCallback)((()=>{_(!1),f(!0)}),[_,f]),j=(0,s.useMemo)((()=>0===h.length&&!v),[h,v]),k=function(){const e=(0,r.B)(),t=(0,s.useCallback)(((t,n,i,s,o,a)=>(0,q.jsxs)("div",(0,m.A)((0,m.A)((0,m.A)({ref:t.innerRef},t.draggableProps),t.dragHandleProps),{},{children:[(0,q.jsx)(Ci,{icon:i.icon,name:e(i.name,a),id:i.id,isPinned:!1,setPromptEditorInfo:s,setDeleteId:o}),(0,q.jsx)("div",{style:{height:"12px"}})]}))),[]);return(0,s.useCallback)(((e,n,i,s,o,a,l="_",r={})=>(0,q.jsxs)("div",(0,m.A)((0,m.A)({},s.droppableProps),{},{ref:s.innerRef,style:(0,m.A)({minHeight:"100px"},r),children:[a?(0,q.jsx)(Ii,{}):null,e.map(((e,s)=>(0,q.jsx)(ji.sx,{draggableId:l+e.id,index:s,children:(s,o)=>t(s,o,e,n,i,e.options)},l+e.id))),s.placeholder]}))),[t])}();return(0,s.useEffect)((()=>{d(a.actionList),p(a.moreActionList)}),[a]),(0,q.jsx)(ji.JY,{onDragEnd:x,onDragUpdate:w,onDragStart:S,children:(0,q.jsxs)("div",{className:wi.menuSorterContainer,children:[(0,q.jsxs)("div",{className:wi.menuSorterItem,children:[(0,q.jsx)("div",{className:wi.menuSorterTitle,children:t("flow_web_ext_setting_toolbar_shown")}),(0,q.jsx)(Ci,{icon:"cici",name:t("flow_web_ext_action_ask"),isPinned:!0,id:u.EU.ask,setPromptEditorInfo:e.setPromptEditorInfo,setDeleteId:e.setDeleteId}),(0,q.jsx)(ji.gL,{droppableId:ds,children:(t,n)=>k(c,e.setPromptEditorInfo,e.setDeleteId,t,n,!1,"_",{marginTop:"12px"})})]}),(0,q.jsxs)("div",{className:wi.menuSorterItem,children:[(0,q.jsx)("div",{className:wi.menuSorterTitle,children:t("flow_web_ext_setting_toolbar_hidden")}),(0,q.jsx)(ji.gL,{droppableId:us,children:(t,n)=>k(h,e.setPromptEditorInfo,e.setDeleteId,t,n,j,"__")})]})]})})},hs=e=>(0,q.jsxs)("div",{className:wi.tabContent,children:[(0,q.jsx)(Si,{isActive:e.isActive,tabType:e.tabType}),(0,q.jsx)(ms,{tabType:e.tabType,setPromptEditorInfo:e.setPromptEditorInfo,setDeleteId:e.setDeleteId})]});var ps=n(80385),gs=n(25227);const _s={"cici-ext-container":"cici-ext-container-uMNo1e",ciciExtContainer:"cici-ext-container-uMNo1e","inactivelink-hover-animation":"inactivelink-hover-animation-BwPvrB",inactivelinkHoverAnimation:"inactivelink-hover-animation-BwPvrB","notactivelink-hover-animation":"notactivelink-hover-animation-iYKd_L",notactivelinkHoverAnimation:"notactivelink-hover-animation-iYKd_L","light-click-animation":"light-click-animation-bSaVfo",lightClickAnimation:"light-click-animation-bSaVfo","click-animation":"click-animation-_xB1K8",clickAnimation:"click-animation-_xB1K8","semi-animation-rotate":"semi-animation-rotate-UtQPL_",semiAnimationRotate:"semi-animation-rotate-UtQPL_","inactive-btn-hover-animation":"inactive-btn-hover-animation-QthXcj",inactiveBtnHoverAnimation:"inactive-btn-hover-animation-QthXcj","cici-ext-always-dark":"cici-ext-always-dark-X2qJ0w",ciciExtAlwaysDark:"cici-ext-always-dark-X2qJ0w","cici-ext-always-light":"cici-ext-always-light-iGj00q",ciciExtAlwaysLight:"cici-ext-always-light-iGj00q",ellipsis:"ellipsis-dSGJ7V",skillBtnContainer:"skillBtnContainer-BzJhoq",discoverBtn:"discoverBtn-NRagCf",newPromptBtn:"newPromptBtn-GS2twn",icon:"icon-mCjig6",lable:"lable-hGXyQh",modalContainer:"modalContainer-zApaCa",addPromptHeader:"addPromptHeader-q6VlYh",title:"title-Scxbbg",closeBtn:"closeBtn-NP1rwn",addPromptContent:"addPromptContent-W049F8",nameAndIcon:"nameAndIcon-vA7iGP",nameContainer:"nameContainer-nXZryw",name:"name-EvWPpM",nameSuffix:"nameSuffix-jGTdLI",exceed:"exceed-WeMdXB",iconLabel:"iconLabel-ymprhh",prompt:"prompt-vH3ONO",addPromptFooter:"addPromptFooter-lIDBxc",cancelBtn:"cancelBtn-Kti9vV",saveBtn:"saveBtn-CAvWnG",addPromptContentTips:"addPromptContentTips-YkxA_o",addPromptIconChoiceBtn:"addPromptIconChoiceBtn-SLlOq8",isOpen:"isOpen-GI5mH6",addPromptIconChoiceContainer:"addPromptIconChoiceContainer-HPI_Ly",header:"header-FREMQO",IconBtnContainer:"IconBtnContainer-F9WWwj",iconBtnContainer:"IconBtnContainer-F9WWwj",selectedIcon:"selectedIcon-IgFFfR",addPromptContentTipsContainer:"addPromptContentTipsContainer-qWhTAP",demoContainer:"demoContainer-kGpvNy",demoText:"demoText-Z7znMk",demoContext:"demoContext-BF7fU3",demoPrompt:"demoPrompt-SNrkn_",toast:"toast-bO90gH",toastError:"toastError-DSKvc4",deletePrompt:"deletePrompt-It878t",warningIcon:"warningIcon-MZonGR",tips:"tips-om_4m1",btn:"btn-fDdHiU",deleteBtn:"deleteBtn-Jp4lKK",displayModeContainer:"displayModeContainer-dGBZU_",radioItem:"radioItem-ADIdjN",card:"card-SNDMtX",radioContainer:"radioContainer-JOQ85u",radio:"radio-m0DJYi",radioSelected:"radioSelected-YFh2WD","activelink-hover-animation":"activelink-hover-animation-kwyZwj",activelinkHoverAnimation:"activelink-hover-animation-kwyZwj"},vs=(e,t)=>{null==t||t(),d.y8.success({content:e,showClose:!1,icon:(0,q.jsx)(O.wO,{}),className:_s.toast})},fs=(e,t)=>{null==t||t(),d.y8.error({content:e,showClose:!1,className:l()([_s.toastError,_s.toast])})},bs=e=>{const{value:t="page",onChange:n}=e,i=(0,r.B)(),s=[{value:"page",lable:i("flow_web_ext_setting_toolbar_skillpopup_nameicon_resultdisplay_popup"),card:(0,q.jsx)(O.Io,{})},{value:"sidebar",lable:i("flow_web_ext_setting_toolbar_skillpopup_nameicon_resultdisplay_sidebar"),card:(0,q.jsx)(O.RH,{})}];return(0,q.jsx)("div",{className:_s.displayModeContainer,children:s.map((e=>{const i=e.value===t;return(0,q.jsxs)("div",{className:_s.radioItem,children:[(0,q.jsx)("span",{onPointerUp:()=>null==n?void 0:n(e.value),className:_s.card,children:e.card}),(0,q.jsxs)("button",{type:"button",className:_s.radioContainer,onPointerUp:()=>null==n?void 0:n(e.value),children:[(0,q.jsx)("div",{className:l()(_s.radio,{[_s.radioSelected]:i}),children:i&&(0,q.jsx)(O.jk,{})}),(0,q.jsx)("div",{className:_s.radioLable,children:e.lable})]},e.value)]})}))})},xs=e=>{const{title:t,onClose:n,style:i}=e;return(0,q.jsxs)("div",{className:_s.addPromptHeader,style:i,children:[(0,q.jsx)("div",{className:_s.title,children:t}),(0,q.jsx)("div",{className:_s.closeBtn,children:(0,q.jsx)("button",{onPointerUp:n,children:(0,q.jsx)(O.gz,{})})})]})},As=()=>{const[e,t]=(0,s.useState)(!1),n=(0,r.B)(),[i]=(0,y.Y)("selectBarOnlyIcon"),o=(0,s.useRef)(null),a=()=>{(0,ce.z8)(de.Ur.examplePopupClose,{}),t(!1)},l=n("flow_web_ext_setting_toolbar_examplepopup_notice2"),c=l.includes(":")?l.indexOf(":"):l.indexOf("\uff1a");return(0,q.jsxs)("div",{className:_s.addPromptContentTips,ref:o,children:[n("flow_web_ext_setting_toolbar_skillpopup_promptcontent_notice"),(0,q.jsx)("span",{onPointerUp:()=>{(0,ce.z8)(de.Ur.exampleClick,{}),t(!0)},children:n("flow_web_ext_setting_toolbar_skillpopup_prompt_example")}),(0,q.jsx)(d.aF,{centered:!0,visible:e,onCancel:a,header:(0,q.jsx)(xs,{title:n("flow_web_ext_setting_toolbar_skillpopup_prompt_example"),onClose:a,style:{justifyContent:"flex-start"}}),footer:null,children:(0,q.jsxs)("div",{className:_s.addPromptContentTipsContainer,children:[(0,q.jsx)("div",{className:_s.demoContainer,children:(0,q.jsx)(Jn,{style:{border:"none"},selectBarOnlyIcon:i,availableActionList:[u.EU.ask,u.EU.explain,u.EU.translate].map((e=>u.YN[e]))})}),(0,q.jsxs)("div",{className:_s.demoText,children:[(0,q.jsx)("div",{children:n("flow_web_ext_setting_toolbar_examplepopup_notice1")}),(0,q.jsxs)("div",{className:_s.demoContext,children:[(0,q.jsx)("div",{children:c>=0?l.substring(0,c+1):l}),(0,q.jsx)("div",{className:_s.demoPrompt,children:c>=0?l.substring(c+1):""})]})]})]})})]})};var ys=n(79613);const ws=e=>{var t;const n=(0,r.B)(),{onChange:i,value:o="customSkillIcon0"}=e,[a,c]=(0,s.useState)(!1),u=null===(t=(0,Bn.A)())||void 0===t?void 0:t.getPopupContainer,m=(0,s.useMemo)((()=>Object.keys(ys.M)),[]);return(0,q.jsx)(d.AM,{getPopupContainer:u,trigger:"custom",visible:a,position:"bottomRight",className:_s.addPromptIconChoiceContainer,onClickOutSide:()=>c(!1),content:(0,q.jsxs)("div",{children:[(0,q.jsxs)("div",{className:_s.header,children:[(0,q.jsx)("span",{children:n("flow_web_ext_setting_toolbar_skillpopup_nameicon_icon")}),(0,q.jsx)("button",{onPointerUp:()=>c(!1),children:(0,q.jsx)(O.gz,{})})]}),(0,q.jsx)("div",{className:_s.IconBtnContainer,children:m.map((e=>(0,q.jsx)("button",{className:l()({[_s.selectedIcon]:e===o}),onPointerUp:()=>{return t=e,i&&i(t),void c(!1);var t},children:(0,O.I)(e)},e)))})]}),children:(0,q.jsx)("button",{type:"button",className:_s.addPromptIconChoiceBtn,value:o,onPointerUp:()=>{(0,ce.z8)(de.Ur.skillPopupIconClick,{}),c(!a)},children:(0,O.I)(o)})})},Ss=e=>{const{info:{editId:t,visible:n},setInfo:o,activeKey:a}=e,[c,u]=(0,s.useState)(!1),[m,h]=(0,s.useState)(""),{className:p,onScroll:g}=(0,ps.j)(),_=(0,r.B)(),v=(0,s.useRef)(),f=[{label:_("flow_web_ext_setting_toolbar_websites"),value:"reading"},{label:_("flow_web_ext_setting_toolbar_texts"),value:"editing"}],[b]=(0,y.Y)("editingPopupActions"),[x]=(0,y.Y)("readingPopupActions"),w="while_editing_texts"===a,S=(0,s.useMemo)((()=>{if(t)return w?b.actionList.find((e=>e.id===t))||b.moreActionList.find((e=>e.id===t)):x.actionList.find((e=>e.id===t))||x.moreActionList.find((e=>e.id===t))}),[b,x,t,a]),[j,k]=(0,s.useState)((null==S?void 0:S.icon)||"customSkillIcon0"),[C,I]=(0,s.useState)((null==S?void 0:S.displayMode)||"page"),T=Boolean(null==S?void 0:S.confId),N=(0,s.useCallback)((()=>{u(!1),o({visible:!1})}),[]),E=e=>{if(v.current){const{icon:t="customSkillIcon0",name:n="",prompt:i="",used:s=[]}=v.current.getValues();ki(e,{skill_name:n,prompt_content:i,icon_id:t,in_viewwebsite:s.includes("reading")?"1":"0",in_editcontent:s.includes("editing")?"1":"0"})}N()},M=(0,s.useCallback)((()=>{vs(_("flow_web_ext_setting_toolbar_skillsaved"),(()=>N()))}),[]),P=(0,s.useCallback)((()=>{fs(_("flow_web_ext_setting_toolbar_savefailed"),(()=>u(!1)))}),[]),L=(0,s.useCallback)(function(){var e=(0,i.A)((function*(e){u(!0);const{icon:t=(null==S?void 0:S.icon)||"customSkillIcon0",name:n=(null==S?void 0:S.name)||"",prompt:i=(null==S?void 0:S.prompt)||"",used:s=[],displayMode:o=(null==S?void 0:S.displayMode)||"page"}=e||{};if(ki(de.Ur.skillPopupSave,{skill_name:n,prompt_content:i,icon_id:t,in_viewwebsite:s.includes("reading")?"1":"0",in_editcontent:s.includes("editing")?"1":"0"}),S){if(t!==S.icon||n!==S.name||i!==S.prompt||o!==S.displayMode){S.icon=t,S.name=n,S.prompt=i,S.displayMode=o;const e=yield function(e){return ts.apply(this,arguments)}({id:S.id,icon:t,title:n,prompt:i,displayMode:o,useIn:w?"editing":"reading",conf_id:S.confId,item_type:S.confId?2:1});""===e?(w?(0,A.vE)("editingPopupActions",{actionList:b.actionList,moreActionList:b.moreActionList}):(0,A.vE)("readingPopupActions",{actionList:x.actionList,moreActionList:x.moreActionList}),M()):P()}else M();return}if(!s.length)return void N();const a=[];s.includes("reading")&&a.push({icon:t,title:n,prompt:i,useIn:"reading",displayMode:o}),s.includes("editing")&&a.push({icon:t,title:n,prompt:i,useIn:"editing",displayMode:o});const l=yield Zi(a);(null==l?void 0:l.length)===a.length?(a.forEach(((e,s)=>{const a="reading"===e.useIn?"readingPopupActions":"editingPopupActions",r="reading"===e.useIn?x:b;r.moreActionList.unshift({id:l[s],icon:t,prompt:i,name:n,displayMode:o}),(0,A.vE)(a,r)})),yield ns(),M()):P()}));return function(t){return e.apply(this,arguments)}}(),[x,b,S]),D=(0,d.ZH)(ws,{valueKey:"value",onKeyChangeFnName:"onChange"}),R=(0,d.ZH)(bs,{valueKey:"value",onKeyChangeFnName:"onChange"});return(0,s.useEffect)((()=>{n&&(k((null==S?void 0:S.icon)||"customSkillIcon0"),I((null==S?void 0:S.displayMode)||"page"),h(S?_(S.name):""))}),[n,S]),(0,q.jsx)(d.aF,{centered:!0,visible:n,footer:null,"data-testid":"options-add-skill-modal",header:(0,q.jsx)(xs,{title:_(S?"flow_web_ext_setting_toolbar_editskill_title":"flow_web_ext_setting_toolbar_addskill"),onClose:()=>E(de.Ur.skillPopupClose)}),style:{padding:0},className:_s.modalContainer,children:(0,q.jsxs)(d.lV,{onSubmit:L,getFormApi:e=>v.current=e,extraTextPosition:"middle",children:[(0,q.jsx)(gs.B,{showScrollbar:!0,onScroll:()=>{g()},className:l()(p),style:{maxHeight:"calc(100vh - 120px - 48px - 28px - 38px)"},children:(0,q.jsxs)("div",{className:_s.addPromptContent,children:[!T&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:_s.nameAndIcon,children:[(0,q.jsx)("div",{className:_s.nameContainer,children:(0,q.jsx)(d.lV.Input,{"data-testid":"options-add-skill-input-name",field:"name",label:_("flow_web_ext_setting_toolbar_skillpopup_nameicon"),placeholder:_("flow_web_ext_setting_toolbar_skillpopup_nameinput"),className:_s.name,trigger:["blur","change"],rules:[{required:!0,message:_("flow_web_ext_setting_toolbar_skillpopup_nameicon_notice")},{validator:(e,t)=>!t||t.length<=20,message:_("flow_web_ext_setting_toolbar_skillpopup_nameicon_notice_length")}],autoComplete:"off",initValue:S?_(S.name):"",onChange:h,suffix:(0,q.jsxs)("span",{className:_s.nameSuffix,children:[(0,q.jsx)("span",{className:l()({[_s.exceed]:m.length>20}),children:m.length}),"/20"]})})}),(0,q.jsx)(D,{field:"icon",label:(0,q.jsx)("div",{className:_s.iconLabel,children:"icon"}),initValue:j,onChange:e=>k(e)})]}),(0,q.jsx)(d.lV.TextArea,{"data-testid":"options-add-skill-input-prompt",field:"prompt",label:_("flow_web_ext_setting_toolbar_skillpopup_prompt"),placeholder:_("flow_web_ext_setting_toolbar_skillpopup_prompt_input"),className:_s.prompt,trigger:["blur","change"],rules:[{required:!0,message:_("flow_web_ext_setting_toolbar_skillpopup_prompt_notice")},{validator:(e,t)=>!t||t.length<=16e3,message:_("flow_web_ext_setting_toolbar_skillpopup_prompt_notice_length")}],extraText:(0,q.jsx)(As,{}),initValue:S?S.prompt:""}),!S&&(0,q.jsx)(d.lV.CheckboxGroup,{field:"used",direction:"horizontal",label:_("flow_web_ext_setting_toolbar_skillpopup_conditiontitle"),options:f,initValue:f.map((e=>e.value)),rules:[{required:!0,message:_("flow_web_ext_setting_toolbar_skillpopup_condition_notice")}],style:{gap:"30px",marginBottom:"12px"}})]}),(0,q.jsx)(R,{field:"displayMode",label:_("flow_web_ext_setting_toolbar_skillpopup_nameicon_resultsdisplay"),initValue:C,onChange:e=>I(e)})]})}),(0,q.jsxs)("div",{className:_s.addPromptFooter,children:[(0,q.jsx)("button",{type:"button",className:_s.cancelBtn,onPointerUp:()=>E(de.Ur.skillPopupCancel),children:(0,q.jsx)("span",{children:_("flow_web_ext_setting_toolbar_skillpopup_cancel")})}),(0,q.jsx)(d.$n,{loading:c,htmlType:"submit",className:_s.saveBtn,"data-testid":"option-select-addSkill-save",children:_("flow_web_ext_setting_toolbar_skillpopup_save")})]})]})})};var js=n(6693);const ks=e=>e.startsWith("data:")?e:"https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/"+e,Cs="saman_skill_card_";var Is=n(86012),Ts=n(43684);const Ns=e=>{const{saveSkillSetting:t,onConfirm:n,onCancel:o}=e,[a,c]=(0,s.useState)(!1),u=(0,r.B)(),m=(0,s.useRef)(),[h,p]=(0,s.useState)("page"),g=(0,d.ZH)(bs,{valueKey:"value",onKeyChangeFnName:"onChange"}),[_]=(0,y.Y)("editingPopupActions"),[v]=(0,y.Y)("readingPopupActions"),{className:f,onScroll:b}=(0,ps.j)();if((0,s.useEffect)((()=>{t&&p("page")}),[t]),!t)return null;const x=[{label:u("flow_web_ext_setting_toolbar_websites"),value:"reading",disabled:t.selected_in_reading},{label:u("flow_web_ext_setting_toolbar_texts"),value:"editing",disabled:t.selected_in_editing}],w=()=>{c(!1),null==o||o()},S=function(){var e=(0,i.A)((function*(e){c(!0);const{used:i,displayMode:s}=e;if(null==i||!i.length||!s)return null==n||n(),void w();const o=[],{name:a="",conf_id:l,bot_id:r,agent_id:d}=t,m=ks(t.icon||"");i.includes("reading")&&o.push({icon:m,title:a,prompt:"",useIn:"reading",displayMode:s,conf_id:l,item_type:2,skill_agent_id:d,skill_bot_id:r}),i.includes("editing")&&o.push({icon:m,title:a,prompt:"",useIn:"editing",displayMode:s,conf_id:l,item_type:2,skill_agent_id:d,skill_bot_id:r});const h=yield Zi(o);(null==h?void 0:h.length)===o.length?(o.forEach(((e,t)=>{const n="reading"===e.useIn?"readingPopupActions":"editingPopupActions",i="reading"===e.useIn?v:_;i.moreActionList.unshift({id:h[t],icon:m,prompt:"",name:a,confId:l,displayMode:s}),(0,A.vE)(n,i)})),yield ns(),vs(u("flow_web_ext_setting_toolbar_skillsaved"),(()=>{w(),null==n||n()}))):fs(u("flow_web_ext_setting_toolbar_savefailed"),(()=>c(!1)))}));return function(t){return e.apply(this,arguments)}}();return(0,q.jsx)(d.aF,{centered:!0,visible:!0,footer:null,header:(0,q.jsx)(xs,{title:`${u("friends_add_button")}${u(t.name||"")}`,onClose:w}),onCancel:w,style:{padding:0},className:_s.modalContainer,children:(0,q.jsxs)(d.lV,{onSubmit:S,getFormApi:e=>m.current=e,extraTextPosition:"middle",children:[(0,q.jsx)(gs.B,{showScrollbar:!0,onScroll:()=>{b()},className:l()(f),style:{maxHeight:"calc(100vh - 120px - 48px - 28px - 38px)"},children:(0,q.jsxs)("div",{className:_s.addPromptContent,children:[(0,q.jsx)(d.lV.CheckboxGroup,{field:"used",direction:"horizontal",label:u("flow_web_ext_setting_toolbar_skillpopup_conditiontitle"),options:x,initValue:x.filter((e=>!e.disabled)).map((e=>e.value)),rules:[{required:!0,message:u("flow_web_ext_setting_toolbar_skillpopup_condition_notice")}],style:{gap:"30px",marginBottom:"12px"}}),(0,q.jsx)(g,{field:"displayMode",label:u("flow_web_ext_setting_toolbar_skillpopup_nameicon_resultsdisplay"),initValue:h,onChange:e=>p(e)})]})}),(0,q.jsxs)("div",{className:_s.addPromptFooter,children:[(0,q.jsx)("button",{type:"button",className:_s.cancelBtn,onPointerUp:w,"data-testid":"option-discoverSkill-deleteBtn",children:(0,q.jsx)("span",{children:u("flow_web_ext_setting_toolbar_skillpopup_cancel")})}),(0,q.jsx)(d.$n,{loading:a,htmlType:"submit",className:_s.saveBtn,"data-testid":"option-discoverSkill-saveBtn",children:u("flow_web_ext_setting_toolbar_skillpopup_save")})]})]})})},Es="discover-modal-kpptRc",Ms="loading-FHGwJF",Ps="modal-title-XCqTRQ",Ls="discover-modal-content-vLy_Cz",Ds="skills-card-Yga9dj",Rs="card-vYCKMi",Bs="card-top-WDYFsQ",Os="imgURL-CKXFnI",Us="card-icon-box-WWZpaD",Fs="icon-hZ8bBQ",qs="card-bottom-xCIKNp",Hs="title-EaTxXr",Vs="author-S9lv3h",Ks="add-T2K1nl",zs="addIcon-GReNeN",Gs="added-i4HON8",$s="addedIcon-jBaIgx",Ws="addButton-lsu4Q1",Ys=({discoverSkillsList:e,setVisible:t})=>{const n=(0,r.B)(),[o]=(0,y.Y)("editingPopupActions"),[a]=(0,y.Y)("readingPopupActions"),[c,d]=(0,s.useState)(null),u=(0,s.useMemo)((()=>{const t=new Set;o.actionList.forEach((e=>e.confId&&t.add(e.confId))),o.moreActionList.forEach((e=>e.confId&&t.add(e.confId)));const n=new Set;return a.actionList.forEach((e=>e.confId&&n.add(e.confId))),a.moreActionList.forEach((e=>e.confId&&n.add(e.confId))),e.map((e=>(0,m.A)((0,m.A)({},e),{},{selected_in_editing:t.has(e.conf_id),selected_in_reading:n.has(e.conf_id)})))}),[o,a,e]),h=function(){var e=(0,i.A)((function*(e,t){const n=e?o:a,i=[...n.actionList,...n.moreActionList].filter((e=>t===e.confId));if(i.length)for(const s of i){if(""!==(yield Ji(s.id)))return!1;(0,A.vE)(e?"editingPopupActions":"readingPopupActions",{actionList:n.actionList.filter((e=>e.id!==s.id)),moreActionList:n.moreActionList.filter((e=>e.id!==s.id))})}return!0}));return function(t,n){return e.apply(this,arguments)}}(),p=function(){var e=(0,i.A)((function*(e){try{const t=yield h(!0,e.conf_id),i=yield h(!1,e.conf_id);t&&i?vs(n("flow_web_ext_setting_toolbar_skilldeleted")):fs(n("flow_web_ext_setting_toolbar_deletefailed"))}catch(t){fs(n("flow_web_ext_setting_toolbar_deletefailed"))}}));return function(t){return e.apply(this,arguments)}}();return(0,q.jsxs)(q.Fragment,{children:[u.map(((e,t)=>(0,q.jsxs)("div",{className:Rs,id:`${Cs+t}`,"data-testid":`${Cs+t}-container`,children:[(0,q.jsxs)("div",{className:Bs,children:[(0,q.jsx)("img",{src:ks(e.cover||""),alt:"img",className:Os}),(0,q.jsx)("div",{className:Us,children:(0,q.jsx)("img",{src:ks(e.icon||""),alt:"ic",className:Fs})})]}),(0,q.jsxs)("div",{className:qs,children:[(0,q.jsxs)("div",{children:[e.name&&(0,q.jsx)("div",{className:Hs,children:n(e.name)}),e.author&&(0,q.jsxs)("div",{className:Vs,children:["@",n(e.author)]})]}),e.selected_in_editing&&e.selected_in_reading?(0,q.jsx)("div",{className:l()(Gs,Ws),onClick:()=>p(e),"data-testid":`${Cs+t}-doneBtn`,children:(0,q.jsx)(Is.A,{className:$s})}):(0,q.jsx)("div",{className:l()(Ks,Ws),onClick:()=>(e=>{d(e)})(e),"data-testid":`${Cs+t}-plusBtn`,children:(0,q.jsx)(Ts.A,{className:zs})})]})]},t+((null==e?void 0:e.bot_id)||"")))),(0,q.jsx)(Ns,{saveSkillSetting:c,onCancel:()=>d(null),onConfirm:()=>t(!1)})]})},Qs="load-more-wrapper-KDso8R",Zs=(0,s.forwardRef)((function(e,t){const{safeMargin:n="15",className:i=""}=e;return(0,q.jsx)("div",{className:l()(Qs,i),style:{marginBottom:`${n}px`},ref:t,children:(0,q.jsx)(d.tK,{size:"middle"})})}));function Xs(){return(Xs=(0,i.A)((function*(e,t){const n=yield(0,We.ew)({method:"POST",url:`${Oe.kD}/plugin/prompt_skill/list_discover_skills`,data:{frontend_source:1,page_size:e,start_index:t}}),{data:i,has_more:s}=n;return{data:i,has_more:s}}))).apply(this,arguments)}const Js=e=>{const{visible:t,setVisible:n}=e,o=(0,r.B)(),{className:a,onScroll:c}=(0,ps.j)(),u=(0,s.useRef)(null),[m,h]=(0,s.useState)([]),[p,g]=(0,s.useState)(!0),[_,v]=(0,s.useState)(!1),f=function(){var e=(0,i.A)((function*(){if(!p)return;v(!0);const e=yield function(e,t){return Xs.apply(this,arguments)}(10,m.length);if(v(!1),!e.data)return;const{data:t,has_more:n}=e;h([...m,...t]),g(Boolean(n))}));return function(){return e.apply(this,arguments)}}();(0,s.useEffect)((()=>{t&&(m.length||f())}),[t,m.length]);const b=(0,s.useCallback)((0,js.A)((()=>{!_&&p&&f()}),300),[m,_,p,f]);return(0,q.jsx)(d.aF,{title:(0,q.jsx)("div",{className:Ps,children:o("cici_desktop_text_selection_setting_selection_skills")}),"data-testid":"options-discover-skills-modal",visible:t,className:Es,width:"800px",footer:null,centered:!0,onCancel:()=>n(!1),children:0===(null==m?void 0:m.length)&&_?(0,q.jsx)("div",{className:Ms,children:(0,q.jsx)(d.tK,{size:"middle"})}):(0,q.jsxs)(gs.B,{reachBottomThreshold:100,onReachBottom:b,ref:u,showScrollbar:!0,onScroll:()=>{c()},className:l()(a,Ls,`${Cs}container`),children:[(0,q.jsx)("div",{className:Ds,children:(0,q.jsx)(Ys,{discoverSkillsList:m,setVisible:n})}),p&&_&&(null==m?void 0:m.length)>0&&(0,q.jsx)(Zs,{})]})})};var eo=n(99346);const to=e=>{const{id:t,setId:n,activeKey:o}=e,a=(0,r.B)(),[l]=(0,y.Y)("editingPopupActions"),[c]=(0,y.Y)("readingPopupActions"),u="while_editing_texts"===o;if(!(0,s.useMemo)((()=>{if(t)return u?l.actionList.find((e=>e.id===t))||l.moreActionList.find((e=>e.id===t)):c.actionList.find((e=>e.id===t))||c.moreActionList.find((e=>e.id===t))}),[l,c,t,o]))return null;const m=()=>{n("")},h=function(){var e=(0,i.A)((function*(){try{""===(yield Ji(t))?(u?(0,A.vE)("editingPopupActions",{actionList:l.actionList.filter((e=>e.id!==t)),moreActionList:l.moreActionList.filter((e=>e.id!==t))}):(0,A.vE)("readingPopupActions",{actionList:c.actionList.filter((e=>e.id!==t)),moreActionList:c.moreActionList.filter((e=>e.id!==t))}),vs(a("flow_web_ext_setting_toolbar_skilldeleted"))):fs(a("flow_web_ext_setting_toolbar_deletefailed"))}catch(e){fs(a("flow_web_ext_setting_toolbar_deletefailed"))}m()}));return function(){return e.apply(this,arguments)}}();return(0,q.jsxs)(d.aF,{centered:!0,visible:!0,footer:null,header:(0,q.jsx)(eo.A,{className:_s.warningIcon}),onCancel:m,style:{width:"360px"},className:_s.deletePrompt,children:[(0,q.jsx)("div",{className:_s.tips,children:a("flow_web_ext_setting_toolbar_deletepopup_notice")}),(0,q.jsxs)("div",{className:_s.btn,children:[(0,q.jsx)("button",{className:_s.deleteBtn,onPointerUp:h,"data-testid":"modal-delete-btn",children:a("flow_web_ext_setting_toolbar_deletepopup_delete")}),(0,q.jsx)("button",{className:_s.cancelBtn,onPointerUp:m,children:a("flow_web_ext_setting_toolbar_deletepopup_cancel")})]})]})},no=e=>{const{setPromptEditorInfo:t,setDiscoverSkillVisible:n}=e,[i]=(0,y.Y)("authInfo"),o=(0,r.B)(),a=(0,s.useCallback)((()=>{i.isAuthenticated?(t({visible:!0}),(0,ce.z8)(de.Ur.newSkillAdd,{})):(0,Ut.DT)()}),[i]),l=(0,s.useCallback)((()=>{i.isAuthenticated?n(!0):(0,Ut.DT)()}),[i]);return(0,q.jsx)(q.Fragment,{children:(0,q.jsxs)("div",{className:_s.skillBtnContainer,children:[(0,q.jsxs)("button",{className:_s.newPromptBtn,onPointerUp:a,"data-testid":"option-select-addSkill",children:[(0,q.jsx)("div",{className:_s.icon,children:(0,q.jsx)(Ts.A,{})}),(0,q.jsx)("span",{className:_s.lable,children:o("flow_web_ext_setting_toolbar_addskill")})]}),(0,q.jsxs)("button",{className:_s.discoverBtn,onPointerUp:l,"data-testid":"option-select-discoverSkill",children:[(0,q.jsx)("div",{className:_s.icon,children:(0,q.jsx)(oe.A,{})}),(0,q.jsx)("span",{className:_s.lable,children:o("flow_web_ext_setting_toolbar_discover")})]})]})})},io={tabs:"tabs-MSRfYc","tab-item":"tab-item-eF1G15",tabItem:"tab-item-eF1G15",active:"active-oXYXEO","tab-content":"tab-content-o82cP7",tabContent:"tab-content-o82cP7",content:"content-TPd3QO",inactive:"inactive-D3tZ2L","slide-in-left":"slide-in-left-ggLvMN",slideInLeft:"slide-in-left-ggLvMN",leftShow:"leftShow-K0b9fN","slide-in-right":"slide-in-right-j_jsFV",slideInRight:"slide-in-right-j_jsFV",rightShow:"rightShow-rSlf0f"},so=({children:e})=>(0,q.jsx)("div",{children:e}),oo=e=>{const[t,n]=(0,s.useState)(!1),{children:i,className:o,onChange:a}=e,r=s.Children.toArray(i).filter((e=>s.isValidElement(e)&&"itemKey"in e.props)),[c,d]=(0,s.useState)(e.activeKey||r[0].props.itemKey),[u,m]=(0,s.useState)(""),[h,p]=(0,s.useState)(!0);return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{className:l()(io.tabs,o),children:r.map((e=>{const{itemTitle:t,itemKey:i}=e.props;return(0,q.jsx)("div",{className:l()(io["tab-item"],{[io.active]:c===i}),onClick:()=>{c!==i&&(m(c),d(i),p(!1),n(!0),null==a||a(i))},"data-testid":`tab-${i}`,children:t},i)}))}),(0,q.jsx)("div",{className:io["tab-content"],children:r.map(((e,i)=>{const s=e.props.itemKey===c;let o="left";if(s){o=r.findIndex((e=>e.props.itemKey===u))>i?"right":o}return(0,q.jsx)("div",{className:l()(io.content,{[io[`slide-in-${o}`]]:s&&!h&&t,[io.inactive]:!s}),onAnimationEnd:()=>{setTimeout((()=>{n(!1)}),300)},"data-testid":`content-${e.props.itemKey}`,children:e.props.children})}))})]})};let ao=!0;const lo=()=>{const[e,t]=(0,s.useState)("while_reading_websites"),[n,i]=(0,s.useState)({visible:!1,editId:""}),[o,a]=(0,s.useState)(!1),[l,c]=(0,s.useState)(""),d=(0,r.B)(),u=[{key:"while_reading_websites",title:d("flow_web_ext_setting_toolbar_websites")},{key:"while_editing_texts",title:d("flow_web_ext_setting_toolbar_texts")}];return(0,s.useEffect)((()=>{if(ao){const e=new URLSearchParams(window.location.search),t=e.get("add_prompt"),n=e.get("discover_skill");t?i({visible:!0}):n&&a(!0)}ao=!1}),[]),(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:wi.skillHeader,children:[(0,q.jsx)("h2",{className:ui,style:{paddingLeft:"0px",marginTop:"0px"},children:d("flow_web_ext_setting_toolbar_skillmanage")}),(0,q.jsx)(no,{setPromptEditorInfo:i,setDiscoverSkillVisible:a})]}),(0,q.jsx)(oo,{onChange:e=>{t(e)},children:u.map((t=>(0,q.jsx)(so,{itemKey:t.key,itemTitle:t.title,children:(0,q.jsx)(hs,{tabType:t.key,isActive:t.key===e,setPromptEditorInfo:i,setDeleteId:c})},t.key)))}),(0,q.jsx)(Ss,{info:n,setInfo:i,activeKey:e}),(0,q.jsx)(to,{id:l,setId:c,activeKey:e}),(0,q.jsx)(Js,{visible:o,setVisible:a})]})};var ro=n(56422);const co=(e,t)=>(0,Ve.wz)((0,A.TK)("uiLanguage")).startsWith("zh")?e:t,uo=(e,t)=>(0,ro.A)(e,(e=>e!==t)),mo="site-oDvfBz",ho="info-nvmdGB",po="favicon-vxaS0i",go="url-RH7gtl",_o="icon-CZnTFF",vo=e=>{const{url:t,favicon:n,onDelete:i}=e,[o,a]=(0,s.useState)(n);return(0,q.jsxs)("div",{className:mo,children:[(0,q.jsxs)("div",{className:ho,children:[(0,q.jsx)("img",{src:o,className:po,onError:()=>a("")}),(0,q.jsx)("span",{className:go,children:t})]}),(0,q.jsx)(O.E,{className:_o,onClick:i})]})},fo="wrapper-nvcfa9",bo="caption-nxFLd1",xo="sites-FUMhtM",Ao=e=>{const{className:t,style:n,disableHosts:i,onDeleteHost:s}=e,o=(0,r.B)();return(0,q.jsxs)("div",{className:l()(fo,t),style:n,children:[(0,q.jsx)("div",{className:bo,children:o("flow_web_ext_setting_disable")}),(0,q.jsx)("div",{className:xo,children:i.map((e=>(0,q.jsx)(vo,{url:e,favicon:`https://s2.googleusercontent.com/s2/favicons?domain=${e}&sz=32`,onDelete:()=>null==s?void 0:s(e)},e)))})]})};var yo=n(82770),wo=n(17933),So=n(36481);const jo=e=>{const{reportEventScene:t,globalDisable:n}=e;(0,So.H)((()=>{var e;void 0!==n&&t&&(null===(e=yo.Ay.Tea)||void 0===e||e.event("always_show_skill",{button_name:(0,wo.Yx)(t),current_page:"setting",whether_show:n?0:1}))}),[n])},ko="wrapper-p7UmGt",Co="caption-XgSv4j",Io="card-XVYKUn",To="illustration-B8ZpHE",No="global-switch-rJTPzM",Eo="meta-WdO3zg",Mo="description-fS3Hwv",Po="switch-BIJos3",Lo=e=>{const{className:t,style:n,caption:i,illustration:s,globalDisableIcon:o,reportEventScene:a,globalDisable:r=!1,enableGlobalDisable:c=!0,globalDisableDescription:u,disableHosts:m,onDeleteHost:h,onGlobalDisableChange:p,switchContainerClassName:g,dataTestId:_}=e;return jo({globalDisable:r,reportEventScene:a}),(0,q.jsxs)("div",{className:l()(ko,t),style:n,"data-testid":_,children:[i&&(0,q.jsx)("div",{className:Co,children:i}),(0,q.jsxs)("div",{className:Io,children:[s&&(0,q.jsx)("img",{className:To,src:s}),(0,q.jsxs)("div",{className:l()(No,g),children:[(0,q.jsxs)("div",{className:Eo,children:[o,(0,q.jsx)("span",{className:Mo,children:u})]}),c&&(0,q.jsx)(d.dO,{className:Po,checked:!r,onChange:e=>null==p?void 0:p(!e)})]})]}),m&&m.length>0?(0,q.jsx)(Ao,{style:{marginTop:24},disableHosts:m,onDeleteHost:h}):null]})},Do=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsxs)("g",{clipPath:"url(#select-bar_svg__a)",children:[(0,q.jsx)("path",{fill:"url(#select-bar_svg__b)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M10.537 11.625a.4.4 0 0 1-.287-.111.4.4 0 0 1-.111-.287q0-.165.111-.27a.4.4 0 0 1 .287-.111h4.465q.17 0 .281.111.111.105.112.27a.4.4 0 0 1-.112.287.38.38 0 0 1-.281.111zm0 5.074a.4.4 0 0 1-.287-.105.37.37 0 0 1-.111-.276q0-.17.111-.28a.38.38 0 0 1 .287-.118h4.465q.17 0 .281.117a.38.38 0 0 1 .112.281q0 .164-.112.276a.4.4 0 0 1-.281.105zm-1.465 2.678q-1.002 0-1.535-.533-.533-.528-.533-1.524v-7.09q0-1.001.533-1.529.534-.527 1.535-.527h9.85q1.008 0 1.535.533.533.528.533 1.523v7.09q0 .996-.533 1.524-.528.533-1.535.533zm.164-1.512h9.522q.351 0 .533-.175.188-.182.188-.557v-6.72q0-.375-.188-.552-.182-.175-.533-.175H9.236q-.351 0-.539.175-.18.177-.181.551v6.72q0 .375.181.557.188.176.54.176m.78-2.73q-.38 0-.598-.223t-.217-.61v-1.077q0-.387.217-.61t.598-.222h7.974q.387 0 .598.222.216.223.217.61v1.078q0 .385-.217.61-.21.221-.598.222zm.521-.973h2.654a.38.38 0 0 0 .282-.111.4.4 0 0 0 .111-.287.381.381 0 0 0-.393-.38h-2.654a.4.4 0 0 0-.287.11.37.37 0 0 0-.111.27q0 .17.111.287.111.111.287.111"})]}),(0,q.jsxs)("defs",{children:[(0,q.jsxs)("linearGradient",{id:"select-bar_svg__b",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]}),(0,q.jsx)("clipPath",{id:"select-bar_svg__a",children:(0,q.jsx)("path",{fill:"#fff",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"})})]})]})),Ro=()=>{const e=(0,s.useRef)(null),t=(0,r.B)(),[n,i]=(0,y.Y)("quickDisabledAll"),[o,a]=(0,y.Y)("quickDisabledHosts"),l=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/select.a1b2aaa4.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/select.4221eba8.png");return(0,q.jsxs)("div",{ref:e,style:{position:"relative"},children:[(0,q.jsx)("h2",{className:di,children:t("flow_web_ext_setting_toolbarconfig")}),(0,q.jsx)(Lo,{illustration:l,globalDisableIcon:(0,q.jsx)(Do,{}),globalDisableDescription:t("flow_web_ext_setting_toolbar_switch"),globalDisable:n,reportEventScene:hn.lf.selectAssistant,onGlobalDisableChange:i}),(0,q.jsx)(yi,{}),(0,q.jsx)(lo,{}),o.length>0&&(0,q.jsx)(Ao,{style:{marginTop:12},disableHosts:o,onDeleteHost:e=>a(uo(o,e))})]})};var Bo=n(32138),Oo=n(37462),Uo=n(59980),Fo=n(13094);const qo={[J.e.OpenSide]:"sidebar",[J.e.TranslatePage]:"translate",[J.e.ReadPage]:"summarize",[J.e.HoverTextTranslate]:"hover_text_translate",[J.e.BilingualSubtitles]:"bilingual_subtitles",[J.e.ScreenCapture]:"screen_capture",[J.e.TTSReadPage]:"tts_read_page",[J.e.VoiceInput]:"voice_input",[J.e.CollectPage]:"collect_page"};const Ho=[J.e.BilingualSubtitles,J.e.VoiceInput],Vo=(e,t)=>e(t?"flow_web_ext_setting_shortcut_sidebar_tip_mac":"flow_web_ext_setting_shortcut_sidebar_tip_win"),Ko={[J.e.OpenSide]:{desc:Vo,list:()=>[`${(0,ee.ZH)()}+K`,`${(0,ee.Z8)()}+K`,`${ee.vK.Ctrl}+${ee.vK.Shift}+L`]},[J.e.VoiceInput]:{desc:e=>e("flow_web_ext_setting_customize_shortcut_tip1"),list:()=>["B"]},[J.e.TranslatePage]:{desc:Vo,list:()=>[`${(0,ee.Z8)()}+1`,`${ee.vK.Ctrl}+${ee.vK.Shift}+1`]},[J.e.ReadPage]:{desc:Vo,list:()=>[`${(0,ee.Z8)()}+2`,`${ee.vK.Ctrl}+${ee.vK.Shift}+2`]},[J.e.ScreenCapture]:{desc:Vo,list:()=>[`${(0,ee.Z8)()}+3`,`${ee.vK.Ctrl}+${ee.vK.Shift}+3`]},[J.e.CollectPage]:{desc:Vo,list:()=>[`${(0,ee.Z8)()}+4`,`${ee.vK.Ctrl}+${ee.vK.Shift}+4`]},[J.e.TTSReadPage]:{desc:Vo,list:()=>[`${(0,ee.Z8)()}+5`,`${ee.vK.Ctrl}+${ee.vK.Shift}+5`]},[J.e.HoverTextTranslate]:{desc:e=>e("flow_web_ext_setting_customize_shortcut_tip2"),list:()=>[`${(0,ee.Z8)()}+Z`,`${(0,ee.ZH)()}+E`,`${(0,ee.ZH)()}+${(0,ee.Z8)()}+E`,`${(0,ee.ZH)()}`]},[J.e.BilingualSubtitles]:{desc:e=>e("flow_web_ext_setting_video_hide_subtitles_tooltip")}};var zo=n(59517);const Go="input-container-UmtZ0k",$o="show-border-uCWd_r",Wo="input-area-s9rXqY",Yo="placeholder-nccdFD",Qo="delete-icon-sEmhxt",Zo="card-iXDqT7",Xo="menu-zyUlZN",Jo="title-y9PLcE",ea="item-ZnfUJ1",ta="divider-SO7nO3",na="block-container-UGy3PM",ia="mute-shortcut-YRrckI",sa="active-shortcut-o7JOr3",oa=({type:e,onShortcutSetDone:t=Oo.A})=>{const n=(0,r.B)(),{isMac:i,editing:o,shortcutKey:a,handleClickInputBox:c,inputBoxClickOutside:u,clearShortcutKey:m,handleTryUpdateShortcutKey:h}=((e,t=Oo.A)=>{const[n,i]=(0,s.useState)(!1),{shortcutKey:o,setShortcutKey:a}=ne(e),l=(0,s.useRef)(!1),[c,d]=(0,s.useState)(o),u=(0,r.B)(),m=(0,ee.Ue)();(0,s.useEffect)((()=>{n||(""===c||c.endsWith("+"))&&(p(""),a(""),t(""))}),[c,n]);const h=(0,s.useCallback)((()=>{l.current||(a(c),t(c))}),[c]),p=e=>{d(e)},g=t=>{const n=(0,A.gv)();if(n){const i=t.split("+");if(Object.keys(n).find((t=>{const s=n[t].key.split("+");if(e===t)return!1;if(i.length!==s.length)return!1;for(let e=i.length-1;e>=0;e-=1)if(!s.includes(i[e]))return!1;return!0})))return p(""),Fo.y.warning({content:u("flow_web_ext_setting_shortcut_fail_confilct"),showClose:!1,theme:"light"}),void(l.current=!0)}p(t),l.current=!1},_=t=>{const n=t.replace(/\+/g,""),i=n===(0,ee.AI)(ee.jv.Command),s=n===(0,ee.AI)(ee.jv.Option),o=i||s;if(Ho.includes(e)){const e=/^[A-Z]$/.test(n);return o||!e?(l.current=!0,void p("")):(l.current=!1,void p(n))}if(e===J.e.HoverTextTranslate){if(!o)return l.current=!0,void p("");l.current=!1,p(n)}else l.current=!0},v=t=>{if(Ho.includes(e)){const e=(0,ee.Lj)(t.code);return void(""!==e&&_(e))}if("Backspace"===t.key)return p(""),void t.preventDefault();let n=!1,i="";if(t.ctrlKey&&(i+=`${ee.vK.Ctrl}+`,n=!0,p(i)),t.metaKey&&(i+=`${m?ee.vK.Command:ee.vK.Windows}+`,n=!0,p(i)),t.altKey&&(i+=`${m?ee.vK.Option:ee.vK.Alt}+`,n=!0,p(i)),t.shiftKey&&(i+=`${ee.vK.Shift}+`,n&&p(i)),n){const e=(0,ee.Lj)(t.code);""!==e?(i+=e,g(i)):_(i)}else l.current=!0,p("");t.preventDefault()};return(0,s.useEffect)((()=>{if(n)return document.addEventListener("keydown",v),document.addEventListener("keyup",h),()=>{document.removeEventListener("keydown",v),document.removeEventListener("keyup",h)}}),[n,h]),{isMac:m,editing:n,shortcutKey:c,handleClickInputBox:()=>{(0,wo.xF)({click_from:qo[e]}),i(!0)},inputBoxClickOutside:()=>{i(!1)},clearShortcutKey:()=>{p(""),l.current=!0},handleTryUpdateShortcutKey:e=>{if(g(e),!l.current)return a(e),!0}}})(e,t),p=(0,zo.A)((()=>{u()})),g=Ko[e];return(0,q.jsx)(d.ms,{trigger:"custom",visible:Boolean(o&&g),position:"bottomLeft",render:g?(0,q.jsxs)(d.ms.Menu,{className:Xo,children:[(0,q.jsx)("div",{className:Jo,children:g.desc(n,i)}),g.list?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(d.ms.Divider,{className:ta}),g.list().map((e=>(0,q.jsx)("div",{className:ea,onMouseDown:()=>{h(e)&&t(e)},children:(0,ee.o)(e)},e)))]}):null]}):null,className:l()(Zo,"cici-ext-always-light","semi-always-light"),children:(0,q.jsxs)("div",{ref:p,className:l()(Go,{[$o]:o}),onClick:c,children:[(0,q.jsx)("div",{className:l()(Wo,{[Yo]:""===a}),children:(()=>{const t=(0,ee.o)(a);return""===a?o?"":n("flow_web_ext_setting_shortcut_sidebar_placeholder","\u70b9\u51fb\u8bbe\u7f6e\u5feb\u6377\u952e"):e===J.e.HoverTextTranslate?n("flow_web_ext_sidebar_settings_translate_mouse_hover_shortcut",{shortcut:t}):t})()}),(0,q.jsx)(Uo.A,{className:Qo,onClick:e=>{e.preventDefault(),e.stopPropagation(),m()}})]})})},aa="select-w3y0RG",la="selectDropdown-wLpGSZ",ra="selectItem-jkEOu7",ca="nameWrapper-pNrk5t",da="locName-bbgJEj",ua="name-ixWj0G",ma="active-knJ4xg",ha="checkbox-HSwLyZ",pa=({itemList:e,onChange:t,value:n})=>(0,q.jsx)(d.l6,{className:aa,dropdownClassName:l()(la,"cici-ext-always-light","semi-always-light"),position:"bottomRight",suffix:(0,q.jsx)(O.vo,{}),showArrow:!1,disabled:e.length<=0,defaultValue:n,value:n,renderSelectedItem:()=>{var t;const i=e.find((e=>e.key===n));return null!==(t=null==i?void 0:i.label)&&void 0!==t?t:""},onChange:n=>{const i=e.find((e=>e.key===n));null!=i&&i.onClick?i.onClick():t(n)},children:e.map((({label:e,key:t,secondLabel:i})=>(0,q.jsx)(d.l6.Option,{showTick:!1,value:t,children:(0,q.jsxs)("div",{className:l()("selectItem",ra,{[ma]:t===n}),children:[(0,q.jsxs)("div",{className:l()("nameWrapper",ca),children:[(0,q.jsx)("div",{className:l()("locName",da),children:e}),i&&(0,q.jsx)("div",{className:l()("name",ua),children:i})]}),(0,q.jsx)("div",{className:l()("checkbox",ha),children:(0,q.jsx)(O.Tf,{})})]})},t)))});const ga=e=>{(0,ce.z8)(de.Ur.quickTranslateSettingClick,{button_name:e})},_a=[hn.WR.Space,hn.WR.Comma,hn.WR.Slash,hn.WR.Equal],va=(e,t)=>t===hn.WR.Space?e("flow_web_ext_setting_translation_desc2_input"):t===hn.WR.Comma?",":t===hn.WR.Slash?"/":t===hn.WR.Equal?"=":t,fa=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("inputTranslateInfo"),i=(e=>_a.map((t=>({code:t,desc:va(e,t)}))))(e).map((e=>({key:e.code,label:e.desc})));return(0,q.jsx)(pa,{value:t.hotKeyCode,onChange:e=>{ga(de._h.shortcut),n((0,m.A)((0,m.A)({},t),{},{hotKeyCode:e}))},itemList:i})};var ba=n(76372);const xa="feature-switch-container-b0uAYU",Aa="setting-container-CL80tK",ya="setting-title-KTTQYc",wa="block-container-wYGpNN",Sa="hover-translate-container-KbfUBz",ja="block-AYUwfI",ka="block-item-t1LdyS",Ca="translate-setting-container-yPZreH";var Ia=n(40992),Ta=n(94870);const Na="block-UcURQc",Ea="block-content-t0t0P2",Ma="container-GNWTvX",Pa="click-A2pCsm",La="disabled-VgitEk",Da="underline-content-2_U9e2",Ra="main-icon-pqv5Od",Ba="left-mm79TQ",Oa="content-wDCS9L",Ua="main-title-JxTiYy",Fa="right-gP4Gne",qa="next-icon-DtnX_p",Ha=e=>{const{className:t,children:n}=e;return(0,q.jsx)("div",{className:l()(Na,t),children:(0,q.jsx)("div",{className:Ea,children:n})})},Va=e=>{const{icon:t,title:n,component:i,onClick:s,className:o,cssStyle:a,showNextIcon:r=!1,disabled:c=!1,itemContentClassName:d,renderChildren:u}=e;return(0,q.jsx)("div",{className:l()(Ma,o,{[Pa]:Boolean(s),[La]:c}),style:(0,m.A)({},a),onClick:s,children:(0,q.jsx)("div",{className:l()(Da,d),children:u?u():(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)("div",{className:Ba,children:[t&&(0,q.jsx)(Ta.Ay$,{className:Ra,svg:t}),(0,q.jsx)("div",{className:Oa,children:(0,q.jsx)("div",{className:Ua,children:n})})]}),(0,q.jsx)("div",{className:Fa,children:i||r&&(0,q.jsx)(O.Pl,{className:l()(qa)})})]})})})};var Ka=n(59865);const za=({onItemChange:e=ba.lQ,initialValue:t})=>{const n=(0,r.B)(),[i,o]=(0,y.Y)("hoverTranslateSetting"),[a,l]=(0,s.useState)(t||i),c=[...(0,Ka.r)(!0).map((e=>{var t;return{key:e,label:(null===(t=(0,Ka.G)(n,e))||void 0===t?void 0:t.desc)||""}})),{key:hn.X0.TRANSLATE_BY_CUSTOM_SHORTCUT,label:"\u81ea\u5b9a\u4e49\u5feb\u6377\u952e"}];return(0,q.jsx)(pa,{value:a,onChange:t=>{var n;if(l(t),e(t),(0,Ia.Kt)({hoverTranslateSetting:t}),o(t),t===hn.X0.TRANSLATE_BY_CUSTOM_SHORTCUT&&(null===(n=(0,A.TK)("shortcutsConfig").HoverTextTranslate)||void 0===n||!n.key)){const e={[J.e.HoverTextTranslate]:{key:(0,ee.ZV)(J.e.HoverTextTranslate)}};(0,A.vE)("shortcutsConfig",e,!0)}},itemList:c})},Ga=({className:e,defaultShortcutOpen:t})=>{const n=(0,r.B)(),[i,o]=(0,y.Y)("hoverTranslateSetting"),[a,c]=(0,s.useState)(t||i===hn.X0.TRANSLATE_BY_CUSTOM_SHORTCUT);return(0,q.jsxs)("div",{className:l()(Sa,e),children:[(0,q.jsx)(Va,{title:n("flow_web_ext_setting_shortcut_translate_mouse_hover"),component:(0,q.jsx)(za,{onItemChange:e=>{c(e===hn.X0.TRANSLATE_BY_CUSTOM_SHORTCUT)},initialValue:t?hn.X0.TRANSLATE_BY_CUSTOM_SHORTCUT:void 0}),className:ja,itemContentClassName:ka}),a&&(0,q.jsx)(Va,{title:n("flow_web_ext_setting_shortcut_translate_mouse_hover_desc"),component:(0,q.jsx)(oa,{type:J.e.HoverTextTranslate,onShortcutSetDone:e=>{o(e?hn.X0.TRANSLATE_BY_CUSTOM_SHORTCUT:hn.X0.NO_TRANSLATE)}}),className:ja,itemContentClassName:ka})]})},$a=()=>{const e=(0,r.B)();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_shortcut")}),(0,q.jsx)(Ha,{children:(0,q.jsx)(Wa,{})})]})},Wa=()=>{const e=(0,r.B)(),t=new URL(window.location.href),n=new URLSearchParams(t.search),i=n.get("shortcut_key"),[o,a]=s.useState(!1);(0,s.useEffect)((()=>{i&&(a(!0),setTimeout((()=>{n.delete("shortcut_key"),t.search=n.toString(),window.history.replaceState(null,"",t.href),a(!1)}),2e3))}),[i]);const c=[{key:J.e.OpenSide,title:e("flow_web_ext_setting_shortcut_sidebar","\u5524\u8d77\u4fa7\u8fb9\u680f"),component:(0,q.jsx)(oa,{type:J.e.OpenSide})},{key:J.e.VoiceInput,title:e("flow_web_ext_setting_shortcut_voice_input"),component:(0,q.jsx)(oa,{type:J.e.VoiceInput})},{key:J.e.TranslatePage,title:e("flow_web_ext_setting_shortcut_translate_webpage","\u7ffb\u8bd1\u6b64\u7f51\u9875"),component:(0,q.jsx)(oa,{type:J.e.TranslatePage})},{key:J.e.ReadPage,title:e("flow_web_ext_setting_shortcut_summarize_webpage","\u603b\u7ed3\u6b64\u7f51\u9875"),component:(0,q.jsx)(oa,{type:J.e.ReadPage})},{key:J.e.ScreenCapture,icon:(0,q.jsx)(Bo.A,{}),title:e("flow_web_ext_sidebar_screenshot2"),component:(0,q.jsx)(oa,{type:J.e.ScreenCapture}),disable:!(0,Vn.eW)()},{key:J.e.CollectPage,icon:(0,q.jsx)(Bo.A,{}),title:e("flow_web_ext_setting_shortcut_bookmark"),component:(0,q.jsx)(oa,{type:J.e.CollectPage})},{key:J.e.TTSReadPage,title:e("flow_web_ext_tts_webpage","\u6717\u8bfb\u9875\u9762"),showNextIcon:!1,component:(0,q.jsx)(oa,{type:J.e.TTSReadPage}),disable:!(0,Vn.gp)()},{key:J.e.BilingualSubtitles,title:e("flow_web_ext_setting_video_hide_subtitles","\u9690\u85cf / \u6253\u5f00\u53cc\u8bed\u5b57\u5e55\uff08\u9f20\u6807\u505c\u5728\u89c6\u9891\u4e0a\u65f6\uff09"),component:(0,q.jsx)(oa,{type:J.e.BilingualSubtitles})},{key:J.e.HoverTextTranslate,title:e("flow_web_ext_setting_translation_title_mouse_hover","\u9f20\u6807\u60ac\u505c\u7ffb\u8bd1"),render:()=>(0,q.jsx)(Ga,{defaultShortcutOpen:i===J.e.HoverTextTranslate}),disable:!(0,Vn.mz)()},{key:"xxx",title:e("flow_web_ext_setting_shortcut_translate_input_box"),component:(0,q.jsx)(fa,{}),disable:!(0,Vn.kr)()}].filter((e=>!e.disable));return(0,q.jsx)("div",{children:c.map((e=>(0,q.jsx)(Va,{title:e.title,renderChildren:e.render,component:e.component,itemContentClassName:na,className:l()(ia,{[sa]:i===e.key&&o})})))})},Ya=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#writing_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M10.097 12.085q.07.062.16.062.098 0 .164-.062a.26.26 0 0 0 .084-.159q.056-.37.117-.623.063-.252.161-.415a.75.75 0 0 1 .257-.26q.16-.095.405-.15.245-.058.6-.099a.246.246 0 0 0 .23-.25.23.23 0 0 0-.065-.162.27.27 0 0 0-.163-.087 7 7 0 0 1-.597-.107 1.4 1.4 0 0 1-.396-.154.8.8 0 0 1-.254-.254 1.5 1.5 0 0 1-.166-.408 8 8 0 0 1-.13-.621.26.26 0 0 0-.085-.158.23.23 0 0 0-.161-.063.24.24 0 0 0-.163.063.25.25 0 0 0-.082.158 7 7 0 0 1-.117.623 1.5 1.5 0 0 1-.163.415.8.8 0 0 1-.257.26q-.159.095-.403.15a6 6 0 0 1-.602.096.25.25 0 0 0-.163.084.24.24 0 0 0-.065.166q0 .097.063.165a.27.27 0 0 0 .163.084q.357.053.597.11.242.059.398.154a.75.75 0 0 1 .252.254q.097.159.165.408.068.252.132.621.017.096.084.159"}),(0,q.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M9.157 16.048a.9.9 0 0 1 .192-.284l6.906-6.96q.384-.386.815-.38.438.005.827.39l1.151 1.168q.39.39.39.83 0 .434-.384.819l-6.901 6.961q-.069.064-.133.112a.7.7 0 0 1-.16.08c-.104.044-.248.111-.42.19-.942.436-2.718 1.256-3.295.781-.565-.466.314-2.266.787-3.232.098-.2.178-.365.225-.475m8.566-4.513.613-.618a.5.5 0 0 0 .085-.107.5.5 0 0 0-.09-.114l-.003-.003L17.18 9.53a.5.5 0 0 0-.116-.09.5.5 0 0 0-.092.077l-.625.63zm-2.088-.67 1.375 1.389-5.553 5.602q-.236.1-.518.234c-.364.169-.79.366-1.281.546a6 6 0 0 1-.603.188q.066-.229.181-.525c.138-.352.307-.715.465-1.042l.124-.255c.1-.204.196-.401.255-.537zm-6.661 8.393q.002.024.001.025t-.001-.025",clipRule:"evenodd"}),(0,q.jsx)("path",{fill:"#fff",d:"M18.014 19.899a.28.28 0 0 1-.197-.076.34.34 0 0 1-.102-.194 9 9 0 0 0-.162-.759 1.9 1.9 0 0 0-.202-.498.9.9 0 0 0-.307-.31 1.7 1.7 0 0 0-.487-.188 9 9 0 0 0-.73-.135.33.33 0 0 1-.199-.102.3.3 0 0 1-.076-.203q0-.117.08-.202a.3.3 0 0 1 .199-.102q.436-.051.735-.117.3-.068.492-.185a.95.95 0 0 0 .314-.317 1.8 1.8 0 0 0 .199-.506q.076-.31.144-.762a.3.3 0 0 1 .1-.194.3.3 0 0 1 .198-.076q.115 0 .197.076a.32.32 0 0 1 .105.194q.08.45.159.759.081.305.202.498.12.193.31.31.19.118.484.188.295.07.73.132a.33.33 0 0 1 .199.105q.079.085.079.2a.3.3 0 0 1-.282.304q-.433.05-.732.12-.3.068-.495.185a.9.9 0 0 0-.314.316q-.12.2-.196.507-.076.31-.144.762a.3.3 0 0 1-.102.194.28.28 0 0 1-.2.076"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"writing_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),Qa=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#grammar_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M17.674 18.324q-.633 0-1.12-.24a1.9 1.9 0 0 1-.755-.668 1.83 1.83 0 0 1-.27-.996q0-.844.616-1.336.62-.498 1.775-.562l1.828-.1v-.487q0-.578-.363-.914-.363-.334-1.002-.334-.528 0-.885.223t-.615.703a.56.56 0 0 1-.217.2.6.6 0 0 1-.287.064.56.56 0 0 1-.387-.135.48.48 0 0 1-.146-.363q0-.094.029-.194.03-.105.076-.21.246-.58.914-.92.669-.346 1.559-.346.78 0 1.348.27.567.263.878.744.31.48.31 1.125v3.867q0 .293-.163.451a.58.58 0 0 1-.428.164.6.6 0 0 1-.422-.152.57.57 0 0 1-.164-.416V17.1h-.03q-.18.375-.503.65-.316.276-.727.422a2.4 2.4 0 0 1-.85.152m.328-.937q.487 0 .885-.205.397-.211.627-.557.234-.351.234-.791v-.598l-1.664.106q-.639.046-.984.322a.86.86 0 0 0-.34.709q0 .457.345.738.346.276.897.276m-10.313.902q-.304 0-.48-.164-.17-.165-.17-.457a1.3 1.3 0 0 1 .076-.404l2.608-7.032q.257-.732 1.02-.732.403 0 .655.182.258.18.393.55l2.59 7.002q.082.229.082.422 0 .294-.188.463-.18.17-.492.17-.293 0-.463-.135-.164-.129-.258-.445l-.65-1.816H9.066l-.65 1.816q-.093.316-.264.445-.163.135-.463.135m1.717-3.486h2.678l-1.324-3.809h-.03z"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"grammar_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]}));var Za=n(22234),Xa=n(56642),Ja=n(98801);function el(e){const[t,n]=(0,s.useState)((0,Za.A)((0,A.TK)("appSettings")[e],Ja.K[e])),[i]=(0,y.Y)("appSettings");return(0,s.useEffect)((()=>{const s=(0,Za.A)(i[e],Ja.K[e]);(0,Xa.x)(t,s)||n(s)}),[i,e]),t}const tl=()=>{const e=(0,r.B)(),t=el("writing_assistant"),n=el("reply_assistant"),[i,s]=(0,y.Y)("InputAssistantDisabledAll"),[o,a]=(0,y.Y)("InputAssistantDisabledHosts"),[l,c]=(0,y.Y)("replyAssistantDisabledAll"),[d,u]=(0,y.Y)("replyAssistantDisabledHosts"),[m,h]=(0,y.Y)("disableGlobalGrammar"),[p,g]=(0,y.Y)("disableGrammarHosts"),_=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/writing.20ba2e0d.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/writing.b041b3e3.png"),v=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/grammar.52821f7a.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/grammar.8180966d.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_writing")}),t.enabled&&(0,q.jsx)(Lo,{caption:e("flow_web_ext_setting_writing_title_writing"),illustration:_,globalDisableIcon:(0,q.jsx)(Ya,{}),globalDisableDescription:e("flow_web_ext_setting_writing_switch_writing"),reportEventScene:hn.lf.inputAssistant,globalDisable:i,onGlobalDisableChange:s,disableHosts:o,onDeleteHost:e=>a(uo(o,e))}),n.enabled&&(0,q.jsx)(Lo,{style:{marginTop:36},illustration:"https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/reply-assistant.4de445e9.png",caption:e("flow_web_ext_help_me_reply","\u5e2e\u6211\u56de\u590d"),globalDisableIcon:(0,q.jsx)(Ya,{}),globalDisableDescription:e("flow_web_ext_help_me_reply_switch","\u5728 Bilibili, \u77e5\u4e4e, \u5fae\u535a, \u5c0f\u7ea2\u4e66\u7684\u56de\u590d\u6846\u5185\u542f\u52a8 AI \u56de\u590d"),reportEventScene:hn.lf.replyAssistant,globalDisable:l,onGlobalDisableChange:c,disableHosts:d,onDeleteHost:e=>u(uo(d,e))}),(0,q.jsx)(Lo,{style:{marginTop:36},caption:e("flow_web_ext_setting_writing_title_grammar"),illustration:v,globalDisable:m,reportEventScene:hn.lf.grammar,onGlobalDisableChange:h,globalDisableIcon:(0,q.jsx)(Qa,{}),globalDisableDescription:e("flow_web_ext_setting_writing_switch_grammar"),disableHosts:p,onDeleteHost:e=>g(uo(p,e))})]})},nl="bilingual_subtitle_shortcut_setting-_jiMgT",il="title-C8x8F7",sl="setting-FZp8q2",ol=()=>{const e=(0,r.B)(),t={key:J.e.BilingualSubtitles,title:e("flow_web_ext_setting_video_hide_subtitles","\u9690\u85cf / \u6253\u5f00\u53cc\u8bed\u5b57\u5e55\uff08\u9f20\u6807\u505c\u5728\u89c6\u9891\u4e0a\u65f6\uff09"),component:(0,q.jsx)(oa,{type:J.e.BilingualSubtitles})};return(0,q.jsxs)("div",{className:nl,children:[(0,q.jsx)("span",{className:il,children:e("flow_web_ext_general_setting","\u8bbe\u7f6e")}),(0,q.jsx)("div",{className:sl,children:(0,q.jsx)(Va,{title:t.title,component:t.component,itemContentClassName:na,className:l()(ia)})})]})},al="https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-summary.0db09d2a.png",ll=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#video-summary_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M11.75 10.73q-.165 0-.27-.105a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h4.723q.158 0 .258.105.105.1.105.252a.35.35 0 0 1-.105.258.34.34 0 0 1-.258.105zm0 1.7q-.165 0-.27-.106a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h2.771q.159 0 .258.106.105.1.106.251a.35.35 0 0 1-.106.258.34.34 0 0 1-.258.106zm.088 5.8q-.37 0-.58-.193-.205-.2-.205-.586v-3.258q0-.387.205-.586.21-.198.58-.199h4.33q.78 0 .78.785v3.258q0 .78-.78.78zm-2.766.217V9.56q0-.915.451-1.377.457-.463 1.366-.463h6.222q.909 0 1.36.463.456.462.457 1.377v8.888q0 .921-.457 1.377-.451.457-1.36.457H10.89q-.908 0-1.366-.457-.45-.457-.45-1.377m.944-.017q0 .439.228.674.235.234.691.234h6.13q.457 0 .685-.235.234-.234.234-.673V9.576q0-.439-.234-.674-.227-.24-.686-.24h-6.129q-.457 0-.69.24-.23.235-.23.674z"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"video-summary_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),rl=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#video-subtitle_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M11.274 7.735a.56.56 0 0 0-.697.878l.001.001.012.01a2 2 0 0 1 .123.11h-1.96a.56.56 0 1 0 0 1.12h.654c.28.834.652 1.507 1.36 2.312-.742.559-1.66.94-2.309 1.038a.56.56 0 0 0 .17 1.11c.878-.135 2.027-.627 2.93-1.343.607.52 1.428.996 1.954 1.28a.56.56 0 0 0 .534-.986c-.502-.272-1.177-.67-1.67-1.07a7.9 7.9 0 0 0 1.44-2.34h.487a.56.56 0 0 0 0-1.122h-2.128a4.762 4.762 0 0 0-.867-.971l-.023-.018-.007-.006-.002-.002zm.31 3.662c-.49-.56-.772-1.025-.983-1.542h1.993a6.9 6.9 0 0 1-1.01 1.542",clipRule:"evenodd"}),(0,q.jsx)("path",{fill:"#fff",d:"M15.819 7.884a.56.56 0 1 0 0 1.122h1.818c.695 0 1.258.563 1.258 1.258v1.819a.56.56 0 1 0 1.122 0v-1.82a2.38 2.38 0 0 0-2.38-2.379z"}),(0,q.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M17.067 12.588a.56.56 0 0 0-.525.365l-2.316 6.21a.561.561 0 0 0 1.05.391l.543-1.454h2.497l.542 1.454a.561.561 0 0 0 1.051-.392l-2.316-6.209a.56.56 0 0 0-.526-.365m0 2.166.83 2.225h-1.66z",clipRule:"evenodd"}),(0,q.jsx)("path",{fill:"#fff",d:"M8.543 15.16a.56.56 0 0 0-.56.56v1.82a2.38 2.38 0 0 0 2.38 2.38h1.818a.56.56 0 1 0 0-1.122h-1.819a1.26 1.26 0 0 1-1.258-1.258v-1.82a.56.56 0 0 0-.56-.56"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"video-subtitle_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),cl=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#video-memo_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M17.488 7.927a1.828 1.828 0 1 1 2.584 2.585l-5.703 5.703-.034.034c-.173.173-.32.321-.5.43a1.8 1.8 0 0 1-.507.21c-.204.05-.414.05-.658.05h-1.047a.56.56 0 0 1-.562-.563v-1.047c0-.244 0-.454.048-.658q.065-.27.21-.507c.11-.179.258-.327.431-.5l.034-.034zm1.789.795a.703.703 0 0 0-.994 0l-5.703 5.703c-.225.226-.27.276-.301.326a.6.6 0 0 0-.076.183c-.014.057-.017.125-.017.443v.436h.436c.318 0 .386-.003.443-.017a.6.6 0 0 0 .183-.076c.05-.03.1-.076.326-.3l5.703-5.704a.703.703 0 0 0 0-.994m-8.393-.065h2.528a.563.563 0 0 1 0 1.125h-2.504c-.51 0-.86 0-1.13.022-.263.022-.402.061-.5.111-.232.118-.42.306-.537.537-.05.098-.09.237-.111.5-.022.27-.023.62-.023 1.13v5.01c0 .51 0 .859.023 1.129.021.263.06.402.111.5.118.232.305.42.536.537.099.05.238.09.501.111.27.022.62.023 1.13.023h5.01c.51 0 .858 0 1.129-.023.263-.021.402-.06.5-.111.231-.118.419-.305.537-.536.05-.099.09-.238.11-.501.023-.27.023-.62.023-1.13v-2.504a.562.562 0 1 1 1.125 0v2.528c0 .481 0 .876-.026 1.197-.027.333-.085.637-.23.92a2.35 2.35 0 0 1-1.028 1.028c-.284.145-.587.203-.92.23-.321.027-.716.027-1.197.027h-5.057c-.481 0-.876 0-1.197-.027-.333-.027-.637-.085-.92-.23a2.35 2.35 0 0 1-1.028-1.027c-.145-.284-.203-.588-.23-.92-.027-.322-.027-.717-.027-1.198v-5.057c0-.48 0-.876.027-1.197.027-.333.085-.636.23-.92a2.35 2.35 0 0 1 1.027-1.028c.284-.145.588-.203.92-.23.322-.026.717-.026 1.198-.026",clipRule:"evenodd"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"video-memo_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),dl=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#video-immersion_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M8.699 18.456q-.681 0-1.065-.385-.384-.383-.384-1.064V9.82q0-.675.384-1.06.384-.384 1.065-.384h10.597q.686 0 1.07.385.384.384.384 1.059v7.186q0 .68-.384 1.064t-1.07.384h-3.463v.939h.022q.219 0 .378.16a.5.5 0 0 1 .16.372.52.52 0 0 1-.16.379.52.52 0 0 1-.378.159h-3.71a.52.52 0 0 1-.378-.16.52.52 0 0 1-.16-.378.5.5 0 0 1 .16-.373.52.52 0 0 1 .378-.16h.022v-.937zm.099-1.18h10.404a.36.36 0 0 0 .27-.1.36.36 0 0 0 .098-.268V9.925q0-.176-.099-.269a.36.36 0 0 0-.269-.099H8.798a.36.36 0 0 0-.27.1q-.098.091-.098.268v6.983q0 .17.099.269a.36.36 0 0 0 .269.099m5.608-1.043a.27.27 0 0 1-.189-.073.32.32 0 0 1-.098-.186 9 9 0 0 0-.155-.729 1.8 1.8 0 0 0-.194-.478.9.9 0 0 0-.295-.298 1.6 1.6 0 0 0-.467-.18 8 8 0 0 0-.701-.13.32.32 0 0 1-.191-.098.28.28 0 0 1-.074-.194q0-.112.076-.195a.3.3 0 0 1 .192-.098q.42-.048.706-.113.287-.064.473-.177a.9.9 0 0 0 .3-.304q.12-.191.192-.487.073-.297.138-.731a.3.3 0 0 1 .096-.186.28.28 0 0 1 .19-.073q.11 0 .19.073a.3.3 0 0 1 .1.186q.076.434.153.729.078.292.194.478a.9.9 0 0 0 .298.298q.183.113.464.18.285.068.7.127a.32.32 0 0 1 .192.101q.076.082.076.192a.29.29 0 0 1-.27.292q-.417.048-.703.116-.287.065-.476.177a.9.9 0 0 0-.3.304q-.116.191-.19.486a8 8 0 0 0-.137.732.3.3 0 0 1-.099.186.27.27 0 0 1-.191.073m-2.47-3.444q.046.04.106.04a.15.15 0 0 0 .107-.04.17.17 0 0 0 .055-.104q.037-.244.078-.41a1 1 0 0 1 .105-.274.5.5 0 0 1 .17-.17 1 1 0 0 1 .266-.1q.16-.037.395-.064a.162.162 0 0 0 .152-.164.15.15 0 0 0-.044-.108.18.18 0 0 0-.107-.057 5 5 0 0 1-.393-.07.9.9 0 0 1-.26-.102.5.5 0 0 1-.168-.167 1 1 0 0 1-.108-.268 6 6 0 0 1-.086-.409.17.17 0 0 0-.056-.104.15.15 0 0 0-.106-.041.16.16 0 0 0-.107.04.17.17 0 0 0-.054.105q-.036.243-.078.41a1 1 0 0 1-.107.273.5.5 0 0 1-.169.17.9.9 0 0 1-.265.1q-.161.036-.396.063a.17.17 0 0 0-.107.056.15.15 0 0 0-.043.108q0 .064.041.11.043.045.107.055.236.035.393.072a.9.9 0 0 1 .262.101.5.5 0 0 1 .166.168q.065.103.109.268t.087.409a.18.18 0 0 0 .055.104",clipRule:"evenodd"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"video-immersion_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),ul="https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-summary.9de87f1d.png",ml=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("videoSummaryDisableAll"),[i,s]=(0,y.Y)("videoSummaryDisableHosts"),[o,a]=(0,y.Y)("videoSubtitleDisableAll"),[l,c]=(0,y.Y)("videoImmersionDisableAll"),[d,u]=(0,y.Y)("videoMemoDisableAll"),[m,h]=(0,y.Y)("videoImmersionDisableHosts"),[p,g]=(0,y.Y)("videoSubtitleDisableHosts"),[_,v]=(0,y.Y)("videoMemoDisableHosts"),f=co(al,ul)?ul:al,b=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-subtitle-translation.239e8cc7.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-subtitle-translation.f577629c.png"),x=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-immersion.b817b2c0.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-immersion.dd144fb5.png"),A=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-memo.999b6b02.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/video-memo.9795bc23.png"),w=el("video_assistant");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_video")}),(w.bilibili_assistant_show||w.youtube_assistant_show)&&(0,q.jsx)(Lo,{caption:e("flow_web_ext_setting_video_title_summary"),illustration:f,globalDisable:t,reportEventScene:Hn.lf.videoSummary,onGlobalDisableChange:n,globalDisableIcon:(0,q.jsx)(ll,{}),globalDisableDescription:e("flow_web_ext_setting_video_switch"),disableHosts:i,onDeleteHost:e=>s(uo(i,e))}),(0,q.jsx)(Lo,{style:{marginTop:36},caption:e("flow_web_ext_setting_video_title_subtitles"),illustration:b,globalDisable:o,reportEventScene:Hn.lf.videoSubtitle,onGlobalDisableChange:a,globalDisableIcon:(0,q.jsx)(rl,{}),globalDisableDescription:e("flow_web_ext_setting_video_switch"),disableHosts:p,onDeleteHost:e=>g(uo(p,e))}),(0,q.jsx)("div",{style:{marginTop:24,width:"100%"},children:(0,q.jsx)(ol,{})}),(0,q.jsx)(Lo,{style:{marginTop:36},caption:e("flow_web_ext_youtube_sharepage_immersionbutton"),illustration:x,globalDisable:l,reportEventScene:Hn.lf.videoImmersion,onGlobalDisableChange:c,globalDisableIcon:(0,q.jsx)(dl,{}),globalDisableDescription:e("flow_web_ext_setting_video_switch_fullscreen_timeline"),disableHosts:m,onDeleteHost:e=>h(uo(m,e))}),(0,q.jsx)(Lo,{style:{marginTop:36},caption:e("flow_web_ext_youtube_take_notes"),illustration:A,globalDisable:d,reportEventScene:Hn.lf.videoMemo,onGlobalDisableChange:e=>{var t;u(e),t=e,(0,ce.z8)(de.Ur.videoSettingClick,{button_name:"to_note",current_page:"settings",is_open:t?"1":"0"})},globalDisableIcon:(0,q.jsx)(cl,{}),globalDisableDescription:e("flow_web_ext_setting_video_notes_switch"),disableHosts:_,onDeleteHost:e=>v(uo(_,e))})]})};var hl=n(6784);const pl=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("inputTranslateInfo"),i=Object.entries(hl.L).map((t=>{const[n,i]=t;return{key:n,label:e(i.label)}})).filter((e=>hl.E.includes(e.key)));return(0,q.jsx)(pa,{value:t.translateService,onChange:e=>{ga(de._h.translateService),n((0,m.A)((0,m.A)({},t),{},{translateService:e}))},itemList:i})},gl=()=>{const e=((e=!1,t=!1)=>{const n=(0,r.B)(),[i]=(0,y.Y)("launchInfo"),{languageList:s}=i;let o=[...s||[]];e&&(o=[{language_code:Ve.Aq,language:n("follow_browser_language"),language_loc:n("follow_browser_language")},...o]);return t||(o=o.filter((e=>e.language_code!==we.Zn))),o.length?o:void 0})(!0)||[],[t,n]=(0,y.Y)("inputTranslateInfo"),i=e.map((e=>{const{language:t,language_code:n,language_loc:i}=e;return{key:n,label:t,secondLabel:i}}));return(0,q.jsx)(pa,{value:t.language,onChange:e=>{ga(de._h.targetLanguage),n((0,m.A)((0,m.A)({},t),{},{language:e}))},itemList:i})},_l=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#search-summary_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M11.75 10.73q-.165 0-.27-.105a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h4.723q.158 0 .258.105.105.1.105.252a.35.35 0 0 1-.105.258.34.34 0 0 1-.258.105zm0 1.7q-.165 0-.27-.106a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h2.771q.159 0 .258.106.105.1.106.251a.35.35 0 0 1-.106.258.34.34 0 0 1-.258.106zm.088 5.8q-.37 0-.58-.193-.205-.2-.205-.586v-3.258q0-.387.205-.586.21-.198.58-.199h4.33q.78 0 .78.785v3.258q0 .78-.78.78zm-2.766.217V9.56q0-.915.451-1.377.457-.463 1.366-.463h6.222q.909 0 1.36.463.456.462.457 1.377v8.888q0 .921-.457 1.377-.451.457-1.36.457H10.89q-.908 0-1.366-.457-.45-.457-.45-1.377m.944-.017q0 .439.228.674.235.234.691.234h6.13q.457 0 .685-.235.234-.234.234-.673V9.576q0-.439-.234-.674-.227-.24-.686-.24h-6.129q-.457 0-.69.24-.23.235-.23.674z"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"search-summary_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),vl=()=>{const e=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/input-translate-setting.a96dc811.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/input-translate-setting.e0b3c5c7.png"),t=(0,r.B)(),[n]=(0,y.Y)("inputTranslateInfo");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Lo,{caption:t("flow_web_ext_setting_translation_title_input","\u8f93\u5165\u6846\u5feb\u6377\u7ffb\u8bd1"),style:{marginTop:36},illustration:e,globalDisableIcon:(0,q.jsx)(_l,{}),globalDisableDescription:t("flow_web_ext_translate_input_box_popup_enable","\u542f\u7528\u8f93\u5165\u6846\u5feb\u6377\u7ffb\u8bd1"),globalDisable:n.disableAll,onGlobalDisableChange:e=>{(0,A.vE)("inputTranslateInfo",(0,m.A)((0,m.A)({},n),{},{disableAll:e}))},dataTestId:"option-input-translate-feature-switch"}),(0,q.jsxs)("div",{className:Aa,children:[(0,q.jsx)("div",{className:ya,children:t("flow_web_ext_setting")}),(0,q.jsxs)(Ha,{children:[(0,q.jsx)(Va,{title:t("flow_web_ext_setting_translation_input_target_language","\u9ed8\u8ba4\u76ee\u6807\u8bed\u8a00"),component:(0,q.jsx)(gl,{}),itemContentClassName:wa}),(0,q.jsx)(Va,{title:t("flow_web_ext_setting_translation_input_shorcut","\u9009\u62e9\u89e6\u53d1\u8be5\u529f\u80fd\u7684\u5b57\u7b26"),component:(0,q.jsx)(fa,{}),itemContentClassName:wa}),(0,q.jsx)(Va,{title:t("flow_web_ext_sidebar_settings_translateservice","\u7ffb\u8bd1\u670d\u52a1"),component:(0,q.jsx)(pl,{}),itemContentClassName:wa})]})]})]})},fl=()=>{const e=(0,r.B)(),t=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/translate-setting.fc19b896.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/translate-setting.ce2017b3.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(Lo,{caption:e("flow_web_ext_setting_translation_title_mouse_hover","\u9f20\u6807\u60ac\u505c\u7ffb\u8bd1"),style:{marginTop:36},illustration:t,globalDisableIcon:(0,q.jsx)(q.Fragment,{}),globalDisableDescription:"",switchContainerClassName:xa,enableGlobalDisable:!1,dataTestId:"option-hover-translate-feature-switch"}),(0,q.jsxs)("div",{className:Aa,children:[(0,q.jsx)("div",{className:ya,children:e("flow_web_ext_setting")}),(0,q.jsx)(Ha,{children:(0,q.jsx)(Ga,{className:Ca})})]})]})};var bl=n(26457),xl=n(12710),Al=n(17114),yl=n(53884);const wl="wrapper-NrzrIK",Sl="caption-j4Lxd5",jl="vocabruary-setting-KDQCVJ",kl="setting-item-OVIDaZ",Cl="actions-ULrOZ1",Il="split-ODD_d0",Tl="palette-setting-dzX4xr",Nl="icon-hD98Zu",El="palette-item-svsBRv",Ml=e=>{const{className:t,style:n}=e,i=(0,r.B)(),o=(0,s.useRef)(null),[a,c]=(0,y.Y)("vocabruaryDisableAll"),[u,m]=(0,y.Y)("vocabruaryDisableHosts"),[h,p]=(0,y.Y)("vocabruaryHighlightColor");return(0,q.jsxs)("div",{ref:o,className:l()(t,wl),style:n,children:[(0,q.jsx)("h2",{className:l()(Sl,"feature-vocabruary-setting"),children:i("flow_web_ext_setting_action_title")}),(0,q.jsxs)("div",{className:l()(jl),style:{marginTop:12},children:[(0,q.jsxs)("div",{className:kl,children:[(0,q.jsx)("div",{className:Sl,children:i("flow_web_ext_setting_action_switch")}),(0,q.jsx)("div",{className:Cl,onClick:()=>{const e="feature-vocabruary-setting"===new URLSearchParams(window.location.search).get("anchor")?"highlight_guide_card":"highlight_tool_bar";(0,yl.s)("highlight_tool_setting_click",{button_name:"auto_highlight",current_page:"settings",click_from:e})},children:(0,q.jsx)(d.dO,{checked:!a,onChange:e=>c(!e)})})]}),(0,q.jsx)("div",{className:Il}),(0,q.jsxs)("div",{className:kl,children:[(0,q.jsx)("div",{className:Sl,children:i("flow_web_ext_setting_action_colour")}),(0,q.jsx)("div",{className:Cl,children:(0,q.jsx)(Al.A,{palette:xl.Bx,getPopupContainer:()=>o.current,selected:h,onSelectedChange:p,children:(0,q.jsxs)("div",{className:Tl,onClick:()=>{const e="feature-vocabruary-setting"===new URLSearchParams(window.location.search).get("anchor")?"highlight_guide_card":"highlight_tool_bar";(0,yl.s)("highlight_tool_setting_click",{button_name:"highlight_color",current_page:"settings",click_from:e})},children:[(0,q.jsx)("div",{className:El,style:{background:h}}),(0,q.jsx)("div",{className:Nl,children:(0,q.jsx)(bl.A,{})})]})})})]})]}),u.length>0&&(0,q.jsx)(Ao,{style:{marginTop:24},disableHosts:u,onDeleteHost:e=>m(uo(u,e))})]})},Pl="desc-yK_jYC",Ll=()=>{const[e,t]=(0,y.Y)("autoTranslatePageHosts"),n=(0,r.B)(),i=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/translate-page.ddaab7fc.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/translate-page.d7eabad3.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:ui,children:n("flow_web_ext_setting_enabledsites")}),(0,q.jsx)("div",{className:Pl,children:n("flow_web_ext_setting_translation_notice")}),(0,q.jsx)("img",{className:hi,src:i}),e.length>0?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("div",{className:mi,children:n("flow_web_ext_setting_translation_sitelist")}),(0,q.jsx)("div",{className:pi,children:e.map((n=>(0,q.jsx)(vo,{url:n,favicon:`https://s2.googleusercontent.com/s2/favicons?domain=${n}&sz=32`,onDelete:()=>(n=>{t(e.filter((e=>e!==n)))})(n)},n)))})]}):null]})},Dl=()=>(0,q.jsx)(q.Fragment,{children:(0,q.jsx)(Ll,{})});var Rl=n(792);const Bl=()=>{const e=(0,r.B)(),t=el("hover_translate_assistant");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_translation")}),(0,q.jsx)(Dl,{}),t.enable&&(0,q.jsx)(fl,{}),(0,Vn.kr)()&&(0,q.jsx)(vl,{}),(0,Rl.wu)()&&(0,q.jsx)(Ml,{style:{marginTop:36}})]})},Ol=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsxs)("g",{clipPath:"url(#float-btn-entry_svg__a)",children:[(0,q.jsx)("path",{fill:"url(#float-btn-entry_svg__b)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M8.97 19.406q-1.023 0-1.568-.545-.543-.538-.544-1.555V10.07q0-1.017.544-1.556.545-.543 1.568-.544h10.054q1.03 0 1.568.544.544.54.544 1.556v7.237q0 1.017-.544 1.555-.54.545-1.568.545zm.167-1.544h9.72q.359 0 .544-.179.192-.18.192-.562v-6.867q0-.383-.192-.562-.185-.18-.544-.18h-9.72q-.36 0-.55.18-.186.18-.186.562v6.867q0 .382.186.562.19.18.55.18m5.467.198V9.28h1.424v8.78zm2.638-6.406a.48.48 0 0 1-.347-.138.456.456 0 0 1 0-.652.48.48 0 0 1 .347-.137h1.13q.204 0 .341.137a.44.44 0 0 1 0 .652.46.46 0 0 1-.34.138zm0 1.692a.48.48 0 0 1-.347-.137.44.44 0 0 1-.138-.323q0-.185.138-.323a.48.48 0 0 1 .347-.138h1.13q.204 0 .341.138a.433.433 0 0 1 0 .646.46.46 0 0 1-.34.137zm0 1.7a.48.48 0 0 1-.347-.138.44.44 0 0 1-.138-.323.43.43 0 0 1 .138-.323.48.48 0 0 1 .347-.138h1.13q.204 0 .341.138a.433.433 0 0 1 0 .646.46.46 0 0 1-.34.137z"})]}),(0,q.jsxs)("defs",{children:[(0,q.jsxs)("linearGradient",{id:"float-btn-entry_svg__b",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]}),(0,q.jsx)("clipPath",{id:"float-btn-entry_svg__a",children:(0,q.jsx)("path",{fill:"#fff",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"})})]})]})),Ul=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#chat-float-card_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M12.4 21.271q-.171.225-.375.27a.5.5 0 0 1-.376-.039.47.47 0 0 1-.23-.283q-.067-.192.039-.462l1.951-5.168H9.645a.53.53 0 0 1-.369-.132.47.47 0 0 1-.138-.342q0-.218.178-.449l6.163-7.85q.172-.225.376-.277a.48.48 0 0 1 .369.04.47.47 0 0 1 .237.283q.066.197-.04.461l-1.95 5.175h3.763q.224 0 .363.132.145.131.145.336 0 .217-.178.448zm.39-1.832-.231-.106 4.357-5.774h-4.094l2.268-4.91.23.098-4.363 5.781h4.1z"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"chat-float-card_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),Fl=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("sidebarButtonDisabledAll"),[i,s]=(0,y.Y)("sidebarButtonDisabledHosts"),[o,a]=(0,y.Y)("chatFloatCardDisableAll"),l=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/sider.82b0f068.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/sider.77a87299.png"),c=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/chat-float-card.8d9dbfaf.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/chat-float-card.e2ff2396.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_sidebar")}),(0,q.jsx)(Lo,{caption:e("flow_web_ext_setting_sidebar_title_icon",{brandName:(0,Ki.L2)()}),illustration:l,globalDisableIcon:(0,q.jsx)(Ol,{}),globalDisableDescription:e("flow_web_ext_setting_sidebar_switch_icon"),reportEventScene:hn.lf.chatAssistant,globalDisable:t,onGlobalDisableChange:n,disableHosts:i,onDeleteHost:e=>s(uo(i,e))}),(0,q.jsx)(Lo,{style:{marginTop:36},caption:e("flow_web_ext_setting_sidebar_title_inputbox_card"),illustration:c,globalDisableIcon:(0,q.jsx)(Ul,{}),globalDisableDescription:e("flow_web_ext_setting_sidebar_switch_inputbox_card"),reportEventScene:hn.lf.sidebarFloatCard,globalDisable:o,onGlobalDisableChange:a})]})},ql=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#search-result-preview_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M11.75 10.73q-.165 0-.27-.105a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h4.723q.158 0 .258.105.105.1.105.252a.35.35 0 0 1-.105.258.34.34 0 0 1-.258.105zm0 1.7q-.165 0-.27-.106a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h2.771q.159 0 .258.106.105.1.106.251a.35.35 0 0 1-.106.258.34.34 0 0 1-.258.106zm.088 5.8q-.37 0-.58-.193-.205-.2-.205-.586v-3.258q0-.387.205-.586.21-.198.58-.199h4.33q.78 0 .78.785v3.258q0 .78-.78.78zm-2.766.217V9.56q0-.915.451-1.377.457-.463 1.366-.463h6.222q.909 0 1.36.463.456.462.457 1.377v8.888q0 .921-.457 1.377-.451.457-1.36.457H10.89q-.908 0-1.366-.457-.45-.457-.45-1.377m.944-.017q0 .439.228.674.235.234.691.234h6.13q.457 0 .685-.235.234-.234.234-.673V9.576q0-.439-.234-.674-.227-.24-.686-.24h-6.129q-.457 0-.69.24-.23.235-.23.674z"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"search-result-preview_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),Hl=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("searchDisabledAll"),[i,s]=(0,y.Y)("searchDisabledHosts"),[o,a]=(0,y.Y)("linkPreviewDisabledAll"),[l,c]=(0,y.Y)("linkPreviewDisabledHosts"),d=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/search.b9e474e5.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/search.efb61719.png"),u=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/search-result-preview.f5ecad88.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/search-result-preview.69c11879.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_search_summary")}),(0,q.jsx)(Lo,{caption:e("flow_web_ext_setting_search_summary_title_summary"),illustration:d,globalDisableIcon:(0,q.jsx)(_l,{}),globalDisableDescription:e("flow_web_ext_setting_search_summary_switch_summary"),reportEventScene:hn.lf.searchAssistant,globalDisable:t,onGlobalDisableChange:n,disableHosts:i,onDeleteHost:e=>s(uo(i,e))}),(0,q.jsx)(Lo,{style:{marginTop:36},caption:e("flow_web_ext_setting_search_summary_title_preview"),illustration:u,globalDisableIcon:(0,q.jsx)(ql,{}),globalDisableDescription:e("flow_web_ext_setting_search_summary_switch_preview"),reportEventScene:hn.lf.linkPreview,globalDisable:o,onGlobalDisableChange:a,disableHosts:l,onDeleteHost:e=>c(uo(l,e))})]})},Vl=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsxs)("g",{clipPath:"url(#recommend-feed_svg__a)",children:[(0,q.jsx)("path",{fill:"url(#recommend-feed_svg__b)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M10.537 11.625a.4.4 0 0 1-.287-.111.4.4 0 0 1-.111-.287q0-.165.111-.27a.4.4 0 0 1 .287-.111h4.465q.17 0 .281.111.111.105.112.27a.4.4 0 0 1-.112.287.38.38 0 0 1-.281.111zm0 5.074a.4.4 0 0 1-.287-.105.37.37 0 0 1-.111-.276q0-.17.111-.28a.38.38 0 0 1 .287-.118h4.465q.17 0 .281.117a.38.38 0 0 1 .112.281q0 .164-.112.276a.4.4 0 0 1-.281.105zm-1.465 2.678q-1.002 0-1.535-.533-.533-.528-.533-1.524v-7.09q0-1.001.533-1.529.534-.527 1.535-.527h9.85q1.008 0 1.535.533.533.528.533 1.523v7.09q0 .996-.533 1.524-.528.533-1.535.533zm.164-1.512h9.522q.351 0 .533-.175.188-.182.188-.557v-6.72q0-.375-.188-.552-.182-.175-.533-.175H9.236q-.351 0-.539.175-.18.177-.181.551v6.72q0 .375.181.557.188.176.54.176m.78-2.73q-.38 0-.598-.223t-.217-.61v-1.077q0-.387.217-.61t.598-.222h7.974q.387 0 .598.222.216.223.217.61v1.078q0 .385-.217.61-.21.221-.598.222zm.521-.973h2.654a.38.38 0 0 0 .282-.111.4.4 0 0 0 .111-.287.381.381 0 0 0-.393-.38h-2.654a.4.4 0 0 0-.287.11.37.37 0 0 0-.111.27q0 .17.111.287.111.111.287.111"})]}),(0,q.jsxs)("defs",{children:[(0,q.jsxs)("linearGradient",{id:"recommend-feed_svg__b",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]}),(0,q.jsx)("clipPath",{id:"recommend-feed_svg__a",children:(0,q.jsx)("path",{fill:"#fff",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"})})]})]})),Kl=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("disableSearchAddonsGlobal"),[i,s]=(0,y.Y)("disableSearchAddonsHosts"),o=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/feed.aa82d45f.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/feed.991be187.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_recommend")}),(0,q.jsx)(Lo,{illustration:o,globalDisableIcon:(0,q.jsx)(Vl,{}),globalDisableDescription:e("flow_web_ext_setting_recommend_switch"),reportEventScene:hn.lf.searchAddons,globalDisable:t,onGlobalDisableChange:n,disableHosts:i,onDeleteHost:e=>s(uo(i,e))})]})},zl=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#podcast-summary_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",d:"M11.875 10.856q-.165 0-.27-.106a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h4.723q.158 0 .258.105.105.1.105.252a.35.35 0 0 1-.105.258.34.34 0 0 1-.258.105zm0 1.699q-.165 0-.27-.106a.36.36 0 0 1-.1-.258q0-.152.1-.252.105-.105.27-.105h2.771q.159 0 .258.106.105.1.106.251a.35.35 0 0 1-.106.258.34.34 0 0 1-.258.106zm.088 5.8q-.37 0-.58-.193-.205-.2-.205-.586v-3.258q0-.387.205-.586.21-.198.58-.199h4.33q.78 0 .78.785v3.258q0 .78-.78.78zm-2.766.217V9.684q0-.915.451-1.377.457-.463 1.366-.463h6.222q.909 0 1.36.463.456.462.457 1.377v8.888q0 .921-.457 1.377-.451.457-1.36.457h-6.222q-.908 0-1.366-.457-.45-.457-.45-1.377m.944-.017q0 .439.228.674.235.234.691.234h6.13q.457 0 .685-.235.234-.234.234-.673V9.7q0-.439-.234-.674-.227-.24-.686-.24H11.06q-.457 0-.69.24-.23.235-.23.674z"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"podcast-summary_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),Gl=()=>{const e=(0,r.B)(),[t,n]=(0,y.Y)("podcastSummaryDisableAll"),[i,s]=(0,y.Y)("podcastSummaryDisableHosts"),o=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/podcast-summary.e4b2725e.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/podcast-summary.006e282f.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_podcast")}),(0,q.jsx)(Lo,{style:{marginTop:36},illustration:o,reportEventScene:hn.lf.podcastSummary,globalDisable:t,onGlobalDisableChange:n,globalDisableIcon:(0,q.jsx)(zl,{}),globalDisableDescription:e("flow_web_ext_setting_podcast_switch"),disableHosts:i,onDeleteHost:e=>s(uo(i,e))})]})},$l=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:28,height:28,fill:"none",viewBox:"0 0 28 28"},e),{},{children:[(0,q.jsx)("path",{fill:"url(#collection_svg__a)",d:"M0 14C0 6.268 6.268 0 14 0s14 6.268 14 14-6.268 14-14 14S0 21.732 0 14"}),(0,q.jsx)("path",{fill:"#fff",fillRule:"evenodd",d:"M17.717 12.194a.32.32 0 0 0 .217.084q.13 0 .22-.084a.35.35 0 0 0 .113-.214q.074-.498.159-.841.084-.34.216-.56.133-.22.347-.35.216-.129.547-.204.33-.078.809-.132a.332.332 0 0 0 .31-.337.31.31 0 0 0-.087-.22.37.37 0 0 0-.22-.117 9 9 0 0 1-.806-.145 1.8 1.8 0 0 1-.534-.207q-.21-.13-.343-.343a2 2 0 0 1-.223-.55 11 11 0 0 1-.175-.839.35.35 0 0 0-.116-.213.3.3 0 0 0-.217-.085.32.32 0 0 0-.22.085.34.34 0 0 0-.11.213 10 10 0 0 1-.16.842q-.082.34-.22.56a1.05 1.05 0 0 1-.345.349 1.8 1.8 0 0 1-.544.204q-.33.075-.812.13a.34.34 0 0 0-.22.113.32.32 0 0 0-.088.223q0 .129.084.223.088.094.22.114.482.071.806.148.327.078.537.207.21.13.34.344.133.213.223.55.09.34.178.838a.37.37 0 0 0 .114.214M15.5 8.02h-3.935c-.175 0-.367 0-.534.013a2 2 0 0 0-.712.176c-.35.166-.635.43-.814.756a1.65 1.65 0 0 0-.19.661c-.013.156-.013.335-.013.496v8.613c0 .026 0 .104.007.177v.005c.006.063.034.355.273.624.242.272.608.424.989.409.374-.015.626-.19.68-.23l.005-.002c.063-.044.125-.097.146-.114l.004-.004 2.525-2.111 2.525 2.111.005.004c.02.017.082.07.146.114l.004.003c.055.038.306.214.68.229.381.015.747-.137.99-.41.239-.268.266-.56.272-.623v-.005c.008-.073.007-.151.007-.177v-5.671s-.302.15-.588.15c-.314 0-.558-.15-.558-.15v5.666c0 .075 0 .113-.016.132a.07.07 0 0 1-.058.024c-.026-.001-.056-.027-.117-.077l-2.525-2.112c-.271-.227-.407-.34-.56-.383a.77.77 0 0 0-.414 0c-.153.043-.288.156-.56.383L10.64 18.81c-.06.05-.091.076-.117.077a.07.07 0 0 1-.058-.024c-.017-.019-.017-.057-.017-.132v-8.58c0-.373 0-.56.079-.702a.7.7 0 0 1 .313-.29c.153-.073.353-.073.755-.073h2.477c.303-.71.792-.876 1.428-1.065",clipRule:"evenodd"}),(0,q.jsx)("defs",{children:(0,q.jsxs)("linearGradient",{id:"collection_svg__a",x1:28,x2:-4.777,y1:28,y2:20.278,gradientUnits:"userSpaceOnUse",children:[(0,q.jsx)("stop",{stopColor:"#44ADFE"}),(0,q.jsx)("stop",{offset:1,stopColor:"#5580FF"})]})})]})),Wl=()=>{const e=(0,r.B)(),{image_enabled:t}=el("collection_assistant"),[n,i]=(0,y.Y)("collectImageDisabledHosts"),[s,o]=(0,y.Y)("collectImageDisabledAll"),[a,l]=(0,y.Y)("socialWebcollectDisabledAll"),c=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/image-collection-button.1bfbde1f.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/image-collection-button.1038eff2.png"),d=co("https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/web-collection-button.a096a5d5.png","https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/web-collection-button-cici.7e2e6a9f.png");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_action_bookmarks")}),(0,q.jsx)("h2",{className:ui,style:{paddingLeft:"0px"},children:e("flow_ext_web_setting_bookmark_webpage_title")}),(0,q.jsx)(Lo,{style:{marginTop:12},illustration:d,reportEventScene:hn.lf.collectionPage,globalDisable:a,onGlobalDisableChange:e=>{l(e),(0,he.F3)("web_collect",e?0:1)},globalDisableIcon:(0,q.jsx)($l,{}),globalDisableDescription:e("flow_ext_web_setting_bookmark_webpage_switch")}),t&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:ui,style:{paddingLeft:"0px",marginTop:36},children:e("flow_ext_web_setting_bookmark_img_title")}),(0,q.jsx)(Lo,{style:{marginTop:12},illustration:c,reportEventScene:hn.lf.collectionImage,globalDisable:s,onGlobalDisableChange:e=>{o(e),(0,he.F3)("hover_pic_collect",e?0:1)},globalDisableIcon:(0,q.jsx)($l,{}),globalDisableDescription:e("flow_ext_web_setting_bookmark_img_switch"),disableHosts:n,onDeleteHost:e=>i(uo(n,e))})]})]})};var Yl=n(92474),Ql=n(89962);const Zl={modal:"modal-XXF22b",speaker:"speaker-AGtJ48",name:"name-Y5RQum",icon:"icon-QRg7XI"},Xl=()=>{const e=(0,r.B)(),t=(0,s.useRef)(null),[n,i]=(0,s.useState)(!1),[o,a]=(0,y.Y)("voiceSpeaker"),[l,c]=(0,s.useState)(null);return(0,q.jsxs)("div",{className:Zl["select-handler"],ref:t,children:[(0,q.jsxs)("div",{className:Zl.speaker,onClick:()=>i(!0),children:[(0,q.jsx)("img",{src:null==o?void 0:o.avatarUrl}),(0,q.jsx)("span",{className:Zl.name,children:null==o?void 0:o.name}),(0,q.jsx)(O.Pl,{className:Zl.icon})]}),(0,q.jsx)(d.aF,{centered:!0,getPopupContainer:()=>t.current,width:480,title:e("flow_web_ext_setting_general_select_voice"),visible:n,onCancel:()=>i(!1),closable:!1,maskClosable:!1,keepDOM:!1,className:Zl.modal,footer:(0,q.jsxs)("div",{children:[(0,q.jsx)("button",{style:{display:"none"},type:"button"}),(0,q.jsx)(Yl.c,{type:"quartary",autoFocus:!1,onClick:()=>i(!1),children:e("flow_web_ext_general_cancel")}),(0,q.jsx)(Yl.c,{onClick:()=>{if(l){try{const e=document.createElement("canvas");e.width=48,e.height=48;const t=e.getContext("2d");if(t&&l){const n=new Image;n.src=l.avatarUrl,n.onload=()=>{t.drawImage(n,0,0,48,48),a((0,m.A)((0,m.A)({},l),{},{avatarUrl:e.toDataURL()}))}}}catch(e){}a(l)}i(!1)},children:e("flow_web_ext_general_confirm")})]}),children:(0,q.jsx)(Ql.E,{onSelect:e=>c(e)})})]})},Jl=()=>{const e=(0,r.B)();return(0,q.jsx)(Va,{icon:(0,q.jsx)(O.fz,{}),title:e("flow_web_ext_setting_general_select_voice"),component:(0,q.jsx)(Xl,{})})},er="user-zD6o67",tr="name-lqjJaM",nr="number-ProLRY",ir="link-cJfMbx",sr="container-imUOpR",or="avatar-sEV9_N",ar="icon-OH0umq",lr=()=>{const e=(0,r.B)(),[t]=(0,y.Y)("authInfo");return(0,q.jsx)("div",{className:sr,children:null!=t&&t.isAuthenticated?(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("img",{src:null==t?void 0:t.avatarUrl,alt:"avatar",className:or}),(0,q.jsxs)("div",{className:er,"data-testid":"auth-user-info",children:[(0,q.jsx)("div",{className:tr,children:null==t?void 0:t.nickname}),(0,q.jsx)("div",{className:nr,children:null==t?void 0:t.username})]})]}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(O.de,{className:ar}),(0,q.jsxs)("div",{className:er,children:[(0,q.jsx)("div",{className:tr,children:e("flow_web_ext_setting_my_account")}),(0,q.jsx)("div",{className:ir,onClick:()=>{(0,Ut.DT)({trackMeta:{previous_page:mn.g6.setting,login_entrance:"setting"}})},children:e("flow_web_ext_login")})]})]})})};const rr=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:32,height:32,fill:"none",viewBox:"0 0 32 32"},e),{},{children:[(0,q.jsxs)("g",{clipPath:"url(#profile-setting_svg__a)",children:[(0,q.jsx)("rect",{width:32,height:32,fill:"#06F",rx:10}),(0,q.jsx)("path",{fill:"#fff",d:"M11.195 22.523q-.666 0-1.047-.307t-.38-.843q0-.702.431-1.472.44-.775 1.26-1.45t1.97-1.091q1.15-.425 2.571-.425 1.429 0 2.57.425 1.15.417 1.964 1.091.82.675 1.26 1.45.439.77.439 1.473 0 .534-.38.842-.376.307-1.048.307zM16 15.653a2.7 2.7 0 0 1-1.501-.44 3.26 3.26 0 0 1-1.092-1.178 3.4 3.4 0 0 1-.403-1.656q0-.893.403-1.626A3.2 3.2 0 0 1 14.5 9.59 2.77 2.77 0 0 1 16 9.157q.82 0 1.502.432a3.15 3.15 0 0 1 1.09 1.157q.41.732.41 1.619 0 .923-.41 1.67-.403.74-1.083 1.179-.681.44-1.509.44"})]}),(0,q.jsx)("defs",{children:(0,q.jsx)("clipPath",{id:"profile-setting_svg__a",children:(0,q.jsx)("rect",{width:32,height:32,fill:"#fff",rx:10})})})]})),cr=(0,n(18935).a)((0,q.jsx)(rr,{})),dr=()=>{const e=(0,r.B)(),[t]=(0,y.Y)("authInfo");return(0,q.jsx)(Va,{showNextIcon:!0,icon:(0,q.jsx)(cr,{}),title:e("flow_web_ext_setting_general_setup"),onClick:()=>{null!=t&&t.isAuthenticated?window.open(Oe.KT,"_blank"):(0,Ut.DT)({trackMeta:{previous_page:mn.g6.setting,login_entrance:"setting"}})}})},ur=()=>{const e=(0,r.B)(),[t]=(0,y.Y)("authInfo");return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h2",{className:di,children:e("flow_web_ext_setting_general")}),(0,q.jsx)(lr,{}),(0,q.jsxs)(Ha,{children:[(null==t?void 0:t.isAuthenticated)&&(0,q.jsx)(dr,{}),!1,(null==t?void 0:t.isAuthenticated)&&(0,q.jsx)(Jl,{})]})]})};class mr{constructor({request:e}={}){if((0,g.A)(this,"request",void 0),!e)throw new Error("FeedbackThirdApiService.request is undefined");this.request=(t,n)=>e(t,(0,m.A)((0,m.A)({},n),{},{overrideConfig:(0,m.A)((0,m.A)({},null==n?void 0:n.overrideConfig),{},{ignoreResponseInterceptors:!0})}))}}var hr=n(33451),pr=n(86956),gr=n(48133),_r=n(7892),vr=n(51668),fr=n(39791),br=n(49392),xr=n(7685),Ar=n.n(xr),yr=n(98502);const wr=()=>"undefined"==typeof window;function Sr(e){try{if(wr()||!e)return!1;const t="__test_storage_key";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return!1}}class jr{constructor(e=!1){(0,g.A)(this,"storage",null),(0,g.A)(this,"storageMap",new Map),(0,g.A)(this,"isSessionStorage",!1),this.isSessionStorage=e,this.storage=wr()?null:e?sessionStorage:localStorage}getItem(e){var t;const{storage:n,storageMap:i}=this;var s,o;return Sr(n)?null!==(s=null!==(o=n.getItem(e))&&void 0!==o?o:i.get(e))&&void 0!==s?s:null:null!==(t=i.get(e))&&void 0!==t?t:null}setItem(e,t){const{storage:n,storageMap:i}=this;try{if(Sr(n))return void n.setItem(e,t);i.set(e,t)}catch(s){(e=>"QuotaExceededError"===e.name)(s)&&i.set(e,t)}}removeItem(e){const{storage:t,storageMap:n}=this;Sr(t)&&t.removeItem(e),n.delete(e)}clear(){const{storage:e,storageMap:t}=this;Sr(e)&&e.clear(),t.clear()}}const kr=new jr,Cr=new jr(!0);var Ir=n(35687);let Tr=function(e){return e[e.UPLOADING=0]="UPLOADING",e[e.FAILED=1]="FAILED",e[e.FINISHED=2]="FINISHED",e}({});const Nr=e=>(0,q.jsx)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),{},{children:(0,q.jsx)("path",{fill:"#fff",d:"M3.525 16q-1.21 0-1.87-.613Q1 14.773 1 13.599V6.474q0-1.176.676-1.825.676-.65 1.85-.649h7.524q1.209 0 1.842.649.633.65.633 1.817v7.06q0 1.176-.662 1.825-.654.65-1.863.649zm11.1-3.57V7.62l2.368-2.04q.244-.21.489-.332.252-.13.496-.13.454 0 .734.295Q19 5.71 19 6.2v7.658q0 .491-.288.786-.28.296-.734.296-.244 0-.496-.13a2.7 2.7 0 0 1-.49-.339z"})})),Er=e=>(0,q.jsx)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:30,height:30,fill:"none",viewBox:"0 0 30 30"},e),{},{children:(0,q.jsx)("path",{fill:"#fff",d:"M5.146 16.287q0-2.042.762-3.83a9.872 9.872 0 0 1 5.23-5.241 9.6 9.6 0 0 1 4.668-.728q.408.045.783.121l-2.67-2.637a1.2 1.2 0 0 1-.221-.331 1 1 0 0 1-.077-.397q0-.465.298-.773.31-.32.761-.32.464 0 .761.31l4.524 4.612q.343.33.343.794 0 .22-.089.42a1.1 1.1 0 0 1-.254.375l-4.524 4.568q-.286.298-.76.298-.442 0-.751-.309a1.03 1.03 0 0 1-.31-.761q0-.21.078-.387.088-.187.232-.342l3.001-2.968a8 8 0 0 0-.916-.132 9 9 0 0 0-1.037-.056 7.5 7.5 0 0 0-3.001.596 7.7 7.7 0 0 0-2.428 1.656 7.7 7.7 0 0 0-1.644 2.45 7.7 7.7 0 0 0-.585 3.012 7.6 7.6 0 0 0 .596 3A8 8 0 0 0 9.56 21.75a7.8 7.8 0 0 0 2.45 1.655 7.7 7.7 0 0 0 3.001.585q1.59 0 2.98-.585a7.6 7.6 0 0 0 2.449-1.655 7.9 7.9 0 0 0 1.655-2.461 7.6 7.6 0 0 0 .596-3.001q0-.497.287-.806.298-.309.772-.309.497 0 .795.309.309.31.309.806a9.8 9.8 0 0 1-.762 3.85 9.7 9.7 0 0 1-2.107 3.145 9.7 9.7 0 0 1-3.145 2.108 9.7 9.7 0 0 1-3.829.761 9.8 9.8 0 0 1-3.85-.761 9.6 9.6 0 0 1-3.135-2.108 10.1 10.1 0 0 1-2.118-3.144 9.8 9.8 0 0 1-.762-3.852"})})),Mr=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:18,height:18,fill:"none",viewBox:"0 0 18 18"},e),{},{children:[(0,q.jsx)("rect",{width:18,height:18,fill:"#000",fillOpacity:.6,rx:9}),(0,q.jsx)("path",{fill:"#fff",d:"M5.797 12.199a.6.6 0 0 1-.16-.278.66.66 0 0 1 .005-.318.6.6 0 0 1 .15-.27L8.123 9l-2.33-2.33a.6.6 0 0 1-.15-.269.7.7 0 0 1 0-.318.6.6 0 0 1 .155-.277.55.55 0 0 1 .277-.16.7.7 0 0 1 .323 0 .56.56 0 0 1 .273.151L9 8.122l2.326-2.326a.56.56 0 0 1 .274-.15.622.622 0 0 1 .596.16.6.6 0 0 1 .159.276.63.63 0 0 1-.152.592L9.878 8.999l2.326 2.33a.56.56 0 0 1 .15.274.66.66 0 0 1-.004.318.56.56 0 0 1-.155.277.57.57 0 0 1-.277.155.66.66 0 0 1-.318.005.54.54 0 0 1-.274-.155L9 9.877l-2.33 2.33a.57.57 0 0 1-.273.146.63.63 0 0 1-.319 0 .6.6 0 0 1-.281-.155"})]})),Pr=e=>(0,q.jsxs)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:32,height:33,fill:"none",viewBox:"0 0 32 33"},e),{},{children:[(0,q.jsx)("g",{clipPath:"url(#add_icon_svg__a)",children:(0,q.jsx)("path",{fill:"#666",d:"M7.826 16.45q0-.45.322-.772.322-.333.772-.332h5.986V9.369q0-.45.322-.771.323-.323.772-.323.459 0 .781.323.323.322.323.771v5.977h5.976q.45 0 .772.332.321.322.322.771 0 .46-.322.781a1.07 1.07 0 0 1-.772.313h-5.976v5.996q0 .44-.323.762a1.06 1.06 0 0 1-.781.322q-.45 0-.771-.322a1.04 1.04 0 0 1-.323-.762v-5.996H8.92q-.45 0-.772-.312a1.06 1.06 0 0 1-.322-.782"})}),(0,q.jsx)("defs",{children:(0,q.jsx)("clipPath",{id:"add_icon_svg__a",children:(0,q.jsx)("path",{fill:"#fff",d:"M0 .5h32v32H0z"})})})]}));var Lr=n(59305),Dr=n(1665),Rr=n(57669);const Br={container:"container-ou61ck",animated:"animated-AZqZm1",forward:"forward-VYEA19",entering:"entering-hJHlR8",entered:"entered-SnBprv",exiting:"exiting-ykszQ7",exited:"exited-JwjwUa",unmounted:"unmounted-olh9bD"},Or=({isEnabled:e=!0,isFinished:t,className:n,style:i,children:o})=>{const[a,r]=(0,s.useState)(0);return(0,Dr.A)((()=>{r(Math.min(a+20,80))}),t&&e?void 0:1e3,{immediate:!0}),(0,Rr.A)((()=>{r(t?100:0)}),[t]),(0,q.jsx)(Lr.Ay,{in:!t&&e,mountOnEnter:!0,timeout:300,children:e=>(0,q.jsxs)(q.Fragment,{children:[null==o?void 0:o(l()(Br.animated,Br.reverse,Br[e])),"exited"!==e&&"unmounted"!==e&&(0,q.jsx)("div",{className:l()(n,Br.container,Br.animated,Br.forward,Br[e]),style:i,children:(0,q.jsx)(d.ke,{percent:a,type:"circle",size:"small",stroke:"white",width:20,strokeWidth:2.5,strokeLinecap:"square",orbitStroke:"rgba(255,255,255,0.6)"})})]})})},Ur={container:"container-thsmXK",entered:"entered-LptaNC",entering:"entering-OVZxOt",exiting:"exiting-afwVZw",exited:"exited-e5mOjc",unmounted:"unmounted-i8Xk9t",loading:"loading-RtE_nN",icon:"icon-BsZEBa",rotate:"rotate-c2fTUQ",rotation:"rotation-divbev"},Fr=({loading:e,title:t,toast:n})=>{const i=(0,s.useRef)();return(0,s.useEffect)((()=>{e?i.current=n.success({icon:(0,q.jsx)("div",{className:Ur.loading,children:(0,q.jsx)("img",{className:l()(Ur.icon,Ur.rotate),src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAACE4AAAhOAFFljFgAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAlGSURBVHgB7VxJbxxFFH7dM+PxvmHHMXEcs0iIiANSOMAFzIFjTigSB35Mfg2XSJzgwIlISCwHH+AQxAFkiIlxbPBux/ZMN++rfq9d0x4blOnuadD7pKeqrprp5e1VXdVEBoPBYDAYDAaDwWAwGAwGg8FgMBj+7wio+mgwNZnqTMHo6Gj94OAgkHrEdRobG4vCMIx2d3fb3B4xnTGh3qKKo07VQ8g0JATGg9mxEoAfjYyMxPqH/f39gIUQjo+PB3t7ezQxMdEIgiAGbW9vQxiglpyjUqiSAAaZhoeGhkaOj499pisC//jw8JDYAmAFMayAhaBdjvE7Ozskv8cz1qRPhdGmiqBG/cfg8PDwbK1Wm6rX607juQxarcR7sECo0WgQH8f8Ozo6Okr/eHp6SgMDA6708ezZM5qamoq5VBerggvm5ubq3FeHpVDirvqKkPoHaOY8040oiobANABMk3pqAbAIFkSgzGf340rWfmLtj9n9uGMuA3Y//jXi6enp9ICZTxwr4na7Hcj11cX1Df26+BST40yz2SS4DK7GGcbHg4ODEEjEzI9ZCOr7I7gf9Iv7US1Gv1/voNnZWdrc3Ez7FxYWaG1tTfthbn1xS2VbQMjMvMFMn5FrOwXguBqIu0hdBZ0rR6AWwC6oI4hC+xEHUIcVqPZPTk6mv5mZmXElM9/9d35+3l1SmX/79m2UcMUN6gPKFAAecIndzejJyYl/XcdAaDt5QgHULSnYBQWs/YG6IC5DsZ40CDPzNQAnJ5d+Zrwr19fX46WlpbT/0aNHrrxz5w6K0mNiWS4I3F1gqiNoKlNYEOoSIrgiPobbcW3M/NQF4ZAJkVazGLS1M88RCoGJ8O8ha3+8tbUVs++PNzY21HoiCIADfcz34tpYCM4alpeX6eHDhzh3NgMrDGUIYJAfdIkzFd/FxMpwaXPHKEUoaAPTEXUP6PmyFQ20NSF3HWZ+vLq6iv6Itd7dz8rKis9wN9ZQJSkaRbugAaZFZr5eJ2BhOP/OjEYADpRcZ/LQJ0x/CCFXfN5UEeeCtagg/VExfD8Yj9jhGH3v3j3Xfv/+fdyHux0qAUVeZIAZu8SMbkiuHmtJ5yaO68P9QPPBrA2mYyoOahVQCCdYZnz04MED18mK79rK0n6iYi1gkZkK3x/KgCkQN6SUWgX/DlHzNyqW+YBahVpDDOaz1rsUFppfJvOBoixgTgiMj0XrAaf5sARKpgxazPynXN+l/iCNDV5bqQIoYi5ogKcOrp+dQdEoFq2/AG5HFvOYEh/dL+AestMVpaKIvPc1zvXrmL/hEvM4AUryrI2nAtCwSv1lfiWQdwx4gZL5FWILcH4elgAhiNtR//87GfMd8hbAfPa8YD6EgdRampDp7JHBIU8BqPan2Q1IYoFaBGbRnpIhRZ4CeBHaDt+PkkQAXPcF8pgMHcgrCxpjRrvZNNV4D8guIIQnlMznGDzkZQEz4mJ8jXczm9IOxv9FhgvIRQDM9Gm4HmZ27J9XXBIEgAk10/4uyMMFjTM1hPmBlugQd4T6Ohm6Ig8LGPcY3THHI9qPmcgTMnRFHgKYwCoG6pxX0hQU5Q4ZLkUeAhhptVpp2qnCkBKwQdcV6DUG4P941xszw3GcrueREkIwAVyBXi0Ab8ed32eGu7Qz446OyHAlerUAx2jV/vSkfCwCqcwSwKqiVwGkK8s8l+PDsp9/QM/jAH8dp1iCCsPwL9CzC5IMKAWY7wmirHVH/1nkMRIOxOdTJgNyfWS4Er1mQY7TGU0PvLKKG0AqhV4ZhNeKadopKWjsDczGyXAlerWAVACa/0v6qefFNiOzgiuQhwtK3ZCmoiIMXek8RoZLkcdc0CEYrkTn0xF6PE2GS5HHuqCxKIommbD+x1966B8/IUNX5GEBm1Jmg7G2YbWEBeNLkIcAtkmW+HlzQlmaI0NX5PVSPrWCWq2Gc8YomVQAS2TZUFfktTYUUfdmwGi321gT6lbCgVgIWHcP5uNd8Z9k6EBeFoAlJ25tv2o9ShALRNPRl5iGydCBPFdHN8IwfEE2QTvt52NsjNZ1obgW9pHa6jgPeS5NXMWGC6m7LEi137OKWS5fIUOKPC0gipKNAGBympJKLEBVLQEZ0RZV73UlllZiV3c6ui8DRUwXv8uajq3q+k2GC0tWuP+M+76i/m1N8oF7vcuu8hbrj/MInE5/x6P5L6gEFLFD5gAPg4ruCYALUiuQdmRFi5TsFejnRo1JvteP+X6u4/4QsySTu0mJYH6iglGEAI75YRCQpxGAQUhNyRuYiUBUCHBb/UhP4Qo/4vtwH5gA8+FBRVGA65QI4IAKRFHfRnjKDzLLNIwH87RfU1NYRcjtuL7uqtmk8vAW04ck26kAzdo8S0AdW6k2qEAU+XEKBNp5fogBYXaannIZqlDEGq5x+TKXGEsUuZDrGtNdpjflONA0WSxAXaS6z++pYOssUgBYsYtV0bf44WoqABkZd2RJlAgG2ojYMSr/PaT8gMnA95k+QF2YTnJ9V8L3+5bKv9nl46+p4BhVRBaUBXzse5R8N0KvqaS7Z9Kxgpc5wfR/lvJ5/DAEik+hvc3nXJQ2f9wTUmeGpoxXS/iMEgsoFGUIAEBG8Q4l2u2uq7GAMpv6qJMpmNDDgA5CwKwrLAobPWAd+975m0LI429QMhYBIbd3bkZTTOrC9C71z5l+oBJQlgAAzAMtUyKEqxjgB+u0H3HEPyZPgz0GXziX9KXaTfKiyGv3f4+VfJ8y/UolocwvRMGvr1Lyon4Kmh3iC3qe36VOZuv4wQ/eHaS+XMcbmsdnYgxJXyBppp5P70vPg+2zn1DBWU8WZX+iCzk/UrszSVNx/QtW4DMJwpD00HchjqH+b/EjMFgF4P3HF0TgBWBfSCuUaH7pa1nLdEFZYGn7G5RMzqUj5sz0RYdVUBKkyW8XxneLI9pN3rtphQoGM7NfUh83j/dTAAp8whIDI4xMff9OXqBOU1jv/UKHj1eLyDC7QyCe319j+oYqMDVeBQEoIIjXmV6l87QU6Jja1rZQIqq/EsMXRuYLLfobMP5bKSuBKglA4b4zx4QJMUxTNDOaT0RdX/wDWVeElBVTHL8w/UgV3K9QRQFkgUkxLO4al7Ip9aZqPAvolAWkn7XcypBtEjEYDAaDwWAwGAwGg8FgMBgMBoPB0Ff8DZGbA78LsLmgAAAAAElFTkSuQmCC"})}),content:t,duration:Math.pow(10,8),showClose:!1}):i.current&&(n.close(i.current),i.current=void 0)}),[e]),(0,q.jsx)(Lr.Ay,{in:e,mountOnEnter:!0,unmountOnExit:!0,timeout:150,children:e=>(0,q.jsx)("div",{className:l()(Ur.container,Ur[e])})})};var qr=n(32727);const Hr={container:"container-MyiC_3",content:"content-XOCUsx",textarea:"textarea-A2HVq9",white:"white-BZhvC0",grey:"grey-ndeQiB",input:"input-Bzb8FZ",count:"count-pX2zzS",red:"red-aK7JTO","file-list":"file-list-QU5Yof",fileList:"file-list-QU5Yof",item:"item-UjgmRq",background:"background-KmR0W4",close:"close-_LyUVE",icon:"icon-DJhw2f",uploading:"uploading-hR1vhG",failed:"failed-eCGhQ0","video-overlay":"video-overlay-LzeJRe",videoOverlay:"video-overlay-LzeJRe",adder:"adder-ZPFzWC","add-icon":"add-icon-cp2WId",addIcon:"add-icon-cp2WId","submit-button":"submit-button-qACIBh",submitButton:"submit-button-qACIBh",tapable:"tapable-Ify9jT",hoverable:"hoverable-sOQPvO"},Vr=({className:e,contentClassName:t,textAreaClassName:n,fileUploadClassName:o,style:a,theme:r="white",onChooseMedia:c,onUploadMedia:u,onSubmit:h,onChange:g,submitButtonClassName:_,submitButtonDisabled:v=!1,textAreaPlaceholderTitle:f,submitButtonTitle:b,showFullPageSubmitLoading:x,notAllAssetsFinishedTitle:A,oversizeToastTitle:y,allowedMediaType:w,renderTextArea:S,mobile:j=!1})=>{var k;const[C,I]=(0,s.useState)(""),T=(0,s.useRef)(null),N=(e=>(0,s.useMemo)((()=>d.EY.create({getPopupContainer:()=>e.current})),[]))(T),[E,M]=(0,s.useState)([]),[P,L]=(0,s.useState)(!1),D=(()=>{const e=(0,s.useRef)(0);return()=>e.current++})();(0,s.useEffect)((()=>{null==g||g({content:C,choosedMediaList:E})}),[C,E]);const R=function(){var e=(0,i.A)((function*(e){const t=Se(e.base64PreviewImage);return t?yield u({type:"file",mimeType:"image/png",mediaType:"image",value:t},N):null}));return function(t){return e.apply(this,arguments)}}(),B=function(){var e=(0,i.A)((function*(){if(!C)return;if(E.some((e=>e.status!==Tr.FINISHED)))return void N.error(A);const e=E.filter((e=>"image"===e.mediaData.mediaType)),t=E.find((e=>"video"===e.mediaData.mediaType)),n=e.map((e=>e.uploaded)).filter((e=>Boolean(e)));L(!0);try{var i,s,o,a,l;const e=t&&(yield R(t)),r=Ar().getParser(navigator.userAgent);yield h({content:C,image_list:n,video_cover_height:null==e?void 0:e.image_height,video_cover_width:null==e?void 0:e.image_width,video_cover_url:null!==(i=null==e?void 0:e.image_uri)&&void 0!==i?i:"",video_play_url:null!==(s=null==t||null===(o=t.uploaded)||void 0===o?void 0:o.image_uri)&&void 0!==s?s:"",extra_params:JSON.stringify({is_private_video:1,is_private_image:1,path:location.pathname+location.search,version:String((null===(a=window.gfdatav1)||void 0===a?void 0:a.ver)||"unknown"),ug_url:kr.getItem("flow_web_landing_page_url"),is_samantha_client:(0,p.ps)()?"1":"0",os:r.getOSName(),browser:r.getBrowserName(),browser_version:r.getBrowserVersion(),tea_uid:null===(l=window.Tea)||void 0===l?void 0:l.getConfig("user_unique_id")}),multi_image:"1"},N)}finally{L(!1)}}));return function(){return e.apply(this,arguments)}}(),O=()=>{const e=["image"];return E.filter((e=>"video"===e.mediaData.mediaType)).length<1&&e.push("video"),w?e.filter((e=>null==w?void 0:w.includes(e))):e},{run:U}=(0,Ir.A)(function(){var e=(0,i.A)((function*(e){const t=null!=e?e:D(),n=O(),i=!(0,br.A)(e)&&E.find((t=>t.id===e));if(i){const{status:e,mediaData:{mediaType:t}}=i;if(e!==Tr.FAILED)throw Error(`Not allow to reupload because it's not failed status: ${e}`,{cause:i});n.includes(t)||n.push(t)}const s=i||(yield c({allowedMediaType:n},N));if(s)if(((e,t)=>{const n=e.mediaData.mediaType;if(!t.includes(n))throw Error(`Not allowed media type: ${n}, only allowed ${t.join(", ")} now.`)})(s,n),"image"===(o=s).mediaData.mediaType&&o.size>5242880||"video"===o.mediaData.mediaType&&o.size>52428800)N.warning(y);else{var o;M((0,yr.jM)((n=>{const i=n.find((t=>t.id===e));i?i.status=Tr.UPLOADING:n.push((0,m.A)((0,m.A)({},s),{},{id:t,status:Tr.UPLOADING}))})));try{const e=yield u(s.mediaData,N);M((0,yr.jM)((n=>{const i=n.find((e=>e.id===t));i&&(i.status=Tr.FINISHED,i.uploaded=e)})))}catch(a){M((0,yr.jM)((e=>{const n=e.find((e=>e.id===t));n&&(n.status=Tr.FAILED)})))}}}));return function(t){return e.apply(this,arguments)}}(),{leading:!0,trailing:!1,wait:500}),F={placeholder:f,value:C,onChange:e=>{I(e.slice(0,300))},className:Hr.input,rows:5,autosize:!0};return(0,q.jsxs)("div",{"data-testid":"feedback_submit_panel",className:l()(Hr.container,e),style:a,ref:T,children:[(0,q.jsxs)("div",{className:l()(Hr.content,t),children:[(0,q.jsxs)("div",{className:l()(Hr.textarea,Hr[r],n),children:[null!==(k=null==S?void 0:S(F))&&void 0!==k?k:(0,q.jsx)(d.fs,(0,m.A)({},F)),(0,q.jsxs)("div",{"data-testid":"feedback_submit_panel_input_count",className:l()(Hr.count,{[Hr.red]:C.length>=300}),children:[C.length,"/",300]})]}),null!=w&&w.length?(0,q.jsxs)("div",{className:Hr["file-list"],children:[E.map((e=>(0,q.jsxs)("div",{"data-testid":"feedback_image",className:l()(Hr.item,o),children:[(0,q.jsx)(Or,{className:Hr.uploading,isFinished:e.status===Tr.FINISHED,isEnabled:e.status!==Tr.FAILED,children:t=>(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("img",{className:l()(Hr.background,t),src:e.base64PreviewImage}),e.status===Tr.FAILED&&(0,q.jsx)("div",{className:l()(Hr.failed,Hr.tapable,t,{[Hr.hoverable]:!j}),onClick:()=>{U(e.id)},children:(0,q.jsx)(Er,{className:Hr.icon})}),e.status===Tr.FINISHED&&"video"===e.mediaData.mediaType&&(0,q.jsx)("div",{className:l()(Hr["video-overlay"]),children:(0,q.jsx)(Nr,{className:Hr.icon})})]})}),(0,q.jsx)("div",{className:l()(Hr.close,Hr.tapable,{[Hr.hoverable]:!j}),onClick:()=>{var t;t=e.id,M((0,yr.jM)((e=>{const n=e.findIndex((e=>e.id===t));-1!==n&&e.splice(n,1)})))},children:(0,q.jsx)(Mr,{className:Hr.icon})})]},e.id))),E.length<4&&(0,q.jsxs)("div",{className:l()(Hr.item,Hr.adder,Hr.tapable,Hr[r],{[Hr.hoverable]:!j},o),onClick:()=>U(),children:[(0,q.jsx)(Pr,{className:Hr["add-icon"]}),(0,q.jsxs)("div",{className:Hr.count,children:[E.length,"/",4]})]})]}):null]}),(0,q.jsx)(qr.r,{"data-testid":"feedback_submit_panel_submit",className:l()(Hr["submit-button"],_),width:"full",onClick:(0,i.A)((function*(){x?B():yield B()})),disabled:!C||v,children:b}),x&&(0,q.jsx)(Fr,{loading:P,title:x.submittingToastTitle,toast:N})]})};var Kr=n(77835),zr=n(85886);const Gr=class{constructor(e){(0,g.A)(this,"value",!1),this.value=!!e}setTrue(){this.value=!0}setFalse(){this.value=!1}isFalse(){return!this.value}isTrue(){return this.value}};const $r=class{constructor(e,t,n,i){(0,g.A)(this,"options",void 0),(0,g.A)(this,"requestFn",void 0),(0,g.A)(this,"debounceFn",void 0),(0,g.A)(this,"throttleFn",void 0),(0,g.A)(this,"pollingTimer",void 0),(0,g.A)(this,"count",0),(0,g.A)(this,"unmountedFlag",new Gr),(0,g.A)(this,"that",this),(0,g.A)(this,"onChangeState",void 0),(0,g.A)(this,"state",{loading:!1,run:this.run.bind(this.that),data:void 0,error:void 0,isPolling:!1,unmountedFlag:this.unmountedFlag,cancel:this.cancel.bind(this.that),refresh:this.refresh.bind(this.that),refreshOptions:this.refreshOptions.bind(this.that),changeData:this.changeData.bind(this.that),unmount:this.unmount.bind(this.that),params:[]});const{debounceThrottleOptions:s,initData:o,debounceInterval:a,throttleInterval:l}=t;if(this.requestFn=e,this.options=t,this.onChangeState=n,this.state.data=o,i&&(this.state=(0,m.A)((0,m.A)({},this.state),i)),this.pollingTimer=void 0,void 0!==a)this.debounceFn=a?(0,js.A)(this._run.bind(this.that),a):void 0;else if(void 0!==l)this.throttleFn=l?(0,zr.A)(this._run.bind(this.that),l):void 0;else if(void 0!==s){const{type:e,interval:t,leading:n="debounce"!==e,trailing:i=!0}=s;"debounce"===e?this.debounceFn=(0,js.A)(this._run.bind(this.that),t,{leading:n,trailing:i}):"throttle"===e&&(this.throttleFn=(0,zr.A)(this._run.bind(this.that),t,{leading:n,trailing:i}))}}setState(e={}){this.state=(0,m.A)((0,m.A)({},this.state),e),this.onChangeState&&this.onChangeState(this.state)}cancelPolling(){void 0!==this.pollingTimer&&(window.clearTimeout(this.pollingTimer),this.pollingTimer=void 0)}dontPolling(){this.setState({isPolling:!1})}_run(...e){this.cancelPolling(),this.count+=1;const t=this.count;return this.setState({loading:!0,params:e,isPolling:Boolean(this.options.pollingInterval)}),this.requestFn(...e).then((n=>{if(this.unmountedFlag.isTrue()||t!==this.count)return;const i=this.options.formatResult?this.options.formatResult(n):n;return this.setState({loading:!1,error:void 0,data:i}),this.options.onSuccess&&this.options.onSuccess(i,e,this.dontPolling.bind(this.that)),i})).catch((n=>{if(!this.unmountedFlag.isTrue()&&t===this.count){if(this.setState({data:void 0,error:n,loading:!1}),this.options.onError&&this.options.onError(n,e,this.dontPolling.bind(this.that)),this.options.throwOnError)throw n;return n}})).finally((()=>{this.unmountedFlag.isTrue()||t!==this.count||this.options.pollingInterval&&this.state.isPolling&&(this.pollingTimer=window.setTimeout((()=>{this._run(...e)}),this.options.pollingInterval))}))}run(...e){const{debounceFn:t,throttleFn:n}=this;return this.unmountedFlag.setFalse(),t?(t(...e),Promise.resolve(null)):n?(n(...e),Promise.resolve(null)):this._run(...e)}cancel(){const{debounceFn:e,throttleFn:t,pollingTimer:n}=this;e&&e.cancel(),t&&t.cancel(),void 0!==n&&this.cancelPolling(),this.count+=1,this.setState({loading:!1,isPolling:!1})}unmount(){this.unmountedFlag.setTrue(),this.cancel()}refresh(){return this.unmountedFlag.setFalse(),this.run(...this.state.params)}refreshOptions(e={}){return this.options=(0,m.A)((0,m.A)({},this.options),e),this.run(...this.state.params)}changeData(e){"function"==typeof e?this.setState({data:e(this.state.data)||{}}):this.setState({data:e})}};var Wr=n(7053);const Yr="BYTED_HOOKS_REQUEST_CACHE_STORAGE";const Qr=new class{constructor(){(0,g.A)(this,"memoryValue",void 0),(0,g.A)(this,"localStorageValue",void 0),(0,g.A)(this,"sessionStorageValue",void 0),(0,g.A)(this,"getValue",((e,t)=>{switch(t){case"memory":default:return this.memoryValue.get(e);case"sessionStorage":return this.sessionStorageValue[e];case"localStorage":return this.localStorageValue[e]}})),(0,g.A)(this,"setValue",((e,t,n)=>{switch(n){case"memory":default:this.memoryValue.set(e,t);break;case"sessionStorage":this.sessionStorageValue[e]=t,this.syncStorage(Cr,this.sessionStorageValue);break;case"localStorage":this.localStorageValue[e]=t,this.syncStorage(kr,this.localStorageValue)}})),(0,g.A)(this,"removeItem",((e,t)=>{switch(t){case"memory":default:this.memoryValue.delete(e);break;case"sessionStorage":delete this.sessionStorageValue[e],this.syncStorage(Cr,this.sessionStorageValue);break;case"localStorage":delete this.localStorageValue[e],this.syncStorage(kr,this.localStorageValue)}})),this.memoryValue=new Map;try{var e,t,n,i;this.localStorageValue=this.compressStorage(JSON.parse(null!==(e=null===(t=window)||void 0===t?void 0:t.localStorage.getItem(Yr))&&void 0!==e?e:"{}")),this.sessionStorageValue=this.compressStorage(JSON.parse(null!==(n=null===(i=window)||void 0===i?void 0:i.sessionStorage.getItem(Yr))&&void 0!==n?n:"{}"))}catch(s){this.localStorageValue={},this.sessionStorageValue={}}}syncStorage(e,t,n=!1){try{e.setItem(Yr,JSON.stringify(t))}catch(i){n||(e.removeItem(Yr),this.syncStorage(e,this.compressStorage(t),!0))}}compressStorage(e){const t={};return Object.entries(e).forEach((([e,n])=>{(-1===n.expireTime||n.expireTime>Date.now())&&(t[e]=n)})),t}};var Zr=n(82831);const Xr="_BYTED_HOOKS_DEFAULT_KEY_",Jr=(e,t={})=>{var n,i,o,a;const{staleTime:l=3e5}=t,{auto:r=!1,defaultParams:c=[],refreshDeps:d=[],initData:u,ready:h=!0,cacheKey:p,cacheStoreType:g="memory",cacheTime:_=3e5,loadingCheck:v=!1,errorCheck:f=!1,formatResult:b,requestKey:x,onError:A,onSuccess:y}=t,w=(0,Zr.A)(e),S=(0,Zr.A)(y),j=(0,Zr.A)(A),k=b?(0,Zr.A)(b):void 0,C=(0,Zr.A)(x),I=(0,s.useCallback)(((e,t)=>{D((n=>(0,m.A)((0,m.A)({},n),{},{[e]:t})))}),[]),T=(0,s.useRef)(p);T.current=p;const N=(0,s.useRef)(g);N.current=g;const E=(0,s.useRef)(h);E.current=h;const M=(0,s.useRef)(Xr),P=()=>{if(T.current){const{data:e,startTime:n=0}=((e,t)=>{var n;const i=Qr.getValue(e,t);if(i&&(-1===(null==i?void 0:i.expireTime)||(null!==(n=null==i?void 0:i.expireTime)&&void 0!==n?n:0)>Date.now()))return(0,Wr.A)(i);Qr.removeItem(e,t)})(T.current,N.current)||{},i=-1===l||(new Date).getTime()-n<=l;if(e&&i){M.current=e.currentRequestKey;const n={};return Object.keys(e.requests).forEach((i=>{const s=e.requests[i],o=new $r(w,(0,m.A)((0,m.A)({},t),{},{onSuccess:S,onError:j,formatResult:k}),I.bind(null,i),{loading:s.loading,params:s.params,data:s.data,error:s.error});n[i]=o.state})),n}return{}}return{}},[L,D]=(0,s.useState)((()=>P())),R=(0,s.useRef)(L);R.current=L;const B=(0,s.useRef)(),O=(0,s.useCallback)(((...e)=>{if(!h)return void(B.current=e);let n;if(x){const t=C(...e);M.current=t,n=R.current[t]}else n=R.current[M.current];if(!n){const n=new $r(w,(0,m.A)((0,m.A)({},t),{},{onSuccess:S,onError:j,formatResult:k}),I.bind(null,M.current)).state;return D((e=>(0,m.A)((0,m.A)({},e),{},{[M.current]:n}))),n.run(...e)}return n.run(...e)}),[x,h]);(0,Rr.A)((()=>{T.current&&((e,t,n,i)=>{const s=Date.now(),o={data:n,expireTime:-1!==t?s+t:t,startTime:s};Qr.setValue(e,o,i)})(T.current,_,{requests:L,currentRequestKey:M.current},N.current)}),[L]);const U=(0,s.useCallback)((()=>{Object.values(R.current).forEach((e=>{e.unmount()})),M.current=Xr,D({}),R.current={}}),[D]),F=(0,s.useRef)(!1);(0,Rr.A)((()=>{h&&(!F.current&&B.current&&O(...B.current),F.current=!0)}),[h]),(0,s.useEffect)((()=>{if(h&&r){const e=P();Object.keys(e).length>0?Object.values(L).forEach((e=>{e.refresh()})):O(...c)}return()=>{Object.values(R.current).forEach((e=>{e.unmount()}))}}),[h]),(0,Rr.A)((()=>{if(E.current&&r){const e=P();0===Object.keys(e).length?Object.values(L).forEach((e=>{e.refresh()})):D(e)}}),[...d]);const q=[t.debounceInterval,t.throttleInterval,null===(n=t.debounceThrottleOptions)||void 0===n?void 0:n.type,null===(i=t.debounceThrottleOptions)||void 0===i?void 0:i.interval,null===(o=t.debounceThrottleOptions)||void 0===o?void 0:o.leading,null===(a=t.debounceThrottleOptions)||void 0===a?void 0:a.trailing,t.pollingInterval];let H;if((0,Rr.A)((()=>{Object.values(L).forEach((e=>{e.unmountedFlag.isTrue()||(void 0!==t.debounceInterval?e.refreshOptions({debounceInterval:t.debounceInterval,pollingInterval:t.pollingInterval}):void 0!==t.throttleInterval?e.refreshOptions({throttleInterval:t.throttleInterval,pollingInterval:t.pollingInterval}):e.refreshOptions({debounceThrottleOptions:t.debounceThrottleOptions,pollingInterval:t.pollingInterval}))}))}),[...q]),H=L[M.current]?(0,m.A)((0,m.A)({},L[M.current]),{},{run:O,reset:U,requests:L}):{loading:r&&h,isPolling:!1,data:u,error:void 0,unmountedFlag:new Gr,params:[],cancel:()=>{},unmount:()=>{},reset:()=>{},refresh:()=>{},refreshOptions:()=>{},changeData:()=>{},run:O,requests:L},"undefined"!=typeof Proxy){return new Proxy(H,{get:(e,t)=>e[t]})}return H},ec=["ready","resetDeps","refreshDeps","itemKey","initPageSize","ref","threshold"];function tc(e,t={}){const{ready:n=!0,resetDeps:i=[],refreshDeps:o=[],itemKey:a,initPageSize:l=10,ref:r,threshold:c=100}=t,d=(0,hr.A)(t,ec),{hasMoreHanlder:u,isNoMore:h,hasMoreHandler:p}=t;let{noMoreHandler:g}=t;g=g||p||u||h;const _=t.incrementSize||l,[v,f]=(0,s.useState)(!1),[b,x]=(0,s.useState)(1),A=(0,s.useRef)(0),y=(0,s.useRef)((new Date).getTime()),w={data:{list:[]},current:1,pageSize:l,offset:0,startTime:y.current},S="boolean"!=typeof d.auto||d.auto,[j,k]=(0,s.useState)(),C=Jr(e,(0,m.A)((0,m.A)({},d),{},{ready:n,auto:S,defaultParams:[w],requestKey:e=>{var t;return((null==e||null===(t=e.data)||void 0===t||null===(t=t.list)||void 0===t?void 0:t.length)||0)+y.current},onSuccess:(...e)=>{var n;null!=j&&null!==(n=j.list)&&void 0!==n&&n.length&&r&&r.current&&(r.current.scrollTop=0),k(void 0),f(!1),x((e=>e+1)),t.onSuccess&&t.onSuccess(...e)},onError:(...e)=>{f(!1),t.onError&&t.onError(...e)}})),{data:I,run:T,error:N,reset:E,loading:M,requests:P}=C,L=(0,s.useMemo)((()=>{let e=[],t=I||{};return Object.keys(P).sort(((e,t)=>Number(e)-Number(t))).forEach((n=>{var i;const s=P[n];var o;null!==(i=s.data)&&void 0!==i&&i.list&&(e=e.concat(null===(o=s.data)||void 0===o?void 0:o.list));s.loading||(t=s.data)})),(0,m.A)((0,m.A)({},t),{},{list:e})}),[P,I]),D=Boolean(!M&&!v&&(g?g(I,N,L):!(null!=I&&I.list.length)||I.total&&L.list.length>=I.total)),R=(0,s.useCallback)((()=>{const{list:e}=L;return{data:L,current:b,pageSize:1===b?l:_,offset:e.length,id:a&&e.length>0?((e,t)=>{const n="function"==typeof a?a(e,t):e[a];return void 0===n?t:n})(e[e.length-1],e.length-1):void 0,startTime:y.current}}),[b,l,_,L]),B=(0,s.useCallback)(((e=!1)=>{e&&k(L),E(),x(1),y.current=(new Date).getTime(),T(w)}),[T,E,L]),O=(0,s.useRef)(B);O.current=B,(0,Rr.A)((()=>{n&&S&&O.current()}),[...i,...o]);const U=(0,s.useCallback)(((e={})=>{if(k(void 0),D||M||v)return;f(!0);const t=R();T((0,m.A)((0,m.A)({},t),e))}),[D,M,v,T,L,R]);(0,s.useEffect)((()=>{if(null==r||!r.current)return()=>{};const e=()=>{null!=r&&r.current&&(A.current<r.current.scrollTop&&r.current.scrollHeight-r.current.scrollTop<=r.current.clientHeight+c&&U(),A.current=r.current.scrollTop)};return r.current.addEventListener("scroll",e),()=>{null!=r&&r.current&&r.current.removeEventListener("scroll",e)}}),[null==r?void 0:r.current,U]);const F=(0,s.useMemo)((()=>{var e;return null!=j&&null!==(e=j.list)&&void 0!==e&&e.length?j:L}),[j,j,L]);return(0,m.A)((0,m.A)({},C),{},{reset:O.current,current:b,data:F,reload:B,loading:M&&Boolean(null==j?void 0:j.list.length)||M&&0===L.list.length,loadMore:U,loadingMore:v,noMore:D,hasMore:D})}const nc=e=>(0,q.jsx)("svg",(0,m.A)((0,m.A)({xmlns:"http://www.w3.org/2000/svg",width:20,height:20,fill:"none",viewBox:"0 0 20 20"},e),{},{children:(0,q.jsx)("path",{fill:"#fff",d:"M3.525 16q-1.21 0-1.87-.613Q1 14.773 1 13.599V6.474q0-1.176.676-1.825.676-.65 1.85-.649h7.524q1.209 0 1.842.649.633.65.633 1.817v7.06q0 1.176-.662 1.825-.654.65-1.863.649zm11.1-3.57V7.62l2.368-2.04q.244-.21.489-.332.252-.13.496-.13.454 0 .734.295Q19 5.71 19 6.2v7.658q0 .491-.288.786-.28.296-.734.296-.244 0-.496-.13a2.7 2.7 0 0 1-.49-.339z"})})),ic="itemContent-ghjyDH",sc="avatar-YeEUHQ",oc="contentInfo-yr3z3r",ac="contentHeader-AQbluT",lc="time-deTmvM",rc="content-DnZS9L",cc="media-ic6tjL",dc="item-FJnSEf",uc="image-xXvESI",mc="video-overlay-a7FLyN",hc="icon-yc8zuK",pc=e=>Number(e)<10?`0${e}`:e,gc=e=>{if(!e)return;const t=new Date(1e3*Number(e)),n=`${t.getFullYear()}/`,i=`${t.getMonth()+1<10?`0${t.getMonth()+1}`:t.getMonth()+1}/`,s=`${t.getDate()} `,o=`${t.getHours()}`,a=`${t.getMinutes()}`,l=`${t.getSeconds()}`;return`${n+i+s+pc(o)}:${pc(a)}:${pc(l)}`},_c=({item:e,userAvatar:t,className:n,style:i,selfUserTitle:s,botUserTitle:o})=>{const{content:a,pub_date:r,type:c,image_list:u,video_cover_url:m}=e;return(0,q.jsxs)("div",{"data-testid":"feedback_history_item",className:l()(ic,n),style:i,children:[(0,q.jsx)("div",{className:sc,children:(0,q.jsx)(d.eu,{src:0===e.type?t:"https://lf-flow-web-cdn.doubao.com/obj/flow-doubao/flow-ext-doubao/cdn-media-assets/doubao_logo.5604ea40.jpeg",size:"default"})}),(0,q.jsxs)("div",{className:oc,children:[(0,q.jsxs)("div",{className:ac,children:[(0,q.jsx)("strong",{children:0===c?s:o}),(0,q.jsx)("div",{className:lc,children:gc(r)})]}),(0,q.jsx)("div",{className:rc,children:a}),(0,q.jsxs)("div",{className:cc,children:[null==u?void 0:u.map((({image_url:e},t)=>(0,q.jsx)("div",{className:dc,children:(0,q.jsx)(d._V,{className:uc,src:e,preview:!1})},t))),m&&(0,q.jsxs)("div",{className:dc,children:[(0,q.jsx)(d._V,{className:uc,src:m,preview:!1}),(0,q.jsx)("div",{children:(0,q.jsx)("div",{className:mc,children:(0,q.jsx)(nc,{className:hc})})})]})]})]})]})},vc="container-vgxrLI",fc="item-XSlLXP",bc="bottom-loading-ybUqyL",xc="show-scrollbar-nzY_Fv",Ac="empty-qHPWSq",yc="emptyHistory-Dl72KA",wc=({className:e,emptyClassName:t,style:n,showScrollBar:o=!0,userAvatar:a,onFeedbackListFetch:r,emptyListTitle:c,selfUserTitle:u,botUserTitle:m,forceLoading:h=!1})=>{const p=(0,s.useRef)(null),{data:g,loading:_,loadingMore:v,noMore:f}=tc(function(){var e=(0,i.A)((function*({current:e,pageSize:t}){var n,i,s;const o=t*(e-1)-1;if(-1!==o&&(null==g||null===(n=g.list)||void 0===n||null===(n=n[o])||void 0===n||!n.id))return{list:[],total:null==g?void 0:g.total};const a=yield r({max_id:null==g||null===(i=g.list)||void 0===i||null===(i=i[o])||void 0===i?void 0:i.id,count:t});return{list:a,total:(null!==(s=null==g?void 0:g.total)&&void 0!==s?s:0)+a.length+1}}));return function(t){return e.apply(this,arguments)}}(),{ref:p,initPageSize:20,incrementSize:20}),b=h||_;return(0,q.jsx)("div",{"data-testid":"feedback_history_panel",ref:p,className:l()(vc,e,{[Ac]:!(null!=g&&g.list.length),[xc]:o}),style:n,children:b?(0,q.jsx)(d.tK,{size:"middle"}):(0,q.jsx)(q.Fragment,{children:null!=g&&g.list&&g.list.length>0?(0,q.jsxs)(q.Fragment,{children:[g.list.map((e=>(0,q.jsx)(_c,{className:fc,userAvatar:a,item:e,selfUserTitle:u,botUserTitle:m},e.id))),!f&&v&&(0,q.jsx)("div",{className:bc,children:(0,q.jsx)(d.tK,{size:"middle"})})]}):(0,q.jsx)("div",{className:l()(yc,t),children:c})})})};var Sc=n(96770),jc=n(47686),kc=n(28159),Cc=n(85371),Ic=n(97164);const Tc=e=>{try{return JSON.stringify(e)}catch(t){return""}};class Nc extends Error{constructor(e){super(),(0,g.A)(this,"code",void 0),(0,g.A)(this,"extra",void 0),this.code=e.code,this.extra=e.extra}}const Ec=function(){var e=(0,i.A)((function*(e){const{data:t,isPost:n=!1,commonParams:i,logger:s,onPost:o,onGet:a}=e,l=(e=>{const t={};for(const n of(0,jc.A)(e)){const i=e[n];(0,kc.A)(i)||(0,At.A)(i)||(0,Ic.A)(i)||(0,Cc.A)(i)?t[n]=i:t[n]=Tc(i)||String(i)}return t})((0,m.A)((0,m.A)({},t),i)),r={"Content-Type":"application/x-www-form-urlencoded"};try{const e=n?yield o({data:l,headers:r}):yield a({params:l,headers:r});if("error"===e.message)throw new Nc({code:e.err_code,extra:e});return e}catch(c){throw null==s||s.persist.error({eventName:"feedback_request_error",error:c}),c}}));return function(t){return e.apply(this,arguments)}}(),Mc=function(){var e=(0,i.A)((function*(e){const{url:t,data:n,isPost:s=!1,logger:o,aid:a,deviceId:l,appName:r,appkey:d,baseUrl:u="",reqQueryParams:h}=e,p=e=>(0,Sc.A)(u)?u(e):u+e;return Ec({data:n,isPost:s,logger:o,commonParams:{aid:a,device_id:l,appName:r,appkey:d},onPost:(_=(0,i.A)((function*({params:e,headers:n,data:i}){const{data:s}=yield c.j.apiService.feedbackThird.request({method:"POST",url:p(t),data:i,params:(0,m.A)((0,m.A)({},e||{}),h||{}),headers:n});return s})),function(e){return _.apply(this,arguments)}),onGet:(g=(0,i.A)((function*({params:e,headers:n}){const{data:i}=yield c.j.apiService.feedbackThird.request({method:"GET",url:p(t),params:(0,m.A)((0,m.A)({},e||{}),h||{}),headers:n});return i})),function(e){return g.apply(this,arguments)})});var g,_}));return function(t){return e.apply(this,arguments)}}(),Pc=function(){var e=(0,i.A)((function*(e,t){const{channel:n}=t,i=(0,m.A)((0,m.A)({},e),{},{channel:n,extra_persistent_params:JSON.stringify({samantha_web:1})});return Mc((0,m.A)({url:"/feedback/2/post_message/",data:i,isPost:!0},t))}));return function(t,n){return e.apply(this,arguments)}}();var Lc=n(3365),Dc=n(15159);const Rc=({userId:e,appId:t,logger:n})=>{const o=(0,s.useRef)();return a=function(){var n=(0,i.A)((function*(n){var i;if(null===(i=o.current)||void 0===i||!i.client){const n=Lc.cV.FEEDBACK,i=Lc.sh.IMAGE,s=new Dc.UploaderService({type:i,scene:n,userId:e,appId:t});o.current=s}const s=o.current;return new Promise(((e,t)=>{const i=(e=>{if("path"===e.type)throw Error("Cannot get Blob from PathMediaData");return"base64"===e.type?Se(e.value):e.value})(n);s.upload(i,{complete:n=>{var i;const{Uri:s,ImageHeight:o=0,ImageWidth:a=0}=null!==(i=n.uploadResult)&&void 0!==i?i:{};s?e({image_uri:s,image_height:o,image_width:a}):t(new Error("uploaded result is empty"))},error:e=>{t(e)}})}))}));return function(e){return n.apply(this,arguments)}}(),function(){var e=(0,i.A)((function*(e){try{return yield a(e)}catch(t){throw n.error({eventName:"feedback_upload_to_imagex_error",error:t}),t}}));return function(t){return e.apply(this,arguments)}}();var a},Bc=e=>{const t=Rc(e);return function(){var e=(0,i.A)((function*(e){if("path"===e.type)throw Error("Not support to upload PathMedia");return t(e)}));return function(t){return e.apply(this,arguments)}}()},Oc="feedback-submit-panel-WP3yui",Uc="feedback-history-panel-xT_ikV",Fc="file-input-MrSr3U",qc="content-xXWMNx",Hc="textarea-EM0AFI",Vc="fileUpload-kIJu2M",Kc="submitButton-R0JdhW",zc="feedbackHistoryEmptyPanel-a6RJgZ",Gc=["userAvatar","userId","t","showFeedbackList","getFeedbackList","getUploadAuthToken","visible","onClose","showFileList","submitButtonDisabled"],$c={image:["jpeg","jpg","png","gif","bmp"],video:["mp4","quicktime","x-m4v","x-flv","x-matroska","webm","3gpp"]};var Wc=function(e){return e.SUBMIT="submit",e.HISTORY="history",e}(Wc||{});const Yc=e=>{let{userAvatar:t,userId:n,t:o,showFeedbackList:a=!0,getFeedbackList:l,getUploadAuthToken:r,visible:c,onClose:u,showFileList:h=!0,submitButtonDisabled:p}=e,g=(0,hr.A)(e,Gc);const{logger:_,aid:v}=g,[f,b]=(0,s.useState)(),x=(0,s.useRef)(null),A=(0,s.useRef)(null),[y,w]=(0,s.useState)(0),[S,j]=(0,s.useState)(Wc.SUBMIT);(0,vr.A)((()=>{var e;null===(e=A.current)||void 0===e||e.complete()})),(0,s.useEffect)((()=>{j(Wc.SUBMIT)}),[c]);const k=Bc({scene:"feedback",data_type:"image",userId:n,appId:v,logger:_,getUploadAuthToken:r}),C=function(){var e=(0,i.A)((function*(){if(!x.current)throw Error("File input element is not exist");return A.current&&(A.current.complete(),A.current=null),A.current=new pr.B,x.current.value="",x.current.click(),yield(0,gr._)(A.current)}));return function(){return e.apply(this,arguments)}}(),I=function(){var e=(0,i.A)((function*({allowedMediaType:e}){if(!e.length)return!1;b(e),yield(0,fr.BK)(200);try{const e=yield C();if(1!==e.length)return!1;const n=e[0],i=je(n.type)?yield((e,t=0)=>new Promise((n=>{const i=document.createElement("video");i.setAttribute("src",URL.createObjectURL(e)),i.load(),i.addEventListener("error",(e=>{n(null)})),i.addEventListener("loadedmetadata",(()=>{i.duration<t?n(null):(setTimeout((()=>{i.currentTime=t}),200),i.addEventListener("seeked",(()=>{const e=document.createElement("canvas");e.width=i.videoWidth,e.height=i.videoHeight;const t=e.getContext("2d");t?(t.drawImage(i,0,0,e.width,e.height),t.canvas.toBlob((e=>{n(e)}),"image/jpeg",.75)):n(null)})))}))})))(n):n,s=i&&(yield(t=i,new Promise(((e,n)=>{const i=new FileReader;i.readAsDataURL(t),i.onload=function(){var t,n;e(null!==(t=null===(n=i.result)||void 0===n?void 0:n.toString())&&void 0!==t?t:"")},i.onerror=function(e){n(e)}}))));return{base64PreviewImage:null!=s?s:"",mediaData:{type:"file",value:n,mimeType:n.type,mediaType:je(n.type)?"video":"image"},size:n.size}}catch(n){if(n instanceof _r.G)return!1;throw n}var t}));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=(0,i.A)((function*(e){try{const{feedback_id:t}=yield Pc(e,g);_.persist.success({eventName:"feedback_submit_success",meta:{feedback_id:t}}),d.y8.success({content:o("feedback_submit_success"),showClose:!1}),u({type:"success"}),w(y+1)}catch(t){throw d.y8.error({content:o("feedback_submit_failed"),showClose:!1}),_.persist.error({eventName:"feedback_submit_error",error:t}),t}}));return function(t){return e.apply(this,arguments)}}();return(0,q.jsxs)("div",{children:[(0,q.jsxs)(oo,{activeKey:S,onChange:e=>j(e),children:[(0,q.jsx)(so,{itemTitle:o("submit_feedback"),itemKey:Wc.SUBMIT,children:(0,q.jsx)(Vr,{className:Oc,contentClassName:qc,textAreaClassName:Hc,fileUploadClassName:Vc,submitButtonClassName:Kc,theme:"grey",onChooseMedia:I,onUploadMedia:k,onSubmit:T,submitButtonDisabled:p,textAreaPlaceholderTitle:o("feedback_placeholder"),submitButtonTitle:o("feedback_submit_button"),oversizeToastTitle:o("feedback_file_large_error"),notAllAssetsFinishedTitle:o("feedback_file_uploading_error"),allowedMediaType:(()=>{if(!h)return[];return["image"]})(),renderTextArea:e=>(0,q.jsx)(Kr.p,(0,m.A)({theme:"default"},e))})}),a&&(0,q.jsx)(so,{itemTitle:o("feedback_history"),itemKey:Wc.HISTORY,children:(0,q.jsx)(wc,{className:Uc,emptyClassName:zc,emptyListTitle:o("no_feedback_history"),selfUserTitle:o("feedback_history_user"),botUserTitle:o("feedback_platform_cn"),onFeedbackListFetch:function(){var e=(0,i.A)((function*(e){const{appkey:t}=g,{data:n=[]}=yield l((0,m.A)((0,m.A)({},e),{},{appkey:t}));return n}));return function(t){return e.apply(this,arguments)}}(),userAvatar:t||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABDgAAAQ4AgMAAACRfoQcAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAMUExUReHw/5muzMfY7a/C3GnhjlIAAAa3SURBVHja7MEBAQAAAICQ/q/uCAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgNm1d6MEoigMwBcYA3QMLcHI2JwSDDhowDiUQGKqNGEPNmAsTdCLoczuwJ4rj8DM2e8r4Z+953HvAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8E5dfL/H2UWjcReO1sHUVIY+94SZ2vguf0VmVvhtH8lz6bhPZovTbdVRmxceRrVWObF767D4amktjGAeWCqli2nqPcFryWTn04Kw4LWXrJsJp6cSOQb2bwUxirYsIxeNIm7W3tKVD8egMIhSPqnQoHnnqOMXNT2ViYen72jKOUEurSqqWVveCaumvmdRcmmdSc+nOKEJrqRqL1lI1Fq2lcxuhtRzZWNyX7jcWW8tOhE5b9VmdtjOIs548wGVTY0c2M3ZUjB2VlfU+W5vCsokpLFu4Rs+WhtLswVCazd2FZXMzejY1o2czM3r2KI6KF8mKDa6yssFla3GIw0rb7PfiqOOw4SchDnGcuf1x/yOO03G4DvN1nDDydYhDHOL4axx+ePF1iEMc4hCHOKxwVjhxiMNdqTi8s3iF82QtDr+7iKO18m/YD3v3j9NGHERx3GsrhYNccgSqKKXvkYLBFFFCmZKSkku4p4xASpcyEpdwT0mVDimiIeBI3pnFSwJKxX6+Rxjtvnlvfv8ydg5mFrbZKoddx/akO7HwFxqrTk47OQvnpKRztE5Z/1/mIktmj0d3f0cvUx7d3T+9jJlS94b1s+TC3DnYyx7bkZnps26z7WWsz7oJ2z3pbtF/CTONJdMIcJmxMXphKbFk5pQ0M6OkmYaSejWwn13DDi+O9tKQjsKK68jMuY7M1CQsMxZYCrvabGbqXymwpIU9C06ZCQ9WWBLSzJSQFpY+jswO5egLLovBfxz3Tr3NtVcjtPX4MsI9b2/igV8jrBlf3N3dno0AAAAAAAAAAAAAAAAAAACGx/j828/zryM8cHETaxa3tqSP3q2iZegFGf+IwuezQVfjJjosrp1VKFyrhno8/lMGfsrnexQGfgbsvTv0EzvxBCdktHA19LsIuvLhV8mcuI2ycOn2xcwnOlo4YjkyBz6OwrGPI7PwcRSOfRyZA+8nFo54jsw+Q1q4lFYyHwf/tmbldOjPFFeOCWnmgJAOSEwn8UwOhzITFFySI+VM2+s4WY9kOp7J677p2d+S/xV/ywv6Sl2B0leG8CJHE2s4sc6/IreUvCK3pGz/bD7I9pl9lrRwypJmjrTZzOFrfRRPq03vOBGPligMfaDeRBCPHukwMd2NIB5VOjiPJB3E41FgEVu2BBbz9DTrMCH8M+tgxLYqqeWFN7FGiksmjBFLSkpLs5LS0o6S8qVJSWlpx5PypVuV1FpcrJHxt2yftDQ5jXvY9NRYtJbSWLSW0li0lpYIraU0Fq2lJBatZUtjMU3v7Bi0MrkZhRmIbfqsTtsSodOWyaBO+6jPmg9uVqt12o7tkGlLnpVpk+1gPIrtYDxaIhiPLbbDwuQDkwjGo6VRjo4L48OKC+PDOsMfA6BkStnSYkr5sJalcmQi2FLleMqjGw8mj86WtjTKsWXnj2XaTWQRWkpkEVpKZBFaSjmElpa5cjxKcJYWUoKT4ZSjh1UkHAFbhUibCOXo5nvrcMrRVw7zn5aJcnTKYf7T0iiHcjw1GzQdVI7+chiWKkcPM+VQDuX453JYaPnN3t3jJBBFYQC9mYRG1+IeXAIFj7GAhCXQkFjJWwo1FlZWxsRNGFpKQ2/raCPeFmjMyzmZFXwJYX7evd+fkTjEIQ5xiEMc4hCHOMThJv1/GXmE80QrDi8HvUkXh69w4nCgwekfcTg56JitQ9gmFkqpxnsy005Zb1Iym5ijzWaGzrOxlQTZ0jqT7Naym6zaDJX01qhlEzsHs7EFndnCNtusWv2cTBVdZTOlAtlC01VW1cIlE2202VIvXNJXJYrJnQLW7C10bDZahP/sXza7Lhe6j6bclItMa0T4ufzaRGO6z3K+fYQ8jj6iQd1rOUu/jzY9vpfTPdRoVfd0aiDrTbSs2w4nZHHYRPuuti/DsNqVo9Vu/nOVo918PXwdtgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfLcHByQAAAAAgv6/bkegAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwEs3G65hPtBG4AAAAASUVORK5CYII="})})]}),(0,q.jsx)("input",{className:Fc,multiple:!1,type:"file",ref:x,accept:f&&(N=f,null==N?void 0:N.map((e=>{var t,n;return null!==(t=null===(n=$c[e])||void 0===n?void 0:n.map((t=>`${e}/${t.toLowerCase()}`)))&&void 0!==t?t:[`${e}/*`]})).flat()).join(", "),onChange:e=>{var t,n;const i=[...null!==(t=e.target.files)&&void 0!==t?t:[]];null===(n=A.current)||void 0===n||n.next(i)}})]},y);var N};var Qc=n(56101),Zc=n(10429),Xc=n(92830),Jc=n(24521),ed=n(29439),td=n(5779),nd=n(66190);const id="content-XCbOeX",sd="expanded-qcHVls",od="operation-btns-kU0ebQ",ad=({payload:e,defaultJSON:t=!1})=>{const[n,i]=(0,s.useState)(t),o=(0,s.useMemo)((()=>"string"==typeof e?e:JSON.stringify(e,null,2)),[e]);return(0,q.jsxs)("div",{className:l()(id,{[sd]:n}),children:[n?(0,q.jsx)("pre",{children:o}):(0,q.jsx)("span",{children:o}),(0,q.jsxs)("div",{className:od,children:[(0,q.jsx)(ed.A,{onClick:()=>{ve()(o),d.y8.success({content:"Copied !",showClose:!1,duration:3})}}),n?(0,q.jsx)(td.A,{onClick:()=>i(!n)}):(0,q.jsx)(nd.A,{onClick:()=>i(!n)})]})]})};var ld=n(86322),rd=n(36245);const cd={container:"container-wtUg6M","operation-area":"operation-area-EGmSg2",operationArea:"operation-area-EGmSg2","log-meta-info":"log-meta-info-m2qwfK",logMetaInfo:"log-meta-info-m2qwfK","log-meta-head":"log-meta-head-_CR0zT",logMetaHead:"log-meta-head-_CR0zT","mark-icon":"mark-icon-EDGqbs",markIcon:"mark-icon-EDGqbs","log-id":"log-id-dyyoaJ",logId:"log-id-dyyoaJ","list-item":"list-item-ffXrw7",listItem:"list-item-ffXrw7",type:"type-KwwuV8",action:"action-M0LMD2",from:"from-gVdMwK",api:"api-xbaS5S","slardar-event-name":"slardar-event-name-R6Bsy4",slardarEventName:"slardar-event-name-R6Bsy4"},dd=new ld.qK(1e3),ud=[{label:"HTTP",value:"http-request"},{label:"Stream",value:"fetch-stream"},{label:"Slardar",value:"slardar"},{label:"WebSocket",value:"websocket"}],md=["fetch-stream","websocket"],hd=e=>{var t,n,i,s;const{_meta:o,time:a,payload:l}=e,r=null==o?void 0:o.filter((e=>"update"===e.action)),c=null==o?void 0:o.filter((e=>"open"===e.action)),u=null==o?void 0:o.filter((e=>"finish"===e.action)),m=null==o?void 0:o.filter((e=>"close"===e.action)),h=(e,t,n=t)=>e.length?(0,q.jsx)(d.mF,{tab:`${t}(${e.length})`,itemKey:n,children:(0,q.jsx)(d.B8,{bordered:!0,dataSource:e,renderItem:e=>(0,q.jsx)(d.B8.Item,{className:cd["list-item"],children:(0,q.jsx)(ad,{payload:e.payload})})})}):null,p=null===(t=c[0])||void 0===t||null===(t=t.payload)||void 0===t?void 0:t.logId,g=`${(null==l||null===(n=l.port)||void 0===n||null===(n=n.sender)||void 0===n||null===(n=n.tab)||void 0===n?void 0:n.title)||(null==l||null===(i=l.port)||void 0===i||null===(i=i.sender)||void 0===i?void 0:i.url)} - ${null==l||null===(s=l.body)||void 0===s||null===(s=s.payload)||void 0===s||null===(s=s.req)||void 0===s?void 0:s.url}`;return(0,q.jsxs)("div",{style:{width:"100%"},children:[(0,q.jsxs)("div",{className:cd["log-meta-info"],children:[(0,q.jsxs)("span",{style:{color:"#f75487"},className:cd["log-meta-head"],children:[(0,q.jsx)(Qc.A,{className:cd["mark-icon"]}),(0,q.jsx)("span",{className:cd.time,children:a})]}),(0,q.jsx)("span",{className:cd.type,children:"fetch-stream"}),(0,q.jsx)("span",{className:cd.from,children:g})]}),p?(0,q.jsxs)("div",{className:cd["log-id"],children:[(0,q.jsx)("span",{children:"LogId:"}),p]}):null,(0,q.jsxs)(d.tU,{defaultActiveKey:"open",children:[h([{payload:l}],"start"),h(c,"open"),h(r,"update"),h(u,"finish"),h(m,"close")]})]})},pd=e=>{const{time:t,action:n,type:i,payload:s}=e;return(0,q.jsxs)("div",{style:{width:"100%"},children:[(0,q.jsxs)("div",{className:cd["log-meta-info"],children:[(0,q.jsxs)("span",{style:{color:"#1fa41f"},className:cd["log-meta-head"],children:[(0,q.jsx)(Zc.A,{className:cd["mark-icon"]}),(0,q.jsx)("span",{className:cd.time,children:t})]}),(0,q.jsx)("span",{className:cd.type,children:i}),(0,q.jsx)("span",{className:cd.action,style:{backgroundColor:"send"===n?"#efcaef":"#c5e497"},children:n})]}),(0,q.jsx)(ad,{payload:s})]})},gd=e=>{const{time:t,action:n,type:i,payload:s}=e;return(0,q.jsxs)("div",{style:{width:"100%"},children:[(0,q.jsxs)("div",{className:cd["log-meta-info"],children:[(0,q.jsxs)("span",{style:{color:"#62a0c7"},className:cd["log-meta-head"],children:[(0,q.jsx)(Xc.A,{className:cd["mark-icon"]}),(0,q.jsx)("span",{className:cd.time,children:t})]}),(0,q.jsx)("span",{className:cd.type,children:i}),(0,q.jsx)("span",{className:cd.action,children:n}),(0,q.jsx)("span",{className:cd["slardar-event-name"],children:null==s?void 0:s.name})]}),(0,q.jsx)(ad,{payload:s})]})},_d=e=>{var t;const{time:n,type:i,payload:s}=e,o=null==s?void 0:s.logId;return(0,q.jsxs)("div",{style:{width:"100%"},children:[(0,q.jsxs)("div",{className:cd["log-meta-info"],children:[(0,q.jsxs)("span",{style:{color:"#c78962"},className:cd["log-meta-head"],children:[(0,q.jsx)(Jc.A,{className:cd["mark-icon"]}),(0,q.jsx)("span",{className:cd.time,children:n})]}),(0,q.jsx)("span",{className:cd.type,children:i}),(0,q.jsx)("span",{className:cd.api,children:null==s||null===(t=s.config)||void 0===t?void 0:t.url})]}),o?(0,q.jsxs)("div",{className:cd["log-id"],children:[(0,q.jsx)("span",{children:"LogId:"}),o]}):null,(0,q.jsx)(ad,{payload:s})]})},vd=()=>{const[e,t]=(0,s.useState)(dd.values().length),[n,i]=(0,s.useState)(md);(0,s.useEffect)((()=>{(0,rd.c)("log-event-debug").onMessage.addListener((e=>{const{type:n,action:i,payload:s}=e,o=`${Date.now().toString()}_${Math.random().toString(16).slice(2,4)}`;dd.set(o,{time:(new Date).toLocaleString(),type:n,action:i,payload:s}),t(dd.values().length)}))}),[]);const o=(0,s.useMemo)((()=>{const e=dd.values().filter((e=>n.includes(e.type))),t=[];for(const n of e)if("fetch-stream"!==n.type)t.push(n);else{var i,s;const e="start"===n.action?null===(i=n.payload)||void 0===i?void 0:i.body.id:null===(s=n.payload)||void 0===s?void 0:s.id,o=t.find((t=>"fetch-stream"===t.type&&t._sid===e));o?o._meta.push(n):t.push((0,m.A)((0,m.A)({},n),{},{_sid:e,_meta:[n]}))}return t}),[e,n]),a=e=>{switch(e.type){case"fetch-stream":return(0,q.jsx)(hd,(0,m.A)({},e));case"websocket":return(0,q.jsx)(pd,(0,m.A)({},e));case"slardar":return(0,q.jsx)(gd,(0,m.A)({},e));case"http-request":return(0,q.jsx)(_d,(0,m.A)({},e));default:return null}};return(0,q.jsxs)("div",{className:cd.container,children:[(0,q.jsxs)("div",{className:cd["operation-area"],children:[(0,q.jsx)(d.$n,{type:"danger",onClick:()=>{dd.clear(),t(0)},children:"\u6e05\u7a7a Cache"}),"  ",(0,q.jsxs)("span",{children:["\u5171\u8ba1 ",dd.values().length," \u6761"]}),(0,q.jsx)("div",{children:(0,q.jsx)(d.$Q,{style:{margin:"8px 0"},onChange:e=>{i(e)},options:ud,defaultValue:n,direction:"horizontal","aria-label":"\u65e5\u5fd7\u8fc7\u6ee4\u9879"})})]}),(0,q.jsx)(d.B8,{bordered:!0,dataSource:o,renderItem:e=>(0,q.jsx)(d.B8.Item,{className:cd["list-item"],children:a(e)})})]})},fd="list-item-X7bNtL",bd="from-IkTajm",xd="actions-gqTZbp",Ad="action-list-doPZRw",yd=({tKey:e,tValue:t,onClose:n,visible:i})=>{const[o,a]=(0,s.useState)(JSON.stringify(t,null,2));return(0,q.jsx)(d.aF,{centered:!0,onOk:()=>{I.A.setItem(e,(0,St.O)(o)),n()},onCancel:n,visible:i,width:480,title:`Edit Storage of ${e}`,children:(0,q.jsx)("textarea",{rows:16,defaultValue:o,value:o,onChange:e=>a(e.target.value),style:{display:"block",width:"100%",maxHeight:600,resize:"none",outline:"none",border:"1px solid #333"}})})},wd=()=>{const[e,t]=(0,s.useState)({}),[n,o]=(0,s.useState)([]),[a,l]=(0,s.useState)({modalVisible:!1,targetKey:"",targetValue:""});(0,s.useEffect)((()=>{(0,i.A)((function*(){try{const e=yield I.A.getAll(),n=Object.keys(e),i=n.reduce(((t,n)=>(0,m.A)({[n]:(0,St.O)(e[n],"{}")},t)),{});t(i),I.A.watch(n.reduce(((e,n)=>(0,m.A)({[n]:e=>{t((t=>{let i=(0,m.A)({},t);return void 0===e.newValue?delete i[n]:i=(0,m.A)((0,m.A)({},i),{},{[n]:e.newValue}),i}))}},e)),{}))}catch(e){}}))()}),[]);const r=function(){var e=(0,i.A)((function*(){I.A.clear();const e=yield I.A.getAll();t(e)}));return function(){return e.apply(this,arguments)}}(),c=(0,s.useMemo)((()=>n.length?n:Object.keys(e).sort()),[n,e]);return(0,q.jsxs)("div",{children:[(0,q.jsxs)("div",{className:Ad,children:[(0,q.jsx)(d.$n,{type:"danger",onClick:r,children:"\u6e05\u7a7a Storage"}),(0,q.jsx)(d.l6,{filter:!0,showClear:!0,style:{width:360},placeholder:"\u641c\u7d22 storage",dropdownMatchSelectWidth:!0,onChange:e=>o(e?[e]:[]),children:Object.keys(e).sort().map((e=>(0,q.jsx)(d.l6.Option,{value:e,children:e},e)))})]}),(0,q.jsx)(d.B8,{bordered:!0,dataSource:c,renderItem:t=>(0,q.jsxs)(d.B8.Item,{className:fd,children:[(0,q.jsx)("span",{className:bd,children:t}),(0,q.jsxs)("span",{className:xd,children:[(0,q.jsx)(O.bz,{onClick:()=>ve()(JSON.stringify(e[t]))}),(0,q.jsx)(O.PW,{onClick:()=>l({modalVisible:!0,targetKey:t,targetValue:e[t]})}),(0,q.jsx)(O.xV,{onClick:()=>(e=>{I.A.remove(e)})(t)})]}),(0,q.jsx)(ad,{payload:e[t]})]})}),a.targetKey&&(0,q.jsx)(yd,{visible:a.modalVisible,tKey:a.targetKey,tValue:a.targetValue,onClose:()=>{l((e=>(0,m.A)((0,m.A)({},e),{},{modalVisible:!1})))}},a.targetKey)]})},Sd=({enabled:e,onClose:t})=>{const[n,i]=(0,s.useState)(e),o=(0,y.Y)("authInfo")[0];return(0,q.jsxs)(d.aF,{visible:n,onCancel:()=>{i(!1),null==t||t()},title:"Debug Panel",width:"75vw",closeOnEsc:!1,maskClosable:!1,children:[(0,q.jsxs)("div",{style:{fontSize:12},children:[(0,q.jsx)("b",{children:"UserId:"})," ",null==o?void 0:o.userId,", ",(0,q.jsx)("b",{children:"ExtVersion:"})," ",(0,Ki.HF)()]}),(0,q.jsxs)(d.tU,{type:"line",contentStyle:{maxHeight:"calc(100vh - 320px)",overflowY:"auto"},children:[(0,q.jsx)(d.mF,{tab:"SW-LOG",itemKey:"sw-log",children:(0,q.jsx)(vd,{})}),(0,q.jsx)(d.mF,{tab:"STORAGE",itemKey:"storage",children:(0,q.jsx)(wd,{})})]})]})},jd="container-LKVCqi";c.j.register("feedbackThird",mr);const kd=()=>{var e;const t=(0,r.B)(),[n]=(0,y.Y)("authInfo"),[i,o]=(0,s.useState)(!1),[a,l]=(0,s.useState)(0);return(0,q.jsxs)("div",{className:jd,children:[(0,q.jsx)("h2",{className:di,onClick:e=>e.shiftKey&&l((e=>e+1)),children:t("flow_web_ext_setting_contact_us")}),(0,q.jsx)(Yc,{userAvatar:null==n?void 0:n.avatarUrl,userId:null!==(e=null==n?void 0:n.userId)&&void 0!==e?e:"",t,logger:b.c6,aid:Number(Oe.sZ),appName:"cici-browser-plugin",appkey:"cici-browser-plugin-web",deviceId:(0,Gi.IP)(),getFeedbackList:(...e)=>c.j.apiService.setting.GetFeedbackList(...e),getUploadAuthToken:(...e)=>c.j.apiService.resource.GetUploadAuthToken(...e),visible:i,onClose:()=>{o(!1)},channel:"extension",baseUrl:Oe.C1,reqQueryParams:{version_code:(0,Ki.HF)()}}),a>=7?(0,q.jsx)(Sd,{enabled:!0,onClose:()=>l(0)}):null]})};var Cd=n(42444),Id=n(82506);const Td=e=>null==e?void 0:e["x-tt-logid"],Nd=e=>{const{responseBody:t={},responseHeaders:n,responseStatusCode:i,responseStatusText:s,requestConfig:o}=e,{code:a,msg:l}=t,r=Td(n);if(401===i)throw Id.g.emit(Id.P.UNAUTHORIZED),new Cd.h({message:l,code:String(a),httpStatus:s||String(i),logId:r,response:t,requestConfig:o});if(200!==i)throw new Cd.h({message:l,code:String(a),httpStatus:s||String(i),logId:r,response:t,requestConfig:o});if(200===i&&0!==a){switch(a){case Ni.t.NOACCESS:Id.g.emit(Id.P.NOACCESS,l,r);break;case Ni.t.SHARK_BLOCKED:Id.g.emit(Id.P.SHARK_BLOCK,l,r);break;case Ni.t.COUNTRY_RESTRICTED:Id.g.emit(Id.P.COUNTRY_RESTRICTED,l,r);break;case Ni.t.NOT_LOGIN:case Ni.t.NO_INNER_SSO_TOKEN:case Ni.t.OPEN_AUTH_INVALID:Id.g.emit(Id.P.UNAUTHORIZED,l,r);break;case Ni.t.NEED_TO_WAIT:Id.g.emit(Id.P.NEED_TO_WAIT,l,r);break;case Ni.t.USER_BANNED:Id.g.emit(Id.P.USER_BANNED,l,r);break;case Ni.t.USER_BAN_RELEASED:case Ni.t.USER_BAN_APPEALING:case Ni.t.USER_BAN_APPEAL_FAILED:Id.g.emit(Id.P.USER_BANNED_OTHER,l,r)}throw new Cd.h({message:l,code:String(a),httpStatus:s||String(i),logId:r,response:t,requestConfig:o})}if(200===i)return(0,m.A)((0,m.A)({},t),{},{_meta:{logId:r}})};var Ed=n(35803),Md=n(52805);let Pd;const Ld=()=>Pd||(Pd=Ed.A.create({timeout:1e4}),Pd.interceptors.response.use(function(){var e=(0,i.A)((function*(e){const{data:t={},headers:n,statusText:i,status:s,config:o}=e,{ignoreResponseInterceptors:a,responseInterceptors:l}=o||{};return a?e:"function"==typeof(null==l?void 0:l[0])?yield l[0](e):Nd({responseBody:t,responseHeaders:n,responseStatusText:i,responseStatusCode:s,requestConfig:{url:o.url}})}));return function(t){return e.apply(this,arguments)}}(),function(){var e=(0,i.A)((function*(e){if((0,Md.F0)(e)){const{response:i,config:s}=e,{ignoreResponseInterceptors:o,responseInterceptors:a}=s||{};if(o)return Promise.reject(e);if("function"==typeof(null==a?void 0:a[1]))return yield a[1](e);if(i){var t,n;const{data:s={},headers:o,statusText:a,status:l}=i;if(((e,t)=>{var n;const{headers:i,data:s}=null!==(n=e.response)&&void 0!==n?n:{},o=Td(i);return 401===t&&(Id.g.emit(Id.P.UNAUTHORIZED,null==s?void 0:s.msg,o),!0)})(e,null==e||null===(t=e.response)||void 0===t?void 0:t.status))return;Nd({responseBody:s,responseHeaders:o,responseStatusText:a,responseStatusCode:l,requestConfig:{url:null==e||null===(n=e.config)||void 0===n?void 0:n.url}})}}throw e}));return function(t){return e.apply(this,arguments)}}()),Pd),Dd=(e,t)=>Ld().request((0,m.A)((0,m.A)({},e),{},{params:(0,m.A)((0,m.A)({},e.params),(null==t?void 0:t.overrideParams)||{})},(null==t?void 0:t.overrideConfig)||{}));var Rd=n(9012),Bd=n(20997),Od=n(27925);const Ud=Od.A;const Fd={autoWrap:!0,ignoreUrls:[/\.(js|css|html)$/gm,/builder-runtime\.hot-update\.json$/gm,/firebaseinstallations\.googleapis\.com/gm,/(.*)\.zijieapi\.com\/list/gm,/(.*)\.byteoversea\.com/gm],collectBodyOnError:!0,extraExtractor:(e,t)=>{const n=function(e){return(0,kc.A)(e)?e.startsWith("{")?(0,St.O)(e,{}):{}:(0,Bd.A)(e)&&e?e:{code:"INVALID_JSON"}}(e),i=t?(0,Rd.A)(t,"response.status"):void 0;return((e,t)=>200===t&&(0,Bd.A)(e)&&"code"in e&&0!==e.code)(n,i)?{code:`${n.code}`}:!!((e,t)=>200===t&&(0,Bd.A)(e)&&"message"in e&&"success"!==e.message&&"data"in e&&(0,Bd.A)(e.data)&&"error_code"in e.data&&(0,At.A)(e.data.error_code))(n,i)&&{error_code:`${n.data.error_code}`,description:"description"in n.data&&(0,kc.A)(n.data.description)?n.data.description:""}}},qd=()=>({bid:"flow_web_ext",env:"public",release:(0,Ki.HF)(),pid:location.pathname,domain:"cn"===(0,Fi.J)()?"mon.zijieapi.com":"mon-va.byteoversea.com",plugins:{ajax:Fd,fetch:Fd,jsError:{ignoreErrors:[]},pageview:{extractPid:()=>location.pathname}}});function Hd(e){Ud("context.merge",e)}function Vd(e,t){Hd(t),function(e){Ud&&Ud("init",(0,m.A)((0,m.A)({},qd()),e))}(e),Ud("start")}var Kd=n(75022),zd=n(93888),Gd=(n(10129),n(74232));n(12365);new class{constructor(){(0,g.A)(this,"_recoder",void 0),(0,g.A)(this,"_recoderName",""),(0,g.A)(this,"start",((e,t="cici_im_fetch_stream_action_perf")=>{const n=Gd.Qz.get("cici_summary_page_action_perf");n?(this._recoderName="cici_summary_page_action_perf",this._recoder=n,this._recoder.mark(e)):(this._recoder=Gd.Qz.create(t,!0),this._recoderName=t,this._recoder.mark(e)),(0,Ti.Rm)(`[ts] ImCorePerfRecoder start ${this._recoderName}[${e}]`)})),(0,g.A)(this,"mark",((e,t="cici_im_fetch_stream_action_perf")=>{this._recoder?((0,Ti.Rm)(`[ts] ImCorePerfRecoder mark ${this._recoderName}[${e}]`),this._recoder.mark(e)):this.start(e,t)})),(0,g.A)(this,"end",((e,t={})=>{this._recoder&&((0,Ti.Rm)(`[ts] ImCorePerfRecoder end ${this._recoderName}[${e}], categories: `,t),this._recoder.end(e,t),Gd.Qz.remove(this._recoderName),this._recoderName="",this._recoder=void 0)}))}},(()=>{const e=(0,rd.c)("im-sdk-socket")})();Oo.A,Oo.A;const $d=`https://${Oe.FI}`;const Wd=()=>{const e=(0,qt.Uk)(),[t,n]=(0,s.useState)("general-section"),i=el("podcast_assistant"),o=[{itemKey:"general-section",caption:e("flow_web_ext_setting_general"),component:(0,q.jsx)(ur,{})},{itemKey:"sidebar",caption:e("flow_web_ext_setting_sidebar"),component:(0,q.jsx)(Fl,{})},{itemKey:"toolbar-configuration",caption:e("flow_web_ext_setting_toolbarconfig"),component:(0,q.jsx)(Ro,{})},{itemKey:"translate",caption:e("flow_web_ext_setting_translation"),component:(0,q.jsx)(Bl,{})},{itemKey:"search-engin-summary",caption:e("flow_web_ext_setting_search_summary"),component:(0,q.jsx)(Hl,{})},{itemKey:"writing",caption:e("flow_web_ext_setting_writing"),component:(0,q.jsx)(tl,{}),disable:!1},{itemKey:"video-summary",caption:e("flow_web_ext_setting_video"),component:(0,q.jsx)(ml,{})},{itemKey:"podcast-summary",caption:e("flow_web_ext_setting_podcast"),component:(0,q.jsx)(Gl,{}),disable:!i.enable},{itemKey:"collection",caption:e("flow_web_ext_action_bookmarks"),component:(0,q.jsx)(Wl,{})},{itemKey:"recommend-feed",caption:e("flow_web_ext_setting_recommend"),component:(0,q.jsx)(Kl,{}),disable:!(0,Vn.I$)()},{itemKey:"shortcuts",caption:e("flow_web_ext_setting_shortcut"),component:(0,q.jsx)($a,{})},{itemKey:"contact-section",caption:e("flow_web_ext_setting_contact_us"),component:(0,q.jsx)(kd,{})}],a=(0,s.useMemo)((()=>o.filter((e=>!0!==e.disable)).find((e=>e.itemKey===t))||o[0]),[t]);return(0,Kd.A)(document,"body"),(0,s.useEffect)((()=>{var e;Vd({}),Ud("sendPageview",null!=e?e:location.pathname);const t=new URLSearchParams(window.location.search);(({enter_method:e})=>{(0,ce.z8)(de.Ur.enterPage,{enter_method:e})})({enter_method:t.get("enter_method")||de.cz.other});const i=t.get("settting_key");i&&n(i);const s=t.get("anchor");s&&(0,Ht.V6)(`.${s}`).then((e=>{null==e||e.scrollIntoView()}))}),[]),(0,q.jsx)(r.C,{t:e,children:(0,q.jsx)("div",{className:l()(ei,"cici-ext-always-light","semi-always-light"),children:(0,q.jsxs)("div",{className:ti,children:[(0,q.jsx)("div",{className:ni,"data-testid":"option-menu-container",children:(0,q.jsxs)("div",{className:ii,children:[(0,q.jsxs)("div",{className:si,children:[(0,q.jsx)("img",{className:oi,src:(0,Ki.Nf)(),alt:"logo"}),(0,q.jsx)("span",{className:ai,children:(0,Ki.L2)()})]}),(0,q.jsx)(d.so,{className:li,selectedKeys:[t],onClick:({itemKey:e=""})=>{n(e)},items:o.filter((e=>!0!==e.disable)).map((e=>({itemKey:e.itemKey,text:e.caption,className:`option-${e.itemKey}`})))})]})}),(0,q.jsx)("div",{className:ri,children:(0,q.jsx)("div",{"data-testid":`option-${a.itemKey}`,className:ci,children:a.component},a.itemKey)})]})})})},Yd=()=>{var e;const t=(0,A.TK)("authInfo");var n;Hd({real_user_id:t.userId,real_device_id:null!==(e=(0,Gi.IP)())&&void 0!==e?e:void 0,country:(0,A.ue)().country,version:(0,Ki.HF)()}),t.userId&&(n={userId:t.userId,deviceId:(0,Gi.IP)(),release:(0,Ki.HF)(),pid:location.pathname},Ud("config",n))};(0,i.A)((function*(){c.j.init({isDebugging:!1,baseURL:Oe.C1,httpClient:Dd,getCommonParams:Gi.wH,getCommonHeaders:Gi.Ql}),yield(0,A.lv)(),yield yo.Ay.initTea(),yield(0,qt.LE)(),c.j.init({isDebugging:!1,httpClient:Wi,getCommonHeaders:Gi.Ql,getCommonParams:Gi.wH,baseURL:$d}),yield(0,zd.f)(),yield rs(),Yd(),(0,jn.c)({name:"update-auth-info",body:{reason:"options: start load"}}),o.createRoot(document.getElementById("root")).render((0,q.jsx)(Wd,{}))}))()},52833:(e,t,n)=>{n.d(t,{e6:()=>m,nx:()=>_,on:()=>p});var i=n(14065),s=n(44557),o=n(34870),a=n(45498),l=n(75943),r=n(77591),c=n(15965),d=n(2573),u=n(44969);let m=function(e){return e.default="default",e.aritical="artical",e.videoTranscript="videoTranscript",e.audioTranscript="audioTranscript",e}({});const h={summaryActionVisible:![u.EP,u.JE,u.j0].some((e=>window.location.href.includes(e))),floatingCardVisible:!0,chatPageReady:!1,subPageIframeWindow:void 0,chatPageInfo:{conversation_id:""},tabInfo:{tabId:void 0,convId:void 0},collectedPage:new Set,webContext:{type:m.aritical,content:""}},p=(0,a.vt)()((0,o.eh)(((e,t)=>(0,s.A)((0,s.A)({},h),{},{setSummaryActionVisible:t=>e({summaryActionVisible:t}),setChatPageReady:t=>e({chatPageReady:!0,chatPageInfo:t||h.chatPageInfo}),setIframeWindowTarget:t=>e({subPageIframeWindow:t}),setFloatingCardVisible:t=>e({floatingCardVisible:t}),addCollectedPageUrl:n=>{const i=t().collectedPage||new Set;i.add(n),e({collectedPage:i})},setTabInfo:t=>{var n;return e({tabInfo:(0,s.A)((0,s.A)({},t),{},{convId:t.tabId?null===(n=(0,r.TK)("tabConversationMap"))||void 0===n||null===(n=n[t.tabId])||void 0===n?void 0:n.conversationId:void 0})})},updateWebContext:t=>{e((()=>({webContext:t})))}})))),g=()=>{p.getState().setFloatingCardVisible(!0),p.getState().setSummaryActionVisible(!0),p.getState().updateWebContext({type:m.default,content:""})};function _(e){return v.apply(this,arguments)}function v(){return(v=(0,i.A)((function*(e){const t=yield(0,c.B9)(e);if(!t)return{href:location.href,title:"",textContent:"",contentType:m.default};const n=p.getState().webContext;return n.content?{href:location.href,title:t.title,textContent:n.content,contentType:n.type}:(0,s.A)((0,s.A)({href:location.href},t),{},{contentType:m.aritical})}))).apply(this,arguments)}d.A.on("router-change",g),l.m.getInstance().registerStore("useGlobalStore",p),(0,l.A)((()=>d.A.off("router-change",g)))},36700:(e,t,n)=>{n.d(t,{F3:()=>m,ae:()=>c,mL:()=>u,o2:()=>d,p6:()=>a,vP:()=>o});var i=n(12038),s=n(56397);let o=function(e){return e.arxiv_view_pdf="arxiv_view_pdf",e.chrome_pdf_viewer="chrome_pdf_viewer",e.side_bar_popover="side_bar_popover",e.search_result_card="search_result_card",e.video_page_summarize="video_page_summarize",e.highlight_result_card_translate="highlight_result_card_translate",e.highlight_result_card_explain="highlight_result_card_explain",e.highlight_result_card_custom_skill="highlight_result_card_custom_skill",e.highlight_function_bar="highlight_function_bar",e.right_click="right_click",e.collect_this_page="collect_this_page",e.webimage_collect="webimage_collect",e.video_memo_save="video_memo_save",e.web_other="web_other",e.podcast_collect="podcast_collect",e.after_screenshot="after_screenshot",e.extract_text_card="extract_text_card",e}({}),a=function(e){return e.videosummary="videosummary",e.searchresult="searchresult",e.textfragment="textfragment",e.TranslateResult="TranslateResult",e.ExplainResult="ExplainResult",e.CustomSkillResult="CustomSkillResult",e.web="web",e.pdf="pdf",e.Podcast="Podcast",e.Image="Image",e.Screenshot="ScreenShot",e.ExtractText="ExtractText",e}({});function l(e=location.hostname){return e}function r(){return(0,i.M5)(location.href)}function c(e,t){(0,i.z8)(s.Ur.collectionButtonShow,{show_from:e,current_page:r(),collect_type:t,collect_from_site:l()})}function d(e,t,n="collect"){(0,i.z8)(s.Ur.collectionButtonClickSave,{click_from:e,collect_type:t,current_page:r(),collect_from_site:l(),button_name:n})}function u(e,t,n,o){(0,i.z8)(s.Ur.collectionButtonClickSaveStatus,{click_from:e,current_page:r(),collect_from_site:l(),success:t,collect_type:n,collect_id:o})}function m(e,t){(0,i.z8)(s.Ur.collectionSettingClick,{button_name:e,is_open:t,current_page:r()})}},56397:(e,t,n)=>{n.d(t,{Ur:()=>l,Yd:()=>o,Z5:()=>s,_h:()=>a,cz:()=>r,g6:()=>i});let i=function(e){return e.setting="setting",e.landing="landing",e.welcome="extension_welcome",e.login="login",e.uninstall="uninstall",e.extensionOther="extension_other",e.baidu="search_engine_baidu",e.google="search_engine_google",e.bing="search_engine_bing",e.toutiao="search_engine_toutiao",e.youtube="youtube",e.bilibili="bilibili",e.douyin="douyin",e.chat="chat",e.chatgpt="chatgpt",e.mail="mail_page",e.xiaoyuzhou="xiaoyuzhou",e.apple="apple",e.webOther="web_otherpage",e}({}),s=function(e){return e.onboarding="onboarding",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantMoreMenu="highlight_function_bar_dropdown",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.podcastAssistant="podcast_page_summarize",e.chatAssistantPopover="sidebar_action_popover",e.chatAssistantPopoverSettings="sidebar_action_popover_settings",e.sendMessageInChat="send_message_in_chat",e.mailCreate="mail_create",e.mailUpdate="mail_update",e.mailEntryButton="mail_entry_button",e.mailPositive="mail_positive",e.mailNegative="mail_negative",e.mailNeedMore="mail_need_more",e.arxiv="arxiv",e.pdf="pdf",e.context_menu="context_menu",e.shortcut="shortcut",e.inputText="input_text",e.collect="collect",e.searchResultPreview="search_result_preview",e.hyperlinkResultPreview="hyperlink_preview",e.deepSearchMode="deep_search_mode",e.podcast_show="podcast_summarize_show",e.podcast_click="podcast_summarize",e.quick_translate="quick_translate",e}({}),o=function(e){return e.setting="setting",e.addASkill="add_a_skill",e.discoverSkill="discover_skill",e}({}),a=function(e){return e.insert="insert_below",e.replace="replace_selection",e.suggest="suggest",e.share="share",e.summarizeVideo="summarize_video",e.immersionGuideTips="immersion_guide_tips",e.immersionGuideIcon="immersion_guide_icon",e.summarizePodcast="summarize_podcast",e.translatePage="translate_this_page",e.summarizePage="summarize_this_page",e.languageSettings="language_settings",e.displayOriginalText="display_original_text",e.alwaysTranslatePage="always_translate_this_page",e.viewInWeb="view_in_web",e.settings="settings",e.historyChats="history_chats",e.collection="collection",e.allConversation="all_conversation",e.understandContext="understand_context",e.download="download",e.updateLog="update_log",e.highlightRecord="highlight_record",e.highlightSelectionBar="highlight_selection_bar",e.fold="fold",e.expand="expand",e.expanded="expanded",e.collapsed="collapsed",e.regeneration="regeneration",e.formalize="formalize",e.elaborate="elaborate",e.shorten="shorten",e.write="help_me_write",e.rewrite="rewrite",e.changeReplyLang="change_reply_lang",e.hideUntilNext="hide_until_next",e.closeWritingAssistant="close_writing_assistant",e.closeGrammerCheck="close_grammar_check",e.writingLanguage="language_setting",e.btnCopy="copy",e.btnInsert="insert",e.btnReplace="replace",e.helpMeReply="help_me_reply",e.gotIt="got_it",e.save="save",e.targetLanguage="target_language",e.shortcut="shortcut",e.translateService="translate_service",e.dismiss="dismiss",e.understandContextOn="understand_context_on",e.understandContextOff="understand_context_off",e.screenCapture="screenshot",e.searchButton="search",e.voiceInput="voice_input",e.translateRead="read",e.translateEdit="edit",e.translateCopyOrigin="copy_origin",e}({}),l=function(e){return e.copy="copy",e.regenerate="click_regenerate",e.continueInChat="continue_in_chat",e.retry="retry",e.enterPage="enter_page",e.generationFailure="generation_failure",e.share="share",e.viewDAU="view_dau",e.activeDAU="active_dau",e.sendMessage="send_message",e.showSelectAssistantMenu="highlight_function_bar_show",e.showSelectAssistantBtn="highlight_function_bar_function_show",e.clickSelectAssistantMenuBtn="highlight_function_bar_click",e.showSelectAssistantResult="highlight_result_show",e.clickSelectAssistantResultBtn="highlight_result_action",e.closeSelectAssistantResult="highlight_result_close",e.showChatAssistant="side_bar_entrance_show",e.clickChatAssistant="side_bar_entrance_click",e.showChatAssistantPopover="show_side_bar_popover",e.clickChatAssistantPopover="click_side_bar_popover",e.showChatAssistantPopoverSettings="show_side_bar_settings_popover_button",e.clickChatAssistantPopoverSettings="click_side_bar_settings_popover_button",e.showChatHeaderBtn="show_chat_header_button",e.clickChatHeaderBtn="click_chat_header_button",e.showChatFloatCard="highlight_action_module_sidebarshow",e.clickChatFloatCard="highlight_action_module_sidebarclick",e.showSearchAssistant="search_result_card_show",e.searchResultCardClick="search_result_card_click",e.showSearchAssistantSuggest="show_suggested_prompt",e.showSearchAssistantSuggestQuestion="show_suggested_prompt_single_question",e.clickSearchAssistantSuggest="click_suggested_prompt",e.closeSearchAssistant="search_result_card_disappear",e.showDeepSearchAssistant="search_summarize_result_show",e.showSources="sources_show",e.clickSources="sources_click",e.collapseDeepSearchCard="search_card_collapse",e.showDeepSearchBtn="deep_search_button_show",e.clickDeepSearchBtn="deep_search_button_click",e.showVideoAssistant="video_summarize_module_show",e.clickVideoAssistantSummarizeBtn="video_summarize_module_click",e.showVideoAssistantSummarizeResult="video_summarize_result_show",e.clickVideoAssistantSummarizeResult="video_summarize_result_click",e.showVideoAssistantHighlightsTimeline="highlights_timeline_singleshow",e.clickVideoAssistantHighlightsTimeline="highlights_timeline_singleclick",e.clickVideoImmersion="video_immersion_click",e.showVideoImmersion="video_immersion_show",e.immersionTimeLine="immersion_timeline",e.showVideoImmersionGuideTips="video_immersion_guide_tips_show",e.clickVideoImmersionGuideTips="video_immersion_guide_tips_click",e.showVideoImmersionGuideIcon="video_immersion_guide_icon_show",e.clickVideoImmersionGuideIcon="video_immersion_guide_icon_click",e.showPodcastAssistant="podcast_summarize_module_show",e.clickPodcastAssistantSummarizeBtn="podcast_summarize_module_click",e.showPodcastAssistantSummarizeResult="podcast_summarize_result_show",e.clickPodcastAssistantSummarizeResult="podcast_summarize_result_click",e.showMailEntryButton="mail_entry_button_show",e.clickMailEntryButton="mail_entry_button_click",e.clickInputBar="input_bar_click",e.showMailThreadResult="mail_thread_result_show",e.clickMailThreadResult="mail_thread_result_click",e.insertMailThreadResult="mail_thread_result_insert",e.closeMailThreadResult="mail_thread_result_close",e.quickReplyButtonShow="ai_reply_button_show",e.hoverQuickReplyButton="hover_ai_reply_button",e.showPdfAssistant="pdf_read_show",e.clickReadPdfBtn="pdf_read_click",e.showDisableMenu="disable_menu_show",e.clickDisableMenu="confirm_close_function",e.chooseLanguage="choose_language_result",e.shortcutClick="shortcut_click",e.newSkillAdd="new_skill_add",e.skillEditClick="skill_edit_click",e.skillEditDelete="skill_edit_delete",e.skillPopupSave="skill_popup_save",e.skillPopupIconClick="skill_popup_icon_click",e.skillPopupCancel="skill_popup_cancel",e.skillPopupClose="skill_popup_close",e.exampleClick="example_click",e.examplePopupClose="example_popup_close",e.collectionButtonShow="collection_button_show",e.collectionButtonClickSave="collection_button_click_save",e.collectionButtonClickSaveStatus="collection_button_click_save_status",e.seeCollectionButtonShow="see_collection_button_show",e.collectionSettingClick="collection_setting_click",e.writingSettingClick="mail_entry_setting_click",e.writingSkilShow="skill_module_show",e.writingSkillClick="click_suggested_content",e.writingAssistantResultClick="writing_assistant_result_click",e.searchLinkPreviewEntryShow="search_result_preview_icon_show",e.searchLinkPreviewResultShow="search_result_preview_result_show",e.searchLinkPreviewResultClick="search_result_preview_result_click",e.hyperLinkPreviewEntryShow="hyperlink_preview_icon_show",e.hyperLinkPreviewResultShow="hyperlink_preview_result_show",e.hyperLinkPreviewResultClick="hyperlink_preview_result_click",e.doubaoDownloadPopupShow="doubao_download_popup_show",e.doubaoDownloadPopupClick="doubao_download_popup_click",e.takeNoteShow="take_note_show",e.takeNotePadShow="take_note_pad_show",e.takeNotePadClick="take_note_pad_click",e.takeNoteBtnClick="video_tool_bar_take_note_click",e.takeNoteStatus="take_note_pad_click_status",e.quickTranslatePopupShow="quick_translate_popup_show",e.quickTranslatePopupClick="quick_translate_popup_click",e.quickTranslate="quick_translate",e.quickTranslateSettingClick="quick_translate_setting_click",e.chooseMouseHoverResult="choose_mouse_hover_result",e.doubaoUpdatePopupShow="doubao_update_popup_show",e.doubaoUpdatePopupClick="doubao_update_popup_click",e.videoSettingClick="video_setting_click",e.translationCardShow="translation_card_show",e.translationCardClick="translation_card_click",e}({}),r=function(e){return e.clickSidebar="click_side_bar",e.selectAssistantMenu="highlight_function_bar",e.selectAssistantResult="highlight_result_card",e.searchAssistant="search_result_card",e.videoAssistant="video_page_summarize",e.podcastAssistant="podcast_page_summarize",e.onboarding="onboarding",e.chatHeader="chat_header",e.disableMenu="close_function",e.screenCapture="screen_capture",e.searchPreview="search_preview",e.other="other",e.default="default",e}({})},12038:(e,t,n)=>{n.d(t,{M5:()=>h,z8:()=>p});var i=n(44557),s=n(56397),o=n(58484),a=n(82770),l=n(76813),r=(n(93476),n(36897)),c=(n(5842),n(77591),n(23362)),d=n(41659),u=n(76360),m=n(44969);const h=e=>{if(e.startsWith((0,u.Yh)()))return s.g6.setting;if(e.includes(m.o2))return s.g6.landing;if(e.includes(m.EP))return s.g6.login;if(e.includes(m.JE))return s.g6.welcome;if(e.includes(m.j0))return s.g6.uninstall;if(e.includes(m.Cp))return s.g6.extensionOther;const t=(0,c.Ay)(e);return t?s.g6[t.name]:(0,r.jB)("youtube")?s.g6.youtube:(0,r.jB)("bilibili")?s.g6.bilibili:(0,l.yf)()?s.g6.douyin:(0,d.nW)(e)?s.g6.mail:/https?:\/\/(\w+\.)?chatgpt\.com\//gi.test(e)?s.g6.chatgpt:function(e){try{const t=new URL(e);if(/^https?:?$/.test(t.protocol))return t.host.replace(/\./gi,"_")}catch(t){}return s.g6.webOther}(e)},p=(e,t={},n=!0,s=!0)=>{var l;const r=h(location.href);null===(l=a.Ay.Tea)||void 0===l||l.event(e,(0,i.A)({current_page:r},t)),n&&(0,o.gR)(e,(0,i.A)({current_page:r},t)),s&&(0,o.zl)(e,(0,i.A)({current_page:r},t))};s.cz.default},17933:(e,t,n)=>{n.d(t,{Bq:()=>d,Yx:()=>r,jk:()=>u,xF:()=>m});var i=n(12038),s=n(56397),o=n(78503);let a=function(e){return e.page="disable_page",e.global="disable_all",e.temp="hide_till_next_time",e}({});const l={[o.lf.chatAssistant]:"side_bar_entrance",[o.lf.searchAssistant]:"search_card",[o.lf.selectAssistant]:"highlight_function",[o.lf.searchAddons]:"search_recommend",[o.lf.linkPreview]:"search_preview",[o.lf.videoSummary]:"video_summarize_card",[o.lf.videoSubtitle]:"video_subtitle",[o.lf.podcastSummary]:"podcast_summarize_card",[o.lf.sidebarFloatCard]:"side_panel",[o.lf.grammar]:"writing_assistant_grammar",[o.lf.inputAssistant]:"writing_assistant",[o.lf.videoImmersion]:"video_immersion",[o.lf.replyAssistant]:"reply_assistant",[o.lf.vocabruary]:"highlight_mark",[o.lf.collectionImage]:"webimage_collect",[o.lf.collectionPage]:"web_collect",[o.lf.videoMemo]:"video_memo"},r=e=>l[e]||"",c=e=>{let t="";switch(e){case o.iI.temp:t=a.temp;break;case o.iI.page:t=a.page;break;case o.iI.global:t=a.global}return t},d=e=>{(0,i.z8)(s.Ur.showDisableMenu,{enter_method:r(e)})},u=(e,t)=>{(0,i.z8)(s.Ur.clickDisableMenu,{enter_method:r(t),button_name:c(e)})},m=({click_from:e})=>{(0,i.z8)(s.Ur.shortcutClick,{click_from:e})}},78503:(e,t,n)=>{n.d(t,{Fc:()=>r,WR:()=>c,X0:()=>l,c$:()=>o,iI:()=>s,lf:()=>i,th:()=>a});let i=function(e){return e.chatAssistant="sidebarButton",e.searchAssistant="search",e.selectAssistant="quick",e.grammar="grammar",e.inputAssistant="input",e.replyAssistant="reply",e.searchAddons="search-addons",e.videoSummary="videoSummary",e.videoSubtitle="videoSubtitle",e.videoImmersion="videoImmersion",e.videoMemo="videoMemo",e.podcastSummary="podcastSummary",e.linkPreview="linkPreview",e.sidebarFloatCard="sidebarFloatCard",e.vocabruary="vocabruary",e.collectionImage="collectionImage",e.collectionPage="collectionPage",e}({}),s=function(e){return e.temp="temp",e.page="page",e.global="global",e}({}),o=function(e){return e.HUOSHAN="huoshan",e.DOUBAO="doubao",e.GPT="gpt",e.GOOGLE="google",e.MICROSOFT="microsoft",e.DEEPL="deepl",e}({}),a=function(e){return e.HUOSHAN="0",e.LLM="1",e.GOOGLE="2",e.MICROSOFT="3",e}({}),l=function(e){return e.NO_TRANSLATE="no_translate",e.TRANSLATE_DIRECTLY="translate_directly",e.TRANSLATE_BY_COMMAND="translate_by_command",e.TRANSLATE_BY_OPTION="translate_by_option",e.TRANSLATE_BY_CUSTOM_SHORTCUT="translate_by_custom_shortcut",e}({}),r=function(e){return e[e.PageTranslate=1]="PageTranslate",e[e.AIReader=2]="AIReader",e[e.ChooseWordsTranslate=3]="ChooseWordsTranslate",e[e.ScreenShotTranslate=4]="ScreenShotTranslate",e[e.ImageTextExtraction=5]="ImageTextExtraction",e[e.HoverTranslate=6]="HoverTranslate",e[e.InputFieldInstantTranslate=7]="InputFieldInstantTranslate",e[e.ToutiaoSearchCard=8]="ToutiaoSearchCard",e[e.SearchRecommendCard=9]="SearchRecommendCard",e[e.CommentReply=10]="CommentReply",e}({}),c=function(e){return e.Space="Space",e.Comma="Comma",e.Slash="Slash",e.Equal="Equal",e}({})},58980:(e,t,n)=>{n.d(t,{Fc:()=>s.Fc,WR:()=>s.WR,X0:()=>s.X0,c$:()=>s.c$,lG:()=>i.l,lf:()=>s.lf,th:()=>s.th});var i=n(15959),s=n(78503)},67685:(e,t,n)=>{n.d(t,{C1:()=>l,FI:()=>s,Jk:()=>u,KT:()=>r,Vl:()=>m,_E:()=>p,eG:()=>h,kD:()=>d,lx:()=>c,nD:()=>a,sZ:()=>o,zs:()=>g});var i=n(78503);const s="www.doubao.com",o="586864",a="production",l="https://www.doubao.com",r=`https://${s}/chat/settings`,c="web",d=`https://${s}/samantha`,u=`https://${s}/alice`,m=`https://${s}/chat/collection`,h="release_version",p=[{name:"flow_web_ext_sidebar_hide_1",key:i.iI.temp,id:1},{name:"flow_web_ext_sidebar_hide_2",key:i.iI.page,id:2},{name:"flow_web_ext_sidebar_hide_3",key:i.iI.global,id:3}],g={[i.lf.sidebarFloatCard]:{global:"chatFloatCardDisableAll",page:"chatFloatCardDisableHosts"},[i.lf.videoSubtitle]:{global:"videoSubtitleDisableAll",page:"videoSubtitleDisableHosts"},[i.lf.videoSummary]:{global:"videoSummaryDisableAll",page:"videoSummaryDisableHosts"},[i.lf.videoMemo]:{global:"videoMemoDisableAll",page:"videoMemoDisableHosts"},[i.lf.podcastSummary]:{global:"podcastSummaryDisableAll",page:"podcastSummaryDisableHosts"},[i.lf.chatAssistant]:{global:"sidebarButtonDisabledAll",page:"sidebarButtonDisabledHosts"},[i.lf.searchAssistant]:{global:"searchDisabledAll",page:"searchDisabledHosts"},[i.lf.selectAssistant]:{global:"quickDisabledAll",page:"quickDisabledHosts"},[i.lf.grammar]:{global:"disableGlobalGrammar",page:"disableGrammarHosts"},[i.lf.inputAssistant]:{global:"InputAssistantDisabledAll",page:"InputAssistantDisabledHosts"},[i.lf.searchAddons]:{global:"disableSearchAddonsGlobal",page:"disableSearchAddonsHosts"},[i.lf.linkPreview]:{global:"linkPreviewDisabledAll",page:"linkPreviewDisabledHosts"},[i.lf.videoImmersion]:{global:"videoImmersionDisableAll",page:"videoImmersionDisableHosts"},[i.lf.replyAssistant]:{global:"replyAssistantDisabledAll",page:"replyAssistantDisabledHosts"},[i.lf.vocabruary]:{global:"vocabruaryDisableAll",page:"vocabruaryDisableHosts"},[i.lf.collectionImage]:{global:"collectImageDisabledAll",page:"collectImageDisabledHosts"}}},28328:(e,t,n)=>{n.d(t,{SM:()=>i,V$:()=>s});n(76360);const i=(e,t)=>{let n=e.classList.toString();const i=new MutationObserver((i=>{for(const s of i)if("class"===s.attributeName){const i=e.classList.toString();if(i!==n){t(i),n=i;break}}}));return i.observe(e,{attributes:!0}),i},s=(e,t)=>{const n=new MutationObserver(t);return n.observe(e,{attributes:!0}),n}},13162:(e,t,n)=>{n.d(t,{r:()=>r});var i=n(3365),s=n(15159),o=n(67685),a=n(77591),l=n(21559);function r(e,t="image"){const n=i.cV.BOT_CHAT,r=Number(o.sZ),{userId:c=""}=(0,a.Fc)(),d="image"===t?i.sh.IMAGE:i.sh.OBJECT,u=new s.UploaderService({type:d,scene:n,userId:c,appId:r});let m;return new Promise(((t,n)=>{const i=()=>{m&&clearTimeout(m),m=setTimeout((()=>{const e=new Error("collect_tos_process_file_faild");l.vF.persist.error({eventName:"tos process file faild",error:e}),n(e)}),1e4)};i(),u.upload(e,{complete:e=>{m&&clearTimeout(m),t(e.uploadResult.Uri||"")},error:e=>{m&&clearTimeout(m),n(e)},progress:()=>{i()}})}))}},98767:(e,t,n)=>{n.d(t,{CU:()=>l,n_:()=>a});var i=n(16409);function s(e){(0,i.cs)({name:"remove-fetch-cross-header",body:e})}let o;function a(e){return new Promise(((t,n)=>{const a=()=>{o=e,(0,i.cs)({name:"add-fetch-cross-header",body:e}).then((({data:i})=>{try{o=i,fetch(e).then((e=>{if(!e.ok)throw new Error("Network response was not ok");e.blob().then((n=>t({blob:n,type:e.headers.get("Content-Type")||"image/jpg"}))).catch(n)})).catch(n).finally((()=>{s(o)}))}catch(a){s(i),n(a)}var o})).catch(n).finally((()=>{o=void 0}))},l=()=>{o?setTimeout((()=>l()),50):a()};l()}))}function l(e){return new Promise(((t,n)=>{try{var i;const n=null===(i=e.getClientRects())||void 0===i?void 0:i[0],s=document.createElement("canvas"),o=s.getContext("2d");s.width=n.width,s.height=n.height,null==o||o.drawImage(e,0,0,n.width,n.height),s.toBlob(t,"image/jpeg",1)}catch(s){n(s)}}))}},64802:(e,t,n)=>{n.d(t,{q4:()=>g,l$:()=>p});var i=n(5687),s=n(89380),o=n(43714),a=n.n(o),l=n(35661),r=n(52289),c=n(24693);function d(e,t=[]){const n=(0,s.A)(e);let i="";for(const s of n){if((0,c.DC)(s))continue;if(!(s instanceof HTMLElement)){i+=s.textContent||"";continue}const e=s.tagName.toLowerCase();if(l.A2.includes(e)){const n=l.hT[e],o={};for(const{key:e,getter:t}of(null==n?void 0:n.attrs)||[]){const n=t?t(s):s.getAttribute(e);n&&(o[e]=n)}t.push({tag:e,originContent:(0,c.UU)(s.textContent||""),attrs:o});const a=t.length-1,{output:r}=d(Array.from(s.childNodes),t);i+=`<b${a}>${r}</b${a}>`;continue}const{output:n}=d(Array.from(s.childNodes),t);i+=n}return{output:(0,c.UU)(i),metaInfo:t}}const u=(e,t=[])=>{(0,i.A)(t,((t,n)=>{const{tag:i,originContent:s}=t,o=new RegExp(`<\\s*[bB]\\s*${n}\\s*>([\\s\\S]*?)<\\s*/\\s*[bB]\\s*${n}\\s*>`),{openTag:a,closeTag:r}=function(e){const{tag:t,attrs:n={}}=e;let i="";for(const[s,o]of Object.entries(n))i+=` ${s}="${o}"`;return["li","ol"].includes(t)?{openTag:`<ul><${t}${i}>`,closeTag:`</${t}></ul>`}:"code"===t?{openTag:"`",closeTag:"`"}:"em"===t?{openTag:"<strong>",closeTag:"</strong>"}:{openTag:`<${t}${i}>`,closeTag:`</${t}>`}}(t),c=l.Jy.includes(i)?`${a}${s}${r}`:`${a}$1${r}`;e=e.replace(o,c)})),e=(e=(0,r.qP)(e)).replaceAll(/\n/g,"<br />");try{return a()(e)}catch(n){return e}};var m=n(12312);n(46514),n(96638);let h;function p(e){if(e.commonAncestorContainer instanceof Element){(0,m.M)(e.commonAncestorContainer);const t=e.cloneContents(),n=(0,m.u)(Array.from(t.childNodes));h=[];return n.map((e=>d(e,h))).map((e=>e.output)).join("\n")}h=void 0}function g(e){return u(e,h||[])}},52289:(e,t,n)=>{function i(e){const t=e.getAttribute("data-cici-select-uid");if(t){const e=document.querySelector(`[data-cici-select-uid="${t}"]`);if(e)return getComputedStyle(e)}}function s(e){return e.replaceAll(/<\s*\/?\s*[bB]\s*\d+\s*>/g,"")}n.d(t,{D6:()=>i,qP:()=>s})},82770:(e,t,n)=>{n.d(t,{Ay:()=>f,FM:()=>p,Mz:()=>_});var i=n(10633),s=n(14065),o=n(85371),a=n(21511),l=n(76021),r=(n(11855),n(60313)),c=n(67685),d=n(77591),u=n(75882),m=(n(47730),n(76360)),h=n(92174);let p=function(e){return e.deepSearchEntryMode="deepSearchEntryMode",e.enableNewChat="enableNewChat",e.enableWebAISearch="enableWebAISearch",e.enableChatCtx="enableChatCtx",e.enableLinkPreview="enableLinkPreview",e.searchCardAutoSummary="searchCardAutoSummary",e.enableHighlightTag="enableHighlightTag",e.vocabruary="vocabruary",e.enableDouyinSummary="enableDouyinSummary",e}({});const g=(0,l.A)((()=>{(0,a.A)(Object.keys(p)).forEach((e=>{v.Tea.getVar(e,null,(t=>{(0,d.vE)("abTestValue",{[e]:t},!0)}))}))}));function _(e,t){const n=(0,d.TK)("abTestValue");return(0,o.A)(n[e])&&v.Tea.getVar(e,t,(t=>{(0,d.vE)("abTestValue",{[e]:t},!0)})),(0,o.A)(n[e])?t:n[e]}const v=new class{constructor(){var e=this;(0,i.A)(this,"Tea",null),(0,i.A)(this,"initTea",(0,s.A)((function*(){const t=yield(0,r.Y)(),n=(0,d.Fc)();h.A.init({app_id:Number(c.sZ),channel:"cn",log:!1,enable_ab_test:!0,ab_channel_domain:"https://abtestvm.bytedance.com"}),h.A.config({_staging_flag:0,extension_version:(0,m.HF)(),user_unique_id:t,user_id:null==n?void 0:n.userId,user_is_login:Boolean(null==n?void 0:n.isAuthenticated)}),h.A.start(),e.updateTea(h.A),g();const i={name:"auth-info-updated",handle:e=>{const{authInfo:t}=e||{};h.A.config({user_id:null==t?void 0:t.userId,user_is_login:Boolean(null==t?void 0:t.isAuthenticated)})}};(0,u.c)(i)}))),(0,i.A)(this,"updateTea",(e=>{this.Tea=e}))}getInstance(){return h.A}},f=v},94953:(e,t,n)=>{n.d(t,{w:()=>s});var i=n(58980);function s(e){switch(e){case i.c$.HUOSHAN:return i.th.HUOSHAN;case i.c$.GOOGLE:return i.th.GOOGLE;case i.c$.MICROSOFT:return i.th.MICROSOFT;default:return i.th.LLM}}},76813:(e,t,n)=>{n.d(t,{ID:()=>i,yf:()=>s});n(67685),n(77591);function i(e,t={}){const n=e.includes("?"),i=Object.keys(t).reduce(((e,n)=>{const i=void 0===t[n]||null===t[n]?"":String(t[n]);return e=`${e}&${`${encodeURIComponent(n)}=${encodeURIComponent(i)}`}`}),"");return n?`${e}${i}`:`${e}?${i.replace(/^&/,"")}`}function s(){return/douyin.com/.test(location.hostname)}},46219:(e,t,n)=>{n.d(t,{EB:()=>h,F6:()=>c,Ln:()=>g,MV:()=>p,On:()=>a,Sf:()=>u,W2:()=>b,_q:()=>l,dO:()=>m,dc:()=>s,fV:()=>f,hn:()=>o,i9:()=>v,rR:()=>_,so:()=>r,sq:()=>d,tL:()=>i});const i="LOCAL_USER",s=18e4,o=6e4,a=4e3,l=15e3,r=3e4,c=6e4,d="ONBOARDING_MESSAGE_ID",u=5e3,m=19e3,h=2e3,p=1e4,g="THINKING_MESSAGE_ID",_="MOCK_REPLY_MESSAGE_ID",v="ASSISTANT_CONV_ID_WITHOUT_CACHE",f=500,b=30},99865:(e,t,n)=>{n.d(t,{SR:()=>a});var i=n(37462),s=n(37357);const o=function e(...t){const{_useTracingStore:n}=e.prototype;if(n)return n(...t);throw Error("useTracingStore is not initialized")};const a=()=>{try{const e=o.getState();return{addDurationPoint:e.addDurationPoint,addDurationPoints:e.addDurationPoints,error:e.error}}catch(e){return s.v.console.error({message:"useTracingStore.getState error",error:e}),{addDurationPoint:i.A,addDurationPoints:i.A,error:i.A}}}},34558:(e,t,n)=>{n.d(t,{e:()=>o});var i=n(90895),s=n(75484);const o=(e,t=!1)=>(0,i.Rx)(s.pU.getState(),e,t)},29537:(e,t,n)=>{n.d(t,{Xy:()=>s});var i=n(8607);const s=(0,i.p)()},96092:(e,t,n)=>{n.d(t,{Et:()=>i,mJ:()=>s});let i=function(e){return e.Pending="Pending",e.Creating="Creating",e.Done="Done",e.Failed="Failed",e}({}),s=function(e){return e.ReachLimit="reach_limit",e}({})},75484:(e,t,n)=>{n.d(t,{pU:()=>i});const i=function e(...t){const{_useFeedStore:n}=e.prototype;if(n)return n(...t);throw Error("useFeedStore is not initialized")}},78821:(e,t,n)=>{n.d(t,{Gl:()=>i,VN:()=>s});const i=(e,t)=>t?e.localConversationMap[t]:void 0,s=(e,t)=>t?e.conversationMap[t]:void 0},90895:(e,t,n)=>{n.d(t,{Rx:()=>s,Xc:()=>a,tY:()=>o});var i=n(29537);const s=(e,t,n=!1)=>{if(!t)return;const{conversation_type:i}=e.conversationMap[t]||{};if(i||!n)return i;const{conversation_type:s}=e.localConversationMap[t]||{};return t?s:void 0},o=(e,t)=>{if(!t)return{};const n=i.Xy.get("chatBotService"),s=e.conversationMap[t];return{conversation:s,botInfo:null!=s&&s.bot_id?null==n?void 0:n.getBot(null==s?void 0:s.bot_id):{}}},a=(e,t,n)=>{const{botInfo:s,conversation:a}=o(e,t),l=i.Xy.get("chatBotService"),r=(null==s?void 0:s.id)||(null==s?void 0:s.bot_id)||(null==a?void 0:a.bot_id);return r||!n?r:t?null==l?void 0:l.getBotIdFromLocalConversation(t):void 0}},14587:(e,t,n)=>{n.d(t,{AU:()=>u,Sx:()=>a,aj:()=>c,dG:()=>h,gm:()=>d,i1:()=>l,if:()=>r,vM:()=>m});var i=n(12648),s=n(81309),o=n(10484);const a=e=>e===i.Cr.CocoWeb||e===i.Cr.Coco,l=e=>e===i.Cr.CocoWebSub||e===i.Cr.CocoSub,r=e=>a(null==e?void 0:e.conversation_type),c=e=>l(null==e?void 0:e.conversation_type),d=(e,t)=>{const n=r(e),i=c(e);return n||i||t===o.H.NewThread||t===o.H.ThreadLocalConversation||t===o.H.CollectionLocalConversation||t===o.H.AIVideoLocalConversation||t===o.H.SharedThreadContinueChat},u=e=>e===s.YK.Coco||e===s.YK.CocoWeb,m=e=>e===s.YK.User,h=e=>e===s.YK.GuanFang},13242:(e,t,n)=>{n.d(t,{BN:()=>i});const i=function e(...t){const{_useChatInputStore:n}=e.prototype;if(n)return n(...t);throw Error("useChatInputStore is not initialized")}},78014:(e,t,n)=>{n.d(t,{hg:()=>i});const i=e=>"text"===(null==e?void 0:e.type)},41772:(e,t,n)=>{n(82854)},42800:(e,t,n)=>{n.d(t,{Az:()=>i.Az,c8:()=>a.c,kk:()=>o.kk,fr:()=>o.fr,YV:()=>o.YV,HZ:()=>o.HZ,QP:()=>o.QP,JG:()=>o.JG,Bu:()=>o.Bu,vm:()=>s.v,p8:()=>l.p});n(76900),n(82854),n(73014);var i=n(60100),s=(n(62887),n(17209)),o=(n(31160),n(69052)),a=n(19664),l=n(69424);n(41772),n(68005)},62887:(e,t,n)=>{n(82854)},88138:(e,t,n)=>{n.d(t,{CU:()=>m,Ns:()=>l,O6:()=>c,PF:()=>u,V3:()=>d});var i=n(32967),s=n(86228),o=n(61276),a=n(10129);const l=e=>{e.forEach((e=>{e.on("message",(e=>(0,i.aT)(e))),e.on("cmd",(e=>(0,s.r)(e))),o.Pv.register(e)}))},r=e=>{e.forEach((e=>{null==e||e.off("message"),null==e||e.off("cmd"),null==e||e.drop()}))},c=e=>{var t;null===(t=o.Pv.get(a.aU.HttpLongPolling))||void 0===t||t.pullMessage(e,{delay:15e3})},d=e=>{var t;null===(t=o.Pv.get(a.aU.HttpChunk))||void 0===t||t.pullMessage(e)},u=({replyId:e,localMessageId:t})=>{var n,i,s;e&&(null===(n=o.Pv.get(a.aU.HttpChunk))||void 0===n||n.abortMessage(e)),e&&(null===(i=o.Pv.get(a.aU.HttpLongPolling))||void 0===i||i.abortMessage(e)),t&&(null===(s=o.Pv.get(a.aU.SamanthaChatCompletion))||void 0===s||s.abortMessage(t))};function m(){r(o.Pv.getAll())}},28087:(e,t,n)=>{n.d(t,{CU:()=>i.CU,Ns:()=>i.Ns,PF:()=>i.PF});n(32967),n(86228);var i=n(88138)},32967:(e,t,n)=>{n.d(t,{aT:()=>f});var i=n(44557),s=n(81435),o=n(49944),a=n(77813),l=n(22042),r=n(60702),c=n(94268),d=n(73014),u=n(37357),m=n(88138),h=n(10129);n(20661);const{Xt:p}=s;function g(e){return e.next_connection_type===p.HttpChunk}function _(e){return e.next_connection_type===p.WebSocket}function v(e){var t;return(null==e||null===(t=e.local_info)||void 0===t?void 0:t.from)===h.aU.Socket}const f=e=>{var t;const{conversation_id:n,message_id:s=""}=e,h={namespace:null===(t=e.local_info)||void 0===t?void 0:t.from,meta:{message:e}};if(function(e,t){var n;const s=d.gO.get("chatConfigService");var o;null!=s&&null!==(n=s.localFeatureConfig)&&void 0!==n&&n.consoleFullMessagePacket&&u.v.console.info((0,i.A)((0,i.A)({},t),{},{message:`Full Message Received, From: ${null===(o=e.local_info)||void 0===o?void 0:o.from}`}))}(e,h),!n)return void function(e){u.v.console.warning((0,i.A)((0,i.A)({},e),{},{message:"message.conversation_id is empty when update message in handleMessage"}))}(h);const p=(0,i.A)((0,i.A)({},e),{},{conversation_id:n});if((0,c.fj)(e))return void(0,r.f)(p);if((0,c.ey)(e))return(0,a.Y)(p),_(e)&&(0,m.O6)(e),void(g(e)&&v(e)&&(0,m.V3)(e));if(!s)return void function(e){u.v.console.warning((0,i.A)((0,i.A)({},e),{},{message:"message.message_id is empty when update message in handleMessage"}))}(h);const f=(0,i.A)((0,i.A)({},e),{},{message_id:s,conversation_id:n});if((0,c.yU)(f))(0,l.C)(f);else{if((0,o.P)(f),g(e)&&v(e))return void(0,m.V3)(e);if(!(0,c.oS)(e)&&_(e))return void(0,m.O6)(e)}}},20661:(e,t,n)=>{n.d(t,{$q:()=>s.$q,BX:()=>i.B,Gm:()=>s.Gm,Kq:()=>o.Kq,O2:()=>s.O2,TU:()=>s.TU,Xv:()=>o.Xv,bT:()=>o.bT,dk:()=>s.dk,eT:()=>s.eT,t:()=>o.t,uX:()=>s.uX});var i=n(10092),s=n(94984),o=n(57387)},81626:(e,t,n)=>{n.d(t,{Tc:()=>i.Tc,WP:()=>i.WP,hy:()=>s.h,to:()=>i.to});var i=n(82205),s=n(93270)},82205:(e,t,n)=>{n.d(t,{Tc:()=>o,WP:()=>s,to:()=>a});var i=n(82854);n(36682);const s=e=>{const t=i.ozw.getState(),n=t.messageLinkMap[e],s=(0,i.A4i)({localMessageMap:t.localMessageMap[e],messageMap:t.messageMap[e]}),o=(0,i.WZZ)(n,(e=>{const n=s(e);return!!n&&(0,i.$4u)(n)&&!!n.reply_id&&!(0,i.c84)(n,t.userInfo.secUserId)}));return o?s(o):void 0},o=(e,t,n=i.ozw.getState())=>(0,i.tP$)(n,e,t),a=e=>(0,i.bRb)(i.ozw.getState(),e)},36682:(e,t,n)=>{var i=n(82854),s=n(21890),o=n(44557),a=n(47997),l=(n(11855),n(81626),n(78821)),r=n(75484),c=n(46219);const d=(0,s.B)(((e,t)=>e.messageLinkMap[t]||[])),u=(0,s.B)(((e,t)=>e.messageListStatusMap[t]||{}));(0,s.B)(((e,t)=>{const n=u.raw(e,t),i=d.raw(e,t),s=u.raw(e,c.i9),o=d.raw(e,c.i9),m=(0,l.VN)(r.pU.getState(),t);return(null==m?void 0:m.conversation_type)===a.Cr.Coco&&0===i.length?{status:s,messageLinks:o,resolveConversationId:c.i9}:{status:n,messageLinks:i,resolveConversationId:t}})),(0,s.B)(((e,t)=>e.messageMap[t]||{})),(0,s.B)(((e,t)=>e.localMessageMap[t]||{})),(0,s.B)(((e,t,n)=>{var i;if(!n)return;return null===(i=(n.isLocalMessage?e.localMessageMap:e.messageMap)[t])||void 0===i?void 0:i[n.messageId]})),(0,s.B)(((e,t,n)=>{const s=(0,i.A4i)((0,i.tvN)(e,t)),o=[];for(const i of n){const e=s(i);e&&o.push(e)}return o})),(0,s.B)(((e,t,n)=>{var i;return n?null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n]:void 0})),(0,s.B)(((e,t,n)=>{var s,a,l;const{regenerateMessageMap:{[t]:r},messageLinkMap:{[t]:c},messageMap:{[t]:d}}=e,u=(0,i.tP$)(e,t,n),m=(()=>{if(null!=u&&u.reply_id&&(0,i.oQq)(u))return(0,i.Jij)(u)?(0,i.rUA)({messageLinks:c,replyId:u.reply_id,getMessage:(0,i.A4i)({localMessageMap:e.localMessageMap[t],messageMap:e.messageMap[t]})}):n.regen_head?null==c?void 0:c.filter((e=>e.regen_head===n.regen_head||e.messageId===n.regen_head)).map((e=>(0,o.A)((0,o.A)({},e),{},{regen_head:e.regen_head||e.messageId}))):void 0})(),h=null===(s=[n,...null!=m?m:[]].map((e=>{var t;return null!==(t=null==d?void 0:d[e.messageId])&&void 0!==t?t:null})).find((e=>null==e?void 0:e.reply_id)))||void 0===s?void 0:s.reply_id;return{activeRegenerateMessage:null!=m&&m.length?null==r||null===(a=r.messageMap)||void 0===a?void 0:a[n.messageId]:void 0,regenerateActiveIndex:null==m?void 0:m.findIndex((({messageId:e})=>e===n.messageId)),isRegenerateHead:Boolean(n.regen_head&&n.messageId),isRegenerateTail:Boolean(n.regen_head&&(null==m||null===(l=m[m.length-1])||void 0===l?void 0:l.messageId)===n.messageId),regenerateMessageLinks:m,replyFromMessage:h&&d[h]||void 0}})),(0,s.B)(((e,t,n)=>{const i=e.suggestMessageMap[t];return(null==i?void 0:i.replyId)===n?i:void 0})),(0,s.B)(((e,t)=>e.lastMessageMap[t])),(0,s.B)(((e,t)=>{try{const n=e.messageLinkMap[t],s=n[n.length-1];if(!s)return!0;const o=e.messageMap[t][s.messageId];return!o||!(0,i.oSs)(o)}catch(n){return!0}}))},77526:(e,t,n)=>{n.d(t,{mf0:()=>i.mf0,Azp:()=>o.Az,c89:()=>o.c8,kkt:()=>o.kk,frm:()=>o.fr,YVR:()=>o.YV,HZ9:()=>o.HZ,QP5:()=>o.QP,JGj:()=>o.JG,BuH:()=>o.Bu,vmW:()=>o.vm,ozw:()=>i.ozw,p8b:()=>o.p8});var i=n(82854),s=n(28087),o=n(42800),a=(n(81626),n(36682),n(65471),n(73014)),l=n(44557),r=(n(10129),n(27737),n(82506)),c=n(81435),d=n(37357);n(75484),n(96092);var u=n(40967),m=n(59355),h=n(1524),p=n(22358),g=n(58447),_=n(43718),v=n(82205),f=n(18590),b=n(13734),x=n(34968);const A={namespace:"cmd",pluginId:"ConversationClearHistory",cmdType:p.HK.ConversationClearHistory,LifeCycle:class{receiveCmdEnd(e){const{conversation_id:t=""}=e||{};d.v.persist.info({message:"Cmd: ConversationClear",meta:{conversation_id:t}}),i.ozw.getState().clearConversationMessages(t)}}};const y={namespace:"cmd",pluginId:"OnboardingBegin",cmdType:p.HK.OnboardingBegin,LifeCycle:class{receiveCmdEnd(e){const{conversation_id:t=""}=e||{};d.v.persist.info({message:"Cmd: OnboardingBegin",meta:{conversation_id:t}}),i.ozw.getState().initOnboarding({conversationId:t})}}};const w={namespace:"cmd",pluginId:"OnboardingFail",cmdType:p.HK.OnboardingFail,LifeCycle:class{receiveCmdEnd(e){const{conversation_id:t=""}=e||{};d.v.persist.info({message:"Cmd: OnboardingFail",meta:{conversation_id:t}}),i.ozw.getState().cancelOnboarding({conversationId:t,reason:"executing onboarding_fail"})}}};const S={namespace:"cmd",pluginId:"OnboardingCancel",cmdType:p.HK.OnboardingCancel,LifeCycle:class{receiveCmdEnd(e){const{conversation_id:t=""}=e||{};d.v.persist.info({message:"Cmd: OnboardingCancel",meta:{conversation_id:t}}),i.ozw.getState().cancelOnboarding({conversationId:t,reason:"executing onboarding_cancel"})}}};const j={namespace:"cmd",pluginId:"UserBanned",cmdType:p.HK.UserBanned,LifeCycle:class{receiveCmdEnd(e){var t;const{conversation_id:n=""}=e||{};d.v.persist.info({message:"Cmd: UserBanned",meta:(0,l.A)({conversation_id:n},e)}),r.g.emit(r.P.USER_BANNED,null==e||null===(t=e.ext)||void 0===t?void 0:t.err_msg)}}};const k={namespace:"cmd",pluginId:"UserBanRelease",cmdType:p.HK.UserBanRelease,LifeCycle:class{receiveCmdEnd(e){var t,n;const{conversation_id:i}=e||{};d.v.persist.info({message:"Cmd: UserBanRelease",meta:{conversation_id:i,index:e.index,error:null==e||null===(t=e.ext)||void 0===t?void 0:t.err_msg}}),r.g.emit(r.P.USER_BAN_RELEASE,null==e||null===(n=e.ext)||void 0===n?void 0:n.err_msg)}}};const C={namespace:"cmd",pluginId:"MessageNotCompliant",cmdType:p.HK.MessageNotCompliant,LifeCycle:class{receiveCmdEnd(e){const{local_message_id:t,conversation_id:n,message_id:o}=e;d.v.console.info({message:"Cmd: MessageNotCompliant",meta:{conversation_id:n,message_id:o,local_message_id:t}}),n&&i.ozw.getState().updateMessageList({conversationId:n,immerUpdate:e=>{const{draftLocalMessageMap:a,draftMessageMap:l}=e,r=c.q7.NotCompliant;if(t&&a[t]&&(a[t].status=r,(0,i.hTZ)(e),(0,s.PF)({localMessageId:t})),o){const t=(0,v.Tc)(n,{isLocalMessage:!1,messageId:o});l[o]&&(l[o].status=r),(0,s.PF)({replyId:o,localMessageId:null==t?void 0:t.local_message_id}),(0,i.c5Z)(e,o),(0,i.Ejp)(e,o)}}})}}};const I={namespace:"cmd",pluginId:"NestedMessageStateChange",cmdType:p.HK.NestedMessageStateChange,LifeCycle:class{receiveCmdEnd(e){const{ext:t}=e,n=i.ozw.getState(),{conversation_id:s,local_message_id:o,update_entity_state_list:l=[]}=(0,f.O)(null==t?void 0:t.body,{});d.v.console.info({message:"Cmd: NestedMessageStateChange",meta:{conversation_id:s,update_entity_state_list:l,local_message_id:o}}),s&&o&&null!=l&&l.length&&(l.forEach((e=>{const t=e.identifier;(0,m.A)(e.update_fields,_.Z2.ParseState)&&n.updateAttachmentParseState(t,e.parse_state),(0,m.A)(e.update_fields,_.Z2.ReviewState)&&n.updateAttachmentReviewState(t,e.review_state)})),i.ozw.getState().updateMessageList({conversationId:s,immerUpdate:e=>{const{draftMessageMap:t}=e,n=(0,u.A)(t).find((e=>e.local_message_id===o));l.forEach((e=>{var t;const i=null==n||null===(t=n.attachments)||void 0===t?void 0:t.find((t=>t.identifier===e.identifier));if(i){if((0,m.A)(e.update_fields,_.Z2.ParseState)){var o;i.file_parse_state=e.parse_state;const t="6",l=a.gO.get("chatTeaService");null==l||l.trackEvent("upload_parse_status",{status:0,error_code:"parse_failed",conversation_id:s,chat_type:(0,h.CB)("",s,(0,h.cL)(s).botInfo),skill_name:g.K9.ReadPDF.toString(),skill_id:t,upload_id:null==n?void 0:n.local_message_id,upload_collection_way:((null==n||null===(o=n.attachments)||void 0===o?void 0:o.length)||0)>1?"multi":"single",upload_type:"Image"===(0,b.ti)(i.name||"")?"pic":"pdf",upload_file_type:(0,b.GO)(i.name||""),upload_file_size:i.size})}(0,m.A)(e.update_fields,_.Z2.ReviewState)&&(i.file_review_state=e.review_state)}}))}}))}}};const T={namespace:"cmd",pluginId:"MessageRefImagesNotCompliant",cmdType:p.HK.MessageRefImagesNotCompliant,LifeCycle:class{receiveCmdEnd(e){const{conversation_id:t,local_message_id:n,ext:s}=e,{review_not_pass_ref_images:o}=(0,f.O)(null==s?void 0:s.body,{});t&&n&&null!=o&&o.length&&(o.forEach((e=>{const t=e;i.ozw.getState().updateAttachmentReviewState(t,p.Cp.ReviewState_NotCompliant)})),i.ozw.getState().updateMessageList({conversationId:t,immerUpdate:e=>{const{draftMessageMap:t}=e,i=(0,u.A)(t).find((e=>e.local_message_id===n));if(null!=i&&i.attachments){const e=i.attachments;o.forEach((t=>{const n=null==e?void 0:e.find((e=>e.identifier===t));n&&(n.file_review_state=p.Cp.ReviewState_NotCompliant)}))}}}))}}};x.v},73014:(e,t,n)=>{n.d(t,{gO:()=>_});var i=n(8607),s=n(82854),o=n(14065),a=n(40967),l=n(76021),r=n(61276),c=n(99865),d=n(28087),u=n(10129),m=n(17834),h=n(31160),p=n(15957);function g(){return g=(0,o.A)((function*(e){const t=s.ozw.getState(),{getCommonSocketParams:i,getCommonHttpParams:l,getCommonHttpHeaders:g,reportEvent:v,config:f,socketClient:b,socketClientLazy:x,fetchStream:A,featureConfig:y,refreshSocketConfig:w}=e;try{var S;const{SocketAdapter:e,HttpChunkAdapter:s,HttpAdapter:k,SamanthaChatCompletionAdapter:C}=yield(0,p.h9)({fn:(j=(0,o.A)((function*(){const{SocketAdapter:e,HttpChunkAdapter:t,HttpAdapter:i,SamanthaChatCompletionAdapter:s}=yield Promise.resolve().then(n.bind(n,80576));return{SocketAdapter:e,HttpChunkAdapter:t,HttpAdapter:i,SamanthaChatCompletionAdapter:s}})),function(){return j.apply(this,arguments)})}),I=()=>{var e;null===(e=r.Pv.get(u.aU.Socket))||void 0===e||null===(e=e.client)||void 0===e||e.removeEventListener(u.QV.open,N)},T=setTimeout((()=>{var e;null!==(e=t.socketStatus)&&void 0!==e&&e.connected?(null==v||v.addDurationPoint("ws"),null==v||v.addDurationPoint("success"),null==v||v.success()):(null==v||v.error({reason:"ws_failed"}),(0,c.SR)().error("ws_failed")),I()}),5e3),N=()=>{null==v||v.addDurationPoint("ws"),null==v||v.addDurationPoint("success"),null==v||v.success(),I(),clearTimeout(T)},E=new e({launchConfig:f,socketClientLazy:x,socketClient:b,getSocketParams:i,consoleSocketPacket:null==y?void 0:y.consoleSocketPacket,refreshSocketConfig:w}),M=new s({poolSize:3,retryAttempt:5,getCommonHttpParams:l,getCommonHttpHeaders:g,deprecatedClient:null==A?void 0:A.deprecatedClient,newClient:null==A?void 0:A.newClient,baseURL:null==A?void 0:A.baseURL,binaryType:null==y?void 0:y.binaryType,consoleIncrementMessagePacket:null==y?void 0:y.consoleIncrementMessagePacket}),P=new k(f),L=new C({baseURL:null==A?void 0:A.baseURL,getCommonHttpParams:l,getCommonHttpHeaders:g}),D=_.get("chatConfigService"),R=_.get("chatTeaService");if(!D||!R)return;const B=yield(0,m.Mz)({key:"enable_samantha_protocol_stage",featureGatingKey:"enableSamanthaProtocolStage",defaultValue:-1,chatConfigService:D,chatTeaService:R});(0,h.iY)(B)?((0,d.Ns)([P,E,M,L]),L.resumeTask((0,r.Pe)((0,a.A)(r.Rq.getState().samanthaChatCompletionTaskMap)))):(0,h.cZ)(B)?(r.Pv.register(L),(0,d.Ns)([P,E,M])):(0,d.Ns)([P,E,M]),M.resumeTask((0,r.Pe)((0,a.A)(r.Rq.getState().chunkTaskMap))),null===(S=E.client)||void 0===S||S.addEventListener(u.QV.open,N),E.on("socket_change",t.setSocketStatus)}catch(k){throw(0,d.CU)(),k}var j})),g.apply(this,arguments)}(0,l.A)((function(e){return g.apply(this,arguments)}));const _=(0,i.p)()},82854:(e,t,n)=>{n.d(t,{mf0:()=>r.mf,A4i:()=>s.A4,xfl:()=>s.xf,c5Z:()=>l.c5,Ejp:()=>l.Ej,hTZ:()=>l.hT,rUA:()=>s.rU,bRb:()=>r.bR,WZZ:()=>s.WZ,tP$:()=>r.tP,tvN:()=>s.tv,P5b:()=>s.P5,P7$:()=>c.P,sDT:()=>s.sD,LQ9:()=>s.LQ,Bvk:()=>s.Bv,aXB:()=>s.aX,zlu:()=>s.zl,U9e:()=>s.U9,jFY:()=>s.jF,mlu:()=>s.ml,Jij:()=>s.Ji,$4u:()=>s.$4,HN1:()=>s.HN,oSs:()=>s.oS,xYz:()=>s.xY,oQq:()=>s.oQ,c84:()=>s.c8,pu_:()=>s.pu,kap:()=>l.k,ozw:()=>d});n(50474),n(892);var i=n(44557),s=n(94268),o=n(39228),a=n(1456),l=n(17003);(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},a.DA),o.U),l.I6),l.Aj);n(73431);var r=n(9057),c=(n(74125),n(79279));n(56570);const d=function e(...t){const{_useMessageStore:n}=e.prototype;if(n)return n(...t);throw Error("useMessageStore is not initialized")}},39228:(e,t,n)=>{n.d(t,{U:()=>i});const i={messageFeedbackMap:{}}},17003:(e,t,n)=>{n.d(t,{Aj:()=>s.A,Ej:()=>i.Ej,I6:()=>o.I,c5:()=>i.c5,hT:()=>i.hT,k:()=>i.k});var i=n(1456),s=n(35119),o=(n(68503),n(19867));n(51239),n(45576)},1456:(e,t,n)=>{n.d(t,{DA:()=>m,Ej:()=>x,ZH:()=>_,c5:()=>b,hT:()=>f,iv:()=>h,k:()=>p,sK:()=>v});var i=n(44557),s=n(72106),o=n(5099),a=n(85371),l=n(76461),r=n(37357),c=n(46219),d=n(81435),u=n(94268);n(73431),n(61276);const m=(0,i.A)((0,i.A)({messageMap:{},localMessageMap:{},messageLinkMap:{},messageListStatusMap:{},regenerateMessageMap:{},searchResultIsFinishedMap:{},messageReportEventMap:{},sendMessagePromiseTasks:{},lastMessageMap:{},socketStatus:{loading:!1,connected:!1},rateLimitConfig:{isLimited:!1,limitExpired:void 0,limitTips:""},userInfo:{secUserId:void 0}},{}),{},{musicAutoPlay:!1});function h({draftLocalMessageMap:e,draftMessageMap:t,draftMessageLinks:n},i){const{isLocalMessage:s,messageId:o}=i;return s?delete e[o]:delete t[o],(0,l.A)(n,(e=>e.messageId===o))}function p(e,t){const{isLocalMessage:n,messageId:i}=t,{draftLocalMessageMap:s,draftMessageMap:o}=e;n&&s[i]?s[i].status=d.q7.InVisible:o[i]&&(o[i].status=d.q7.InVisible)}const g=(e,t)=>{const n=(0,i.A)((0,i.A)({},e.ext?e.ext:{}),t.ext||{});return(0,i.A)((0,i.A)((0,i.A)({},(0,o.A)(e,["local","local_message_id"])),(0,s.A)(t,a.A)),{},{ext:n})};function _({draft:e,localMessage:t,message:n,omitReportEventProperty:i=[]}){var s,a;const{message_id:l}=n,{local_message_id:c}=t;l&&c?(e.draftMessageReportEventMap[l]={reportEvents:(0,o.A)((null===(s=e.draftMessageReportEventMap[c])||void 0===s?void 0:s.reportEvents)||{},i),reportParams:(null===(a=e.draftMessageReportEventMap[c])||void 0===a?void 0:a.reportParams)||{}},delete e.draftMessageReportEventMap[c]):r.v.console.warning("skip moveReportEvents: invalid remote/local message")}function v({draft:e,localMessage:t,message:n,useRemoteMessageKey:i=!0,useOriginalMessageKey:s=!1}){const{message_id:o}=n,{local_message_id:a}=t;if(!o||!a)return void r.v.console.warning("skip replaceLocalMessageWithRemoteMessage: invalid remote/local message");e.draftMessageMap[o]=g(t,n);const l=h(e,{isLocalMessage:!0,messageId:a});if(l>-1){var c,d;const t=e.draftMessageLinks[l],n=s?t.messageKey:a;return null===(c=e.draftMessageLinks.splice(l,1,{isLocalMessage:!1,messageId:o,messageKey:i?o:n,regen_head:null===(d=e.draftMessageLinks[l])||void 0===d?void 0:d.regen_head}))||void 0===c?void 0:c[0]}r.v.persist.warning({message:"not found local message to replace",meta:{localMessageId:a}})}function f(e,t){const n=e.draftLocalMessageMap[c.rR],i=null==n?void 0:n.reply_id;if(!(0,a.A)(t)&&!(0,a.A)(i)&&t!==i)return;const s=(0,l.A)(e.draftMessageLinks,(e=>e.messageId===c.rR));if(~s){const{messageId:t}=e.draftMessageLinks[s];return h(e,{isLocalMessage:!0,messageId:t}),e.draftMessageLinks.splice(s,1)}}function b(e,t){if(!t)return;const n=(0,u.A4)({localMessageMap:e.draftLocalMessageMap,messageMap:e.draftMessageMap});(0,u.rU)({messageLinks:e.draftMessageLinks,getMessage:n,replyId:t}).forEach((t=>{h(e,{isLocalMessage:!0,messageId:t.messageId});const n=e.draftMessageLinks.findIndex((e=>e.messageId===t.messageId));-1!==n&&e.draftMessageLinks.splice(n,1)}))}function x(e,t){if(!t)return;const{draftLocalMessageMap:n}=e;Object.entries(n).forEach((([n,i])=>{i.reply_id===t&&h(e,{isLocalMessage:!0,messageId:n})}))}},35119:(e,t,n)=>{n.d(t,{A:()=>i});n(24323),n(45576),n(73014);const i={preprocessTaskMap:{},uploaderToken:{}}},68503:(e,t,n)=>{var i=n(44557),s=n(19867),o=n(35119),a=n(1456),l=n(39228),r=(n(94268),n(9057),n(61276),n(14065)),c=n(10633),d=n(27527);class u{constructor(){(0,c.A)(this,"TIMEOUT",300),(0,c.A)(this,"QUEUE_MAX_LENGTH",5),(0,c.A)(this,"queue",[]),(0,c.A)(this,"timeoutId",null),(0,c.A)(this,"promise",null),(0,c.A)(this,"hangResolver",null),(0,c.A)(this,"hangPromise",new Promise((e=>this.hangResolver=e))),(0,c.A)(this,"sended",!1)}add(e){this.queue.includes(e)||this.queue.push(e),this.queue.length>=this.QUEUE_MAX_LENGTH?(this.run(),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)):this.timeoutId||(this.timeoutId=setTimeout((()=>this.run()),this.TIMEOUT))}get(e){var t=this;return(0,r.A)((function*(){if(yield t.hangPromise,t.promise){var n;const{data:i}=yield t.promise;return null==i||null===(n=i.preview_images)||void 0===n?void 0:n[e]}}))()}run(){var e;this.sended=!0,this.promise=d.j.apiService.samantha.PDFPreview({uris:this.queue}),null===(e=this.hangResolver)||void 0===e||e.call(this)}}(()=>{let e=new u})(),(0,i.A)((0,i.A)((0,i.A)((0,i.A)({},a.DA),o.A),s.I),l.U)},45576:(e,t,n)=>{var i=n(11512),s=n(22358);new Map,i.ck.EntityType_File,i.ck.EntityType_File,s.pt.File,s.pt.OCRImage},19867:(e,t,n)=>{n.d(t,{I:()=>i});const i={suggestMessageMap:{}}},51239:(e,t,n)=>{},73431:(e,t,n)=>{var i=n(46219);i.W2},9057:(e,t,n)=>{n.d(t,{YJ:()=>i.YJ,bR:()=>i.bR,mf:()=>i.mf,qo:()=>i.qo,tP:()=>i.tP,vW:()=>i.vW});var i=n(46346)},46346:(e,t,n)=>{n.d(t,{YJ:()=>d,Zw:()=>m,bR:()=>s,mf:()=>u,qo:()=>l,tP:()=>a,vW:()=>c});var i=n(94268);const s=(e,t)=>{const n=e.messageLinkMap[t]?o(e,t,e.messageLinkMap[t]):void 0;return{lastAvailableMessage:n?a(e,t,n):void 0,lastAvailableMessageLink:n}},o=(e,t,n)=>{for(let s=n.length-1;s>=0;s--){const o=n[s],l=n[s-1],r=a(e,t,o),c=a(e,t,l);if((0,i.i8)(r)&&(0,i.i8)(c))return(0,i.hd)(r)?l:o;if((0,i.$4)(r))return o}},a=(e,t,n)=>(0,i.A4)((0,i.tv)(e,t))(n),l=(e,t)=>{const{message:n}=r(e,t,e.messageLinkMap[t],(({messageLink:e})=>e.isLocalMessage&&!!e.messageId));return n&&(0,i.xX)(n)?n:void 0},r=(e,t,n,s)=>{const o=(0,i.A4)((0,i.tv)(e,t)),a=(0,i.WZ)(n||[],(e=>s({messageLink:e,getMessage:()=>o(e)})));return{messageLink:a,message:a?o(a):void 0}},c=(e,{conversationId:t,replyId:n})=>{const s=(0,i.ci)({messageLinks:e.messageLinkMap[t],replyId:n,getMessage:(0,i.A4)((0,i.tv)(e,t))});return s?a(e,t,s):void 0},d=(e,t,n)=>{var i;return(null===(i=e.localMessageMap[t])||void 0===i?void 0:i[n])||{}},u=(e,t)=>e.preprocessTaskMap[t].key,m=(e,t,n)=>{const i=e.messageMap[t],s=i[n];if(!s)return[];const o=!s.reply_id||"0"===s.reply_id?n:s.reply_id,a=i[null!=o?o:""],l=Object.keys(i).filter((e=>{var t;return(null===(t=i[e])||void 0===t?void 0:t.reply_id)===o})).map((e=>Number(i[e].index)));return[...a?[Number(a.index)]:[],...l]}},56570:(e,t,n)=>{var i=n(62693),s=n(21511),o=n(76779),a=n(16350),l=n(45498),r=n(81435),c=n(20592),d=n(46219),u=n(37357),m=n(46346),h=n(82205),p=n(34870),g=n(64873);const _=[r.cM.Text,r.cM.Music,r.cM.Video,r.cM.Image,r.cM.File,r.cM.PluginSearchResult,r.cM.Composite,r.cM.Nested,r.cM.CopilotCard,r.cM.LyricsToSongMusic,r.cM.LyricsToSongLyric,r.cM.Outline];(0,l.vt)()((0,p.eh)(((e,t)=>({scene:void 0,isSelectMode:!1,messageIndexList:[],contentTypeWhiteList:_,preShareId:"",preMessageIndexList:[],preShareType:c.I9.All,shareType:c.I9.All,extraInfo:{},setContentTypeWhiteList:(t=_)=>{e({contentTypeWhiteList:t})},enterSelectMode:({scene:n,extraInfo:i={},data:s})=>{var o,a,l,r,d,u,m;const{isSelectMode:h,scene:p}=t();h&&n===p||e({extraInfo:i,scene:n,isSelectMode:!0,preShareId:null!==(o=null==s||null===(a=s.share_info)||void 0===a?void 0:a.share_id)&&void 0!==o?o:"",preMessageIndexList:2===(null==s||null===(l=s.share_info)||void 0===l?void 0:l.share_status)&&null!==(r=null==s||null===(d=s.share_info)||void 0===d?void 0:d.message_index_list)&&void 0!==r?r:[],preShareType:(null==s||null===(u=s.share_info)||void 0===u?void 0:u.share_type)||c.I9.All,shareType:(null==s||null===(m=s.share_info)||void 0===m?void 0:m.share_type)||c.I9.All})},exitSelectMode:()=>{t().isSelectMode&&e({scene:void 0,isSelectMode:!1,messageIndexList:[],preShareId:"",preMessageIndexList:[],extraInfo:{}})},toggleMessage:({conversationId:n,messageIndex:i,state:o})=>{var l;const{messageIndexList:r,getIsCheckboxDisabled:c,_findMessageByIndex:u}=t(),h=r.includes(i),p=u({conversationId:n,state:o,messageIndex:i}),g=(0,m.Zw)(o,n,null!==(l=null==p?void 0:p.message_id)&&void 0!==l?l:""),[_,...v]=g;if(h)return!(i===_)&&v.filter((e=>r.includes(e))).length>1?void e({messageIndexList:(0,a.A)(r,i)}):void e({messageIndexList:(0,a.A)(r,...g)});if(c({conversationId:n,messageIndex:i,state:o}))return;const f=g.filter((e=>!c({conversationId:n,messageIndex:e,state:o})));r.length+f.length>d.fV?e({messageIndexList:[...r,i].sort(((e,t)=>e-t))}):e({messageIndexList:(0,s.A)([...r,...f]).sort(((e,t)=>e-t))})},selectAll:n=>{const{_getSelectAllIndexList:i}=t();e({messageIndexList:i(n)})},deselectAll:()=>{e({messageIndexList:[]})},_findMessageByIndex:({conversationId:e,state:t,messageIndex:n})=>{var i,s;const o=t.messageMap[e],a=t.messageLinkMap[e];if(!o||!a)return;const l=Number(null===(i=o[null===(s=a[0])||void 0===s?void 0:s.messageId])||void 0===i?void 0:i.index),r=a[n-l];if(r){const i=(0,h.Tc)(e,r,t);if((null==i?void 0:i.index)===n)return i}const c=Object.keys(o).find((e=>{var t;return Number(null===(t=o[e])||void 0===t?void 0:t.index)===n}));return c?o[c]:void 0},_getSelectAllIndexList:({conversationId:e,state:n,lastMessageIndex:s})=>{var a,l,r,c;const{getIsCheckboxDisabled:d}=t(),u=n.messageMap[e],m=n.messageLinkMap[e];if(!u||!m)return[];const h=Number(null===(a=u[null===(l=m[0])||void 0===l?void 0:l.messageId])||void 0===a?void 0:a.index),p=Number(null===(r=u[null===(c=m[m.length-1])||void 0===c?void 0:c.messageId])||void 0===r?void 0:r.index);return(0,o.A)(1,s+1).filter((t=>!(0,i.A)(t,h,p+1)||!d({conversationId:e,messageIndex:t,state:n})))},getIsSelectAllChecked:e=>{const{messageIndexList:n,_getSelectAllIndexList:i}=t(),s=i(e);return n.length>0&&n.length>=s.length},getIsCheckboxDisabled:({conversationId:e,state:n,messageIndex:i})=>{const{messageIndexList:s,_findMessageByIndex:o,_isMessageDisableSelect:a,contentTypeWhiteList:l}=t();if(s.includes(i))return!1;const r=o({state:n,messageIndex:i,conversationId:e}),c=a(r);var d;c&&u.v.persist.info({eventName:"thread_share_checkbox_disabled",meta:{messageIndex:null==r?void 0:r.index,messageId:null==r?void 0:r.message_id,messageStatus:null==r?void 0:r.status,messageContentType:null==r?void 0:r.content_type,contentTypeWhiteList:l,isOnboarding:null==r||null===(d=r.ext)||void 0===d?void 0:d.onboarding,listLength:s.length}});return c},_isMessageDisableSelect:e=>{var n;const{messageIndexList:i,contentTypeWhiteList:s}=t();return!e||(!!(0,g.Tq)(e)||(e.status===r.q7.InVisible||("1"===(null===(n=e.ext)||void 0===n?void 0:n.onboarding)||(i.length>=d.fV||(!e.content_type||!s.includes(e.content_type))))))},updateMessageIndexList:n=>{const{messageIndexList:i,_isMessageDisableSelect:s}=t(),o=[];for(const e of Object.values(n)){-1!==i.indexOf(Number(e.index))&&s(e)&&o.push(Number(e.index))}const a=i.filter((e=>!o.includes(e)));e({messageIndexList:a})},setShareType:t=>{e({shareType:t})}}))))},74125:(e,t,n)=>{n(51239)},98673:(e,t,n)=>{n.d(t,{A4:()=>a,i0:()=>c,rJ:()=>r,tv:()=>o,um:()=>l});var i=n(28159),s=n(64873);n(51239);const o=(e,t)=>({messageMap:e.messageMap[t],localMessageMap:e.localMessageMap[t],messageLinks:e.messageLinkMap[t],messageListStatus:e.messageListStatusMap[t]}),a=e=>t=>{var n,i;if(!t)return;const{isLocalMessage:s,messageId:o}=t;return s?null===(n=e.localMessageMap)||void 0===n?void 0:n[o]:null===(i=e.messageMap)||void 0===i?void 0:i[o]},l=e=>`replyTo${e}`,r=e=>e?(0,s.Ji)(e)?"pic":(0,s.ze)(e)?"video":(0,s.dz)(e)?"music":(0,s.ml)(e)?"file":(0,s._n)(e)?"search_card":(0,s.TQ)(e)?"lyrics_to_song_lyric":(0,s.lT)(e)||(0,s.A9)(e)?"lyrics_to_song_music":"text":"text",c=e=>{if(e&&(0,s.pu)(e)){const{text:t}=e.content_obj||{};return(0,i.A)(t)&&t.includes("coco://sendMessage")?1:0}return 0}},94268:(e,t,n)=>{n.d(t,{rV:()=>a,A4:()=>s.A4,xf:()=>l.x,rU:()=>i.rU,WZ:()=>i.WZ,ci:()=>i.ci,i0:()=>s.i0,tv:()=>s.tv,P5:()=>r.P5,rJ:()=>s.rJ,um:()=>s.um,Y4:()=>o.Y4,fj:()=>o.fj,sD:()=>o.sD,LQ:()=>o.LQ,i8:()=>o.i8,xT:()=>o.xT,Bv:()=>o.Bv,aX:()=>o.aX,zl:()=>o.zl,U9:()=>o.U9,jF:()=>o.jF,nt:()=>o.nt,tG:()=>o.tG,ml:()=>o.ml,w5:()=>o.w5,Ji:()=>o.Ji,Wr:()=>o.Wr,xX:()=>o.xX,wt:()=>o.wt,$4:()=>o.$4,HN:()=>o.HN,oS:()=>o.oS,Wp:()=>o.Wp,KU:()=>o.KU,up:()=>o.up,Ys:()=>o.Ys,Wi:()=>o.Wi,ln:()=>o.ln,e1:()=>o.e1,ET:()=>o.ET,xY:()=>o.xY,RR:()=>o.RR,oQ:()=>o.oQ,Et:()=>o.Et,c8:()=>o.c8,yU:()=>o.yU,pu:()=>o.pu,ey:()=>o.ey,hd:()=>o.hd,t6:()=>o.t6,Cd:()=>d.C,Qw:()=>c.Q});var i=n(8382),s=n(98673),o=n(64873);function a(e,t){return(Number(null==e?void 0:e.index)||0)-(Number(null==t?void 0:t.index)||0)}var l=n(89638),r=n(32618),c=n(94063),d=n(67666)},64873:(e,t,n)=>{n.d(t,{$4:()=>j,A9:()=>H,Bv:()=>ne,ET:()=>D,Et:()=>ee,HN:()=>b,Ji:()=>$,KU:()=>te,LQ:()=>Y,RR:()=>E,TQ:()=>q,Tq:()=>K,U9:()=>oe,UQ:()=>X,Wi:()=>B,Wp:()=>y,Wr:()=>g,Y4:()=>v,Ys:()=>L,_n:()=>Z,aX:()=>se,c8:()=>w,dz:()=>z,e1:()=>U,ey:()=>k,fj:()=>S,hd:()=>I,i8:()=>N,jF:()=>ae,lT:()=>V,ln:()=>O,ml:()=>W,nt:()=>T,oQ:()=>M,oS:()=>A,pu:()=>J,sD:()=>Q,t6:()=>f,tG:()=>_,up:()=>x,w5:()=>G,wt:()=>h,xT:()=>P,xX:()=>m,xY:()=>le,yU:()=>C,ze:()=>F,zl:()=>ie});var i=n(28159),s=n(85371),o=n(9012),a=n(81435),l=n(27737),r=n(46219),c=n(95589),d=n(36572),u=n(10129);const m=e=>Boolean(e&&"local"in e),h=e=>{var t;return!!m(e)&&Boolean(null==e||null===(t=e.local)||void 0===t?void 0:t.hasBroken)},p=e=>!(!m(e)||!(B(e)||D(e)||R(e))),g=e=>{var t;return"1"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.coco_web_new_search_result_style)},_=e=>{var t;return"2"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.coco_web_new_search_result_style)},v=e=>{var t;return"3"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.coco_web_new_search_result_style)},f=e=>{var t;return"4"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.coco_web_new_search_result_style)},b=e=>{var t,n;return m(e)?e.local.failed||!(null===(t=e.error_details)||void 0===t||!t.has_error):!(null==e||null===(n=e.error_details)||void 0===n||!n.has_error)},x=e=>(null==e?void 0:e.status)===a.q7.NotCompliant,A=e=>!p(e)&&(!k(e)&&((!m(e)||!U(e))&&(!(null==e||!e.is_finish)&&e.status!==a.q7.Streaming))),y=e=>{var t,n;return!((null==e||!e.has_suggest)&&(null==e||null===(t=e.ext)||void 0===t||!t.sp)||null!=e&&null!==(n=e.ext)&&void 0!==n&&n.browser_explain)},w=(e,t)=>{if(null!=e&&e.user_type)return e.user_type===a.ut.Human;if(e&&m(e)&&e.local.isRegenerate)return!1;const{sec_sender:n}=e||{};return!!n&&(n===t||n===r.tL)},S=e=>(null==e?void 0:e.message_type)===a.Go.Ack||(null==e?void 0:e.message_type)===c.Bx.ACK,j=e=>!(0,s.A)(null==e?void 0:e.status)&&(null==e?void 0:e.status)!==a.q7.InVisible,k=e=>(null==e?void 0:e.message_type)===a.Go.Loading||(null==e?void 0:e.content_type)===d.cM.SamanthaLoading,C=e=>(null==e?void 0:e.content_type)===a.cM.Suggest||(null==e?void 0:e.content_type)===d.cM.SamanthaSuggest,I=e=>T(e)&&(null==e?void 0:e.status)!==a.q7.Available,T=e=>{var t;return"1"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.is_crowd_testing)&&J(e)},N=e=>T(e)&&j(e),E=e=>{var t,n;return!(null==e||!e.ext||null==e||null===(t=e.ext)||void 0===t||!t.onboarding||"0"===(null==e||null===(n=e.ext)||void 0===n?void 0:n.onboarding))},M=e=>{return m(e)?e.local.isRegenerate:"1"===(null===(t=e.ext)||void 0===t?void 0:t.regen);var t},P=e=>(null==e?void 0:e.status)===a.q7.Broken,L=e=>{const{status:t}=e.local;return t===u.FQ.ReceivingFirstPackage||t===u.FQ.ReceivingStream},D=e=>{const{status:t}=e.local;return t===u.FQ.SendingRegenerate},R=e=>{const{status:t}=e.local;return t===u.FQ.WaitingAck},B=e=>{const{status:t}=e.local;return t===u.FQ.ReceivingFirstPackage},O=e=>{const{status:t}=e.local;return t===u.FQ.ReceivingStream},U=e=>{const{status:t}=e.local;return t===u.FQ.Sending},F=e=>{var t;return(null==e?void 0:e.content_type)===a.cM.Video&&Array.isArray(null==e||null===(t=e.content_obj)||void 0===t?void 0:t.video_list)},q=e=>(null==e?void 0:e.content_type)===a.cM.LyricsToSongLyric,H=e=>(null==e?void 0:e.content_type)===a.cM.LyricsToSongsMusic,V=e=>(null==e?void 0:e.content_type)===a.cM.LyricsToSongMusic,K=e=>{var t;return"pages_outline"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.samantha_item_type)},z=e=>(null==e?void 0:e.content_type)===a.cM.Music||(null==e?void 0:e.content_type)===d.cM.SamanthaMusic,G=e=>{var t;return!(null==e||null===(t=e.local_info)||void 0===t||!t.finish_reply)},$=e=>(null==e?void 0:e.content_type)===a.cM.Image||(null==e?void 0:e.content_type)===d.cM.SamanthaImageOutput,W=e=>{var t;return(null==e?void 0:e.content_type)===a.cM.File&&Array.isArray(null==e||null===(t=e.content_obj)||void 0===t?void 0:t.file_list)},Y=e=>(null==e?void 0:e.content_type)===a.cM.Image,Q=e=>(null==e?void 0:e.content_type)===a.cM.File,Z=e=>!!ee(e);const X=e=>(null==e?void 0:e.content_type)===d.cM.SamanthaSearchText||(null==e?void 0:e.content_type)===d.cM.SamanthaLoading,J=e=>(null==e?void 0:e.content_type)===a.cM.Text||(null==e?void 0:e.content_type)===d.cM.SamanthaText||(null==e?void 0:e.content_type)===d.cM.SamanthaImageInput||(null==e?void 0:e.content_type)===d.cM.SamanthaSearchInput,ee=e=>(null==e?void 0:e.content_type)===a.cM.PluginSearchResult||(null==e?void 0:e.content_type)===d.cM.SamanthaSearchCard;function te(e){var t;return(null==e||null===(t=e.error_details)||void 0===t?void 0:t.error_code)===l.t.CLEAR_LAST_PROMPT}function ne(e){return(null==e?void 0:e.content_type)===a.cM.Composite}function ie(e){return ne(e)&&Array.isArray((0,o.A)(e,["content_obj","image_model","image_list"]))}function se(e){return ne(e)&&Array.isArray((0,o.A)(e,["content_obj","file_model","file_list"]))}function oe(e){return ne(e)&&(0,i.A)((0,o.A)(e,["content_obj","link_model","url"]))}function ae(e){return ne(e)&&Array.isArray((0,o.A)(e,["content_obj","website_model","pages"]))}function le(e){return!!e&&e.content_type===a.cM.Nested}},32618:(e,t,n)=>{n.d(t,{P5:()=>a});var i=n(28159),s=n(2633),o=n(64873);const a=(e,t,n)=>{if(!e)return;const a=(e=>{var t,n;if(e&&((0,o.pu)(e)||(0,o.UQ)(e))&&(0,i.A)(null==e||null===(t=e.content_obj)||void 0===t?void 0:t.text))return null==e||null===(n=e.content_obj)||void 0===n?void 0:n.text})(e);return(0,i.A)(a)?a:(0,o.HN)(e)||(0,o.Ji)(e)?void 0:t?(0,s.A)(null==e?void 0:e.content_obj)?`${n} message.content\uff1a${null==e?void 0:e.content}`:`${n} message.content\uff1a\n\n\`\`\`json\n${JSON.stringify(null==e?void 0:e.content_obj,void 0,2)}\n\`\`\`\n\n`:n}},65471:(e,t,n)=>{n.d(t,{EO:()=>i.E,o3:()=>s.o});var i=n(32102),s=(n(10734),n(25442));n(94363)},94363:(e,t,n)=>{n(82854)},61276:(e,t,n)=>{n.d(t,{FU:()=>s.FU,KF:()=>s.KF,KS:()=>s.KS,Pe:()=>s.Pe,Pv:()=>i.Pv,Rq:()=>o.Rq,TU:()=>s.TU,Yr:()=>s.Yr,kv:()=>s.kv,q6:()=>s.q6,r8:()=>s.r8,u_:()=>s.u_,up:()=>s.up,xr:()=>s.xr});var i=n(13303),s=(n(87233),n(30642)),o=n(80210);n(25856),n(91027),n(59076),n(51067)},51067:(e,t,n)=>{var i=n(170);i.nc,i.VX,i.P9},59076:(e,t,n)=>{n.d(t,{rd:()=>s});var i=n(8607);const s=(0,i.p)()},80210:(e,t,n)=>{n.d(t,{Rq:()=>i});n(84774);const i=function e(...t){const{_useChunkTaskStore:n}=e.prototype;if(n)return n(...t);throw Error("useChunkTaskStore is not initialized")}},84774:(e,t,n)=>{n(50474)},91214:(e,t,n)=>{n.d(t,{Lf:()=>a});var i=n(1800),s=n(91027),o=n(639);function a(e){return s.Hg.fromBinary(i.K.dec(e),{readerFactory:o.G}).toJson({useProtoFieldName:!0})}},18651:(e,t,n)=>{n.d(t,{I:()=>a,P:()=>o});var i=n(80160);function s(e){const t=Date.now();return t-function(e){const t=Date.now(),n=Math.pow(10,t.toString().length-1);if(e%n===e){const n=1e3*e;return n<t?n:e}return e}(e||t)<3e5}const o=e=>{const t=[];for(const n of e)if(s(Number(n.createTime))){t.push(n);break}return t};function a(e,t){return i.A.stringifyUrl({url:e,query:t})}},30642:(e,t,n)=>{n.d(t,{C_:()=>l.C_,FU:()=>o.FU,ID:()=>s.I,KF:()=>u.KF,KS:()=>u.KS,Lf:()=>r.Lf,MH:()=>o.MH,NY:()=>l.NY,OS:()=>o.OS,Pe:()=>s.P,TU:()=>u.TU,Uy:()=>i.Uy,Yr:()=>d.Yr,dV:()=>i.dV,ge:()=>l.ge,kv:()=>u.kv,n0:()=>a.n,oQ:()=>c.oQ,pu:()=>c.pu,q6:()=>o.q6,r8:()=>u.r8,u_:()=>d.bN,up:()=>i.up,xr:()=>o.xr,yU:()=>c.yU});var i=n(32206),s=n(18651),o=n(47725),a=n(84433),l=n(70942),r=n(91214),c=n(65320),d=n(84620),u=n(59257)},65320:(e,t,n)=>{n.d(t,{T1:()=>d,ey:()=>o,oQ:()=>u,pu:()=>c,xT:()=>l,yU:()=>a,zG:()=>r});var i=n(36572),s=n(81435);const o=e=>(null==e?void 0:e.message_type)===s.Go.Loading||(null==e?void 0:e.content_type)===i.cM.SamanthaLoading,a=e=>(null==e?void 0:e.content_type)===s.cM.Suggest||(null==e?void 0:e.content_type)===i.cM.SamanthaSuggest,l=e=>(null==e?void 0:e.status)===s.q7.Broken;function r(e){return(null==e?void 0:e.content_type)===s.cM.Nested}const c=e=>(null==e?void 0:e.content_type)===s.cM.Text||(null==e?void 0:e.content_type)===i.cM.SamanthaText||(null==e?void 0:e.content_type)===i.cM.SamanthaImageInput,d=e=>{var t;return"1"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.is_finish)},u=e=>{var t;return"1"===(null==e||null===(t=e.ext)||void 0===t?void 0:t.stream_async)}},32206:(e,t,n)=>{n.d(t,{Uy:()=>m,dV:()=>h,up:()=>p});var i=n(44557),s=n(85371),o=n(81435),a=n(36572),l=n(65320),r=n(37357);function c(e,t){return(0,i.A)((0,i.A)((0,i.A)({},e),t),{},{text:((null==e?void 0:e.text)||"")+((null==t?void 0:t.text)||"")})}function d(e,t){var n,i;return{suggest:[...null!==(n=null==e?void 0:e.suggest)&&void 0!==n?n:[],...null!==(i=null==t?void 0:t.suggest)&&void 0!==i?i:[]]}}function u(e,t){return[...null!=e?e:[],...null!=t?t:[]]}function m(e,t){if(!e)return t;if(!t)return e;const n=(0,l.xT)(t),s=(0,i.A)((0,i.A)((0,i.A)({},e),t),{},{is_delta:!1});if(e.message_type!==t.message_type||e.content_type!==t.content_type)return t;if(!t.is_delta)return t;if((0,l.ey)(t))return t;if(t.is_delta){var a,m,h;if(p(e,t))return e;if(t.content_obj)switch(t.content_type){case o.cM.Text:s.content_obj=c(e.content_obj,n?void 0:t.content_obj);break;case o.cM.Suggest:s.content_obj=d(e.content_obj,n?void 0:t.content_obj);break;case o.cM.CopilotCard:s.content_obj=(g=e.content_obj,_=n?void 0:t.content_obj,{copilot:[...null!==(v=null==g?void 0:g.copilot)&&void 0!==v?v:[],...null!==(f=null==_?void 0:_.copilot)&&void 0!==f?f:[]]});break;default:s.content_obj=n?e.content_obj:t.content_obj}if(null!==(a=s.ext)&&void 0!==a&&a.ref_info_data)s.ext.ref_info_data=function(e,t){if(!e&&!t)return"[]";let n=[],i=[];try{n=e&&"null"!==e?JSON.parse(e):[],i=t&&"null"!==t?JSON.parse(t):[]}catch(s){return r.v.console.info(`json parse refInfoData error: ${s}`),null!=t?t:"[]"}return JSON.stringify([...n,...i])}(null==e||null===(m=e.ext)||void 0===m?void 0:m.ref_info_data,null==t||null===(h=t.ext)||void 0===h?void 0:h.ref_info_data);s.meta_infos=u(e.meta_infos,n?void 0:t.meta_infos)}var g,_,v,f;return s}function h(e,t){if(!e)return(0,i.A)((0,i.A)({},t),{},{is_delta:!1});if(!t)return e;const n=(0,i.A)((0,i.A)((0,i.A)({},e),t),{},{is_delta:!1});if(e.content_type!==t.content_type)return(0,i.A)((0,i.A)({},t),{},{is_delta:!1});if(!t.is_delta)return t;if((0,l.ey)(t))return(0,i.A)((0,i.A)({},t),{},{is_delta:!1});if(t.is_delta){if(t.content_obj)switch(t.content_type){case a.cM.SamanthaSearchText:case a.cM.SamanthaText:n.content_obj=c(e.content_obj,t.content_obj);break;case a.cM.SamanthaSuggest:n.content_obj=d(e.content_obj,t.content_obj);break;default:n.content_obj=t.content_obj}n.meta_infos=u(e.meta_infos,t.meta_infos)}return n}const p=(e,t)=>{const n=t.chunk_seq,i=null==e?void 0:e.chunk_seq;return!(0,s.A)(n)&&!(0,s.A)(i)&&Number(n)<Number(i)}},47725:(e,t,n)=>{n.d(t,{FU:()=>p,MH:()=>b,OS:()=>f,q6:()=>g,xr:()=>v});var i=n(44557),s=n(65814),o=n(76398),a=n(2633),l=n(9012),r=n(63379),c=n(18590),d=n(95589),u=n(36572),m=n(59076),h=n(65320);const p=e=>{var t;const n=null===(t=(0,c.O)((0,l.A)(e,["samantha_context"]),{}))||void 0===t?void 0:t.query_context;return null!=n&&n.edit_image_url?{edit_image_config:n}:{}},g=e=>{const t=(0,o.A)((0,c.O)((0,l.A)(e,["input_skill"]),void 0),["variables","show_variables","ext_info"]);return(0,a.A)(t)?{}:{translate_config:t}},_=e=>{const t=(0,h.oQ)(e);return(0,h.T1)(e)&&!t},v=(e,t)=>{const n=(0,i.A)((0,i.A)({},e),{},{local_info:t,content_obj:(0,c.O)(e.content,void 0)});(0,r.A)(n,(0,i.A)((0,i.A)({is_finish:_(e),has_suggest:"1"===(0,l.A)(e,["ext","has_suggest"])},(e=>{const t=(0,l.A)(e,["ext","has_err"]);return t?{error_details:{has_error:!0,error_code:Number(t),error_message:"Server Error",locale:""}}:{}})(e)),{},{ext:e.ext}));const o=m.rd.service;if(e.content_type&&o){const i=null==o?void 0:o.getChatProtocolPlugin(e.content_type);return(0,s.A)(i,((n,i)=>i.normalizePushMessage(n,e,t)),n)}return n},f=(e,t)=>{var n,s,o;const a=(0,i.A)((0,i.A)({},e.message),{},{message_type:d.Bx.CMPL,conversation_id:e.conversation_id,local_message_id:e.local_message_id,local_conversation_id:e.local_conversation_id,message_id:e.message_id,is_delta:e.is_delta,reply_id:e.reply_id,status:e.status,local_info:t,content_obj:(0,c.O)(null===(n=e.message)||void 0===n?void 0:n.content,{}),section_id:e.section_id,is_finish:e.is_finish,has_suggest:e.has_suggest,input_content_type:e.input_content_type,message_action_bar:{invisible:null===(s=e.message_action_bar)||void 0===s?void 0:s.invisible,config:(0,c.O)(null===(o=e.message_action_bar)||void 0===o?void 0:o.config,{})}});var l;return a.content_type===u.cM.SamanthaSuggest?(null!==(l=a.content_obj)&&void 0!==l&&l.suggest&&(a.content_obj={suggest:[a.content_obj.suggest]}),a):a},b=(e,t,n)=>{var i;const s=null==t||null===(i=t.messages)||void 0===i?void 0:i[0],o={message_type:d.Bx.ACK,content_type:null==s?void 0:s.content_type,conversation_id:e.conversation_id,local_message_id:e.local_message_id,local_conversation_id:e.local_conversation_id,message_id:e.message_id,section_id:e.section_id,attachments:null==s?void 0:s.attachments,references:null==s?void 0:s.references,status:e.status,is_delta:!1,reply_id:"0",local_info:n,is_finish:!0};return null==s||s.content_type,o}},84620:(e,t,n)=>{n.d(t,{Yr:()=>d,bN:()=>u});var i=n(44557),s=n(36572),o=n(18590),a=n(59257),l=n(47725),r=n(58447),c=n(96274);function d(e){if(e.length<=0)return;const t=1===e.length?{message:e[0]}:{message_list:e};return(0,i.A)((0,i.A)({},t),{},{event_type:c.B.Message})}function u(e,t){var n,s;if(!(e.length<=0))return{messages:e.map((e=>{var t;const n=(0,o.O)(e.content,{}),s=(0,o.O)(null===(t=e.ext)||void 0===t?void 0:t.input_skill,{});switch(Number(s.skill_id)){case r.K9.ImageGeneration:{var c,d,u;const t=(0,o.O)(e.content,{text:""}),n={text:(null==t?void 0:t.text)||"",style:null===(c=s.variables)||void 0===c?void 0:c.style,ratio:null===(d=s.variables)||void 0===d?void 0:d.ratio,template_type:null===(u=s.variables)||void 0===u?void 0:u.template_type,edit_image:(0,l.FU)(e.ext).edit_image_config};return{content:JSON.stringify(n),content_type:m[r.K9.ImageGeneration],references:(0,a.KS)(e.ext)}}case r.K9.Translate:{var h;const t=(0,i.A)({text:n.text},null===(h=(0,l.q6)(e.ext))||void 0===h?void 0:h.translate_config);return{content:(0,o.e)(t),content_type:m[r.K9.Translate]}}case r.K9.ReadPDF:{var p;const t={text:n.text,immersive_files:null==e||null===(p=e.ext)||void 0===p?void 0:p.immersive_reading_files},i=[],s=[...(0,a.KS)(e.ext)];return null!=n&&n.file_model&&i.push(...(0,a.TU)(n.file_model)),null!=n&&n.link_model&&i.push((0,a.kv)(n.link_model)),null!=n&&n.entities&&i.push(...(0,a.r8)(n.entities)),{content:(0,o.e)(t),content_type:m[r.K9.ReadPDF],attachments:i,references:s}}case r.K9.ReadWebsite:{var g;const e={text:n.text},t=null===(g=e.text.match(/http[s]{0,1}:\/\/.*/))||void 0===g?void 0:g[0];return{content:(0,o.e)(e),content_type:m[r.K9.ReadWebsite],attachments:t?[(0,a.cz)(t)]:[]}}default:{const e={text:n.text||""},t=[];return null!=n&&n.file_model&&t.push(...(0,a.TU)(n.file_model)),null!=n&&n.link_model&&t.push((0,a.kv)(n.link_model)),n.image_model&&t.push(...(0,a.KF)(n.image_model)),n.entities&&t.push(...(0,a.r8)(n.entities)),{content:(0,o.e)(e),content_type:m[s.skill_id||r.K9.Default],attachments:t}}}})),completion_option:(0,i.A)({is_regen:"1"===(null===(n=e[0])||void 0===n||null===(n=n.ext)||void 0===n?void 0:n.regen),with_suggest:!(null===(s=e[0].ext)||void 0===s||!s.answer_with_suggest),need_create_conversation:!!e[0].local_conversation_id},t),conversation_id:Number(e[0].conversation_id),local_conversation_id:e[0].local_conversation_id,local_message_id:e[0].local_message_id,reply_id:e[0].reply_id}}const m={[r.K9.Default]:s.cM.SamanthaText,[r.K9.ImageGeneration]:s.cM.SamanthaImageInput,[r.K9.MusicAssistant]:s.cM.SamanthaMusicGenInput,[r.K9.AcademicSearch]:s.cM.SamanthaText,[r.K9.Search]:s.cM.SamanthaSearchInput,[r.K9.DeepSearch]:s.cM.SamanthaText,[r.K9.Translate]:s.cM.SamanthaTranslate,[r.K9.WriteAssistant]:s.cM.SamanthaText,[r.K9.ReadPDF]:s.cM.SamanthaReadInput,[r.K9.ReadWebsite]:s.cM.SamanthaWebpageInput,[r.K9.ExerciseAssistant]:s.cM.SamanthaText,[r.K9.ReadAndSummarize]:s.cM.SamanthaText,[r.K9.ReadMultiWebsites]:s.cM.SamanthaText,[r.K9.CodeInterpreter]:s.cM.SamanthaText}},17834:(e,t,n)=>{n.d(t,{Mz:()=>o});var i=n(14065),s=n(49392);const o=function(){var e=(0,i.A)((function*(e){const{chatTeaService:t,chatConfigService:n}=e;if(e.featureGatingKey&&e.featureGatingKey in n.featureGating&&!(0,s.A)(n.featureGating[e.featureGatingKey]))return n.featureGating[e.featureGatingKey];return yield t.getTeaVar(e.key,null==e?void 0:e.defaultValue)}));return function(t){return e.apply(this,arguments)}}()},72041:(e,t,n)=>{n.d(t,{WR:()=>i});var i={Unknown:0,File:1,Image:2}},81309:(e,t,n)=>{n.d(t,{YK:()=>i});let i=function(e){return e[e.User=0]="User",e[e.Coco=1]="Coco",e[e.GuanFang=2]="GuanFang",e[e.CocoWeb=3]="CocoWeb",e}({})},22358:(e,t,n)=>{n.d(t,{Cp:()=>a,HK:()=>i,hI:()=>o,pt:()=>s});let i=function(e){return e[e.MessageDelete=1]="MessageDelete",e[e.MessageLike=2]="MessageLike",e[e.MessageDislike=3]="MessageDislike",e[e.MessageIDLocalMapping=4]="MessageIDLocalMapping",e[e.MessageNotCompliant=5]="MessageNotCompliant",e[e.ConversationArchive=11]="ConversationArchive",e[e.ConversationAdd=12]="ConversationAdd",e[e.ConversationCreateSection=13]="ConversationCreateSection",e[e.ConversationClearHistory=14]="ConversationClearHistory",e[e.ConversationUpdate=15]="ConversationUpdate",e[e.ConversationRead=16]="ConversationRead",e[e.ConversationLandingInsert=17]="ConversationLandingInsert",e[e.OnboardingBegin=21]="OnboardingBegin",e[e.OnboardingFail=22]="OnboardingFail",e[e.OnboardingCancel=23]="OnboardingCancel",e[e.OnboardingNeedStart=26]="OnboardingNeedStart",e[e.UserBanned=31]="UserBanned",e[e.UserBanRelease=32]="UserBanRelease",e[e.UserConfigUpdate=41]="UserConfigUpdate",e[e.NeedLocation=51]="NeedLocation",e[e.PushToast=60]="PushToast",e[e.TTSBegin=91]="TTSBegin",e[e.UserMute=101]="UserMute",e[e.UserMuteRelease=102]="UserMuteRelease",e[e.TouristReachChatLimit=1e3]="TouristReachChatLimit",e[e.NestedMessageStateChange=1001]="NestedMessageStateChange",e[e.TouristReachThreadLimit=1002]="TouristReachThreadLimit",e[e.MessageRefImagesNotCompliant=1003]="MessageRefImagesNotCompliant",e[e.MessageUpdate=1004]="MessageUpdate",e}({}),s=function(e){return e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.OCRImage=2]="OCRImage",e[e.Audio=3]="Audio",e}({}),o=function(e){return e[e.ParseState_Default=0]="ParseState_Default",e[e.ParseState_Success=1]="ParseState_Success",e[e.ParseState_Failed=2]="ParseState_Failed",e[e.ParseState_Processing=3]="ParseState_Processing",e}({}),a=function(e){return e[e.ReviewState_Default=0]="ReviewState_Default",e[e.ReviewState_Access=1]="ReviewState_Access",e[e.ReviewState_NotCompliant=2]="ReviewState_NotCompliant",e[e.ReviewState_Processing=3]="ReviewState_Processing",e}({})},81435:(e,t,n)=>{n.d(t,{Go:()=>o,Xt:()=>i,cM:()=>s,q7:()=>a,ut:()=>l});let i=function(e){return e[e.WebSocket=0]="WebSocket",e[e.HttpChunk=1]="HttpChunk",e[e.Http=2]="Http",e}({}),s=function(e){return e[e.Text=1]="Text",e[e.Suggest=2]="Suggest",e[e.Music=3]="Music",e[e.WebView=4]="WebView",e[e.Video=5]="Video",e[e.Image=6]="Image",e[e.File=7]="File",e[e.PluginSearchResult=8]="PluginSearchResult",e[e.AwemeVideoList=9]="AwemeVideoList",e[e.Composite=10]="Composite",e[e.Biz=11]="Biz",e[e.Nested=20]="Nested",e[e.Card=50]="Card",e[e.BotCard=51]="BotCard",e[e.FormMsg=53]="FormMsg",e[e.CopilotCard=60]="CopilotCard",e[e.LyricsToSongMusic=70]="LyricsToSongMusic",e[e.LyricsToSongLyric=71]="LyricsToSongLyric",e[e.LyricsToSongsMusic=72]="LyricsToSongsMusic",e[e.PagesCard=80]="PagesCard",e[e.Outline=81]="Outline",e[e.Widget=100]="Widget",e[e.DoraRecord=101]="DoraRecord",e[e.Multi=900]="Multi",e[e.Unsupported=1e3]="Unsupported",e}({}),o=function(e){return e[e.Message=1]="Message",e[e.Ack=2]="Ack",e[e.Loading=3]="Loading",e}({}),a=function(e){return e[e.Available=1]="Available",e[e.InVisible=2]="InVisible",e[e.Broken=3]="Broken",e[e.Streaming=4]="Streaming",e[e.Unselected=5]="Unselected",e[e.NotCompliant=6]="NotCompliant",e}({}),l=function(e){return e[e.Human=1]="Human",e[e.Bot=2]="Bot",e}({})},11512:(e,t,n)=>{n.d(t,{ck:()=>i});let i=function(e){return e[e.EntityType_Unknown=0]="EntityType_Unknown",e[e.EntityType_File=1]="EntityType_File",e[e.EntityType_Image=2]="EntityType_Image",e}({})},20592:(e,t,n)=>{n.d(t,{I9:()=>i});let i=function(e){return e[e.All=1]="All",e[e.Conversation=2]="Conversation",e}({})},58447:(e,t,n)=>{n.d(t,{K9:()=>i});let i=function(e){return e[e.Default=0]="Default",e[e.ReadAndSummarize=1]="ReadAndSummarize",e[e.WriteAssistant=2]="WriteAssistant",e[e.ImageGeneration=3]="ImageGeneration",e[e.Search=4]="Search",e[e.Translate=5]="Translate",e[e.ReadPDF=6]="ReadPDF",e[e.ReadWebsite=7]="ReadWebsite",e[e.DeepSearch=8]="DeepSearch",e[e.MusicAssistant=9]="MusicAssistant",e[e.AcademicSearch=10]="AcademicSearch",e[e.ExerciseAssistant=11]="ExerciseAssistant",e[e.ReadMultiWebsites=12]="ReadMultiWebsites",e[e.CodeInterpreter=13]="CodeInterpreter",e}({})},27737:(e,t,n)=>{n.d(t,{t:()=>i});let i=function(e){return e[e.UNKNOWN_ERROR=1]="UNKNOWN_ERROR",e[e.SHARK_BLOCKED=710022002]="SHARK_BLOCKED",e[e.COUNTRY_RESTRICTED=710022017]="COUNTRY_RESTRICTED",e[e.CONTENT_UNAVAILABLE=710012005]="CONTENT_UNAVAILABLE",e[e.NOACCESS=710012e3]="NOACCESS",e[e.NO_PERMISSION=710020101]="NO_PERMISSION",e[e.BAD_REQUEST=710020201]="BAD_REQUEST",e[e.INVALID_PARAMS=710020202]="INVALID_PARAMS",e[e.USER_INVALID=710022e3]="USER_INVALID",e[e.SYSTEM_ERROR=710020702]="SYSTEM_ERROR",e[e.SYSTEM_ERROR2=710022001]="SYSTEM_ERROR2",e[e.NOT_LOGIN=710012001]="NOT_LOGIN",e[e.NO_INNER_SSO_TOKEN=710012006]="NO_INNER_SSO_TOKEN",e[e.LIMIT_TO_SEND_MESSAGE=710022004]="LIMIT_TO_SEND_MESSAGE",e[e.BOT_INVALID=710022005]="BOT_INVALID",e[e.BOT_BANNED=710022010]="BOT_BANNED",e[e.BOT_REVIEWING=710022011]="BOT_REVIEWING",e[e.CONVERSATION_INVALID=710022006]="CONVERSATION_INVALID",e[e.NEED_TO_WAIT=710012007]="NEED_TO_WAIT",e[e.CLEAR_LAST_PROMPT=710022008]="CLEAR_LAST_PROMPT",e[e.USER_BANNED=710012008]="USER_BANNED",e[e.USER_BAN_RELEASED=710012009]="USER_BAN_RELEASED",e[e.USER_BAN_APPEALING=710012011]="USER_BAN_APPEALING",e[e.USER_BAN_APPEAL_FAILED=710012010]="USER_BAN_APPEAL_FAILED",e[e.NETWORK_TIMEOUT=710010701]="NETWORK_TIMEOUT",e[e.MYSQL_ERROR=710020801]="MYSQL_ERROR",e[e.PARAMS_VALID_FAILED=710020203]="PARAMS_VALID_FAILED",e[e.REDIS_ERROR=710020803]="REDIS_ERROR",e[e.USER_NO_AUTH_USE_BOT=710012012]="USER_NO_AUTH_USE_BOT",e[e.USER_NOT_EXISTED=710012014]="USER_NOT_EXISTED",e[e.OPEN_AUTH_INVALID=710012020]="OPEN_AUTH_INVALID",e[e.IMAGE_SAFETY_ERROR=710025003]="IMAGE_SAFETY_ERROR",e[e.FILE_SAFETY_ERROR=710025004]="FILE_SAFETY_ERROR",e[e.CONVERSATION_MESSAGE_OVER_LIMIT=710018001]="CONVERSATION_MESSAGE_OVER_LIMIT",e[e.CONVERSATION_UNDER_REVIEW=710018002]="CONVERSATION_UNDER_REVIEW",e[e.CONVERSATION_SHARE_DELETED=710018003]="CONVERSATION_SHARE_DELETED",e[e.GUEST_REACH_LIMIT=710022013]="GUEST_REACH_LIMIT",e[e.GUEST_CONVERSATION_REACH_LIMIT=710022022]="GUEST_CONVERSATION_REACH_LIMIT",e[e.COLLECTION_DELETED=710027003]="COLLECTION_DELETED",e[e.INVALID_MUSIC_SHARING=710019001]="INVALID_MUSIC_SHARING",e[e.SECURITY_RESOURCE_REJECTED=671020001]="SECURITY_RESOURCE_REJECTED",e}({})},80385:(e,t,n)=>{n.d(t,{j:()=>l,o:()=>r});var i=n(6693),s=n(11855),o=n(35687),a=n(34774);const l=()=>{const[e,t]=(0,s.useState)(!1),n=(0,s.useMemo)((()=>(0,i.A)((()=>t(!1)),300,{leading:!1,trailing:!0})),[]),o=(0,s.useCallback)((()=>{e||t(!0),n()}),[e]);return{className:e?a.A["show-scrollbar-thumb"]:"",onScroll:o}},r=({onVisibleChange:e})=>{const t=(0,s.useRef)(!1),n=n=>{n!==t.current&&(t.current=n,null==e||e(n))},{run:i}=(0,o.A)((()=>{n(!1)}),{wait:300,leading:!1,trailing:!0});return{onScroll:()=>{t.current||n(!0),i()}}}},15159:(e,t,n)=>{n.d(t,{UploaderService:()=>g});var i=n(44557),s=n(14065),o=n(10633),a=n(42579),l=n.n(a),r=n(69902),c=n(16100),d=n(25865),u=n.n(d),m=n(27527),h=n(3365);const p=u();class g{constructor(e){(0,o.A)(this,"type",void 0),(0,o.A)(this,"scene",void 0),(0,o.A)(this,"authToken",void 0),(0,o.A)(this,"client",void 0),(0,o.A)(this,"useDirectUpload",void 0),(0,o.A)(this,"callbackMap",{});const{type:t,scene:n,userId:i,appId:s,useDirectUpload:a=!1}=e;this.useDirectUpload=a,this.type=t,this.scene=n;const l=(0,c.XB)({eventName:"uploader_service_init",meta:this.localParams});try{var r,d,u;this.client=new p({appId:s,userId:i,useFileExtension:!0}),null===(r=this.client)||void 0===r||r.on("complete",this.onComplete.bind(this)),null===(d=this.client)||void 0===d||d.on("error",this.onError.bind(this)),null===(u=this.client)||void 0===u||u.on("progress",this.onProgress.bind(this)),l.success()}catch(m){l.error({reason:"init error",error:m})}}get stsToken(){var e,t,n,i,s;return{CurrentTime:(null===(e=this.authToken)||void 0===e||null===(e=e.auth)||void 0===e?void 0:e.current_time)||"",ExpiredTime:(null===(t=this.authToken)||void 0===t||null===(t=t.auth)||void 0===t?void 0:t.expired_time)||"",SessionToken:(null===(n=this.authToken)||void 0===n||null===(n=n.auth)||void 0===n?void 0:n.session_token)||"",AccessKeyId:(null===(i=this.authToken)||void 0===i||null===(i=i.auth)||void 0===i?void 0:i.access_key_id)||"",SecretAccessKey:(null===(s=this.authToken)||void 0===s||null===(s=s.auth)||void 0===s?void 0:s.secret_access_key)||""}}get tokenExpired(){var e;if(!this.authToken)return!0;const t=l()(),n=l()(null===(e=this.authToken)||void 0===e||null===(e=e.auth)||void 0===e?void 0:e.expired_time);return t.isAfter(n)}get localParams(){return{type:this.type,scene:this.scene}}refreshToken(){var e=this;return(0,s.A)((function*(){const t=(0,c.XB)({eventName:"uploader_service_refresh_token",meta:e.localParams});try{const{data:o}=yield m.j.apiService.resource.GetUploadAuthToken({scene:e.scene,data_type:e.type===h.sh.IMAGE?"image":"file"});if(o){var n,i,s;if(e.authToken=o,null===(n=e.client)||void 0===n||n.refreshSTSToken(e.stsToken),e.type===h.sh.IMAGE)null===(i=e.client)||void 0===i||i.setOption({imageHost:`https://${null==o?void 0:o.upload_host}`,imageConfig:{serviceId:(null==o?void 0:o.service_id)||""}});else null===(s=e.client)||void 0===s||s.setOption({imageHost:`https://${null==o?void 0:o.upload_host}`,objectConfig:{serviceId:(null==o?void 0:o.service_id)||""}});return t.success(),Promise.resolve(o)}return t.error({reason:"GetUploadAuthToken empty"}),Promise.reject(new Error("GetUploadAuthToken empty"))}catch(o){return t.error({reason:"GetUploadAuthToken catch",error:o}),Promise.reject(o)}}))()}onComplete(e){var t,n;this.callbackMap[e.key]&&(null===(t=this.callbackMap[e.key])||void 0===t||null===(n=t.complete)||void 0===n||n.call(t,e),delete this.callbackMap[e.key])}onError(e){var t,n;this.callbackMap[e.key]&&(null===(t=this.callbackMap[e.key])||void 0===t||null===(n=t.error)||void 0===n||n.call(t,e))}onProgress(e){var t,n;null===(t=this.callbackMap[e.key])||void 0===t||null===(n=t.progress)||void 0===n||n.call(t,e)}upload(e,t){var n=this;return(0,s.A)((function*(){var s;const o=(0,c.XB)({eventName:"uploader_service_upload",meta:n.localParams});if(!n.client)return void o.error({reason:"client is empty"});if(n.tokenExpired)try{yield n.refreshToken()}catch(u){var a;o.error({reason:"refreshToken error",error:u});const e={startTime:0,endTime:0,stageStartTime:0,stageEndTime:0,duration:0,fileSize:0,key:"",oid:"",percent:0,signature:"",sliceLength:0,stage:"",status:3,task:null,uploadID:"",type:"error",extra:{error:u,message:"refreshToken error"}};return void(null==t||null===(a=t.error)||void 0===a||a.call(t,e))}if(null===(s=n.authToken)||void 0===s||!s.auth)throw o.error({reason:"authToken is empty"}),new Error("authToken is empty");const l={file:e,stsToken:n.stsToken,type:n.type,useDirectUpload:n.useDirectUpload};o.updateMeta({file_size:e.size,file_name_length:(0,r.p)("name")(e).length});const d=n.type===h.sh.IMAGE?n.client.addImageFile(l):n.client.addFile(l);n.callbackMap[d]=(0,i.A)((0,i.A)({},t),{},{complete:e=>{var n;o.success(),null===(n=t.complete)||void 0===n||n.call(t,e)},error:e=>{var n,i;o.error({reason:"upload error",error:null===(n=e.extra)||void 0===n?void 0:n.error}),null===(i=t.error)||void 0===i||i.call(t,e)}}),n.client.start(d)}))()}}},36225:(e,t,n)=>{n.d(t,{Bo:()=>a,q3:()=>l});var i=n(49392),s=n(28159),o=n(91689);n(49196);const a=e=>(0,o.A)(e)&&e.every(s.A);const l=e=>!(0,i.A)(e)},13734:(e,t,n)=>{n.d(t,{GO:()=>i,ti:()=>g});const i=e=>{var t;return(null===(t=(e||"").match(/\.([^.]+)$/))||void 0===t?void 0:t[1].toLowerCase().trim())||""},s=e=>t=>e.includes(t),o=s(["txt"]),a=s(["csv"]),l=s(["xlsx","xls"]),r=s(["xbm","tif","pjp","svgz","jpg","jpeg","ico","tiff","gif","svg","jfif","webp","png","bmp","pjpeg","avif"]),c=s(["pdf"]),d=s(["ppt","pptx"]),u=s(["doc","docx"]),m=s(["md","markdown"]),h=s(["epub"]),p=s(["mobi"]),g=e=>a(e)?"CSV":c(e)?"PDF":l(e)?"Spreadsheet":r(e)?"Image":d(e)?"PPT":u(e)?"Document":o(e)?"Txt":m(e)?"Markdown":h(e)?"Epub":p(e)?"Mobi":"File"},39415:(e,t,n)=>{n.d(t,{F_:()=>o,M:()=>l,UP:()=>a,Z5:()=>r,jc:()=>s,ps:()=>c});n(7685);let i;const s=()=>{if(void 0===i){const{userAgent:e}=navigator,t=/iPad/.test(e),n=e.includes("Macintosh")&&"ontouchstart"in document.documentElement;i=t||n}return i},o=()=>"function"==typeof window.webkitConvertPointFromNodeToPage,a=()=>/edge?\//.test(navigator.userAgent.toLowerCase());const l="undefined"!=typeof window,r=()=>{if("undefined"==typeof navigator)return;const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\.([0-9]+)\.([0-9]+)/);if(null===e||5!==e.length)return;const[,t,n,i,s]=e.map((e=>parseInt(e,10)));return{major:t,minor:n,build:i,patch:s}},c=()=>{if("undefined"!=typeof window){const{userAgent:e}=navigator;return/Samantha/.test(e)}return!1}},15957:(e,t,n)=>{n.d(t,{h9:()=>s,ts:()=>i});n(11855);const i=(e,t=3,n=1e3)=>new Promise(((s,o)=>{e().then(s).catch((a=>{setTimeout((()=>{1!==t?i(e,t-1,n).then(s,o):o(a)}),n)}))})),s=({fn:e,retriesLeft:t=3,interval:n=1e3,fallback:i={default:()=>null},onError:o=()=>{}})=>new Promise(((a,l)=>{e().then(a).catch((r=>{setTimeout((()=>{if(1===t)return null==o||o(r),void a(i);s({fn:e,retriesLeft:t-1,interval:n,fallback:i,onError:o}).then(a,l)}),n)}))}))},34774:(e,t,n)=>{n.d(t,{A:()=>i});const i={"show-scrollbar-thumb":"show-scrollbar-thumb-RYti2z",showScrollbarThumb:"show-scrollbar-thumb-RYti2z"}}},n={};function i(e){var s=n[e];if(void 0!==s)return s.exports;var o=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}i.m=t,e=[],i.O=(t,n,s,o)=>{if(!n){var a=1/0;for(d=0;d<e.length;d++){for(var[n,s,o]=e[d],l=!0,r=0;r<n.length;r++)(!1&o||a>=o)&&Object.keys(i.O).every((e=>i.O[e](n[r])))?n.splice(r--,1):(l=!1,o<a&&(a=o));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[n,s,o]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={575:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var s,o,[a,l,r]=n,c=0;if(a.some((t=>0!==e[t]))){for(s in l)i.o(l,s)&&(i.m[s]=l[s]);if(r)var d=r(i)}for(t&&t(n);c<a.length;c++)o=a[c],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return i.O(d)},n=self.webpackChunkflow_web_extension=self.webpackChunkflow_web_extension||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.O(void 0,[126,627,685,279,141,736,773,609,896,922],(()=>i(37894)));var s=i.O(void 0,[126,627,685,279,141,736,773,609,896,922],(()=>i(97466)));s=i.O(s);